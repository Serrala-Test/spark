<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_71) on Thu Apr 02 14:27:49 PDT 2015 -->
<title>WriteAheadLogManager (Spark 1.4.0 JavaDoc)</title>
<meta name="date" content="2015-04-02">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="WriteAheadLogManager (Spark 1.4.0 JavaDoc)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogFileSegment.html" title="class in org.apache.spark.streaming.util"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.LogInfo.html" title="class in org.apache.spark.streaming.util"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/spark/streaming/util/WriteAheadLogManager.html" target="_top">Frames</a></li>
<li><a href="WriteAheadLogManager.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.spark.streaming.util</div>
<h2 title="Class WriteAheadLogManager" class="title">Class WriteAheadLogManager</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>Object</li>
<li>
<ul class="inheritance">
<li>org.apache.spark.streaming.util.WriteAheadLogManager</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../org/apache/spark/Logging.html" title="interface in org.apache.spark">Logging</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">WriteAheadLogManager</span>
extends Object
implements <a href="../../../../../org/apache/spark/Logging.html" title="interface in org.apache.spark">Logging</a></pre>
<div class="block">This class manages write ahead log files.
 - Writes records (bytebuffers) to periodically rotating log files.
 - Recovers the log files and the reads the recovered records upon failures.
 - Cleans up old log files.
 <p>
 Uses <a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogWriter.html" title="class in org.apache.spark.streaming.util"><code>WriteAheadLogWriter</code></a> to write
 and <a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogReader.html" title="class in org.apache.spark.streaming.util"><code>WriteAheadLogReader</code></a> to read.
 <p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.LogInfo.html" title="class in org.apache.spark.streaming.util">WriteAheadLogManager.LogInfo</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.LogInfo$.html" title="class in org.apache.spark.streaming.util">WriteAheadLogManager.LogInfo$</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.html#WriteAheadLogManager(java.lang.String,%20org.apache.hadoop.conf.Configuration,%20int,%20int,%20java.lang.String,%20org.apache.spark.util.Clock)">WriteAheadLogManager</a></strong>(String&nbsp;logDirectory,
                    org.apache.hadoop.conf.Configuration&nbsp;hadoopConf,
                    int&nbsp;rollingIntervalSecs,
                    int&nbsp;maxFailures,
                    String&nbsp;callerName,
                    <a href="../../../../../org/apache/spark/util/Clock.html" title="interface in org.apache.spark.util">Clock</a>&nbsp;clock)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.html#cleanupOldLogs(long,%20boolean)">cleanupOldLogs</a></strong>(long&nbsp;threshTime,
              boolean&nbsp;waitForCompletion)</code>
<div class="block">Delete the log files that are older than the threshold time.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static scala.util.matching.Regex</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.html#logFileRegex()">logFileRegex</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static scala.collection.Seq&lt;<a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.LogInfo.html" title="class in org.apache.spark.streaming.util">WriteAheadLogManager.LogInfo</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.html#logFilesTologInfo(scala.collection.Seq)">logFilesTologInfo</a></strong>(scala.collection.Seq&lt;org.apache.hadoop.fs.Path&gt;&nbsp;files)</code>
<div class="block">Convert a sequence of files to a sequence of sorted LogInfo objects</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>scala.collection.Iterator&lt;java.nio.ByteBuffer&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.html#readFromLog()">readFromLog</a></strong>()</code>
<div class="block">Read all the existing logs from the log directory.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.html#stop()">stop</a></strong>()</code>
<div class="block">Stop the manager, close any open log writer</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static String</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.html#timeToLogFile(long,%20long)">timeToLogFile</a></strong>(long&nbsp;startTime,
             long&nbsp;stopTime)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogFileSegment.html" title="class in org.apache.spark.streaming.util">WriteAheadLogFileSegment</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.html#writeToLog(java.nio.ByteBuffer)">writeToLog</a></strong>(java.nio.ByteBuffer&nbsp;byteBuffer)</code>
<div class="block">Write a byte buffer to the log file.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_org.apache.spark.Logging">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.apache.spark.<a href="../../../../../org/apache/spark/Logging.html" title="interface in org.apache.spark">Logging</a></h3>
<code><a href="../../../../../org/apache/spark/Logging.html#initializeIfNecessary()">initializeIfNecessary</a>, <a href="../../../../../org/apache/spark/Logging.html#initializeLogging()">initializeLogging</a>, <a href="../../../../../org/apache/spark/Logging.html#isTraceEnabled()">isTraceEnabled</a>, <a href="../../../../../org/apache/spark/Logging.html#log_()">log_</a>, <a href="../../../../../org/apache/spark/Logging.html#log()">log</a>, <a href="../../../../../org/apache/spark/Logging.html#logDebug(scala.Function0)">logDebug</a>, <a href="../../../../../org/apache/spark/Logging.html#logDebug(scala.Function0,%20java.lang.Throwable)">logDebug</a>, <a href="../../../../../org/apache/spark/Logging.html#logError(scala.Function0)">logError</a>, <a href="../../../../../org/apache/spark/Logging.html#logError(scala.Function0,%20java.lang.Throwable)">logError</a>, <a href="../../../../../org/apache/spark/Logging.html#logInfo(scala.Function0)">logInfo</a>, <a href="../../../../../org/apache/spark/Logging.html#logInfo(scala.Function0,%20java.lang.Throwable)">logInfo</a>, <a href="../../../../../org/apache/spark/Logging.html#logTrace(scala.Function0)">logTrace</a>, <a href="../../../../../org/apache/spark/Logging.html#logTrace(scala.Function0,%20java.lang.Throwable)">logTrace</a>, <a href="../../../../../org/apache/spark/Logging.html#logWarning(scala.Function0)">logWarning</a>, <a href="../../../../../org/apache/spark/Logging.html#logWarning(scala.Function0,%20java.lang.Throwable)">logWarning</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="WriteAheadLogManager(java.lang.String, org.apache.hadoop.conf.Configuration, int, int, java.lang.String, org.apache.spark.util.Clock)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>WriteAheadLogManager</h4>
<pre>public&nbsp;WriteAheadLogManager(String&nbsp;logDirectory,
                    org.apache.hadoop.conf.Configuration&nbsp;hadoopConf,
                    int&nbsp;rollingIntervalSecs,
                    int&nbsp;maxFailures,
                    String&nbsp;callerName,
                    <a href="../../../../../org/apache/spark/util/Clock.html" title="interface in org.apache.spark.util">Clock</a>&nbsp;clock)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="logFileRegex()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logFileRegex</h4>
<pre>public static&nbsp;scala.util.matching.Regex&nbsp;logFileRegex()</pre>
</li>
</ul>
<a name="timeToLogFile(long, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>timeToLogFile</h4>
<pre>public static&nbsp;String&nbsp;timeToLogFile(long&nbsp;startTime,
                   long&nbsp;stopTime)</pre>
</li>
</ul>
<a name="logFilesTologInfo(scala.collection.Seq)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logFilesTologInfo</h4>
<pre>public static&nbsp;scala.collection.Seq&lt;<a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.LogInfo.html" title="class in org.apache.spark.streaming.util">WriteAheadLogManager.LogInfo</a>&gt;&nbsp;logFilesTologInfo(scala.collection.Seq&lt;org.apache.hadoop.fs.Path&gt;&nbsp;files)</pre>
<div class="block">Convert a sequence of files to a sequence of sorted LogInfo objects</div>
</li>
</ul>
<a name="writeToLog(java.nio.ByteBuffer)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeToLog</h4>
<pre>public&nbsp;<a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogFileSegment.html" title="class in org.apache.spark.streaming.util">WriteAheadLogFileSegment</a>&nbsp;writeToLog(java.nio.ByteBuffer&nbsp;byteBuffer)</pre>
<div class="block">Write a byte buffer to the log file. This method synchronously writes the data in the
 ByteBuffer to HDFS. When this method returns, the data is guaranteed to have been flushed
 to HDFS, and will be available for readers to read.</div>
</li>
</ul>
<a name="readFromLog()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readFromLog</h4>
<pre>public&nbsp;scala.collection.Iterator&lt;java.nio.ByteBuffer&gt;&nbsp;readFromLog()</pre>
<div class="block">Read all the existing logs from the log directory.
 <p>
 Note that this is typically called when the caller is initializing and wants
 to recover past state from the write ahead logs (that is, before making any writes).
 If this is called after writes have been made using this manager, then it may not return
 the latest the records. This does not deal with currently active log files, and
 hence the implementation is kept simple.</div>
</li>
</ul>
<a name="cleanupOldLogs(long, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cleanupOldLogs</h4>
<pre>public&nbsp;void&nbsp;cleanupOldLogs(long&nbsp;threshTime,
                  boolean&nbsp;waitForCompletion)</pre>
<div class="block">Delete the log files that are older than the threshold time.
 <p>
 Its important to note that the threshold time is based on the time stamps used in the log
 files, which is usually based on the local system time. So if there is coordination necessary
 between the node calculating the threshTime (say, driver node), and the local system time
 (say, worker node), the caller has to take account of possible time skew.
 <p>
 If waitForCompletion is set to true, this method will return only after old logs have been
 deleted. This should be set to true only for testing. Else the files will be deleted
 asynchronously.</div>
</li>
</ul>
<a name="stop()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>stop</h4>
<pre>public&nbsp;void&nbsp;stop()</pre>
<div class="block">Stop the manager, close any open log writer</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogFileSegment.html" title="class in org.apache.spark.streaming.util"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../org/apache/spark/streaming/util/WriteAheadLogManager.LogInfo.html" title="class in org.apache.spark.streaming.util"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/spark/streaming/util/WriteAheadLogManager.html" target="_top">Frames</a></li>
<li><a href="WriteAheadLogManager.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
