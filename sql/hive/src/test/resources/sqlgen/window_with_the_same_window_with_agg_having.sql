-- This file is automatically generated by LogicalPlanToSQLSuite.
SELECT key, value,
MAX(value) OVER (PARTITION BY key % 5 ORDER BY key DESC) AS max
FROM parquet_t1 GROUP BY key, value HAVING key > 5
--------------------------------------------------------------------------------
SELECT parquet_t1.`key`, parquet_t1.`value`, `max` FROM (SELECT parquet_t1.`key`, parquet_t1.`value`, `_w0`, `max`, `max` FROM (SELECT parquet_t1.`key`, parquet_t1.`value`, `_w0`, max(parquet_t1.`value`) OVER (PARTITION BY `_w0` ORDER BY parquet_t1.`key` DESC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS `max` FROM (SELECT parquet_t1.`key`, parquet_t1.`value`, (parquet_t1.`key` % CAST(5 AS BIGINT)) AS `_w0` FROM parquet_t1 GROUP BY parquet_t1.`key`, parquet_t1.`value` HAVING (parquet_t1.`key` > CAST(5 AS BIGINT)))))
