-- This file is automatically generated by LogicalPlanToSQLSuite.
SELECT t.key - 5, cnt, SUM(cnt)
FROM (SELECT x.key, COUNT(*) as cnt
FROM parquet_t1 x JOIN parquet_t1 y ON x.key = y.key GROUP BY x.key) t
GROUP BY cnt, t.key - 5
WITH ROLLUP
--------------------------------------------------------------------------------
SELECT (t.`key` - CAST(5 AS BIGINT)) AS `(key - CAST(5 AS BIGINT))`, t.`cnt` AS `cnt`, sum(t.`cnt`) AS `sum(cnt)` FROM (SELECT t.`key`, t.`cnt`, t.`cnt` AS `cnt`, (t.`key` - CAST(5 AS BIGINT)) AS `(key - cast(5 as bigint))` FROM (SELECT x.`key`, count(1) AS `cnt` FROM (parquet_t1) AS x INNER JOIN (parquet_t1) AS y ON (x.`key` = y.`key`) GROUP BY x.`key`) AS t) GROUP BY t.`cnt`, (t.`key` - CAST(5 AS BIGINT)) GROUPING SETS((t.`cnt`, (t.`key` - CAST(5 AS BIGINT))), (t.`cnt`), ())
