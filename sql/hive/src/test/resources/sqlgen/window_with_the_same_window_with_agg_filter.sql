-- This file is automatically generated by LogicalPlanToSQLSuite.
SELECT key, value,
DENSE_RANK() OVER (DISTRIBUTE BY key SORT BY key, value) AS dr,
COUNT(key) OVER(DISTRIBUTE BY key SORT BY key, value) AS ca
FROM parquet_t1
--------------------------------------------------------------------------------
SELECT parquet_t1.`key`, parquet_t1.`value`, `dr`, `ca` FROM (SELECT parquet_t1.`key`, parquet_t1.`value`, `dr`, `ca`, `dr`, `ca` FROM (SELECT parquet_t1.`key`, parquet_t1.`value`, DENSE_RANK() OVER (PARTITION BY parquet_t1.`key` ORDER BY parquet_t1.`key` ASC, parquet_t1.`value` ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS `dr`, count(parquet_t1.`key`) OVER (PARTITION BY parquet_t1.`key` ORDER BY parquet_t1.`key` ASC, parquet_t1.`value` ASC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS `ca` FROM (SELECT parquet_t1.`key`, parquet_t1.`value` FROM parquet_t1)))
