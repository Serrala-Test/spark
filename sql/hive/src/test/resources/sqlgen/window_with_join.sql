-- This file is automatically generated by LogicalPlanToSQLSuite.
SELECT x.key, MAX(y.key) OVER (PARTITION BY x.key % 5 ORDER BY x.key)
FROM parquet_t1 x JOIN parquet_t1 y ON x.key = y.key
--------------------------------------------------------------------------------
SELECT x.`key`, `max(key) OVER (PARTITION BY (key % CAST(5 AS BIGINT)) ORDER BY key ASC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)` FROM (SELECT x.`key`, y.`key`, `_w1`, `max(key) OVER (PARTITION BY (key % CAST(5 AS BIGINT)) ORDER BY key ASC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)`, `max(key) OVER (PARTITION BY (key % CAST(5 AS BIGINT)) ORDER BY key ASC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)` FROM (SELECT x.`key`, y.`key`, `_w1`, max(y.`key`) OVER (PARTITION BY `_w1` ORDER BY x.`key` ASC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS `max(key) OVER (PARTITION BY (key % CAST(5 AS BIGINT)) ORDER BY key ASC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)` FROM (SELECT x.`key`, y.`key`, (x.`key` % CAST(5 AS BIGINT)) AS `_w1` FROM (parquet_t1) AS x INNER JOIN (parquet_t1) AS y ON (x.`key` = y.`key`))))
