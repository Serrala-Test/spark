-- This file is automatically generated by LogicalPlanToSQLSuite.
SELECT key, value,
DENSE_RANK() OVER (DISTRIBUTE BY key SORT BY key, value) AS dr,
COUNT(key)
FROM parquet_t1 GROUP BY key, value
--------------------------------------------------------------------------------
SELECT parquet_t1.`key`, parquet_t1.`value`, `dr`, `count(key)` FROM (SELECT parquet_t1.`key`, parquet_t1.`value`, `count(key)`, `dr`, `dr` FROM (SELECT parquet_t1.`key`, parquet_t1.`value`, `count(key)`, DENSE_RANK() OVER (PARTITION BY parquet_t1.`key` ORDER BY parquet_t1.`key` ASC, parquet_t1.`value` ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS `dr` FROM (SELECT parquet_t1.`key`, parquet_t1.`value`, count(parquet_t1.`key`) AS `count(key)` FROM parquet_t1 GROUP BY parquet_t1.`key`, parquet_t1.`value`)))
