-- Automatically generated by TPCDSQueryTestSuite

-- !query
SELECT
  ca_state,
  cd_gender,
  cd_marital_status,
  count(*) cnt1,
  min(cd_dep_count),
  max(cd_dep_count),
  avg(cd_dep_count),
  cd_dep_employed_count,
  count(*) cnt2,
  min(cd_dep_employed_count),
  max(cd_dep_employed_count),
  avg(cd_dep_employed_count),
  cd_dep_college_count,
  count(*) cnt3,
  min(cd_dep_college_count),
  max(cd_dep_college_count),
  avg(cd_dep_college_count)
FROM
  customer c, customer_address ca, customer_demographics
WHERE
  c.c_current_addr_sk = ca.ca_address_sk AND
    cd_demo_sk = c.c_current_cdemo_sk AND
    exists(SELECT *
           FROM store_sales, date_dim
           WHERE c.c_customer_sk = ss_customer_sk AND
             ss_sold_date_sk = d_date_sk AND
             d_year = 2002 AND
             d_qoy < 4) AND
    (exists(SELECT *
            FROM web_sales, date_dim
            WHERE c.c_customer_sk = ws_bill_customer_sk AND
              ws_sold_date_sk = d_date_sk AND
              d_year = 2002 AND
              d_qoy < 4) OR
      exists(SELECT *
             FROM catalog_sales, date_dim
             WHERE c.c_customer_sk = cs_ship_customer_sk AND
               cs_sold_date_sk = d_date_sk AND
               d_year = 2002 AND
               d_qoy < 4))
GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count,
  cd_dep_employed_count, cd_dep_college_count
ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count,
  cd_dep_employed_count, cd_dep_college_count
LIMIT 100
-- !query schema
struct<ca_state:string,cd_gender:string,cd_marital_status:string,cnt1:bigint,min(cd_dep_count):int,max(cd_dep_count):int,avg(cd_dep_count):double,cd_dep_employed_count:int,cnt2:bigint,min(cd_dep_employed_count):int,max(cd_dep_employed_count):int,avg(cd_dep_employed_count):double,cd_dep_college_count:int,cnt3:bigint,min(cd_dep_college_count):int,max(cd_dep_college_count):int,avg(cd_dep_college_count):double>
-- !query output
NULL	F	D	1	0	0	0.0	1	1	1	1	1.0	2	1	2	2	2.0
NULL	F	D	1	0	0	0.0	3	1	3	3	3.0	0	1	0	0	0.0
NULL	F	D	1	0	0	0.0	5	1	5	5	5.0	0	1	0	0	0.0
NULL	F	D	1	0	0	0.0	6	1	6	6	6.0	0	1	0	0	0.0
NULL	F	D	1	1	1	1.0	1	1	1	1	1.0	1	1	1	1	1.0
NULL	F	D	1	1	1	1.0	5	1	5	5	5.0	3	1	3	3	3.0
NULL	F	D	1	3	3	3.0	0	1	0	0	0.0	5	1	5	5	5.0
NULL	F	D	1	3	3	3.0	1	1	1	1	1.0	3	1	3	3	3.0
NULL	F	D	1	3	3	3.0	5	1	5	5	5.0	4	1	4	4	4.0
NULL	F	D	1	4	4	4.0	2	1	2	2	2.0	5	1	5	5	5.0
NULL	F	D	1	4	4	4.0	4	1	4	4	4.0	4	1	4	4	4.0
NULL	F	D	1	6	6	6.0	0	1	0	0	0.0	6	1	6	6	6.0
NULL	F	D	1	6	6	6.0	5	1	5	5	5.0	4	1	4	4	4.0
NULL	F	M	1	0	0	0.0	0	1	0	0	0.0	3	1	3	3	3.0
NULL	F	M	1	0	0	0.0	3	1	3	3	3.0	6	1	6	6	6.0
NULL	F	M	1	1	1	1.0	2	1	2	2	2.0	4	1	4	4	4.0
NULL	F	M	1	1	1	1.0	3	1	3	3	3.0	3	1	3	3	3.0
NULL	F	M	1	1	1	1.0	4	1	4	4	4.0	2	1	2	2	2.0
NULL	F	M	1	1	1	1.0	6	1	6	6	6.0	2	1	2	2	2.0
NULL	F	M	1	2	2	2.0	1	1	1	1	1.0	0	1	0	0	0.0
NULL	F	M	1	2	2	2.0	5	1	5	5	5.0	4	1	4	4	4.0
NULL	F	M	1	3	3	3.0	0	1	0	0	0.0	4	1	4	4	4.0
NULL	F	M	1	4	4	4.0	2	1	2	2	2.0	1	1	1	1	1.0
NULL	F	M	1	4	4	4.0	4	1	4	4	4.0	1	1	1	1	1.0
NULL	F	M	1	5	5	5.0	1	1	1	1	1.0	2	1	2	2	2.0
NULL	F	M	1	5	5	5.0	3	1	3	3	3.0	3	1	3	3	3.0
NULL	F	M	1	6	6	6.0	2	1	2	2	2.0	2	1	2	2	2.0
NULL	F	M	1	6	6	6.0	2	1	2	2	2.0	3	1	3	3	3.0
NULL	F	M	1	6	6	6.0	3	1	3	3	3.0	4	1	4	4	4.0
NULL	F	M	1	6	6	6.0	5	1	5	5	5.0	1	1	1	1	1.0
NULL	F	M	2	1	1	1.0	1	2	1	1	1.0	0	2	0	0	0.0
NULL	F	S	1	0	0	0.0	0	1	0	0	0.0	3	1	3	3	3.0
NULL	F	S	1	0	0	0.0	2	1	2	2	2.0	3	1	3	3	3.0
NULL	F	S	1	0	0	0.0	3	1	3	3	3.0	6	1	6	6	6.0
NULL	F	S	1	0	0	0.0	4	1	4	4	4.0	5	1	5	5	5.0
NULL	F	S	1	1	1	1.0	0	1	0	0	0.0	3	1	3	3	3.0
NULL	F	S	1	1	1	1.0	3	1	3	3	3.0	4	1	4	4	4.0
NULL	F	S	1	1	1	1.0	4	1	4	4	4.0	0	1	0	0	0.0
NULL	F	S	1	1	1	1.0	4	1	4	4	4.0	4	1	4	4	4.0
NULL	F	S	1	1	1	1.0	5	1	5	5	5.0	0	1	0	0	0.0
NULL	F	S	1	2	2	2.0	0	1	0	0	0.0	3	1	3	3	3.0
NULL	F	S	1	2	2	2.0	1	1	1	1	1.0	6	1	6	6	6.0
NULL	F	S	1	2	2	2.0	2	1	2	2	2.0	2	1	2	2	2.0
NULL	F	S	1	2	2	2.0	4	1	4	4	4.0	6	1	6	6	6.0
NULL	F	S	1	2	2	2.0	6	1	6	6	6.0	1	1	1	1	1.0
NULL	F	S	1	2	2	2.0	6	1	6	6	6.0	5	1	5	5	5.0
NULL	F	S	1	3	3	3.0	1	1	1	1	1.0	0	1	0	0	0.0
NULL	F	S	1	3	3	3.0	1	1	1	1	1.0	2	1	2	2	2.0
NULL	F	S	1	3	3	3.0	3	1	3	3	3.0	0	1	0	0	0.0
NULL	F	S	1	3	3	3.0	4	1	4	4	4.0	6	1	6	6	6.0
NULL	F	S	1	3	3	3.0	6	1	6	6	6.0	6	1	6	6	6.0
NULL	F	S	1	4	4	4.0	0	1	0	0	0.0	2	1	2	2	2.0
NULL	F	S	1	5	5	5.0	4	1	4	4	4.0	2	1	2	2	2.0
NULL	F	S	1	5	5	5.0	6	1	6	6	6.0	6	1	6	6	6.0
NULL	F	S	1	6	6	6.0	0	1	0	0	0.0	0	1	0	0	0.0
NULL	F	S	1	6	6	6.0	0	1	0	0	0.0	2	1	2	2	2.0
NULL	F	S	1	6	6	6.0	4	1	4	4	4.0	5	1	5	5	5.0
NULL	F	U	1	0	0	0.0	4	1	4	4	4.0	1	1	1	1	1.0
NULL	F	U	1	0	0	0.0	5	1	5	5	5.0	1	1	1	1	1.0
NULL	F	U	1	0	0	0.0	6	1	6	6	6.0	6	1	6	6	6.0
NULL	F	U	1	1	1	1.0	5	1	5	5	5.0	2	1	2	2	2.0
NULL	F	U	1	2	2	2.0	4	1	4	4	4.0	4	1	4	4	4.0
NULL	F	U	1	3	3	3.0	1	1	1	1	1.0	6	1	6	6	6.0
NULL	F	U	1	3	3	3.0	3	1	3	3	3.0	6	1	6	6	6.0
NULL	F	U	1	3	3	3.0	4	1	4	4	4.0	3	1	3	3	3.0
NULL	F	U	1	3	3	3.0	5	1	5	5	5.0	1	1	1	1	1.0
NULL	F	U	1	3	3	3.0	6	1	6	6	6.0	0	1	0	0	0.0
NULL	F	U	1	3	3	3.0	6	1	6	6	6.0	3	1	3	3	3.0
NULL	F	U	1	6	6	6.0	1	1	1	1	1.0	3	1	3	3	3.0
NULL	F	U	1	6	6	6.0	2	1	2	2	2.0	1	1	1	1	1.0
NULL	F	U	1	6	6	6.0	5	1	5	5	5.0	6	1	6	6	6.0
NULL	F	W	1	0	0	0.0	2	1	2	2	2.0	4	1	4	4	4.0
NULL	F	W	1	0	0	0.0	6	1	6	6	6.0	2	1	2	2	2.0
NULL	F	W	1	2	2	2.0	5	1	5	5	5.0	1	1	1	1	1.0
NULL	F	W	1	4	4	4.0	0	1	0	0	0.0	4	1	4	4	4.0
NULL	F	W	1	4	4	4.0	1	1	1	1	1.0	1	1	1	1	1.0
NULL	F	W	1	4	4	4.0	2	1	2	2	2.0	6	1	6	6	6.0
NULL	F	W	1	4	4	4.0	4	1	4	4	4.0	3	1	3	3	3.0
NULL	F	W	1	5	5	5.0	6	1	6	6	6.0	1	1	1	1	1.0
NULL	F	W	1	6	6	6.0	2	1	2	2	2.0	6	1	6	6	6.0
NULL	F	W	1	6	6	6.0	3	1	3	3	3.0	4	1	4	4	4.0
NULL	F	W	1	6	6	6.0	4	1	4	4	4.0	0	1	0	0	0.0
NULL	F	W	1	6	6	6.0	5	1	5	5	5.0	6	1	6	6	6.0
NULL	M	D	1	1	1	1.0	5	1	5	5	5.0	6	1	6	6	6.0
NULL	M	D	1	2	2	2.0	3	1	3	3	3.0	3	1	3	3	3.0
NULL	M	D	1	2	2	2.0	6	1	6	6	6.0	1	1	1	1	1.0
NULL	M	D	1	2	2	2.0	6	1	6	6	6.0	6	1	6	6	6.0
NULL	M	D	1	3	3	3.0	5	1	5	5	5.0	4	1	4	4	4.0
NULL	M	D	1	3	3	3.0	6	1	6	6	6.0	6	1	6	6	6.0
NULL	M	D	1	4	4	4.0	5	1	5	5	5.0	5	1	5	5	5.0
NULL	M	D	1	6	6	6.0	1	1	1	1	1.0	1	1	1	1	1.0
NULL	M	D	1	6	6	6.0	2	1	2	2	2.0	5	1	5	5	5.0
NULL	M	D	1	6	6	6.0	4	1	4	4	4.0	3	1	3	3	3.0
NULL	M	D	1	6	6	6.0	4	1	4	4	4.0	4	1	4	4	4.0
NULL	M	M	1	0	0	0.0	0	1	0	0	0.0	2	1	2	2	2.0
NULL	M	M	1	0	0	0.0	1	1	1	1	1.0	6	1	6	6	6.0
NULL	M	M	1	0	0	0.0	2	1	2	2	2.0	0	1	0	0	0.0
NULL	M	M	1	0	0	0.0	6	1	6	6	6.0	1	1	1	1	1.0
NULL	M	M	1	0	0	0.0	6	1	6	6	6.0	2	1	2	2	2.0
NULL	M	M	1	1	1	1.0	1	1	1	1	1.0	6	1	6	6	6.0
