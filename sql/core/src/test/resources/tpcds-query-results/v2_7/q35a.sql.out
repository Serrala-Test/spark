-- Automatically generated by TPCDSQueryTestSuite

-- !query
-- This is a new query in TPCDS v2.7
select
  ca_state,
  cd_gender,
  cd_marital_status,
  cd_dep_count,
  count(*) cnt1,
  avg(cd_dep_count),
  max(cd_dep_count),
  sum(cd_dep_count),
  cd_dep_employed_count,
  count(*) cnt2,
  avg(cd_dep_employed_count),
  max(cd_dep_employed_count),
  sum(cd_dep_employed_count),
  cd_dep_college_count,
  count(*) cnt3,
  avg(cd_dep_college_count),
  max(cd_dep_college_count),
  sum(cd_dep_college_count)
from
  customer c, customer_address ca, customer_demographics
where
  c.c_current_addr_sk = ca.ca_address_sk
    and cd_demo_sk = c.c_current_cdemo_sk
    and exists (
        select *
        from store_sales, date_dim
        where c.c_customer_sk = ss_customer_sk
          and ss_sold_date_sk = d_date_sk
          and d_year = 1999
          and d_qoy < 4)
    and exists (
        select *
        from (
            select ws_bill_customer_sk customsk
            from web_sales, date_dim
            where ws_sold_date_sk = d_date_sk
              and d_year = 1999
              and d_qoy < 4
        union all
        select cs_ship_customer_sk customsk
        from catalog_sales, date_dim
        where cs_sold_date_sk = d_date_sk
          and d_year = 1999
          and d_qoy < 4) x
        where x.customsk = c.c_customer_sk)
group by
  ca_state,
  cd_gender,
  cd_marital_status,
  cd_dep_count,
  cd_dep_employed_count,
  cd_dep_college_count
order by
  ca_state,
  cd_gender,
  cd_marital_status,
  cd_dep_count,
  cd_dep_employed_count,
  cd_dep_college_count
limit 100
-- !query schema
struct<ca_state:string,cd_gender:string,cd_marital_status:string,cd_dep_count:int,cnt1:bigint,avg(cd_dep_count):double,max(cd_dep_count):int,sum(cd_dep_count):bigint,cd_dep_employed_count:int,cnt2:bigint,avg(cd_dep_employed_count):double,max(cd_dep_employed_count):int,sum(cd_dep_employed_count):bigint,cd_dep_college_count:int,cnt3:bigint,avg(cd_dep_college_count):double,max(cd_dep_college_count):int,sum(cd_dep_college_count):bigint>
-- !query output
NULL	F	D	0	1	0.0	0	0	2	1	2.0	2	2	1	1	1.0	1	1
NULL	F	D	0	1	0.0	0	0	2	1	2.0	2	2	6	1	6.0	6	6
NULL	F	D	1	1	1.0	1	1	2	1	2.0	2	2	4	1	4.0	4	4
NULL	F	D	1	1	1.0	1	1	4	1	4.0	4	4	6	1	6.0	6	6
NULL	F	D	1	1	1.0	1	1	5	1	5.0	5	5	5	1	5.0	5	5
NULL	F	D	2	1	2.0	2	2	1	1	1.0	1	1	0	1	0.0	0	0
NULL	F	D	2	1	2.0	2	2	4	1	4.0	4	4	5	1	5.0	5	5
NULL	F	D	3	1	3.0	3	3	2	1	2.0	2	2	2	1	2.0	2	2
NULL	F	D	3	1	3.0	3	3	4	1	4.0	4	4	6	1	6.0	6	6
NULL	F	D	4	1	4.0	4	4	1	1	1.0	1	1	3	1	3.0	3	3
NULL	F	D	4	1	4.0	4	4	3	1	3.0	3	3	1	1	1.0	1	1
NULL	F	D	4	1	4.0	4	4	6	1	6.0	6	6	4	1	4.0	4	4
NULL	F	D	4	1	4.0	4	4	6	1	6.0	6	6	6	1	6.0	6	6
NULL	F	D	5	1	5.0	5	5	4	1	4.0	4	4	0	1	0.0	0	0
NULL	F	D	5	1	5.0	5	5	6	1	6.0	6	6	2	1	2.0	2	2
NULL	F	D	6	1	6.0	6	6	1	1	1.0	1	1	4	1	4.0	4	4
NULL	F	D	6	1	6.0	6	6	1	1	1.0	1	1	5	1	5.0	5	5
NULL	F	M	0	1	0.0	0	0	0	1	0.0	0	0	3	1	3.0	3	3
NULL	F	M	0	1	0.0	0	0	2	1	2.0	2	2	1	1	1.0	1	1
NULL	F	M	1	1	1.0	1	1	1	1	1.0	1	1	0	1	0.0	0	0
NULL	F	M	1	1	1.0	1	1	1	1	1.0	1	1	6	1	6.0	6	6
NULL	F	M	1	1	1.0	1	1	3	1	3.0	3	3	3	1	3.0	3	3
NULL	F	M	1	1	1.0	1	1	4	1	4.0	4	4	4	1	4.0	4	4
NULL	F	M	2	1	2.0	2	2	4	1	4.0	4	4	3	1	3.0	3	3
NULL	F	M	2	1	2.0	2	2	6	1	6.0	6	6	2	1	2.0	2	2
NULL	F	M	3	1	3.0	3	3	4	1	4.0	4	4	5	1	5.0	5	5
NULL	F	M	4	1	4.0	4	4	5	1	5.0	5	5	5	1	5.0	5	5
NULL	F	M	5	1	5.0	5	5	0	1	0.0	0	0	0	1	0.0	0	0
NULL	F	M	5	1	5.0	5	5	2	1	2.0	2	2	4	1	4.0	4	4
NULL	F	M	6	1	6.0	6	6	4	1	4.0	4	4	5	1	5.0	5	5
NULL	F	M	6	1	6.0	6	6	5	1	5.0	5	5	5	1	5.0	5	5
NULL	F	S	0	1	0.0	0	0	1	1	1.0	1	1	3	1	3.0	3	3
NULL	F	S	0	1	0.0	0	0	2	1	2.0	2	2	3	1	3.0	3	3
NULL	F	S	0	1	0.0	0	0	3	1	3.0	3	3	6	1	6.0	6	6
NULL	F	S	0	1	0.0	0	0	5	1	5.0	5	5	1	1	1.0	1	1
NULL	F	S	1	1	1.0	1	1	2	1	2.0	2	2	3	1	3.0	3	3
NULL	F	S	2	1	2.0	2	2	1	1	1.0	1	1	2	1	2.0	2	2
NULL	F	S	2	1	2.0	2	2	3	1	3.0	3	3	4	1	4.0	4	4
NULL	F	S	2	1	2.0	2	2	6	1	6.0	6	6	4	1	4.0	4	4
NULL	F	S	3	1	3.0	3	3	1	1	1.0	1	1	1	1	1.0	1	1
NULL	F	S	3	1	3.0	3	3	3	1	3.0	3	3	0	1	0.0	0	0
NULL	F	S	3	1	3.0	3	3	3	1	3.0	3	3	1	1	1.0	1	1
NULL	F	S	3	1	3.0	3	3	4	1	4.0	4	4	0	1	0.0	0	0
NULL	F	S	3	1	3.0	3	3	5	1	5.0	5	5	3	1	3.0	3	3
NULL	F	S	3	1	3.0	3	3	5	1	5.0	5	5	5	1	5.0	5	5
NULL	F	S	3	1	3.0	3	3	6	1	6.0	6	6	6	1	6.0	6	6
NULL	F	S	4	1	4.0	4	4	2	1	2.0	2	2	2	1	2.0	2	2
NULL	F	S	6	1	6.0	6	6	0	1	0.0	0	0	0	1	0.0	0	0
NULL	F	S	6	1	6.0	6	6	5	1	5.0	5	5	3	1	3.0	3	3
NULL	F	U	1	1	1.0	1	1	6	1	6.0	6	6	5	1	5.0	5	5
NULL	F	U	2	1	2.0	2	2	6	1	6.0	6	6	3	1	3.0	3	3
NULL	F	U	3	1	3.0	3	3	3	1	3.0	3	3	6	1	6.0	6	6
NULL	F	U	5	1	5.0	5	5	3	1	3.0	3	3	3	1	3.0	3	3
NULL	F	U	6	1	6.0	6	6	5	1	5.0	5	5	3	1	3.0	3	3
NULL	F	U	6	1	6.0	6	6	6	1	6.0	6	6	0	1	0.0	0	0
NULL	F	W	0	1	0.0	0	0	1	1	1.0	1	1	3	1	3.0	3	3
NULL	F	W	0	1	0.0	0	0	4	1	4.0	4	4	5	1	5.0	5	5
NULL	F	W	0	1	0.0	0	0	5	1	5.0	5	5	1	1	1.0	1	1
NULL	F	W	0	1	0.0	0	0	6	1	6.0	6	6	4	1	4.0	4	4
NULL	F	W	3	1	3.0	3	3	3	1	3.0	3	3	0	1	0.0	0	0
NULL	F	W	3	1	3.0	3	3	3	1	3.0	3	3	2	1	2.0	2	2
NULL	F	W	3	1	3.0	3	3	3	1	3.0	3	3	3	1	3.0	3	3
NULL	F	W	3	1	3.0	3	3	6	1	6.0	6	6	0	1	0.0	0	0
NULL	F	W	4	1	4.0	4	4	1	1	1.0	1	1	1	1	1.0	1	1
NULL	F	W	4	1	4.0	4	4	2	1	2.0	2	2	3	1	3.0	3	3
NULL	F	W	4	1	4.0	4	4	3	1	3.0	3	3	1	1	1.0	1	1
NULL	F	W	4	1	4.0	4	4	4	1	4.0	4	4	4	1	4.0	4	4
NULL	F	W	5	1	5.0	5	5	0	1	0.0	0	0	1	1	1.0	1	1
NULL	F	W	5	1	5.0	5	5	4	1	4.0	4	4	2	1	2.0	2	2
NULL	F	W	6	1	6.0	6	6	0	1	0.0	0	0	6	1	6.0	6	6
NULL	F	W	6	1	6.0	6	6	3	1	3.0	3	3	2	1	2.0	2	2
NULL	F	W	6	1	6.0	6	6	5	1	5.0	5	5	5	1	5.0	5	5
NULL	F	W	6	2	6.0	6	12	2	2	2.0	2	4	6	2	6.0	6	12
NULL	M	D	0	1	0.0	0	0	1	1	1.0	1	1	4	1	4.0	4	4
NULL	M	D	0	1	0.0	0	0	3	1	3.0	3	3	0	1	0.0	0	0
NULL	M	D	1	1	1.0	1	1	4	1	4.0	4	4	5	1	5.0	5	5
NULL	M	D	1	1	1.0	1	1	5	1	5.0	5	5	6	1	6.0	6	6
NULL	M	D	2	1	2.0	2	2	4	1	4.0	4	4	2	1	2.0	2	2
NULL	M	D	2	1	2.0	2	2	5	1	5.0	5	5	4	1	4.0	4	4
NULL	M	D	2	1	2.0	2	2	5	1	5.0	5	5	6	1	6.0	6	6
NULL	M	D	3	1	3.0	3	3	2	1	2.0	2	2	2	1	2.0	2	2
NULL	M	D	3	1	3.0	3	3	4	1	4.0	4	4	2	1	2.0	2	2
NULL	M	D	5	1	5.0	5	5	2	1	2.0	2	2	4	1	4.0	4	4
NULL	M	D	5	1	5.0	5	5	4	1	4.0	4	4	6	1	6.0	6	6
NULL	M	D	6	1	6.0	6	6	1	1	1.0	1	1	5	1	5.0	5	5
NULL	M	M	0	1	0.0	0	0	5	1	5.0	5	5	0	1	0.0	0	0
NULL	M	M	1	1	1.0	1	1	1	1	1.0	1	1	3	1	3.0	3	3
NULL	M	M	1	1	1.0	1	1	2	1	2.0	2	2	0	1	0.0	0	0
NULL	M	M	1	1	1.0	1	1	2	1	2.0	2	2	2	1	2.0	2	2
NULL	M	M	2	1	2.0	2	2	0	1	0.0	0	0	4	1	4.0	4	4
NULL	M	M	2	1	2.0	2	2	4	1	4.0	4	4	1	1	1.0	1	1
NULL	M	M	2	1	2.0	2	2	6	1	6.0	6	6	6	1	6.0	6	6
NULL	M	M	3	1	3.0	3	3	0	1	0.0	0	0	5	1	5.0	5	5
NULL	M	M	3	1	3.0	3	3	1	1	1.0	1	1	0	1	0.0	0	0
NULL	M	M	3	1	3.0	3	3	1	1	1.0	1	1	6	1	6.0	6	6
NULL	M	M	3	1	3.0	3	3	6	1	6.0	6	6	6	1	6.0	6	6
NULL	M	M	4	1	4.0	4	4	2	1	2.0	2	2	2	1	2.0	2	2
NULL	M	M	4	3	4.0	4	12	6	3	6.0	6	18	6	3	6.0	6	18
NULL	M	M	6	1	6.0	6	6	2	1	2.0	2	2	1	1	1.0	1	1
NULL	M	M	6	1	6.0	6	6	2	1	2.0	2	2	5	1	5.0	5	5
