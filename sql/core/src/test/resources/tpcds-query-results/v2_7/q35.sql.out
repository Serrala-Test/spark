-- Automatically generated by TPCDSQueryTestSuite

-- !query
SELECT
  -- select list of q35 in TPCDS v1.4 is below:
  -- ca_state,
  -- cd_gender,
  -- cd_marital_status,
  -- count(*) cnt1,
  -- min(cd_dep_count),
  -- max(cd_dep_count),
  -- avg(cd_dep_count),
  -- cd_dep_employed_count,
  -- count(*) cnt2,
  -- min(cd_dep_employed_count),
  -- max(cd_dep_employed_count),
  -- avg(cd_dep_employed_count),
  -- cd_dep_college_count,
  -- count(*) cnt3,
  -- min(cd_dep_college_count),
  -- max(cd_dep_college_count),
  -- avg(cd_dep_college_count)
  ca_state,
  cd_gender,
  cd_marital_status,
  cd_dep_count,
  count(*) cnt1,
  avg(cd_dep_count),
  max(cd_dep_count),
  sum(cd_dep_count),
  cd_dep_employed_count,
  count(*) cnt2,
  avg(cd_dep_employed_count),
  max(cd_dep_employed_count),
  sum(cd_dep_employed_count),
  cd_dep_college_count,
  count(*) cnt3,
  avg(cd_dep_college_count),
  max(cd_dep_college_count),
  sum(cd_dep_college_count)
FROM
  customer c, customer_address ca, customer_demographics
WHERE
  c.c_current_addr_sk = ca.ca_address_sk AND
    cd_demo_sk = c.c_current_cdemo_sk AND
    exists(SELECT *
           FROM store_sales, date_dim
           WHERE c.c_customer_sk = ss_customer_sk AND
             ss_sold_date_sk = d_date_sk AND
             d_year = 2002 AND
             d_qoy < 4) AND
    (exists(SELECT *
            FROM web_sales, date_dim
            WHERE c.c_customer_sk = ws_bill_customer_sk AND
              ws_sold_date_sk = d_date_sk AND
              d_year = 2002 AND
              d_qoy < 4) OR
      exists(SELECT *
             FROM catalog_sales, date_dim
             WHERE c.c_customer_sk = cs_ship_customer_sk AND
               cs_sold_date_sk = d_date_sk AND
               d_year = 2002 AND
               d_qoy < 4))
GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count,
  cd_dep_employed_count, cd_dep_college_count
ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count,
  cd_dep_employed_count, cd_dep_college_count
LIMIT 100
-- !query schema
struct<ca_state:string,cd_gender:string,cd_marital_status:string,cd_dep_count:int,cnt1:bigint,avg(cd_dep_count):double,max(cd_dep_count):int,sum(cd_dep_count):bigint,cd_dep_employed_count:int,cnt2:bigint,avg(cd_dep_employed_count):double,max(cd_dep_employed_count):int,sum(cd_dep_employed_count):bigint,cd_dep_college_count:int,cnt3:bigint,avg(cd_dep_college_count):double,max(cd_dep_college_count):int,sum(cd_dep_college_count):bigint>
-- !query output
NULL	F	D	0	1	0.0	0	0	1	1	1.0	1	1	2	1	2.0	2	2
NULL	F	D	0	1	0.0	0	0	3	1	3.0	3	3	0	1	0.0	0	0
NULL	F	D	0	1	0.0	0	0	5	1	5.0	5	5	0	1	0.0	0	0
NULL	F	D	0	1	0.0	0	0	6	1	6.0	6	6	0	1	0.0	0	0
NULL	F	D	1	1	1.0	1	1	1	1	1.0	1	1	1	1	1.0	1	1
NULL	F	D	1	1	1.0	1	1	5	1	5.0	5	5	3	1	3.0	3	3
NULL	F	D	3	1	3.0	3	3	0	1	0.0	0	0	5	1	5.0	5	5
NULL	F	D	3	1	3.0	3	3	1	1	1.0	1	1	3	1	3.0	3	3
NULL	F	D	3	1	3.0	3	3	5	1	5.0	5	5	4	1	4.0	4	4
NULL	F	D	4	1	4.0	4	4	2	1	2.0	2	2	5	1	5.0	5	5
NULL	F	D	4	1	4.0	4	4	4	1	4.0	4	4	4	1	4.0	4	4
NULL	F	D	6	1	6.0	6	6	0	1	0.0	0	0	6	1	6.0	6	6
NULL	F	D	6	1	6.0	6	6	5	1	5.0	5	5	4	1	4.0	4	4
NULL	F	M	0	1	0.0	0	0	0	1	0.0	0	0	3	1	3.0	3	3
NULL	F	M	0	1	0.0	0	0	3	1	3.0	3	3	6	1	6.0	6	6
NULL	F	M	1	1	1.0	1	1	2	1	2.0	2	2	4	1	4.0	4	4
NULL	F	M	1	1	1.0	1	1	3	1	3.0	3	3	3	1	3.0	3	3
NULL	F	M	1	1	1.0	1	1	4	1	4.0	4	4	2	1	2.0	2	2
NULL	F	M	1	1	1.0	1	1	6	1	6.0	6	6	2	1	2.0	2	2
NULL	F	M	1	2	1.0	1	2	1	2	1.0	1	2	0	2	0.0	0	0
NULL	F	M	2	1	2.0	2	2	1	1	1.0	1	1	0	1	0.0	0	0
NULL	F	M	2	1	2.0	2	2	5	1	5.0	5	5	4	1	4.0	4	4
NULL	F	M	3	1	3.0	3	3	0	1	0.0	0	0	4	1	4.0	4	4
NULL	F	M	4	1	4.0	4	4	2	1	2.0	2	2	1	1	1.0	1	1
NULL	F	M	4	1	4.0	4	4	4	1	4.0	4	4	1	1	1.0	1	1
NULL	F	M	5	1	5.0	5	5	1	1	1.0	1	1	2	1	2.0	2	2
NULL	F	M	5	1	5.0	5	5	3	1	3.0	3	3	3	1	3.0	3	3
NULL	F	M	6	1	6.0	6	6	2	1	2.0	2	2	2	1	2.0	2	2
NULL	F	M	6	1	6.0	6	6	2	1	2.0	2	2	3	1	3.0	3	3
NULL	F	M	6	1	6.0	6	6	3	1	3.0	3	3	4	1	4.0	4	4
NULL	F	M	6	1	6.0	6	6	5	1	5.0	5	5	1	1	1.0	1	1
NULL	F	S	0	1	0.0	0	0	0	1	0.0	0	0	3	1	3.0	3	3
NULL	F	S	0	1	0.0	0	0	2	1	2.0	2	2	3	1	3.0	3	3
NULL	F	S	0	1	0.0	0	0	3	1	3.0	3	3	6	1	6.0	6	6
NULL	F	S	0	1	0.0	0	0	4	1	4.0	4	4	5	1	5.0	5	5
NULL	F	S	1	1	1.0	1	1	0	1	0.0	0	0	3	1	3.0	3	3
NULL	F	S	1	1	1.0	1	1	3	1	3.0	3	3	4	1	4.0	4	4
NULL	F	S	1	1	1.0	1	1	4	1	4.0	4	4	0	1	0.0	0	0
NULL	F	S	1	1	1.0	1	1	4	1	4.0	4	4	4	1	4.0	4	4
NULL	F	S	1	1	1.0	1	1	5	1	5.0	5	5	0	1	0.0	0	0
NULL	F	S	2	1	2.0	2	2	0	1	0.0	0	0	3	1	3.0	3	3
NULL	F	S	2	1	2.0	2	2	1	1	1.0	1	1	6	1	6.0	6	6
NULL	F	S	2	1	2.0	2	2	2	1	2.0	2	2	2	1	2.0	2	2
NULL	F	S	2	1	2.0	2	2	4	1	4.0	4	4	6	1	6.0	6	6
NULL	F	S	2	1	2.0	2	2	6	1	6.0	6	6	1	1	1.0	1	1
NULL	F	S	2	1	2.0	2	2	6	1	6.0	6	6	5	1	5.0	5	5
NULL	F	S	3	1	3.0	3	3	1	1	1.0	1	1	0	1	0.0	0	0
NULL	F	S	3	1	3.0	3	3	1	1	1.0	1	1	2	1	2.0	2	2
NULL	F	S	3	1	3.0	3	3	3	1	3.0	3	3	0	1	0.0	0	0
NULL	F	S	3	1	3.0	3	3	4	1	4.0	4	4	6	1	6.0	6	6
NULL	F	S	3	1	3.0	3	3	6	1	6.0	6	6	6	1	6.0	6	6
NULL	F	S	4	1	4.0	4	4	0	1	0.0	0	0	2	1	2.0	2	2
NULL	F	S	5	1	5.0	5	5	4	1	4.0	4	4	2	1	2.0	2	2
NULL	F	S	5	1	5.0	5	5	6	1	6.0	6	6	6	1	6.0	6	6
NULL	F	S	6	1	6.0	6	6	0	1	0.0	0	0	0	1	0.0	0	0
NULL	F	S	6	1	6.0	6	6	0	1	0.0	0	0	2	1	2.0	2	2
NULL	F	S	6	1	6.0	6	6	4	1	4.0	4	4	5	1	5.0	5	5
NULL	F	U	0	1	0.0	0	0	4	1	4.0	4	4	1	1	1.0	1	1
NULL	F	U	0	1	0.0	0	0	5	1	5.0	5	5	1	1	1.0	1	1
NULL	F	U	0	1	0.0	0	0	6	1	6.0	6	6	6	1	6.0	6	6
NULL	F	U	1	1	1.0	1	1	5	1	5.0	5	5	2	1	2.0	2	2
NULL	F	U	2	1	2.0	2	2	4	1	4.0	4	4	4	1	4.0	4	4
NULL	F	U	3	1	3.0	3	3	1	1	1.0	1	1	6	1	6.0	6	6
NULL	F	U	3	1	3.0	3	3	3	1	3.0	3	3	6	1	6.0	6	6
NULL	F	U	3	1	3.0	3	3	4	1	4.0	4	4	3	1	3.0	3	3
NULL	F	U	3	1	3.0	3	3	5	1	5.0	5	5	1	1	1.0	1	1
NULL	F	U	3	1	3.0	3	3	6	1	6.0	6	6	0	1	0.0	0	0
NULL	F	U	3	1	3.0	3	3	6	1	6.0	6	6	3	1	3.0	3	3
NULL	F	U	6	1	6.0	6	6	1	1	1.0	1	1	3	1	3.0	3	3
NULL	F	U	6	1	6.0	6	6	2	1	2.0	2	2	1	1	1.0	1	1
NULL	F	U	6	1	6.0	6	6	5	1	5.0	5	5	6	1	6.0	6	6
NULL	F	W	0	1	0.0	0	0	2	1	2.0	2	2	4	1	4.0	4	4
NULL	F	W	0	1	0.0	0	0	6	1	6.0	6	6	2	1	2.0	2	2
NULL	F	W	2	1	2.0	2	2	5	1	5.0	5	5	1	1	1.0	1	1
NULL	F	W	4	1	4.0	4	4	0	1	0.0	0	0	4	1	4.0	4	4
NULL	F	W	4	1	4.0	4	4	1	1	1.0	1	1	1	1	1.0	1	1
NULL	F	W	4	1	4.0	4	4	2	1	2.0	2	2	6	1	6.0	6	6
NULL	F	W	4	1	4.0	4	4	4	1	4.0	4	4	3	1	3.0	3	3
NULL	F	W	5	1	5.0	5	5	6	1	6.0	6	6	1	1	1.0	1	1
NULL	F	W	6	1	6.0	6	6	2	1	2.0	2	2	6	1	6.0	6	6
NULL	F	W	6	1	6.0	6	6	3	1	3.0	3	3	4	1	4.0	4	4
NULL	F	W	6	1	6.0	6	6	4	1	4.0	4	4	0	1	0.0	0	0
NULL	F	W	6	1	6.0	6	6	5	1	5.0	5	5	6	1	6.0	6	6
NULL	M	D	1	1	1.0	1	1	5	1	5.0	5	5	6	1	6.0	6	6
NULL	M	D	2	1	2.0	2	2	3	1	3.0	3	3	3	1	3.0	3	3
NULL	M	D	2	1	2.0	2	2	6	1	6.0	6	6	1	1	1.0	1	1
NULL	M	D	2	1	2.0	2	2	6	1	6.0	6	6	6	1	6.0	6	6
NULL	M	D	3	1	3.0	3	3	5	1	5.0	5	5	4	1	4.0	4	4
NULL	M	D	3	1	3.0	3	3	6	1	6.0	6	6	6	1	6.0	6	6
NULL	M	D	4	1	4.0	4	4	5	1	5.0	5	5	5	1	5.0	5	5
NULL	M	D	6	1	6.0	6	6	1	1	1.0	1	1	1	1	1.0	1	1
NULL	M	D	6	1	6.0	6	6	2	1	2.0	2	2	5	1	5.0	5	5
NULL	M	D	6	1	6.0	6	6	4	1	4.0	4	4	3	1	3.0	3	3
NULL	M	D	6	1	6.0	6	6	4	1	4.0	4	4	4	1	4.0	4	4
NULL	M	M	0	1	0.0	0	0	0	1	0.0	0	0	2	1	2.0	2	2
NULL	M	M	0	1	0.0	0	0	1	1	1.0	1	1	6	1	6.0	6	6
NULL	M	M	0	1	0.0	0	0	2	1	2.0	2	2	0	1	0.0	0	0
NULL	M	M	0	1	0.0	0	0	6	1	6.0	6	6	1	1	1.0	1	1
NULL	M	M	0	1	0.0	0	0	6	1	6.0	6	6	2	1	2.0	2	2
NULL	M	M	1	1	1.0	1	1	1	1	1.0	1	1	6	1	6.0	6	6
