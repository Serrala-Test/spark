-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT rand(0)
-- !query analysis
Project [rand(0) AS rand(0)#x]
+- OneRowRelation


-- !query
SELECT rand(cast(3 / 7 AS int))
-- !query analysis
Project [rand(cast((cast(3 as double) / cast(7 as double)) as int)) AS rand(CAST((3 / 7) AS INT))#x]
+- OneRowRelation


-- !query
SELECT rand(NULL)
-- !query analysis
Project [rand(null) AS rand(NULL)#x]
+- OneRowRelation


-- !query
SELECT rand(cast(NULL AS int))
-- !query analysis
Project [rand(cast(null as int)) AS rand(CAST(NULL AS INT))#x]
+- OneRowRelation


-- !query
SELECT rand(1.0)
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"1.0\"",
    "inputType" : "\"DECIMAL(2,1)\"",
    "paramIndex" : "1",
    "requiredType" : "(\"INT\" or \"BIGINT\")",
    "sqlExpr" : "\"rand(1.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 16,
    "fragment" : "rand(1.0)"
  } ]
}


-- !query
SELECT randn(0L)
-- !query analysis
Project [randn(0) AS randn(0)#x]
+- OneRowRelation


-- !query
SELECT randn(cast(3 / 7 AS long))
-- !query analysis
Project [randn(cast((cast(3 as double) / cast(7 as double)) as bigint)) AS randn(CAST((3 / 7) AS BIGINT))#x]
+- OneRowRelation


-- !query
SELECT randn(NULL)
-- !query analysis
Project [randn(null) AS randn(NULL)#x]
+- OneRowRelation


-- !query
SELECT randn(cast(NULL AS long))
-- !query analysis
Project [randn(cast(null as bigint)) AS randn(CAST(NULL AS BIGINT))#x]
+- OneRowRelation


-- !query
SELECT rand('1')
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"1\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "1",
    "requiredType" : "(\"INT\" or \"BIGINT\")",
    "sqlExpr" : "\"rand(1)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 16,
    "fragment" : "rand('1')"
  } ]
}
