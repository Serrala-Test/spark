-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW inner_table (a, b) AS VALUES
    (1, 10),
    (2, 20),
    (3, 30),
    (4, 40),
    (5, 50),
    (8, 80),
    (9, 90)
-- !query analysis
CreateViewCommand `inner_table`, [(a,None), (b,None)], VALUES
    (1, 10),
    (2, 20),
    (3, 30),
    (4, 40),
    (5, 50),
    (8, 80),
    (9, 90), false, false, LocalTempView, true
   +- LocalRelation [col1#x, col2#x]


-- !query
CREATE TEMPORARY VIEW outer_table (a, b) AS VALUES
    (1, 100),
    (2, 200),
    (3, 300),
    (4, 400),
    (6, 600),
    (7, 700),
    (10, 1000)
-- !query analysis
CreateViewCommand `outer_table`, [(a,None), (b,None)], VALUES
    (1, 100),
    (2, 200),
    (3, 300),
    (4, 400),
    (6, 600),
    (7, 700),
    (10, 1000), false, false, LocalTempView, true
   +- LocalRelation [col1#x, col2#x]


-- !query
CREATE TEMPORARY VIEW no_match_inner_table (a, b) AS VALUES
    (6, 600),
    (7, 700),
    (10, 1000)
-- !query analysis
CreateViewCommand `no_match_inner_table`, [(a,None), (b,None)], VALUES
    (6, 600),
    (7, 700),
    (10, 1000), false, false, LocalTempView, true
   +- LocalRelation [col1#x, col2#x]


-- !query
CREATE TEMPORARY VIEW no_match_outer_table (a, b) AS VALUES
    (5, 50),
    (8, 80),
    (9, 90)
-- !query analysis
CreateViewCommand `no_match_outer_table`, [(a,None), (b,None)], VALUES
    (5, 50),
    (8, 80),
    (9, 90), false, false, LocalTempView, true
   +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias inner_table
   :              +- View (`inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias inner_table
   :              +- View (`inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias inner_table
   :              +- View (`inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias inner_table
   :              +- View (`inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias inner_table
   :              +- View (`inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [a#x], [sum(a#x) AS c#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [a#x], [sum(a#x) AS c#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [sum(a#x) AS c#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [sum(a#x) AS c#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [a#x], [count(a#x) AS c#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [a#x], [count(a#x) AS c#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [count(a#x) AS c#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [count(a#x) AS c#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Distinct
                  +- Project [a#x]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Distinct
                  +- Project [a#x]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [a#x], [sum(a#x) AS c#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [a#x], [sum(a#x) AS c#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [sum(a#x) AS c#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [sum(a#x) AS c#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [a#x], [count(a#x) AS c#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [a#x], [count(a#x) AS c#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [count(a#x) AS c#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [count(a#x) AS c#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Distinct
                  +- Project [a#x]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Distinct
                  +- Project [a#x]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Project [a#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [sum(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [count(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [count(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [count(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  a  FROM inner_table  WHERE inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS c#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [sum(a#x) AS c#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS c#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [count(a#x) AS c#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [count(a#x) AS c#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [count(a#x) AS c#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias no_match_inner_table
   :              +- View (`no_match_inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias no_match_inner_table
   :              +- View (`no_match_inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias no_match_inner_table
   :              +- View (`no_match_inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias no_match_inner_table
   :              +- View (`no_match_inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias no_match_inner_table
   :              +- View (`no_match_inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM outer_table  ORDER BY outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [sum(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [sum(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [a#x], [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Distinct
         +- Aggregate [count(a#x) AS c#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- Aggregate [count(a#x) AS c#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 10 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Distinct
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- Sort [a#x DESC NULLS LAST], true
         +- Project [a#x]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [a#x], [sum(a#x) AS c#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [a#x], [sum(a#x) AS c#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [sum(a#x) AS c#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [sum(a#x) AS c#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [a#x], [count(a#x) AS c#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [a#x], [count(a#x) AS c#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [count(a#x) AS c#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [count(a#x) AS c#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Distinct
                  +- Project [a#x]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Distinct
                  +- Project [a#x]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [a#x], [sum(a#x) AS c#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [a#x], [sum(a#x) AS c#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [sum(a#x) AS c#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [sum(a#x) AS c#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [a#x], [count(a#x) AS c#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [a#x], [count(a#x) AS c#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Distinct
                  +- Aggregate [count(a#x) AS c#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT c  FROM (SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery  ORDER BY c
-- !query analysis
Sort [c#xL ASC NULLS FIRST], true
+- Project [c#xL]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [c#xL DESC NULLS LAST], true
               +- Aggregate [count(a#x) AS c#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Distinct
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Project [a#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Distinct
                  +- Project [a#x]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Distinct
                  +- Project [a#x]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a  FROM (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery  ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x]
   +- SubqueryAlias subquery
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [a#x DESC NULLS LAST], true
               +- Project [a#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a IN(SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a NOT IN(SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE EXISTS(SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE NOT EXISTS(SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [sum(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [count(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [count(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [count(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS c#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [sum(a#x) AS c#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS c#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [count(a#x) AS c#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [count(a#x) AS c#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [count(a#x) AS c#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM outer_table WHERE outer_table.a =(SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias inner_table
   :              +- View (`inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias inner_table
   :              +- View (`inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias inner_table
   :              +- View (`inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias inner_table
   :              +- View (`inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias inner_table
   :              +- View (`inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  a  FROM inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  a  FROM inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  SUM(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [sum(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [count(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [count(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  COUNT(a) AS c  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [count(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  a  FROM inner_table  WHERE inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  SUM(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS c#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  SUM(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [sum(a#x) AS c#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS c#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  COUNT(a) AS c  FROM inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [count(a#x) AS c#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [count(a#x) AS c#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  COUNT(a) AS c  FROM inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [count(a#x) AS c#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  a  FROM inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  a  FROM inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias no_match_inner_table
   :              +- View (`no_match_inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias no_match_inner_table
   :              +- View (`no_match_inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias no_match_inner_table
   :              +- View (`no_match_inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias no_match_inner_table
   :              +- View (`no_match_inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- Filter (a#x = outer(a#x))
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [sum(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [a#x], [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Distinct
   :              +- Aggregate [count(a#x) AS c#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [c#xL DESC NULLS LAST], true
   :           +- Aggregate [count(a#x) AS c#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Distinct
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Project [a#x]
   :           +- SubqueryAlias no_match_inner_table
   :              +- View (`no_match_inner_table`, [a#x, b#x])
   :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Distinct
   :              +- Project [a#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )  AS subquery FROM no_match_outer_table  ORDER BY no_match_outer_table.b, subquery
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [a#x DESC NULLS LAST], true
   :           +- Project [a#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Distinct
      :        +- Aggregate [count(a#x) AS c#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [c#xL]
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE EXISTS(SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  SUM(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [sum(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [count(a#x) AS c#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  COUNT(a) AS c  FROM no_match_inner_table )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [count(a#x) AS c#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  a  FROM no_match_inner_table LIMIT 10 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Distinct
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE NOT EXISTS(SELECT  a  FROM no_match_inner_table ORDER BY a  DESC )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [a#x DESC NULLS LAST], true
      :     +- Project [a#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  SUM(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [sum(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [count(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [count(a#x) AS c#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  COUNT(a) AS c  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [count(a#x) AS c#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  a  FROM no_match_inner_table  WHERE no_match_inner_table.a = no_match_outer_table.a ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  SUM(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [sum(a#x) AS c#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS c#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  SUM(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [sum(a#x) AS c#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS c#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  COUNT(a) AS c  FROM no_match_inner_table GROUP BY a ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [a#x], [count(a#x) AS c#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Distinct
      :              +- Aggregate [count(a#x) AS c#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  COUNT(a) AS c  FROM no_match_inner_table ORDER BY c  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [c#xL DESC NULLS LAST], true
      :           +- Aggregate [count(a#x) AS c#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Distinct
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  a  FROM no_match_inner_table LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Project [a#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Distinct
      :              +- Project [a#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b  FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT  a  FROM no_match_inner_table ORDER BY a  DESC  LIMIT 1 )   ORDER BY a, b
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [a#x DESC NULLS LAST], true
      :           +- Project [a#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]
