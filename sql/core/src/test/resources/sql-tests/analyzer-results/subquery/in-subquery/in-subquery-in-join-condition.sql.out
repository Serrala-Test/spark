-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMP VIEW x(x1, x2) AS VALUES
    (0, 1),
    (1, 1),
    (1, 2),
    (3, 4),
    (5, 6),
    (9, 10)
-- !query analysis
CreateViewCommand `x`, [(x1,None), (x2,None)], VALUES
    (0, 1),
    (1, 1),
    (1, 2),
    (3, 4),
    (5, 6),
    (9, 10), false, false, LocalTempView, true
   +- LocalRelation [col1#x, col2#x]


-- !query
CREATE TEMP VIEW y(y1, y2) AS VALUES
    (0, 2),
    (1, 4),
    (1, 5),
    (2, 6),
    (3, 8),
    (4, 11)
-- !query analysis
CreateViewCommand `y`, [(y1,None), (y2,None)], VALUES
    (0, 2),
    (1, 4),
    (1, 5),
    (2, 6),
    (3, 8),
    (4, 11), false, false, LocalTempView, true
   +- LocalRelation [col1#x, col2#x]


-- !query
CREATE TEMP VIEW z(z1, z2) AS VALUES
    (0, 2),
    (1, 4),
    (3, 3),
    (3, 6),
    (8, 11)
-- !query analysis
CreateViewCommand `z`, [(z1,None), (z2,None)], VALUES
    (0, 2),
    (1, 4),
    (3, 3),
    (3, 6),
    (8, 11), false, false, LocalTempView, true
   +- LocalRelation [col1#x, col2#x]


-- !query
select * from x inner join y on x1 = y1 and x2 IN (select z1 from z where z2 = x2) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join Inner, ((x1#x = y1#x) AND x2#x IN (list#x [x2#x]))
      :  +- Project [z1#x]
      :     +- Filter (z2#x = outer(x2#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x inner join y on x1 = y1 and x2 not IN (select z1 from z where z2 = x2) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join Inner, ((x1#x = y1#x) AND NOT x2#x IN (list#x [x2#x]))
      :  +- Project [z1#x]
      :     +- Filter (z2#x = outer(x2#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x left join y on x1 = y1 and x2 IN (select z1 from z where z2 = x2) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join LeftOuter, ((x1#x = y1#x) AND x2#x IN (list#x [x2#x]))
      :  +- Project [z1#x]
      :     +- Filter (z2#x = outer(x2#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x left join y on x1 = y1 and x2 not IN (select z1 from z where z2 = x2) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join LeftOuter, ((x1#x = y1#x) AND NOT x2#x IN (list#x [x2#x]))
      :  +- Project [z1#x]
      :     +- Filter (z2#x = outer(x2#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x inner join y on x1 = y1 and y2 IN (select z1 from z where z2 = y2) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join Inner, ((x1#x = y1#x) AND y2#x IN (list#x [y2#x]))
      :  +- Project [z1#x]
      :     +- Filter (z2#x = outer(y2#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x inner join y on x1 = y1 and y2 not IN (select z1 from z where z2 = y2) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join Inner, ((x1#x = y1#x) AND NOT y2#x IN (list#x [y2#x]))
      :  +- Project [z1#x]
      :     +- Filter (z2#x = outer(y2#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x left join y on x1 = y1 and y2 IN (select z1 from z where z2 = y2) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join LeftOuter, ((x1#x = y1#x) AND y2#x IN (list#x [y2#x]))
      :  +- Project [z1#x]
      :     +- Filter (z2#x = outer(y2#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x left join y on x1 = y1 and y2 not IN (select z1 from z where z2 = y2) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join LeftOuter, ((x1#x = y1#x) AND NOT y2#x IN (list#x [y2#x]))
      :  +- Project [z1#x]
      :     +- Filter (z2#x = outer(y2#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x inner join y on x1 = y1 or x2 IN (select z1 from z where z1 = x1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join Inner, ((x1#x = y1#x) OR x2#x IN (list#x [x1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(x1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x inner join y on x1 = y1 or x2 not IN (select z1 from z where z1 = x1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join Inner, ((x1#x = y1#x) OR NOT x2#x IN (list#x [x1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(x1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x left join y on x1 = y1 or x2 IN (select z1 from z where z1 = x1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join LeftOuter, ((x1#x = y1#x) OR x2#x IN (list#x [x1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(x1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x left join y on x1 = y1 or x2 not IN (select z1 from z where z1 = x1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join LeftOuter, ((x1#x = y1#x) OR NOT x2#x IN (list#x [x1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(x1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x inner join y on x1 = y1 or y2 IN (select z1 from z where z1 = y1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join Inner, ((x1#x = y1#x) OR y2#x IN (list#x [y1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(y1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x inner join y on x1 = y1 or y2 not IN (select z1 from z where z1 = y1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join Inner, ((x1#x = y1#x) OR NOT y2#x IN (list#x [y1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(y1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x left join y on x1 = y1 or y2 IN (select z1 from z where z1 = y1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join LeftOuter, ((x1#x = y1#x) OR y2#x IN (list#x [y1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(y1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x left join y on x1 = y1 or y2 not IN (select z1 from z where z1 = y1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join LeftOuter, ((x1#x = y1#x) OR NOT y2#x IN (list#x [y1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(y1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x inner join y on x1 = y1 and x2 IN (select z1 from z where z1 = x1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join Inner, ((x1#x = y1#x) AND x2#x IN (list#x [x1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(x1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x inner join y on x1 = y1 and x2 not IN (select z1 from z where z1 = x1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join Inner, ((x1#x = y1#x) AND NOT x2#x IN (list#x [x1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(x1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x left join y on x1 = y1 and x2 IN (select z1 from z where z1 = x1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join LeftOuter, ((x1#x = y1#x) AND x2#x IN (list#x [x1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(x1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x left join y on x1 = y1 and x2 not IN (select z1 from z where z1 = x1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join LeftOuter, ((x1#x = y1#x) AND NOT x2#x IN (list#x [x1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(x1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x inner join y on x1 = y1 and y2 IN (select z1 from z where z1 = y1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join Inner, ((x1#x = y1#x) AND y2#x IN (list#x [y1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(y1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x inner join y on x1 = y1 and y2 not IN (select z1 from z where z1 = y1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join Inner, ((x1#x = y1#x) AND NOT y2#x IN (list#x [y1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(y1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x left join y on x1 = y1 and y2 IN (select z1 from z where z1 = y1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join LeftOuter, ((x1#x = y1#x) AND y2#x IN (list#x [y1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(y1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
select * from x left join y on x1 = y1 and y2 not IN (select z1 from z where z1 = y1) order by x1, x2, y1, y2
-- !query analysis
Sort [x1#x ASC NULLS FIRST, x2#x ASC NULLS FIRST, y1#x ASC NULLS FIRST, y2#x ASC NULLS FIRST], true
+- Project [x1#x, x2#x, y1#x, y2#x]
   +- Join LeftOuter, ((x1#x = y1#x) AND NOT y2#x IN (list#x [y1#x]))
      :  +- Project [z1#x]
      :     +- Filter (z1#x = outer(y1#x))
      :        +- SubqueryAlias z
      :           +- View (`z`, [z1#x,z2#x])
      :              +- Project [cast(col1#x as int) AS z1#x, cast(col2#x as int) AS z2#x]
      :                 +- LocalRelation [col1#x, col2#x]
      :- SubqueryAlias x
      :  +- View (`x`, [x1#x,x2#x])
      :     +- Project [cast(col1#x as int) AS x1#x, cast(col2#x as int) AS x2#x]
      :        +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias y
         +- View (`y`, [y1#x,y2#x])
            +- Project [cast(col1#x as int) AS y1#x, cast(col2#x as int) AS y2#x]
               +- LocalRelation [col1#x, col2#x]
