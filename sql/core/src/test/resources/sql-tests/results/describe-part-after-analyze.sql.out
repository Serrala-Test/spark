-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE t (key STRING, value STRING, ds STRING, hr INT) USING parquet
    PARTITIONED BY (ds, hr)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Can not create the managed table('`spark_catalog`.`default`.`t`'). The associated location('file:/Users/Daniel.Tenedorio/spark-2/sql/core/spark-warehouse/org.apache.spark.sql.SQLQueryTestSuite/t') already exists.


-- !query
INSERT INTO TABLE t PARTITION (ds='2017-08-01', hr=10)
VALUES ('k1', 100), ('k2', 200), ('k3', 300)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table not found: t; line 1 pos 18


-- !query
INSERT INTO TABLE t PARTITION (ds='2017-08-01', hr=11)
VALUES ('k1', 101), ('k2', 201), ('k3', 301), ('k4', 401)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table not found: t; line 1 pos 18


-- !query
INSERT INTO TABLE t PARTITION (ds='2017-09-01', hr=5)
VALUES ('k1', 102), ('k2', 202)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table not found: t; line 1 pos 18


-- !query
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=10)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: t; line 1 pos 14


-- !query
ANALYZE TABLE t PARTITION (ds='2017-08-01', hr=10) COMPUTE STATISTICS
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or permanent view not found: t; line 1 pos 14


-- !query
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=10)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: t; line 1 pos 14


-- !query
ANALYZE TABLE t PARTITION (ds='2017-08-01') COMPUTE STATISTICS
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or permanent view not found: t; line 1 pos 14


-- !query
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=10)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: t; line 1 pos 14


-- !query
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=11)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: t; line 1 pos 14


-- !query
ANALYZE TABLE t PARTITION (ds, hr) COMPUTE STATISTICS
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or permanent view not found: t; line 1 pos 14


-- !query
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=10)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: t; line 1 pos 14


-- !query
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=11)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: t; line 1 pos 14


-- !query
DESC EXTENDED t PARTITION (ds='2017-09-01', hr=5)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: t; line 1 pos 14


-- !query
DROP TABLE t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: t; line 1 pos 11
