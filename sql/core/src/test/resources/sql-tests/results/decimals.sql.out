-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 8


-- !query 0
create table decimals_test(id int, a decimal(38,18), b decimal(38,18)) using parquet
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
insert into decimals_test values(1, 100.0, 999.0), (2, 12345.123, 12345.123),
  (3, 0.1234567891011, 1234.1), (4, 123456789123456789.0, 1.123456789123456789)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
select id, a+b, a-b, a*b, a/b from decimals_test order by id
-- !query 2 schema
struct<id:int,(a + b):decimal(38,18),(a - b):decimal(38,18),(a * b):decimal(38,36),(a / b):decimal(38,18)>
-- !query 2 output
1	1099	-899	NULL	0.1001001001001001
2	24690.246	0	NULL	1
3	1234.2234567891011	-1233.9765432108989	NULL	0.000100037913541123
4	123456789123456790.123456789123456789	123456789123456787.876543210876543211	NULL	109890109097814272.043109406191131436


-- !query 3
select id, a*10, b/10 from decimals_test order by id
-- !query 3 schema
struct<id:int,(CAST(a AS DECIMAL(38,18)) * CAST(CAST(10 AS DECIMAL(2,0)) AS DECIMAL(38,18))):decimal(38,18),(CAST(b AS DECIMAL(38,18)) / CAST(CAST(10 AS DECIMAL(2,0)) AS DECIMAL(38,18))):decimal(38,19)>
-- !query 3 output
1	1000	99.9
2	123451.23	1234.5123
3	1.234567891011	123.41
4	1234567891234567890	0.1123456789123456789


-- !query 4
set spark.sql.decimalOperations.allowPrecisionLoss=true
-- !query 4 schema
struct<key:string,value:string>
-- !query 4 output
spark.sql.decimalOperations.allowPrecisionLoss	true


-- !query 5
select id, a+b, a-b, a*b, a/b from decimals_test order by id
-- !query 5 schema
struct<id:int,(a + b):decimal(38,17),(a - b):decimal(38,17),(a * b):decimal(38,6),(a / b):decimal(38,6)>
-- !query 5 output
1	1099	-899	99900	0.1001
2	24690.246	0	152402061.885129	1
3	1234.2234567891011	-1233.9765432108989	152.358023	0.0001
4	123456789123456790.12345678912345679	123456789123456787.87654321087654321	138698367904130467.515623	109890109097814272.043109


-- !query 6
select id, a*10, b/10 from decimals_test order by id
-- !query 6 schema
struct<id:int,(CAST(a AS DECIMAL(38,18)) * CAST(CAST(10 AS DECIMAL(2,0)) AS DECIMAL(38,18))):decimal(38,15),(CAST(b AS DECIMAL(38,18)) / CAST(CAST(10 AS DECIMAL(2,0)) AS DECIMAL(38,18))):decimal(38,18)>
-- !query 6 output
1	1000	99.9
2	123451.23	1234.5123
3	1.234567891011	123.41
4	1234567891234567890	0.112345678912345679


-- !query 7
drop table decimals_test
-- !query 7 schema
struct<>
-- !query 7 output

