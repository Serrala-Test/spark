-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 131


-- !query 0
CREATE DATABASE indb
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
CREATE TABLE t1(t1a String, t1b Short, t1c Int, t1d Long, t1e float, t1f double, t1g DECIMAL, t1h TIMESTAMP, t1i Date)
using parquet
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
CREATE TABLE t2(t2a String, t2b Short, t2c Int, t2d Long, t2e float, t2f double, t2g DECIMAL, t2h TIMESTAMP, t2i Date)
using parquet
-- !query 2 schema
struct<>
-- !query 2 output



-- !query 3
CREATE TABLE t3(t3a String, t3b Short, t3c Int, t3d Long, t3e float, t3f double, t3g DECIMAL, t3h TIMESTAMP, t3i Date)
using parquet
-- !query 3 schema
struct<>
-- !query 3 output



-- !query 4
INSERT INTO t1 VALUES
 ('t1a', 6, 8, 10, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t1b', 8, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1a', 16, 12, 21, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t1a', 16, 12, 10, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t1c', 8, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1d', null, 16, 22, 17, 25, 26.00, timestamp(date("2014-05-04")), null),
 ('t1d', null, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), null),
 ('t1e', 10, null, 25, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1e', 10, null, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1d', 10, null, 12, 17, 25, 26.00, timestamp(date("2015-05-04")), date("2015-04-05")),
 ('t1a', 6, 8, 10, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t1e', 10, null, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05"))
-- !query 4 schema
struct<>
-- !query 4 output



-- !query 5
INSERT INTO t2 VALUES
 ('t2a', 6, 12, 10, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t1b', 10, 12, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1b', 8, 16, 119, 17, 25, 26.00, timestamp(date("2015-05-04")), date("2014-04-05")),
 ('t1c', 12, 16, 219, 17, 25, 26.00, timestamp(date("2016-05-04")), date("2014-04-05")),
 ('t1b', null, 16, 319, 17, 25, 26.00, timestamp(date("2017-05-04")), null),
 ('t2e', 8, null, 419, 17, 25, 26.00, timestamp(date("2014-06-04")), date("2014-04-05")),
 ('t1f', 19, null, 519, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1b', 10, 12, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1b', 8, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1c', 12, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1e', 8, null, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1f', 19, null, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1b', null, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), null)
-- !query 5 schema
struct<>
-- !query 5 output



-- !query 6
INSERT INTO t3 VALUES
 ('t3a', 6, 12, 110, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t3a', 6, 12, 10, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t1b', 10, 12, 219, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1b', 10, 12, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1b', 8, 16, 319, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1b', 8, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t3c', 17, 16, 519, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t3c', 17, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t1b', null, 16, 419, 17, 25, 26.00, timestamp(date("2014-05-04")), null),
 ('t1b', null, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), null),
 ('t3b', 8, null, 719, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05")),
 ('t3b', 8, null, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-04-05"))
-- !query 6 schema
struct<>
-- !query 6 output



-- !query 7
select * from t1 where t1a in (select t2a from t2)
-- !query 7 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 7 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 8
select * from t1 where t1b in (select t2b from t2 where t1a = t2a)
-- !query 8 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 8 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 9
select t1a, t1b from t1 where t1c in (select t2b from t2 where t1a != t2a)
-- !query 9 schema
struct<t1a:string,t1b:smallint>
-- !query 9 output
t1a	16
t1a	16
t1a	6
t1a	6


-- !query 10
select t1a, t1b from t1 where t1c in (select t2b from t2 where t1a = t2a or t1b > t2b)
-- !query 10 schema
struct<t1a:string,t1b:smallint>
-- !query 10 output
t1a	16
t1a	16


-- !query 11
select t1a, t1b from t1 where t1c in (select t2b from t2 where t2a in
                      (select t3a from t3 where t2c = t3c))
-- !query 11 schema
struct<t1a:string,t1b:smallint>
-- !query 11 output
t1a	6
t1a	6


-- !query 12
select t1a, t1b from t1 where t1c in (select t2b from t2 where t2a in
                      (select t3a from t3 where t2c = t3c and t2b is not NULL))
-- !query 12 schema
struct<t1a:string,t1b:smallint>
-- !query 12 output
t1a	6
t1a	6


-- !query 13
select * from t1 where t1a not in (select t2a from t2)
-- !query 13 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 13 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL


-- !query 14
select * from t1 where t1d not in (select t2d from t2 where t2h > t1h or t2i > t1i)
-- !query 14 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 14 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04


-- !query 15
select * from t1 where t1b not in (select t2b from t2 where t1a < t2a and t2b > 6)
-- !query 15 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 15 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 16
select t1a, avg(t1b) from t1 where t1a in (select t2a from t2) group by t1a
-- !query 16 schema
struct<t1a:string,avg(t1b):double>
-- !query 16 output
t1b	8.0
t1c	8.0
t1e	10.0


-- !query 17
select t1a, max(t1b) from t1 where t1b in (select t2b from t2 where t1a = t2a) group by t1a, t1d
-- !query 17 schema
struct<t1a:string,max(t1b):smallint>
-- !query 17 output
t1b	8


-- !query 18
select t1a, sum(t1b) from t1 where t1c in (select t2c from t2 where t1a = t2a) group by t1a, t1c
-- !query 18 schema
struct<t1a:string,sum(t1b):bigint>
-- !query 18 output
t1b	8
t1c	8


-- !query 19
select t1a, sum(distinct(t1b)) from t1 where t1c in (select t2c from t2 where t1a = t2a) or
t1c in (select t3c from t3 where t1a = t3a) group by t1a, t1c
-- !query 19 schema
struct<t1a:string,sum(DISTINCT t1b):bigint>
-- !query 19 output
t1b	8
t1c	8


-- !query 20
select t1a, count(distinct(t1b)) from t1 where t1c in (select t2c from t2 where t1a = t2a)
group by t1a, t1c having t1a = "t1b"
-- !query 20 schema
struct<t1a:string,count(DISTINCT t1b):bigint>
-- !query 20 output
t1b	1


-- !query 21
select * from t1 where t1b in (select max(t2b) from t2 group by t2a)
-- !query 21 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 21 output
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 22
select * from (select * from t2 where t2a in (select t1a from t1 where t1b = t2b)) t2
-- !query 22 schema
struct<t2a:string,t2b:smallint,t2c:int,t2d:bigint,t2e:float,t2f:double,t2g:decimal(10,0),t2h:timestamp,t2i:date>
-- !query 22 output
t1b	8	16	119	17.0	25.0	26	2015-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 23
select count(distinct(*)) from t1 where t1b in (select min(t2b) from t2 where t1a = t2a and t1c = t2c group by t2a)
-- !query 23 schema
struct<count(DISTINCT t1a, t1b, t1c, t1d, t1e, t1f, t1g, t1h, t1i):bigint>
-- !query 23 output
1


-- !query 24
select t1a, t1b from t1 where t1c in (select max(t2c) from t2 where t1a = t2a group by t2a, t2c having t2c > 8)
-- !query 24 schema
struct<t1a:string,t1b:smallint>
-- !query 24 output
t1b	8
t1c	8


-- !query 25
select t1a, t1b from t1 where t1c in (select t2c from t2 where t2a in
( select min(t3a) from t3 where t3a = t2a group by t3b))
-- !query 25 schema
struct<t1a:string,t1b:smallint>
-- !query 25 output
t1a	16
t1a	16
t1b	8
t1c	8
t1d	NULL
t1d	NULL


-- !query 26
select * from t1 where t1a in
(select min(t2a) from t2 where t2a = t2a and t2c >= 1 group by t2c having t2c in
(select t3c from t3 having t2b > 6 and t3b > t2b))
-- !query 26 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 26 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 27
select * from (select * from t2 where t2a in (select t1a from t1 where t1b = t2b)) t2 where t2a in
(select t2a from t2 where t2a = t2a and t2c > 1 group by t2a having t2c > 8)
-- !query 27 schema
struct<t2a:string,t2b:smallint,t2c:int,t2d:bigint,t2e:float,t2f:double,t2g:decimal(10,0),t2h:timestamp,t2i:date>
-- !query 27 output
t1b	8	16	119	17.0	25.0	26	2015-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 28
select t1a, avg(t1b) from t1 where t1a not in (select t2a from t2) group by t1a
-- !query 28 schema
struct<t1a:string,avg(t1b):double>
-- !query 28 output
t1a	11.0
t1d	10.0


-- !query 29
select t1a, sum(distinct(t1b)) from t1 where t1d not in (select t2d from t2 where t1h < t2h) group by t1a
-- !query 29 schema
struct<t1a:string,sum(DISTINCT t1b):bigint>
-- !query 29 output
t1a	22
t1b	8
t1c	8
t1d	10
t1e	10


-- !query 30
select * from t1 where t1b not in (select max(t2b) from t2 where t2i not in
 (select t1i from t1 where t1d > t2d) group by t2a)
-- !query 30 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 30 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 31
select count(*) from (select * from t2 where t2a not in (select t3a from t3 where t3h != t2h)) t2
where t2b not in (select min(t2b) from t2 where t2b = t2b group by t2c)
-- !query 31 schema
struct<count(1):bigint>
-- !query 31 output
6


-- !query 32
select t1a, t1b from t1 where t1c not in (select max(t2b) from t2 where t1a = t2a group by t2a)
-- !query 32 schema
struct<t1a:string,t1b:smallint>
-- !query 32 output
t1a	16
t1a	16
t1a	6
t1a	6
t1b	8
t1c	8
t1d	NULL
t1d	NULL


-- !query 33
select t1a, t1b from t1 where t1c in (select t2b from t2 where t2a not in
( select min(t3a) from t3 where t3a = t2a group by t3b))
-- !query 33 schema
struct<t1a:string,t1b:smallint>
-- !query 33 output
t1a	16
t1a	16
t1a	6
t1a	6


-- !query 34
select * from t1 where t1a in (select t2a from t2) order by t1a
-- !query 34 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 34 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 35
select t1a from t1 where t1b in (select t2b from t2 where t1a = t2a) order by t1b desc
-- !query 35 schema
struct<t1a:string>
-- !query 35 output
t1b


-- !query 36
select t1a, t1b from t1 where t1c in (select t2c from t2 where t1a = t2a) order by 1
-- !query 36 schema
struct<t1a:string,t1b:smallint>
-- !query 36 output
t1b	8
t1c	8


-- !query 37
select count(distinct(t1a)) from t1 where t1b in (select t2b from t2 where t1a = t2a) order by count(distinct(t1a))
-- !query 37 schema
struct<count(DISTINCT t1a):bigint>
-- !query 37 output
1


-- !query 38
select * from t1 where t1a in (select t2a from t2 order by t2a)
-- !query 38 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 38 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 39
select * from t1 where t1b in (select min(t2b) from t2 where t1a = t2a order by min(t2b))
-- !query 39 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 39 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 40
select t1a, t1b, t1h from t1 where t1c in (select t2c from t2 where t1a = t2a order by t2b desc) or
                                   t1h in (select t2h from t2 where t1h > t2h) order by t1h asc
-- !query 40 schema
struct<t1a:string,t1b:smallint,t1h:timestamp>
-- !query 40 output
t1b	8	2014-05-04 00:00:00
t1c	8	2014-05-04 00:00:00


-- !query 41
select * from t1 where t1a not in (select t2a from t2) order by t1a
-- !query 41 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 41 output
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05


-- !query 42
select t1a, t1b from t1 where t1a not in (select t2a from t2 where t1a = t2a) order by t1a
-- !query 42 schema
struct<t1a:string,t1b:smallint>
-- !query 42 output
t1a	6
t1a	16
t1a	16
t1a	6
t1d	NULL
t1d	NULL
t1d	10


-- !query 43
select * from t1 where t1a not in (select t2a from t2 order by t2a desc) and
                       t1c in (select t2c from t2 order by t2b asc) order by t1c desc
-- !query 43 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 43 output
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04


-- !query 44
select * from t1 where t1b in (select min(t2b) from t2 group by t2a order by t2a desc)
-- !query 44 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 44 output
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 45
select count(distinct(*)) from t1 where t1a in (select min(t2a) from t2 group by t2c order by t2c desc)
-- !query 45 schema
struct<count(DISTINCT t1a, t1b, t1c, t1d, t1e, t1f, t1g, t1h, t1i):bigint>
-- !query 45 output
1


-- !query 46
select t1a, count(distinct(t1b)) from t1 where t1b in (select min(t2b)
from t2 where t1a = t2a group by t2a order by t2a desc) group by t1a, t1h
-- !query 46 schema
struct<t1a:string,count(DISTINCT t1b):bigint>
-- !query 46 output
t1b	1


-- !query 47
select t1a, t1b from t1 where t1b in (select min(t2b) from t2
where t1a = t2a group by t2d order by t2d desc)
-- !query 47 schema
struct<t1a:string,t1b:smallint>
-- !query 47 output
t1b	8


-- !query 48
select * from t1 where t1b not in (select min(t2b) from t2 group by t2a order by t2a)
-- !query 48 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 48 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 49
select count(*) from t1 where t1b not in (select min(t2b) from t2 group by t2c order by t2c desc) group by t1a
-- !query 49 schema
struct<count(1):bigint>
-- !query 49 output
1
2
3


-- !query 50
select t1a, sum(distinct(t1b)) from t1 where t1b not in (select min(t2b) from t2
where t1a = t2a group by t2c order by t2c) group by t1a
-- !query 50 schema
struct<t1a:string,sum(DISTINCT t1b):bigint>
-- !query 50 output
t1a	22
t1c	8
t1d	10
t1e	10


-- !query 51
select count(distinct(t1a)), t1b from t1 where t1b not in (select min(t2b) from t2
where t1a = t2a group by t2d order by t2d desc) group by t1a, t1b order by t1b desc
-- !query 51 schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query 51 output



-- !query 52
select * from t1 where t1a in (select t2a from t2 limit 2)
-- !query 52 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 52 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 53
select * from t1 where t1c in (select t2c from t2 where t2b >=8 limit 2) limit 4
-- !query 53 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 53 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 54
select count(distinct(t1a)), t1b from t1 where t1d in (select t2d from t2 order by t2c)
group by t1b order by t1b limit 1
-- !query 54 schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query 54 output
1	NULL


-- !query 55
select * from t1 where t1a not in (select t2a from t2 limit 2)
-- !query 55 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 55 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 56
select * from t1 where t1b not in (select t2b from t2 where t2b > 6 limit 2)
-- !query 56 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 56 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04


-- !query 57
select count(distinct(t1a)), t1b from t1 where t1d not in
(select t2d from t2 order by t2b) group by t1b limit 1
-- !query 57 schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query 57 output
1	NULL


-- !query 58
select * from t1 where t1a in (select t2a from t2 having t2c > 10)
-- !query 58 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 58 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 59
select * from t1 where t1b in (select min(t2b) from t2 where t1a = t2a group by t2b having t2b > 1)
-- !query 59 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 59 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 60
select count(distinct(t1a)), t1b from t1 where t1c in (select t2c from t2 where t1a = t2a having t2c > 10)
group by t1b having t1b >= 8
-- !query 60 schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query 60 output
2	8


-- !query 61
select t1a, max(t1b) from t1 where t1b > 0 group by t1a having t1a in
(select t2a from t2 where t2b in (select t3b from t3 where t2c = t3c))
-- !query 61 schema
struct<t1a:string,max(t1b):smallint>
-- !query 61 output
t1b	8


-- !query 62
select * from t1 where t1a not in (select t2a from t2 having t2c > 10)
-- !query 62 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 62 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 63
select t1a, t1b from t1 where t1d not in (select t2d from t2 where t1a = t2a having t2c > 8)
-- !query 63 schema
struct<t1a:string,t1b:smallint>
-- !query 63 output
t1a	16
t1a	16
t1a	6
t1a	6
t1d	10
t1d	NULL
t1d	NULL
t1e	10
t1e	10
t1e	10


-- !query 64
select t1a, t1b from t1 where t1c not in (select t2c from t2 where t1a = t2a having t2c not in
(select t3c from t3)) group by t1a, t1b limit 2
-- !query 64 schema
struct<t1a:string,t1b:smallint>
-- !query 64 output
t1d	10
t1e	10


-- !query 65
select t1a, max(t1b) from t1 where t1b > 0 group by t1a having t1a not in (select t2a from t2 where t2b > 3)
-- !query 65 schema
struct<t1a:string,max(t1b):smallint>
-- !query 65 output
t1a	16
t1d	10


-- !query 66
select * from t1 natural join t3 where t1a in (select t2a from t2 ) and t1b = t3b order by t1a, t1b
-- !query 66 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date,t3a:string,t3b:smallint,t3c:int,t3d:bigint,t3e:float,t3f:double,t3g:decimal(10,0),t3h:timestamp,t3i:date>
-- !query 66 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t3b	8	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t3b	8	NULL	719	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	8	16	319	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t3b	8	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t3b	8	NULL	719	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	8	16	319	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	10	12	219	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	10	12	219	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	10	12	219	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 67
select count(distinct(t1a)), t1b, t3a, t3b, t3c from t1 natural left join t3 where t1a
in (select t2a from t2 ) and t1b > t3b group by t1a, t1b, t3a, t3b, t3c order by t1a desc limit 2
-- !query 67 schema
struct<count(DISTINCT t1a):bigint,t1b:smallint,t3a:string,t3b:smallint,t3c:int>
-- !query 67 output
1	10	t3a	6	12
1	10	t1b	8	16


-- !query 68
select count(distinct(*)) from t1 natural right join t3
where t1a in (select t2a from t2 where t1b = t2b) and t1b in (select t2b from t2 where t1c > t2c) and t1a = t3a
group by t1a order by t1a
-- !query 68 schema
struct<count(DISTINCT t1a, t1b, t1c, t1d, t1e, t1f, t1g, t1h, t1i, t3a, t3b, t3c, t3d, t3e, t3f, t3g, t3h, t3i):bigint>
-- !query 68 output



-- !query 69
select t1a, t1b, t1c, t3a, t3b, t3c from t1 full outer join t3
where t1a in (select t2a from t2 ) and t1b != t3b order by t1a
-- !query 69 schema
struct<t1a:string,t1b:smallint,t1c:int,t3a:string,t3b:smallint,t3c:int>
-- !query 69 output
t1b	8	16	t3a	6	12
t1b	8	16	t3a	6	12
t1b	8	16	t1b	10	12
t1b	8	16	t1b	10	12
t1b	8	16	t3c	17	16
t1b	8	16	t3c	17	16
t1c	8	16	t3a	6	12
t1c	8	16	t3a	6	12
t1c	8	16	t1b	10	12
t1c	8	16	t1b	10	12
t1c	8	16	t3c	17	16
t1c	8	16	t3c	17	16
t1e	10	NULL	t3a	6	12
t1e	10	NULL	t3a	6	12
t1e	10	NULL	t1b	8	16
t1e	10	NULL	t1b	8	16
t1e	10	NULL	t3c	17	16
t1e	10	NULL	t3c	17	16
t1e	10	NULL	t3b	8	NULL
t1e	10	NULL	t3b	8	NULL
t1e	10	NULL	t3a	6	12
t1e	10	NULL	t3a	6	12
t1e	10	NULL	t1b	8	16
t1e	10	NULL	t1b	8	16
t1e	10	NULL	t3c	17	16
t1e	10	NULL	t3c	17	16
t1e	10	NULL	t3b	8	NULL
t1e	10	NULL	t3b	8	NULL
t1e	10	NULL	t3a	6	12
t1e	10	NULL	t3a	6	12
t1e	10	NULL	t1b	8	16
t1e	10	NULL	t1b	8	16
t1e	10	NULL	t3c	17	16
t1e	10	NULL	t3c	17	16
t1e	10	NULL	t3b	8	NULL
t1e	10	NULL	t3b	8	NULL


-- !query 70
select count(distinct(t1a)), t1b from t1 full outer join t3 where t1a in (select t2a from t2 where t2h > t3h)
and t3a in (select t2a from t2 where t2c > t3c) and t1h >= t3h group by t1a, t1b order by t1a
-- !query 70 schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query 70 output
1	8
1	8


-- !query 71
select count(*) from t1 left semi join t3 where t1a in (select t2a from t2 ) group by t1a order by t1a
-- !query 71 schema
struct<count(1):bigint>
-- !query 71 output
1
1
3


-- !query 72
select count(distinct(t1a)), t1b from t1 left anti join t2 on t1a > t2a where t1b in (select t2b from t2)
or t1a in (select t2a from t2) group by t1b having t1b > 1
-- !query 72 schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query 72 output
1	6
1	8


-- !query 73
select * from t1 where t1a in (select t2a from t2 left join t3 where t2b = t3b)
-- !query 73 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 73 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 74
select t1a, t1b from t1 where t1a in (select t2a from t2 full outer join t1 where t2b > t1b) limit 2
-- !query 74 schema
struct<t1a:string,t1b:smallint>
-- !query 74 output
t1b	8
t1c	8


-- !query 75
select count(distinct(t1a)), t1b from t1 where t1a in (select t2a from t2 cross join t1 where t2b <> t1b) and
t1h in (select t2h from t2 right join t3 where t2b = t3b) group by t1b
-- !query 75 schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query 75 output
1	10
2	8


-- !query 76
select count(distinct(t1a)), t1b from t1 where t1a in (select t2a from t2 right join t1 where t2b <> t1b) or
                              t1b in (select t2b from t2 left join t1 where t2c = t1c) group by t1b
-- !query 76 schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query 76 output
1	6
2	10
2	8


-- !query 77
select * from t1 full outer join t2 where t1a in
(select t2a from t2 left join t3 where t2b = t3b) and t1c = t2c limit 10
-- !query 77 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date,t2a:string,t2b:smallint,t2c:int,t2d:bigint,t2e:float,t2f:double,t2g:decimal(10,0),t2h:timestamp,t2i:date>
-- !query 77 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	8	16	119	17.0	25.0	26	2015-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	NULL	16	319	17.0	25.0	26	2017-05-04 00:00:00	NULL
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1c	12	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1c	12	16	219	17.0	25.0	26	2016-05-04 00:00:00	2014-04-05


-- !query 78
select count(distinct(t1a)), t1b from t1 inner join t2
where t1a in (select t2a from t2 join t3 where t2b > t3b) and
t1c in (select min(t3c) from t3 left outer join t2 group by t3a having t3a = t2a) and t1a = t2a
group by t1b order by t1b desc
-- !query 78 schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query 78 output



-- !query 79
select t1a, t1b, t1c, t2a, t2b, t2c from t1 right join t2
where t1a in (select t2a from t2 full outer join t3 where t2b > t3b) and
t1b in ( select t3b from t3 left semi join t1 where t3c = t1c) and t1h > t2h
-- !query 79 schema
struct<t1a:string,t1b:smallint,t1c:int,t2a:string,t2b:smallint,t2c:int>
-- !query 79 output
t1b	8	16	t2a	6	12
t1c	8	16	t2a	6	12


-- !query 80
select t1a, t1b, t1c, t2a, t2b, t2c from t1 full join t2
where t1a in (select t2a from t2 left anti join t3 on t2b < t3b where t2c in (select t1c from t1 where t1a = t2a))
and t1a = t2a
-- !query 80 schema
struct<t1a:string,t1b:smallint,t1c:int,t2a:string,t2b:smallint,t2c:int>
-- !query 80 output
t1b	8	16	t1b	10	12
t1b	8	16	t1b	10	12
t1b	8	16	t1b	8	16
t1b	8	16	t1b	8	16
t1b	8	16	t1b	NULL	16
t1b	8	16	t1b	NULL	16


-- !query 81
select * from (select * from t3 left outer join t2 where t3a = t2a and t2a in
(select t1a from t1 where t2b = t1b)) t1 natural full outer join t2
where t1.t2a in (select t2a from t2 left anti join t3 on t2b < t3b) and t1.t2c = t2c order by t2a, t3a desc limit 5
-- !query 81 schema
struct<t2a:string,t2b:smallint,t2c:int,t2d:bigint,t2e:float,t2f:double,t2g:decimal(10,0),t2h:timestamp,t2i:date,t3a:string,t3b:smallint,t3c:int,t3d:bigint,t3e:float,t3f:double,t3g:decimal(10,0),t3h:timestamp,t3i:date>
-- !query 81 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	10	12	219	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1b	8	16	119	17.0	25.0	26	2015-05-04 00:00:00	2014-04-05	t1b	10	12	219	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1b	8	16	119	17.0	25.0	26	2015-05-04 00:00:00	2014-04-05	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	8	16	319	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 82
select t1a, t1b, t1c, t3a, t3b, t3c from t1 natural join t3 where t1a not in (select t2a from t2 ) and t1b = t3b
-- !query 82 schema
struct<t1a:string,t1b:smallint,t1c:int,t3a:string,t3b:smallint,t3c:int>
-- !query 82 output
t1a	6	8	t3a	6	12
t1a	6	8	t3a	6	12
t1a	6	8	t3a	6	12
t1a	6	8	t3a	6	12
t1d	10	NULL	t1b	10	12
t1d	10	NULL	t1b	10	12


-- !query 83
select t1a, t1b, t1c, t3a, t3b, t3c from t1 full outer join t3
where t1a not in (select t2a from t2 where t2c not in (select t1c from t1 where t1a = t2a)) and t1b != t3b order by t1a
-- !query 83 schema
struct<t1a:string,t1b:smallint,t1c:int,t3a:string,t3b:smallint,t3c:int>
-- !query 83 output
t1a	6	8	t1b	10	12
t1a	6	8	t1b	10	12
t1a	6	8	t1b	8	16
t1a	6	8	t1b	8	16
t1a	6	8	t3c	17	16
t1a	6	8	t3c	17	16
t1a	6	8	t3b	8	NULL
t1a	6	8	t3b	8	NULL
t1a	16	12	t3a	6	12
t1a	16	12	t3a	6	12
t1a	16	12	t1b	10	12
t1a	16	12	t1b	10	12
t1a	16	12	t1b	8	16
t1a	16	12	t1b	8	16
t1a	16	12	t3c	17	16
t1a	16	12	t3c	17	16
t1a	16	12	t3b	8	NULL
t1a	16	12	t3b	8	NULL
t1a	16	12	t3a	6	12
t1a	16	12	t3a	6	12
t1a	16	12	t1b	10	12
t1a	16	12	t1b	10	12
t1a	16	12	t1b	8	16
t1a	16	12	t1b	8	16
t1a	16	12	t3c	17	16
t1a	16	12	t3c	17	16
t1a	16	12	t3b	8	NULL
t1a	16	12	t3b	8	NULL
t1a	6	8	t1b	10	12
t1a	6	8	t1b	10	12
t1a	6	8	t1b	8	16
t1a	6	8	t1b	8	16
t1a	6	8	t3c	17	16
t1a	6	8	t3c	17	16
t1a	6	8	t3b	8	NULL
t1a	6	8	t3b	8	NULL
t1b	8	16	t3a	6	12
t1b	8	16	t3a	6	12
t1b	8	16	t1b	10	12
t1b	8	16	t1b	10	12
t1b	8	16	t3c	17	16
t1b	8	16	t3c	17	16
t1c	8	16	t3a	6	12
t1c	8	16	t3a	6	12
t1c	8	16	t1b	10	12
t1c	8	16	t1b	10	12
t1c	8	16	t3c	17	16
t1c	8	16	t3c	17	16
t1d	10	NULL	t3a	6	12
t1d	10	NULL	t3a	6	12
t1d	10	NULL	t1b	8	16
t1d	10	NULL	t1b	8	16
t1d	10	NULL	t3c	17	16
t1d	10	NULL	t3c	17	16
t1d	10	NULL	t3b	8	NULL
t1d	10	NULL	t3b	8	NULL
t1e	10	NULL	t3a	6	12
t1e	10	NULL	t3a	6	12
t1e	10	NULL	t1b	8	16
t1e	10	NULL	t1b	8	16
t1e	10	NULL	t3c	17	16
t1e	10	NULL	t3c	17	16
t1e	10	NULL	t3b	8	NULL
t1e	10	NULL	t3b	8	NULL
t1e	10	NULL	t3a	6	12
t1e	10	NULL	t3a	6	12
t1e	10	NULL	t1b	8	16
t1e	10	NULL	t1b	8	16
t1e	10	NULL	t3c	17	16
t1e	10	NULL	t3c	17	16
t1e	10	NULL	t3b	8	NULL
t1e	10	NULL	t3b	8	NULL
t1e	10	NULL	t3a	6	12
t1e	10	NULL	t3a	6	12
t1e	10	NULL	t1b	8	16
t1e	10	NULL	t1b	8	16
t1e	10	NULL	t3c	17	16
t1e	10	NULL	t3c	17	16
t1e	10	NULL	t3b	8	NULL
t1e	10	NULL	t3b	8	NULL


-- !query 84
select count(*) from t1 left semi join t3 where t1a not in (select t2a from t2 left outer join t3 where t2a = t3a)
group by t1a order by t1a
-- !query 84 schema
struct<count(1):bigint>
-- !query 84 output
4
1
3
3


-- !query 85
select * from t1 where t1a not in (select t2a from t2 left join t3 where t2b = t3b) and t1d not in (select t2d from t2)
-- !query 85 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 85 output
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL


-- !query 86
select count(distinct(t1a)), t1b, t1c, t1d from t1 where t1a not in (select t2a from t2 cross join t1 where t2b <> t1b)
group by t1b, t1c, t1d having t1d not in (select t2d from t2 where t1d = t2d)
-- !query 86 schema
struct<count(DISTINCT t1a):bigint,t1b:smallint,t1c:int,t1d:bigint>
-- !query 86 output
1	10	NULL	12
1	16	12	21
1	NULL	16	22


-- !query 87
select sum(distinct(t1a)), t1b, t1c, t1d from t1 where t1a not in (select t2a from t2 left semi join t1)
group by t1b, t1c, t1d having t1b < sum(t1c)
-- !query 87 schema
struct<sum(DISTINCT CAST(t1a AS DOUBLE)):double,t1b:smallint,t1c:int,t1d:bigint>
-- !query 87 output
NULL	6	8	10


-- !query 88
select * from t1 full outer join t2 where t1a not in (select t2a from t2 left join t3 where t2b = t3b) and t1c = t2c
-- !query 88 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date,t2a:string,t2b:smallint,t2c:int,t2d:bigint,t2e:float,t2f:double,t2g:decimal(10,0),t2h:timestamp,t2i:date>
-- !query 88 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04	t2a	6	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04	t2a	6	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	8	16	119	17.0	25.0	26	2015-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	NULL	16	319	17.0	25.0	26	2017-05-04 00:00:00	NULL
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1c	12	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1c	12	16	219	17.0	25.0	26	2016-05-04 00:00:00	2014-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	8	16	119	17.0	25.0	26	2015-05-04 00:00:00	2014-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	NULL	16	319	17.0	25.0	26	2017-05-04 00:00:00	NULL
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1c	12	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1c	12	16	219	17.0	25.0	26	2016-05-04 00:00:00	2014-04-05
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	8	16	119	17.0	25.0	26	2015-05-04 00:00:00	2014-04-05
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	NULL	16	319	17.0	25.0	26	2017-05-04 00:00:00	NULL
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1c	12	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1c	12	16	219	17.0	25.0	26	2016-05-04 00:00:00	2014-04-05


-- !query 89
select * from t1 full outer join t2 where t1a not in (select t2a from t2 inner join t3 where t2b = t3b) and t1c = t2c
-- !query 89 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date,t2a:string,t2b:smallint,t2c:int,t2d:bigint,t2e:float,t2f:double,t2g:decimal(10,0),t2h:timestamp,t2i:date>
-- !query 89 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04	t2a	6	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04	t2a	6	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	8	16	119	17.0	25.0	26	2015-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	NULL	16	319	17.0	25.0	26	2017-05-04 00:00:00	NULL
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1c	12	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1c	12	16	219	17.0	25.0	26	2016-05-04 00:00:00	2014-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	8	16	119	17.0	25.0	26	2015-05-04 00:00:00	2014-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	NULL	16	319	17.0	25.0	26	2017-05-04 00:00:00	NULL
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1c	12	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1c	12	16	219	17.0	25.0	26	2016-05-04 00:00:00	2014-04-05
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	8	16	119	17.0	25.0	26	2015-05-04 00:00:00	2014-04-05
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1b	NULL	16	319	17.0	25.0	26	2017-05-04 00:00:00	NULL
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1c	12	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL	t1c	12	16	219	17.0	25.0	26	2016-05-04 00:00:00	2014-04-05


-- !query 90
select t2a from (select t2a from t2 where t2a in (select t1a from t1)
       union all select t2a from t2 where t2a in (select t1a from t1)) as t3
-- !query 90 schema
struct<t2a:string>
-- !query 90 output
t1b
t1b
t1b
t1b
t1b
t1b
t1b
t1b
t1b
t1b
t1b
t1b
t1c
t1c
t1c
t1c
t1e
t1e


-- !query 91
select t2a from (select t2a from t2 where t2a in (select t1a from t1)
       union select t2a from t2 where t2a in (select t3a from t3)) as t3
-- !query 91 schema
struct<t2a:string>
-- !query 91 output
t1b
t1c
t1e


-- !query 92
select t2a from (select t2a from t2 where t2a in (select t1a from t1 where t1b = t2b)
       union all select t2a from t2 where t2a in (select t1a from t1 where t2c = t1c)) as t3
-- !query 92 schema
struct<t2a:string>
-- !query 92 output
t1b
t1b
t1b
t1b
t1b
t1b
t1c
t1c


-- !query 93
select t2a from (select t2a from t2 where t2a in (select t1a from t1 where t1b = t2b)
       union select t2a from t2 where t2a in (select t1a from t1 where t2c = t1c)) as t3
-- !query 93 schema
struct<t2a:string>
-- !query 93 output
t1b
t1c


-- !query 94
select t2a from (select t2a from t2 where t2a in (select t1a from t1 where t1b = t2b)
       union distinct select t2a from t2 where t2a in (select t1a from t1 where t2c = t1c)) as t3
-- !query 94 schema
struct<t2a:string>
-- !query 94 output
t1b
t1c


-- !query 95
select t2a from (select t2a from t2 where t2a in (select t1a from t1 where t1b = t2b)
       intersect select t2a from t2 where t2a in (select t1a from t1 where t2c = t1c)) as t3
-- !query 95 schema
struct<t2a:string>
-- !query 95 output
t1b


-- !query 96
select t2a from (select t2a from t2 where t2a in (select t1a from t1 where t1b != t2b)
       except select t2a from t2 where t2a in (select t3a from t3 where t2c = t3c)) as t3
-- !query 96 schema
struct<t2a:string>
-- !query 96 output
t1c
t1e


-- !query 97
select * from t1 where t1a in (select t3a from (select t2a t3a from t2 union all select t2a t3a from t2) as t3)
-- !query 97 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 97 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 98
select * from t1 where t1b in (
select t2b from (select t2b from t2 where t2b > 6 union select t2b from t2 where t2b > 6) as t3)
-- !query 98 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 98 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 99
select t1a, t1b, t1c from t1 where t1b in (
select t2b from (select t2b from t2 where t2b > 6 union distinct select t1b from t1 where t1b > 6) as t3)
-- !query 99 schema
struct<t1a:string,t1b:smallint,t1c:int>
-- !query 99 output
t1a	16	12
t1a	16	12
t1b	8	16
t1c	8	16
t1d	10	NULL
t1e	10	NULL
t1e	10	NULL
t1e	10	NULL


-- !query 100
select t1a, t1b, t1c from t1 where t1b in (
select t2b from (select t2b from t2 where t2b > 6 intersect select t1b from t1 where t1b > 6) as t3 where t2b = t1b)
-- !query 100 schema
struct<t1a:string,t1b:smallint,t1c:int>
-- !query 100 output
t1b	8	16
t1c	8	16
t1d	10	NULL
t1e	10	NULL
t1e	10	NULL
t1e	10	NULL


-- !query 101
select t1a, t1b, t1c from t1 where t1h in (
select t2h from (select t2h from t2 except select t3h from t3 ) as t3)
-- !query 101 schema
struct<t1a:string,t1b:smallint,t1c:int>
-- !query 101 output
t1d	10	NULL


-- !query 102
select t1a, t1b, t1c from t1 where t1a in (select t3a from (select t2a t3a from t2 union all select t2a t3a from t2)
 as t3)
union all
select t1a, t1b, t1c from t1 where t1a in (select t3a from (select t2a t3a from t2 union select t2a t3a from t2)
 as t3)
-- !query 102 schema
struct<t1a:string,t1b:smallint,t1c:int>
-- !query 102 output
t1b	8	16
t1b	8	16
t1c	8	16
t1c	8	16
t1e	10	NULL
t1e	10	NULL
t1e	10	NULL
t1e	10	NULL
t1e	10	NULL
t1e	10	NULL


-- !query 103
select t1a, t1b, t1c from t1 where t1b in (
select t2b from (select t2b from t2 where t2b > 6 intersect select t1b from t1 where t1b > 6) as t3)
union distinct
select t1a, t1b, t1c from t1 where t1b in (
select t2b from (select t2b from t2 where t2b > 6 except select t1b from t1 where t1b > 6) as t3 where t2b = t1b)
-- !query 103 schema
struct<t1a:string,t1b:smallint,t1c:int>
-- !query 103 output
t1b	8	16
t1c	8	16
t1d	10	NULL
t1e	10	NULL


-- !query 104
select count(distinct t2b) from
(select t2a, t2b from (select t2a, t2b from t2 where t2h in (select t1h from t1 where t1a = t2a)
         union distinct select t1a, t1b from t1 where t1h in (select t3h from t3 union select t1h from t1)) t4
         where t4.t2b in (select min(t3b) from t3 where t4.t2a = t3a))
-- !query 104 schema
struct<count(DISTINCT t2b):bigint>
-- !query 104 output
1


-- !query 105
select t2a from (select t2a from t2 where t2a not in (select t1a from t1 union select t3a from t3)
       union all select t2a from t2 where t2a not in (select t1a from t1 intersect select t2a from t2)) as t3
       where t3.t2a not in (select t1a from t1 intersect select t2a from t2)
-- !query 105 schema
struct<t2a:string>
-- !query 105 output
t1f
t1f
t1f
t1f
t2a
t2a
t2e
t2e


-- !query 106
select t1a, t1b, t1c from t1 where t1b not in (
select t2b from (select t2b from t2 where t2b not in (select t1b from t1) union
                 select t1b from t1 where t1b not in (select t3b from t3) union distinct
                 select t3b from t3 where t3b not in (select t2b from t2)) as t3 where t2b = t1b)
-- !query 106 schema
struct<t1a:string,t1b:smallint,t1c:int>
-- !query 106 output
t1a	16	12
t1a	16	12
t1a	6	8
t1a	6	8
t1b	8	16
t1c	8	16
t1d	10	NULL
t1d	NULL	16
t1d	NULL	16
t1e	10	NULL
t1e	10	NULL
t1e	10	NULL


-- !query 107
select distinct(t1a), t1b, t1c from t1 where t1b not in (
select t2b from (select t2b from t2 where t2b > 6 union distinct select t1b from t1 where t1b > 6) as t3)
union
select distinct(t1a), t1b, t1c from t1 where t1b not in (
select t2b from (select t2b from t2 where t2b > 6 intersect select t1b from t1 where t1b > 6) as t3 where t2b = t1b)
group by t1a, t1b, t1c
-- !query 107 schema
struct<t1a:string,t1b:smallint,t1c:int>
-- !query 107 output
t1a	16	12
t1a	6	8


-- !query 108
with cte1 as (select t1a, t1b from t1) select * from t1 where t1b in
(select cte1.t1b from cte1 where cte1.t1b > 0)
-- !query 108 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 108 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 109
with cte1 as (select t1a, t1b from t1) select t1a, t1b from t1 where t1b in
(select cte1.t1b from cte1 where cte1.t1b > 0 union select cte1.t1b from cte1 where cte1.t1b > 5)
-- !query 109 schema
struct<t1a:string,t1b:smallint>
-- !query 109 output
t1a	16
t1a	16
t1a	6
t1a	6
t1b	8
t1c	8
t1d	10
t1e	10
t1e	10
t1e	10


-- !query 110
with cte1 as (select t1a, t1b from t1) select * from
(select cte1.t1b from cte1 where cte1.t1b > 0 union select cte1.t1b from cte1 where cte1.t1b > 5) s where t1b > 6
-- !query 110 schema
struct<t1b:smallint>
-- !query 110 output
10
16
8


-- !query 111
with cte1 as (select t1a, t1b from t1) select distinct(*) from
(select cte1.t1b from cte1 cross join cte1 cte2 on cte1.t1b > 5) s where t1b > 6
-- !query 111 schema
struct<t1b:smallint>
-- !query 111 output
10
16
8


-- !query 112
with cte1 as (select t1a, t1b from t1 where t1b in (select t2b from t2 where t1c = t2c)) select distinct(*) from
(select cte1.t1b from cte1 cross join cte1 cte2 on cte1.t1b > 5 and cte1.t1a = cte2.t1a) s where t1b in (8)
-- !query 112 schema
struct<t1b:smallint>
-- !query 112 output
8


-- !query 113
with cte1 as (select t1a, t1b, t1h from t1 where t1a in (select t2a from t2 where t1b < t2b))
select count(distinct t1a), t1b from
(select cte1.t1a, cte1.t1b from cte1 cross join cte1 cte2 on cte1.t1h >= cte2.t1h) s where t1b in (select t1b from t1)
group by t1b
-- !query 113 schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query 113 output
2	8


-- !query 114
with cte1 as (select t1a, t1b from t1 where t1b in (select t2b from t2 where t1c = t2c)) select distinct(*) from
(select cte1.t1b from cte1 left semi join cte1 cte2 on cte1.t1b > 5 and cte1.t1a != cte2.t1a) s
-- !query 114 schema
struct<t1b:smallint>
-- !query 114 output
8


-- !query 115
with cte1 as (select t1a, t1b from t1 where t1b in (select t2b from t2 where t1c = t2c))
select count(distinct(s.t1a)), s.t1b from
(select cte1.t1a, cte1.t1b from cte1 right outer join cte1 cte2 on cte1.t1a = cte2.t1a ) s
where t1b in (8) group by s.t1b
-- !query 115 schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query 115 output
2	8


-- !query 116
with cte1 as (select t1a, t1b from t1 where t1b in (select t2b from t2 where t1c = t2c)) select distinct(*) from
(select cte1.t1b from cte1 left outer join cte1 cte2 on cte1.t1b = cte2.t1b) s
where s.t1b in (select t1b from t1 left semi join cte1 on t1.t1a = cte1.t1a)
-- !query 116 schema
struct<t1b:smallint>
-- !query 116 output
8


-- !query 117
with cte1 as (select t1a, t1b from t1) select * from t1 where t1b not in (select cte1.t1b from cte1 where cte1.t1b < 0)
-- !query 117 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 117 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 118
with cte1 as (select t1a, t1b from t1 where t1a not in (select t2a from t2)) select distinct(*) from
(select cte1.t1b from cte1 cross join cte1 cte2) s
-- !query 118 schema
struct<t1b:smallint>
-- !query 118 output
10
16
6
NULL


-- !query 119
with cte1 as (select t1a, t1b, t1c, t1h from t1 where t1d not in (select t2d from t2)) select * from
(select cte1.t1b, cte1.t1c, cte1.t1h from cte1 full outer join cte1 cte2 where cte1.t1h = cte2.t1h) s where s.t1h
not in (select t3h from t3)
-- !query 119 schema
struct<t1b:smallint,t1c:int,t1h:timestamp>
-- !query 119 output
10	NULL	2015-05-04 00:00:00


-- !query 120
select * from t1 where (t1a, t1h) not in
(select t2a, t2h from t2 where t2a = t1a order by t2a)
-- !query 120 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 120 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05
t1d	NULL	16	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1d	NULL	16	22	17.0	25.0	26	2014-05-04 00:00:00	NULL


-- !query 121
select * from t1 where (t1b, t1d) in (select t2b, t2d from t2 where t2h in (select t3h from t3 where t2b > t3b))
-- !query 121 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 121 output
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 122
select * from t1 where (t1b, t1d) not in (select t2b, t2d from t2 where t2h in (select t3h from t3 where t2b > t3b))
-- !query 122 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 122 output
t1a	16	12	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	16	12	21	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-04-05
t1e	10	NULL	25	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05


-- !query 123
select t2a from (select t2a from t2 where (t2a, t2b) in (select t1a, t1b from t1) union all
                 select t2a from t2 where (t2a, t2b) in (select t1a, t1b from t1) union distinct
                 select t2a from t2 where (t2a, t2b) in (select t3a, t3b from t3)) as t4
-- !query 123 schema
struct<t2a:string>
-- !query 123 output
t1b


-- !query 124
select * from (select * from t3 left outer join t2 where t3a = t2a and (t2a, t2b) in
(select t1a, t1b from t1 where t2b = t1b)) t1 natural full outer join t2
where (t1.t2a, t1.t2b) not in (select t2a, t2b from t2 left anti join t3 on t2a = t3a) order by t2a, t3a desc limit 5
-- !query 124 schema
struct<t2a:string,t2b:smallint,t2c:int,t2d:bigint,t2e:float,t2f:double,t2g:decimal(10,0),t2h:timestamp,t2i:date,t3a:string,t3b:smallint,t3c:int,t3d:bigint,t3e:float,t3f:double,t3g:decimal(10,0),t3h:timestamp,t3i:date>
-- !query 124 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	10	12	219	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	10	12	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	8	16	319	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-04-05	t1b	NULL	16	419	17.0	25.0	26	2014-05-04 00:00:00	NULL


-- !query 125
with cte1 as (select t1a, t1b from t1 where (t1b, t1d) in (select t2b, t2d from t2 where t1c = t2c))
select distinct(*) from (select cte1.t1b from cte1 cross join cte1 cte2 on cte1.t1b > 5) s where t1b in (8)
-- !query 125 schema
struct<t1b:smallint>
-- !query 125 output
8


-- !query 126
DROP TABLE t1
-- !query 126 schema
struct<>
-- !query 126 output



-- !query 127
DROP TABLE t2
-- !query 127 schema
struct<>
-- !query 127 output



-- !query 128
DROP TABLE t3
-- !query 128 schema
struct<>
-- !query 128 output



-- !query 129
USE default
-- !query 129 schema
struct<>
-- !query 129 output



-- !query 130
DROP DATABASE indb
-- !query 130 schema
struct<>
-- !query 130 output

