-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE explain_temp1(a INT, b INT) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE explain_temp2(c INT, d INT) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
ANALYZE TABLE explain_temp1 COMPUTE STATISTICS FOR ALL COLUMNS
-- !query schema
struct<>
-- !query output



-- !query
ANALYZE TABLE explain_temp2 COMPUTE STATISTICS FOR ALL COLUMNS
-- !query schema
struct<>
-- !query output



-- !query
EXPLAIN COST WITH max_store_sales AS
(
  SELECT max(csales) tpcds_cmax
  FROM (
    SELECT sum(b) csales
    FROM explain_temp1 WHERE a < 100
  ) x
),
best_ss_customer AS
(
  SELECT c
  FROM explain_temp2
  WHERE d > (SELECT * FROM max_store_sales)
)
SELECT c FROM best_ss_customer
-- !query schema
struct<plan:string>
-- !query output
org.apache.spark.sql.catalyst.analysis.UnresolvedException: Invalid call to toAttribute on unresolved object
== Optimized Logical Plan ==
org.apache.spark.sql.catalyst.analysis.UnresolvedException: Invalid call to toAttribute on unresolved object
== Physical Plan ==
org.apache.spark.sql.catalyst.analysis.UnresolvedException: Invalid call to toAttribute on unresolved object


-- !query
DROP TABLE explain_temp1
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE explain_temp2
-- !query schema
struct<>
-- !query output

