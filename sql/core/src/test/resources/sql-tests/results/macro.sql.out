-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 49


-- !query 0
CREATE TEMPORARY MACRO SIGMOID (x DOUBLE) 1.0 / (1.0 + EXP(-x))
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
SELECT SIGMOID(2)
-- !query 1 schema
struct<(CAST(1.0 AS DOUBLE) / (CAST(1.0 AS DOUBLE) + EXP(CAST((- 2) AS DOUBLE)))):double>
-- !query 1 output
0.8807970779778823


-- !query 2
DROP TEMPORARY MACRO SIGMOID
-- !query 2 schema
struct<>
-- !query 2 output



-- !query 3
CREATE TEMPORARY MACRO FIXED_NUMBER() 1
-- !query 3 schema
struct<>
-- !query 3 output



-- !query 4
SELECT FIXED_NUMBER() + 1
-- !query 4 schema
struct<(1 + 1):int>
-- !query 4 output
2


-- !query 5
DROP TEMPORARY MACRO FIXED_NUMBER
-- !query 5 schema
struct<>
-- !query 5 output



-- !query 6
CREATE TEMPORARY MACRO SIMPLE_ADD (x INT, y INT) x + y
-- !query 6 schema
struct<>
-- !query 6 output



-- !query 7
SELECT SIMPLE_ADD(1, 9)
-- !query 7 schema
struct<(1 + 9):int>
-- !query 7 output
10


-- !query 8
DROP TEMPORARY MACRO SIMPLE_ADD
-- !query 8 schema
struct<>
-- !query 8 output



-- !query 9
CREATE TEMPORARY MACRO flr(d bigint) FLOOR(d/10)*10
-- !query 9 schema
struct<>
-- !query 9 output



-- !query 10
SELECT flr(12)
-- !query 10 schema
struct<(FLOOR((CAST(12 AS DOUBLE) / CAST(10 AS DOUBLE))) * CAST(10 AS BIGINT)):bigint>
-- !query 10 output
10


-- !query 11
DROP TEMPORARY MACRO flr
-- !query 11 schema
struct<>
-- !query 11 output



-- !query 12
CREATE TEMPORARY MACRO STRING_LEN(x string) length(x)
-- !query 12 schema
struct<>
-- !query 12 output



-- !query 13
CREATE TEMPORARY MACRO STRING_LEN_PLUS_ONE(x string) length(x)+1
-- !query 13 schema
struct<>
-- !query 13 output



-- !query 14
CREATE TEMPORARY MACRO STRING_LEN_PLUS_TWO(x string) length(x)+2
-- !query 14 schema
struct<>
-- !query 14 output



-- !query 15
create table macro_test (x string) using parquet
-- !query 15 schema
struct<>
-- !query 15 output



-- !query 16
insert into table macro_test values ("bb"), ("a"), ("ccc")
-- !query 16 schema
struct<>
-- !query 16 output



-- !query 17
SELECT CONCAT(STRING_LEN(x), ":", STRING_LEN_PLUS_ONE(x), ":", STRING_LEN_PLUS_TWO(x)) a
FROM macro_test
-- !query 17 schema
struct<a:string>
-- !query 17 output
1:2:3
2:3:4
3:4:5


-- !query 18
SELECT CONCAT(STRING_LEN(x), ":", STRING_LEN_PLUS_ONE(x), ":", STRING_LEN_PLUS_TWO(x)) a
FROM
macro_test
sort by a
-- !query 18 schema
struct<a:string>
-- !query 18 output
1:2:3
2:3:4
3:4:5


-- !query 19
drop table macro_test
-- !query 19 schema
struct<>
-- !query 19 output



-- !query 20
CREATE TABLE macro_testing(a int, b int, c int) using parquet
-- !query 20 schema
struct<>
-- !query 20 output



-- !query 21
insert into table macro_testing values (1,2,3)
-- !query 21 schema
struct<>
-- !query 21 output



-- !query 22
insert into table macro_testing values (4,5,6)
-- !query 22 schema
struct<>
-- !query 22 output



-- !query 23
CREATE TEMPORARY MACRO math_square(x int) x*x
-- !query 23 schema
struct<>
-- !query 23 output



-- !query 24
CREATE TEMPORARY MACRO math_add(x int) x+x
-- !query 24 schema
struct<>
-- !query 24 output



-- !query 25
select math_square(a), math_square(b),factorial(a), factorial(b), math_add(a), math_add(b),int(c)
from macro_testing order by int(c)
-- !query 25 schema
struct<(a * a):int,(b * b):int,factorial(a):bigint,factorial(b):bigint,(a + a):int,(b + b):int,c:int>
-- !query 25 output
1	4	1	2	2	4	3
16	25	24	120	8	10	6


-- !query 26
drop table macro_testing
-- !query 26 schema
struct<>
-- !query 26 output



-- !query 27
CREATE TEMPORARY MACRO max(x int, y int) x + y
-- !query 27 schema
struct<>
-- !query 27 output



-- !query 28
SELECT max(1, 2)
-- !query 28 schema
struct<(1 + 2):int>
-- !query 28 output
3


-- !query 29
DROP TEMPORARY MACRO max
-- !query 29 schema
struct<>
-- !query 29 output



-- !query 30
SELECT max(2)
-- !query 30 schema
struct<max(2):int>
-- !query 30 output
2


-- !query 31
CREATE TEMPORARY MACRO c() 3E9
-- !query 31 schema
struct<>
-- !query 31 output



-- !query 32
SELECT floor(c()/10)
-- !query 32 schema
struct<FLOOR((CAST(3E+9 AS DECIMAL(10,0)) / CAST(CAST(10 AS DECIMAL(10,0)) AS DECIMAL(10,0)))):decimal(11,0)>
-- !query 32 output
300000000


-- !query 33
DROP TEMPORARY MACRO c
-- !query 33 schema
struct<>
-- !query 33 output



-- !query 34
CREATE TEMPORARY MACRO fixed_number() 42
-- !query 34 schema
struct<>
-- !query 34 output



-- !query 35
DROP TEMPORARY FUNCTION fixed_number
-- !query 35 schema
struct<>
-- !query 35 output



-- !query 36
DROP TEMPORARY MACRO IF EXISTS fixed_number
-- !query 36 schema
struct<>
-- !query 36 output



-- !query 37
CREATE TEMPORARY MACRO add_bigint_int(x bigint, y int) x + y
-- !query 37 schema
struct<>
-- !query 37 output



-- !query 38
SELECT add_bigint_int(1, 1.5)
-- !query 38 schema
struct<(CAST(1 AS BIGINT) + CAST(1.5 AS BIGINT)):bigint>
-- !query 38 output
2


-- !query 39
DROP TEMPORARY MACRO add_bigint_int
-- !query 39 schema
struct<>
-- !query 39 output



-- !query 40
multiply

CREATE TEMPORARY MACRO simple_add_error(x int) x + y
-- !query 40 schema
struct<>
-- !query 40 output
org.apache.spark.sql.catalyst.parser.ParseException

extraneous input 'multiply' expecting {'(', 'SELECT', 'FROM', 'ADD', 'DESC', 'WITH', 'VALUES', 'CREATE', 'TABLE', 'INSERT', 'DELETE', 'DESCRIBE', 'EXPLAIN', 'SHOW', 'USE', 'DROP', 'ALTER', 'MAP', 'SET', 'RESET', 'START', 'COMMIT', 'ROLLBACK', 'REDUCE', 'REFRESH', 'CLEAR', 'CACHE', 'UNCACHE', 'DFS', 'TRUNCATE', 'ANALYZE', 'LIST', 'REVOKE', 'GRANT', 'LOCK', 'UNLOCK', 'MSCK', 'EXPORT', 'IMPORT', 'LOAD'}(line 1, pos 0)

== SQL ==
multiply
^^^

CREATE TEMPORARY MACRO simple_add_error(x int) x + y


-- !query 41
CREATE TEMPORARY MACRO simple_add_error(x int, x int) x + y
-- !query 41 schema
struct<>
-- !query 41 output
org.apache.spark.sql.AnalysisException
Failed to CREATE TEMPORARY MACRO simple_add_error, because at least one parameter name was used more than once : x,x;


-- !query 42
CREATE TEMPORARY MACRO simple_add_error(x int) x NOT IN (select c2)
-- !query 42 schema
struct<>
-- !query 42 output
org.apache.spark.sql.AnalysisException
Failed to CREATE TEMPORARY MACRO simple_add_error, because of exception: cannot resolve '`c2`' given input columns: []; line 1 pos 64;


-- !query 43
DROP TEMPORARY MACRO SOME_MACRO
-- !query 43 schema
struct<>
-- !query 43 output
org.apache.spark.sql.AnalysisException
Temporary macro 'SOME_MACRO' not found;


-- !query 44
CREATE TEMPORARY MACRO macro_add(x int, y int, z int) x + y
-- !query 44 schema
struct<>
-- !query 44 output
org.apache.spark.sql.AnalysisException
Failed to CREATE TEMPORARY MACRO macro_add, because expected columns Set(0, 1) but found x,y,z;


-- !query 45
CREATE TEMPORARY MACRO macro_add(x int, x int) x + x
-- !query 45 schema
struct<>
-- !query 45 output
org.apache.spark.sql.AnalysisException
Failed to CREATE TEMPORARY MACRO macro_add, because at least one parameter name was used more than once : x,x;


-- !query 46
CREATE TEMPORARY MACRO macro_add(x int, y int) x + y
-- !query 46 schema
struct<>
-- !query 46 output



-- !query 47
SELECT macro_add(1, 2, 3)
-- !query 47 schema
struct<>
-- !query 47 output
org.apache.spark.sql.AnalysisException
Arguments length: 3 != expected number: 2 of arguments for Macro macro_add; line 1 pos 7


-- !query 48
DROP TEMPORARY MACRO macro_add
-- !query 48 schema
struct<>
-- !query 48 output

