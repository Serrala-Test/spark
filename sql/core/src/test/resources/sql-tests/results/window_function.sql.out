-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 6


-- !query 0
SELECT year, quarter, sales,
       first_value(sales) OVER (DISTRIBUTE BY year SORT BY sales ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING),
       last_value(sales) OVER (DISTRIBUTE BY year SORT BY sales DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)
FROM salesdata
-- !query 0 schema
struct<year:int,quarter:string,sales:int,first(sales, false) OVER (PARTITION BY year ORDER BY sales ASC NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING):int,last(sales, false) OVER (PARTITION BY year ORDER BY sales DESC NULLS LAST ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING):int>
-- !query 0 output
2015	1Q	1	1	1
2015	2Q	4	1	1
2015	3Q	2	1	1
2015	4Q	2	1	1
2016	1Q	10	2	2
2016	2Q	7	2	2
2016	3Q	2	2	2
2016	4Q	5	2	2


-- !query 1
SELECT year, quarter, sales,
       first_value(sales) OVER w1 AS fv,
       last_value(sales) OVER w2 AS lv
FROM salesdata
WINDOW w1 AS (DISTRIBUTE BY year SORT BY sales ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING),
       w2 AS (DISTRIBUTE BY year SORT BY sales DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)
-- !query 1 schema
struct<year:int,quarter:string,sales:int,fv:int,lv:int>
-- !query 1 output
2015	1Q	1	1	1
2015	2Q	4	1	1
2015	3Q	2	1	1
2015	4Q	2	1	1
2016	1Q	10	2	2
2016	2Q	7	2	2
2016	3Q	2	2	2
2016	4Q	5	2	2


-- !query 2
SELECT year, quarter, sales,
  row_number() OVER w AS n,
  ntile(2) OVER w AS nt,
  rank() OVER w AS r,
  dense_rank() OVER w AS dr,
  cume_dist() OVER w AS cud,
  percent_rank() OVER w AS pr
FROM salesdata
WINDOW w AS (DISTRIBUTE BY year SORT BY sales)
-- !query 2 schema
struct<year:int,quarter:string,sales:int,n:int,nt:int,r:int,dr:int,cud:double,pr:double>
-- !query 2 output
2015	1Q	1	1	1	1	1	0.25	0.0
2015	2Q	4	4	2	4	3	1.0	1.0
2015	3Q	2	2	1	2	2	0.75	0.3333333333333333
2015	4Q	2	3	2	2	2	0.75	0.3333333333333333
2016	1Q	10	4	2	4	4	1.0	1.0
2016	2Q	7	3	2	3	3	0.75	0.6666666666666666
2016	3Q	2	1	1	1	1	0.25	0.0
2016	4Q	5	2	1	2	2	0.5	0.3333333333333333


-- !query 3
SELECT year, quarter, sales,
  count(sales) OVER w AS ca,
  sum(sales) OVER w AS ca,
  avg(sales) OVER w AS avg,
  stddev(sales) OVER w AS st,
  stddev_pop(sales) OVER w AS st_pop,
  stddev_samp(sales) OVER w AS st_pop,
  variance(sales) OVER w AS var,
  var_pop(sales) OVER w AS var_pop,
  var_samp(sales) OVER w AS var_samp,
  collect_set(sales) OVER w AS uniq_size,
  corr(sales, -sales) OVER w AS cor,
  covar_samp(sales, sales/2) OVER w AS cov_samp,
  covar_pop(sales, sales/2) OVER w AS cov_pop
FROM salesdata
WINDOW w AS (DISTRIBUTE BY year SORT BY sales ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)
-- !query 3 schema
struct<year:int,quarter:string,sales:int,ca:bigint,ca:bigint,avg:double,st:double,st_pop:double,st_pop:double,var:double,var_pop:double,var_samp:double,uniq_size:array<int>,cor:double,cov_samp:double,cov_pop:double>
-- !query 3 output
2015	1Q	1	4	9	2.25	1.2583057392117916	1.0897247358851683	1.2583057392117916	1.583333333333333	1.1874999999999998	1.583333333333333	[1,2,4]	-1.0	0.7916666666666666	0.59375
2015	2Q	4	4	9	2.25	1.2583057392117916	1.0897247358851683	1.2583057392117916	1.583333333333333	1.1874999999999998	1.583333333333333	[1,2,4]	-1.0	0.7916666666666666	0.59375
2015	3Q	2	4	9	2.25	1.2583057392117916	1.0897247358851683	1.2583057392117916	1.583333333333333	1.1874999999999998	1.583333333333333	[1,2,4]	-1.0	0.7916666666666666	0.59375
2015	4Q	2	4	9	2.25	1.2583057392117916	1.0897247358851683	1.2583057392117916	1.583333333333333	1.1874999999999998	1.583333333333333	[1,2,4]	-1.0	0.7916666666666666	0.59375
2016	1Q	10	4	24	6.0	3.366501646120693	2.9154759474226504	3.366501646120693	11.333333333333334	8.5	11.333333333333334	[5,2,10,7]	-1.0	5.666666666666667	4.25
2016	2Q	7	4	24	6.0	3.366501646120693	2.9154759474226504	3.366501646120693	11.333333333333334	8.5	11.333333333333334	[5,2,10,7]	-1.0	5.666666666666667	4.25
2016	3Q	2	4	24	6.0	3.366501646120693	2.9154759474226504	3.366501646120693	11.333333333333334	8.5	11.333333333333334	[5,2,10,7]	-1.0	5.666666666666667	4.25
2016	4Q	5	4	24	6.0	3.366501646120693	2.9154759474226504	3.366501646120693	11.333333333333334	8.5	11.333333333333334	[5,2,10,7]	-1.0	5.666666666666667	4.25


-- !query 4
SELECT year, quarter, sales,
  sum(null) OVER(DISTRIBUTE BY year SORT BY sales) AS sum,
  avg(null) OVER(DISTRIBUTE BY year SORT BY sales) AS avg
FROM salesdata
-- !query 4 schema
struct<year:int,quarter:string,sales:int,sum:bigint,avg:double>
-- !query 4 output
2015	1Q	1	NULL	NULL
2015	2Q	4	NULL	NULL
2015	3Q	2	NULL	NULL
2015	4Q	2	NULL	NULL
2016	1Q	10	NULL	NULL
2016	2Q	7	NULL	NULL
2016	3Q	2	NULL	NULL
2016	4Q	5	NULL	NULL


-- !query 5
SELECT
  FIRST_VALUE(FALSE) OVER () AS c1,
  FIRST_VALUE(FALSE, FALSE) OVER () AS c2,
  FIRST_VALUE(TRUE, TRUE) OVER () AS c3,
  LAST_VALUE(FALSE) OVER () AS c4,
  LAST_VALUE(FALSE, FALSE) OVER () AS c5,
  LAST_VALUE(TRUE, TRUE) OVER () AS c6
-- !query 5 schema
struct<c1:boolean,c2:boolean,c3:boolean,c4:boolean,c5:boolean,c6:boolean>
-- !query 5 output
false	false	true	false	false	true
