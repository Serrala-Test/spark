-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 42


-- !query 0
CREATE TABLE test_having (a int, b int, c string, d string) USING parquet
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
INSERT INTO test_having VALUES (0, 1, 'XXXX', 'A')
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
INSERT INTO test_having VALUES (1, 2, 'AAAA', 'b')
-- !query 2 schema
struct<>
-- !query 2 output



-- !query 3
INSERT INTO test_having VALUES (2, 2, 'AAAA', 'c')
-- !query 3 schema
struct<>
-- !query 3 output



-- !query 4
INSERT INTO test_having VALUES (3, 3, 'BBBB', 'D')
-- !query 4 schema
struct<>
-- !query 4 output



-- !query 5
INSERT INTO test_having VALUES (4, 3, 'BBBB', 'e')
-- !query 5 schema
struct<>
-- !query 5 output



-- !query 6
INSERT INTO test_having VALUES (5, 3, 'bbbb', 'F')
-- !query 6 schema
struct<>
-- !query 6 output



-- !query 7
INSERT INTO test_having VALUES (6, 4, 'cccc', 'g')
-- !query 7 schema
struct<>
-- !query 7 output



-- !query 8
INSERT INTO test_having VALUES (7, 4, 'cccc', 'h')
-- !query 8 schema
struct<>
-- !query 8 output



-- !query 9
INSERT INTO test_having VALUES (8, 4, 'CCCC', 'I')
-- !query 9 schema
struct<>
-- !query 9 output



-- !query 10
INSERT INTO test_having VALUES (9, 4, 'CCCC', 'j')
-- !query 10 schema
struct<>
-- !query 10 output



-- !query 11
SELECT udf(b), udf(c) FROM test_having
	GROUP BY b, c HAVING udf(count(*)) = 1 ORDER BY b, c
-- !query 11 schema
struct<CAST(udf(cast(b as string)) AS INT):int,CAST(udf(cast(c as string)) AS STRING):string>
-- !query 11 output
1	XXXX
3	bbbb


-- !query 12
SELECT udf(b), udf(c) FROM test_having
	GROUP BY b, c HAVING udf(count(*)) = 1 ORDER BY udf(b), c
-- !query 12 schema
struct<CAST(udf(cast(b as string)) AS INT):int,CAST(udf(cast(c as string)) AS STRING):string>
-- !query 12 output
1	XXXX
3	bbbb


-- !query 13
SELECT udf(b), udf(c) FROM test_having
	GROUP BY b, c HAVING udf(count(*)) = 1 ORDER BY udf(b), udf(c)
-- !query 13 schema
struct<CAST(udf(cast(b as string)) AS INT):int,CAST(udf(cast(c as string)) AS STRING):string>
-- !query 13 output
1	XXXX
3	bbbb


-- !query 14
SELECT udf(b), udf(c) FROM test_having
	GROUP BY b, c HAVING udf(b) = 3 ORDER BY b, c
-- !query 14 schema
struct<CAST(udf(cast(b as string)) AS INT):int,CAST(udf(cast(c as string)) AS STRING):string>
-- !query 14 output
3	BBBB
3	bbbb


-- !query 15
SELECT udf(b), udf(c) FROM test_having
	GROUP BY b, c HAVING udf(b) = 3 ORDER BY udf(b), c
-- !query 15 schema
struct<CAST(udf(cast(b as string)) AS INT):int,CAST(udf(cast(c as string)) AS STRING):string>
-- !query 15 output
3	BBBB
3	bbbb


-- !query 16
SELECT udf(b), udf(c) FROM test_having
	GROUP BY b, c HAVING udf(b) = 3 ORDER BY udf(b), udf(c)
-- !query 16 schema
struct<CAST(udf(cast(b as string)) AS INT):int,CAST(udf(cast(c as string)) AS STRING):string>
-- !query 16 output
3	BBBB
3	bbbb


-- !query 17
SELECT udf(c), max(udf(a)) FROM test_having
	GROUP BY c HAVING udf(count(*)) > 2 OR udf(min(a)) = udf(max(a))
	ORDER BY c
-- !query 17 schema
struct<CAST(udf(cast(c as string)) AS STRING):string,max(CAST(udf(cast(a as string)) AS INT)):int>
-- !query 17 output
XXXX	0
bbbb	5


-- !query 18
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(min(a)) = udf(max(a))
-- !query 18 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 18 output



-- !query 19
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(udf(min(a))) = udf(max(a))
-- !query 19 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 19 output



-- !query 20
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(udf(min(a))) = udf(udf(max(a)))
-- !query 20 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 20 output



-- !query 21
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(min(a)) = udf(udf(max(a)))
-- !query 21 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 21 output



-- !query 22
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(min(a)) < udf(max(a))
-- !query 22 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 22 output
0	9


-- !query 23
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(udf(min(a))) < udf(max(a))
-- !query 23 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 23 output
0	9


-- !query 24
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(udf(min(a))) < udf(udf(max(a)))
-- !query 24 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 24 output
0	9


-- !query 25
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(min(a)) < udf(udf(max(a)))
-- !query 25 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 25 output
0	9


-- !query 26
SELECT udf(min(udf(a))), udf(max(udf(a))) FROM test_having HAVING udf(min(udf(a))) = udf(max(udf(a)))
-- !query 26 schema
struct<CAST(udf(cast(min(cast(udf(cast(a as string)) as int)) as string)) AS INT):int,CAST(udf(cast(max(cast(udf(cast(a as string)) as int)) as string)) AS INT):int>
-- !query 26 output



-- !query 27
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(udf(min(udf(a)))) = udf(max(udf(a)))
-- !query 27 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 27 output



-- !query 28
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(udf(min(udf(a)))) = udf(udf(max(udf(a))))
-- !query 28 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 28 output



-- !query 29
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(min(udf(a))) = udf(udf(max(udf(a))))
-- !query 29 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 29 output



-- !query 30
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(min(udf(a))) < udf(max(udf(a)))
-- !query 30 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 30 output
0	9


-- !query 31
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(udf(min(udf(a)))) < udf(max(udf(a)))
-- !query 31 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 31 output
0	9


-- !query 32
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(udf(min(udf(a)))) < udf(udf(max(udf(a))))
-- !query 32 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 32 output
0	9


-- !query 33
SELECT udf(min(a)), udf(max(a)) FROM test_having HAVING udf(min(udf(a))) < udf(udf(max(udf(a))))
-- !query 33 schema
struct<CAST(udf(cast(min(a) as string)) AS INT):int,CAST(udf(cast(max(a) as string)) AS INT):int>
-- !query 33 output
0	9


-- !query 34
SELECT udf(a) FROM test_having HAVING udf(min(a)) < udf(max(a))
-- !query 34 schema
struct<>
-- !query 34 output
org.apache.spark.sql.AnalysisException
grouping expressions sequence is empty, and 'default.test_having.`a`' is not an aggregate function. Wrap '(min(default.test_having.`a`) AS `min(a#x)`, max(default.test_having.`a`) AS `max(a#x)`)' in windowing function(s) or wrap 'default.test_having.`a`' in first() (or first_value) if you don't care which value you get.;


-- !query 35
SELECT 1 AS one FROM test_having HAVING udf(a) > 1
-- !query 35 schema
struct<>
-- !query 35 output
org.apache.spark.sql.AnalysisException
cannot resolve '`a`' given input columns: [one]; line 1 pos 44


-- !query 36
SELECT 1 AS one FROM test_having HAVING udf(1 > 2)
-- !query 36 schema
struct<one:int>
-- !query 36 output



-- !query 37
SELECT 1 AS one FROM test_having HAVING udf(udf(1) > udf(2))
-- !query 37 schema
struct<one:int>
-- !query 37 output



-- !query 38
SELECT 1 AS one FROM test_having HAVING udf(1 < 2)
-- !query 38 schema
struct<one:int>
-- !query 38 output
1


-- !query 39
SELECT 1 AS one FROM test_having HAVING udf(udf(1) < udf(2))
-- !query 39 schema
struct<one:int>
-- !query 39 output
1


-- !query 40
SELECT 1 AS one FROM test_having WHERE 1/udf(a) = 1 HAVING 1 < 2
-- !query 40 schema
struct<one:int>
-- !query 40 output
1


-- !query 41
DROP TABLE test_having
-- !query 41 schema
struct<>
-- !query 41 output

