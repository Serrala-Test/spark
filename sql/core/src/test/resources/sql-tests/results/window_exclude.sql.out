-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 47


-- !query 0
create table table1 (col1 int, col2 int, col3 int) using parquet
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
insert into table1 values(6, 12, 10), (6, 11, 4), (6, 13, 11), 
(6, 9, 10), (6, 15, 8), (6, 10, 1), (6, 15, 8), (6, 7, 4), (6, 7, 8)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between 2 preceding and 2 following exclude current row)
from table1 where col1 = 6 order by col3
-- !query 2 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING EXCLUDE CURRENT ROW):bigint>
-- !query 2 output
6	10	1	18
6	7	4	28
6	11	4	39
6	7	8	48
6	15	8	42
6	15	8	43
6	9	10	55
6	12	10	37
6	13	11	21


-- !query 3
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between 2 preceding and 2 following exclude group) 
from table1 where col1 = 6 order by col3
-- !query 3 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING EXCLUDE GROUP):bigint>
-- !query 3 output
6	10	1	18
6	7	4	28
6	11	4	39
6	7	8	48
6	15	8	27
6	15	8	28
6	9	10	55
6	12	10	37
6	13	11	21


-- !query 4
select col1, col2, col3, sum(col2)
    over (partition by col1 order by col3, col2 rows 
    between 2 preceding and 2 following exclude ties)
from table1 where col1 = 6 order by col3
-- !query 4 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING EXCLUDE TIES):bigint>
-- !query 4 output
6	10	1	28
6	7	4	35
6	11	4	50
6	7	8	55
6	15	8	42
6	15	8	43
6	9	10	64
6	12	10	49
6	13	11	34


-- !query 5
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between 2 preceding and 2 following)
from table1 where col1 = 6 order by col3
-- !query 5 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING EXCLUDE NO OTHERS):bigint>
-- !query 5 output
6	10	1	28
6	7	4	35
6	11	4	50
6	7	8	55
6	15	8	57
6	15	8	58
6	9	10	64
6	12	10	49
6	13	11	34


-- !query 6
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between unbounded preceding and current row exclude current row)
from table1 where col1 = 6 order by col3
-- !query 6 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE CURRENT ROW):bigint>
-- !query 6 output
6	10	1	NULL
6	7	4	10
6	11	4	17
6	7	8	28
6	15	8	35
6	15	8	50
6	9	10	65
6	12	10	74
6	13	11	86


-- !query 7
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between unbounded preceding and current row exclude group)
from table1 where col1 = 6 order by col3
-- !query 7 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE GROUP):bigint>
-- !query 7 output
6	10	1	NULL
6	7	4	10
6	11	4	17
6	7	8	28
6	15	8	35
6	15	8	35
6	9	10	65
6	12	10	74
6	13	11	86


-- !query 8
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between unbounded preceding and current row exclude ties) 
from table1 where col1 = 6 order by col3
-- !query 8 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE TIES):bigint>
-- !query 8 output
6	10	1	10
6	7	4	17
6	11	4	28
6	7	8	35
6	15	8	50
6	15	8	50
6	9	10	74
6	12	10	86
6	13	11	99


-- !query 9
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between unbounded preceding and current row) 
from table1 where col1 = 6 order by col3
-- !query 9 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE NO OTHERS):bigint>
-- !query 9 output
6	10	1	10
6	7	4	17
6	11	4	28
6	7	8	35
6	15	8	50
6	15	8	65
6	9	10	74
6	12	10	86
6	13	11	99


-- !query 10
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between current row and unbounded following exclude current row)
from table1 where col1 = 6 order by col3
-- !query 10 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING EXCLUDE CURRENT ROW):bigint>
-- !query 10 output
6	10	1	89
6	7	4	82
6	11	4	71
6	7	8	64
6	15	8	49
6	15	8	34
6	9	10	25
6	12	10	13
6	13	11	NULL


-- !query 11
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between current row and unbounded following exclude group)
from table1 where col1 = 6 order by col3
-- !query 11 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING EXCLUDE GROUP):bigint>
-- !query 11 output
6	10	1	89
6	7	4	82
6	11	4	71
6	7	8	64
6	15	8	34
6	15	8	34
6	9	10	25
6	12	10	13
6	13	11	NULL


-- !query 12
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between current row and unbounded following exclude ties)
from table1 where col1 = 6 order by col3
-- !query 12 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING EXCLUDE TIES):bigint>
-- !query 12 output
6	10	1	99
6	7	4	89
6	11	4	82
6	7	8	71
6	15	8	49
6	15	8	49
6	9	10	34
6	12	10	25
6	13	11	13


-- !query 13
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between current row and unbounded following) 
from table1 where col1 = 6 order by col3
-- !query 13 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING EXCLUDE NO OTHERS):bigint>
-- !query 13 output
6	10	1	99
6	7	4	89
6	11	4	82
6	7	8	71
6	15	8	64
6	15	8	49
6	9	10	34
6	12	10	25
6	13	11	13


-- !query 14
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between unbounded preceding and unbounded following exclude current row)
from table1 where col1 = 6 order by col3
-- !query 14 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING EXCLUDE CURRENT ROW):bigint>
-- !query 14 output
6	10	1	89
6	7	4	92
6	11	4	88
6	7	8	92
6	15	8	84
6	15	8	84
6	9	10	90
6	12	10	87
6	13	11	86


-- !query 15
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between unbounded preceding and unbounded following exclude group)
from table1 where col1 = 6 order by col3
-- !query 15 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING EXCLUDE GROUP):bigint>
-- !query 15 output
6	10	1	89
6	7	4	92
6	11	4	88
6	7	8	92
6	15	8	69
6	15	8	69
6	9	10	90
6	12	10	87
6	13	11	86


-- !query 16
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between unbounded preceding and  unbounded following exclude ties) 
from table1 where col1 = 6 order by col3
-- !query 16 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING EXCLUDE TIES):bigint>
-- !query 16 output
6	10	1	99
6	7	4	99
6	11	4	99
6	7	8	99
6	15	8	84
6	15	8	84
6	9	10	99
6	12	10	99
6	13	11	99


-- !query 17
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3, col2 rows 
    between unbounded preceding and unbounded following) 
from table1 where col1 = 6 order by col3
-- !query 17 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST, col2 ASC NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING EXCLUDE NO OTHERS):bigint>
-- !query 17 output
6	10	1	99
6	7	4	99
6	11	4	99
6	7	8	99
6	15	8	99
6	15	8	99
6	9	10	99
6	12	10	99
6	13	11	99


-- !query 18
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between 3 preceding and 3 following)
from table1 where col1 = 6 order by col3
-- !query 18 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN 3 PRECEDING AND 3 FOLLOWING EXCLUDE NO OTHERS):bigint>
-- !query 18 output
6	10	1	28
6	7	4	28
6	11	4	28
6	15	8	71
6	15	8	71
6	7	8	71
6	12	10	71
6	9	10	71
6	13	11	71


-- !query 19
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between 3 preceding and 3 following exclude current row)
from table1 where col1 = 6 order by col3
-- !query 19 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN 3 PRECEDING AND 3 FOLLOWING EXCLUDE CURRENT ROW):bigint>
-- !query 19 output
6	10	1	18
6	7	4	21
6	11	4	17
6	15	8	56
6	15	8	56
6	7	8	64
6	12	10	59
6	9	10	62
6	13	11	58


-- !query 20
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between 3 preceding and 3 following exclude group )
from table1 where col1 = 6 order by col3
-- !query 20 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN 3 PRECEDING AND 3 FOLLOWING EXCLUDE GROUP):bigint>
-- !query 20 output
6	10	1	18
6	7	4	10
6	11	4	10
6	15	8	34
6	15	8	34
6	7	8	34
6	12	10	50
6	9	10	50
6	13	11	58


-- !query 21
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between 3 preceding and 3 following exclude ties)
from table1 where col1 = 6 order by col3
-- !query 21 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN 3 PRECEDING AND 3 FOLLOWING EXCLUDE TIES):bigint>
-- !query 21 output
6	10	1	28
6	7	4	17
6	11	4	21
6	15	8	49
6	15	8	49
6	7	8	41
6	12	10	62
6	9	10	59
6	13	11	71


-- !query 22
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between unbounded preceding and current row)
from table1 where col1 = 6 order by col3
-- !query 22 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE NO OTHERS):bigint>
-- !query 22 output
6	10	1	10
6	7	4	28
6	11	4	28
6	15	8	65
6	15	8	65
6	7	8	65
6	12	10	86
6	9	10	86
6	13	11	99


-- !query 23
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between unbounded preceding and current row exclude current row)
from table1 where col1 = 6 order by col3
-- !query 23 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE CURRENT ROW):bigint>
-- !query 23 output
6	10	1	NULL
6	7	4	21
6	11	4	17
6	15	8	50
6	15	8	50
6	7	8	58
6	12	10	74
6	9	10	77
6	13	11	86


-- !query 24
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between unbounded preceding and current row exclude group)
from table1 where col1 = 6 order by col3
-- !query 24 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE GROUP):bigint>
-- !query 24 output
6	10	1	NULL
6	7	4	10
6	11	4	10
6	15	8	28
6	15	8	28
6	7	8	28
6	12	10	65
6	9	10	65
6	13	11	86


-- !query 25
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between unbounded preceding and current row exclude ties) 
from table1 where col1 = 6 order by col3
-- !query 25 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE TIES):bigint>
-- !query 25 output
6	10	1	10
6	7	4	17
6	11	4	21
6	15	8	43
6	15	8	43
6	7	8	35
6	12	10	77
6	9	10	74
6	13	11	99


-- !query 26
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between current row and unbounded following ) 
from table1 where col1 = 6 order by col3
-- !query 26 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING EXCLUDE NO OTHERS):bigint>
-- !query 26 output
6	10	1	99
6	7	4	89
6	11	4	89
6	15	8	71
6	15	8	71
6	7	8	71
6	12	10	34
6	9	10	34
6	13	11	13


-- !query 27
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between current row and unbounded following exclude current row)
from table1 where col1 = 6 order by col3
-- !query 27 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING EXCLUDE CURRENT ROW):bigint>
-- !query 27 output
6	10	1	89
6	7	4	82
6	11	4	78
6	15	8	56
6	15	8	56
6	7	8	64
6	12	10	22
6	9	10	25
6	13	11	NULL


-- !query 28
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between current row and unbounded following exclude group)
from table1 where col1 = 6 order by col3
-- !query 28 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING EXCLUDE GROUP):bigint>
-- !query 28 output
6	10	1	89
6	7	4	71
6	11	4	71
6	15	8	34
6	15	8	34
6	7	8	34
6	12	10	13
6	9	10	13
6	13	11	NULL


-- !query 29
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between current row and unbounded following exclude ties)
from table1 where col1 = 6 order by col3
-- !query 29 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING EXCLUDE TIES):bigint>
-- !query 29 output
6	10	1	99
6	7	4	78
6	11	4	82
6	15	8	49
6	15	8	49
6	7	8	41
6	12	10	25
6	9	10	22
6	13	11	13


-- !query 30
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between unbounded preceding and unbounded following )
from table1 where col1 = 6 order by col3
-- !query 30 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING EXCLUDE NO OTHERS):bigint>
-- !query 30 output
6	10	1	99
6	7	4	99
6	11	4	99
6	15	8	99
6	15	8	99
6	7	8	99
6	12	10	99
6	9	10	99
6	13	11	99


-- !query 31
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between unbounded preceding and unbounded following exclude current row) 
from table1 where col1 = 6 order by col3
-- !query 31 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING EXCLUDE CURRENT ROW):bigint>
-- !query 31 output
6	10	1	89
6	7	4	92
6	11	4	88
6	15	8	84
6	15	8	84
6	7	8	92
6	12	10	87
6	9	10	90
6	13	11	86


-- !query 32
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between unbounded preceding and unbounded following exclude group) 
from table1 where col1 = 6 order by col3
-- !query 32 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING EXCLUDE GROUP):bigint>
-- !query 32 output
6	10	1	89
6	7	4	81
6	11	4	81
6	15	8	62
6	15	8	62
6	7	8	62
6	12	10	78
6	9	10	78
6	13	11	86


-- !query 33
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range 
    between unbounded preceding and unbounded following exclude ties) 
from table1 where col1 = 6 order by col3
-- !query 33 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING EXCLUDE TIES):bigint>
-- !query 33 output
6	10	1	99
6	7	4	88
6	11	4	92
6	15	8	77
6	15	8	77
6	7	8	69
6	12	10	90
6	9	10	87
6	13	11	99


-- !query 34
select col1, col2, col3, sum(col2) 
    over (partition by col1 order by col3 range
    between unbounded preceding and current row exclude current row)
from table1 where col1 = 6 order by col3
-- !query 34 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE CURRENT ROW):bigint>
-- !query 34 output
6	10	1	NULL
6	7	4	21
6	11	4	17
6	15	8	50
6	15	8	50
6	7	8	58
6	12	10	74
6	9	10	77
6	13	11	86


-- !query 35
select col1, col2, col3, AVG(col2) 
    over (partition by col1 order by col3 range 
    between unbounded preceding and current row exclude current row) 
from table1 where col1 = 6 order by col3
-- !query 35 schema
struct<col1:int,col2:int,col3:int,avg(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE CURRENT ROW):double>
-- !query 35 output
6	10	1	NULL
6	7	4	10.5
6	11	4	8.5
6	15	8	10.0
6	15	8	10.0
6	7	8	11.6
6	12	10	10.571428571428571
6	9	10	11.0
6	13	11	10.75


-- !query 36
select col1, col2, col3, MIN(col2) over 
(partition by col1 order by col3 range between unbounded preceding and 
current row exclude group) 
from table1 where col1 = 6 order by col3
-- !query 36 schema
struct<col1:int,col2:int,col3:int,min(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE GROUP):int>
-- !query 36 output
6	10	1	NULL
6	7	4	10
6	11	4	10
6	15	8	7
6	15	8	7
6	7	8	7
6	12	10	7
6	9	10	7
6	13	11	7


-- !query 37
select col1, col2, col3, MAX(col2) over 
(partition by col1 order by col3 range between unbounded preceding and 
current row exclude current row) 
from table1 where col1 = 6 order by col3
-- !query 37 schema
struct<col1:int,col2:int,col3:int,max(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE CURRENT ROW):int>
-- !query 37 output
6	10	1	NULL
6	7	4	11
6	11	4	10
6	15	8	15
6	15	8	15
6	7	8	15
6	12	10	15
6	9	10	15
6	13	11	15


-- !query 38
select col1, col2, col3, MAX(col2) 
    over (partition by col1 order by col3 range 
    between unbounded preceding and current row exclude group) 
from table1 where col1 = 6 order by col3
-- !query 38 schema
struct<col1:int,col2:int,col3:int,max(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE GROUP):int>
-- !query 38 output
6	10	1	NULL
6	7	4	10
6	11	4	10
6	15	8	11
6	15	8	11
6	7	8	11
6	12	10	15
6	9	10	15
6	13	11	15


-- !query 39
select col1, cume_dist()
    over (partition by col1 order by col3 range
    between unbounded preceding and current row exclude current row)
from table1
-- !query 39 schema
struct<>
-- !query 39 output
org.apache.spark.sql.AnalysisException
Window function class org.apache.spark.sql.catalyst.expressions.CumeDist does not support exclude clause;


-- !query 40
select col1, rank()
    over (partition by col1 order by col3 range
    between unbounded preceding and current row exclude current row)
from table1
-- !query 40 schema
struct<>
-- !query 40 output
org.apache.spark.sql.AnalysisException
Window function class org.apache.spark.sql.catalyst.expressions.Rank does not support exclude clause;


-- !query 41
select col1, lead(2)
    over (partition by col1 order by col3 range
    between unbounded preceding and  current row exclude current row)
from table1
-- !query 41 schema
struct<>
-- !query 41 output
org.apache.spark.sql.AnalysisException
Window function class org.apache.spark.sql.catalyst.expressions.Lead does not support exclude clause;


-- !query 42
create table table2 (col1 int, col2 int, col3 int) using parquet
-- !query 42 schema
struct<>
-- !query 42 output



-- !query 43
insert into table2 values (6, 12, 10), (6, 11, 4), (6, 13, 11), (6, 9, 10), (6, 15, 8),
(6, 10, 1), (6, 15, 8), (6, 7, 4), (6, 7, 8), (7, 12, 10), (7, 11, 4),
(7, 13, 11), (7, 9, 10), (7, 15, 8), (7, 10, 1), (7, 15, 8), (7, 7, 4), (7, 7, 8)
-- !query 43 schema
struct<>
-- !query 43 output



-- !query 44
select col1, col2, col3, sum(col2)
    over (partition by col1 order by col3 range
    between unbounded preceding and current row exclude current row )
from table2 where col1 < 20 order by col1
-- !query 44 schema
struct<col1:int,col2:int,col3:int,sum(col2) OVER (PARTITION BY col1 ORDER BY col3 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE CURRENT ROW):bigint>
-- !query 44 output
6	10	1	NULL
6	11	4	17
6	7	4	21
6	15	8	50
6	15	8	50
6	7	8	58
6	12	10	74
6	9	10	77
6	13	11	86
7	10	1	NULL
7	11	4	17
7	7	4	21
7	15	8	50
7	15	8	50
7	7	8	58
7	12	10	74
7	9	10	77
7	13	11	86


-- !query 45
DROP TABLE table1
-- !query 45 schema
struct<>
-- !query 45 output



-- !query 46
DROP TABLE table2
-- !query 46 schema
struct<>
-- !query 46 output

