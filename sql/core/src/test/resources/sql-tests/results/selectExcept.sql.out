-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW tbl_view AS SELECT * FROM VALUES
  (10, "name1"),
  (20, "name2"),
  (30, "name3"),
  (40, "name4"),
  (50, "name5"),
  (70, "name7")
AS tbl_view(id, name)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE ids (id INT) USING CSV
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM tbl_view
-- !query schema
struct<id:int,name:string>
-- !query output
10	name1
20	name2
30	name3
40	name4
50	name5
70	name7


-- !query
SELECT * EXCEPT (id) FROM tbl_view
-- !query schema
struct<name:string>
-- !query output
name1
name2
name3
name4
name5
name7


-- !query
SELECT * EXCEPT (name) FROM tbl_view
-- !query schema
struct<id:int>
-- !query output
10
20
30
40
50
70


-- !query
SELECT * EXCEPT (id, name) FROM tbl_view
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE namesTbl USING CSV AS SELECT * EXCEPT (id) FROM tbl_view
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM namesTbl
-- !query schema
struct<name:string>
-- !query output
name1
name2
name3
name4
name5
name7


-- !query
SELECT * EXCEPT (`a-b-c`) FROM (SELECT 1 a_b_c, 2 `a-b-c`)
-- !query schema
struct<a_b_c:int>
-- !query output
1


-- !query
SELECT tbl_view.* EXCEPT (name) FROM tbl_view
-- !query schema
struct<id:int>
-- !query output
10
20
30
40
50
70


-- !query
INSERT INTO ids
SELECT * EXCEPT (name) FROM tbl_view
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM ids
-- !query schema
struct<id:int>
-- !query output
10
20
30
40
50
70


-- !query
SELECT * EXCEPT (ids.id) FROM ids
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM (SELECT * EXCEPT (name) FROM tbl_view)
-- !query schema
struct<id:int>
-- !query output
10
20
30
40
50
70


-- !query
SELECT * EXCEPT name FROM tbl_view
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'name'",
    "hint" : ""
  }
}


-- !query
SELECT * EXCEPT() name FROM tbl_view
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "')'",
    "hint" : ""
  }
}


-- !query
SELECT * EXCEPT(invalid_column) FROM tbl_view
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`invalid_column`",
    "proposal" : "`id`, `name`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 31,
    "fragment" : "* EXCEPT(invalid_column)"
  } ]
}


-- !query
SELECT * EXCEPT(id, invalid_column) FROM tbl_view
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`invalid_column`",
    "proposal" : "`id`, `name`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 35,
    "fragment" : "* EXCEPT(id, invalid_column)"
  } ]
}


-- !query
SELECT * EXCEPT(id, id) FROM tbl_view
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkException
{
  "errorClass" : "INTERNAL_ERROR",
  "sqlState" : "XX000",
  "messageParameters" : {
    "message" : "Cannot find main error class 'EXCEPT_OVERLAPPING_COLUMNS'"
  }
}
