-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 23


-- !query 0
CREATE DATABASE indb
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
CREATE TABLE t1(t1a String, t1b Short, t1c Int, t1d Long, t1e float, t1f double, t1g DECIMAL, t1h TIMESTAMP, t1i Date)
using parquet
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
CREATE TABLE t2(t2a String, t2b Short, t2c Int, t2d Long, t2e float, t2f double, t2g DECIMAL, t2h TIMESTAMP, t2i Date)
using parquet
-- !query 2 schema
struct<>
-- !query 2 output



-- !query 3
CREATE TABLE t3(t3a String, t3b Short, t3c Int, t3d Long, t3e float, t3f double, t3g DECIMAL, t3h TIMESTAMP, t3i Date)
using parquet
-- !query 3 schema
struct<>
-- !query 3 output



-- !query 4
INSERT INTO t1 VALUES
 ('t1a', 6, 8, 10, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t1b', 8, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t1a', 16, 12, 21, 15, 20, 20.00, timestamp(date("2014-06-04")), date("2014-06-04")),
 ('t1a', 16, 12, 10, 15, 20, 20.00, timestamp(date("2014-07-04")), date("2014-07-04")),
 ('t1c', 8, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-05")),
 ('t1d', null, 16, 22, 17, 25, 26.00, timestamp(date("2014-06-04")), null),
 ('t1d', null, 16, 19, 17, 25, 26.00, timestamp(date("2014-07-04")), null),
 ('t1e', 10, null, 25, 17, 25, 26.00, timestamp(date("2014-08-04")), date("2014-08-04")),
 ('t1e', 10, null, 19, 17, 25, 26.00, timestamp(date("2014-09-04")), date("2014-09-04")),
 ('t1d', 10, null, 12, 17, 25, 26.00, timestamp(date("2015-05-04")), date("2015-05-04")),
 ('t1a', 6, 8, 10, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t1e', 10, null, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-0=4"))
-- !query 4 schema
struct<>
-- !query 4 output



-- !query 5
INSERT INTO t2 VALUES
 ('t2a', 6, 12, 14, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t1b', 10, 12, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t1b', 8, 16, 119, 17, 25, 26.00, timestamp(date("2015-05-04")), date("2015-05-04")),
 ('t1c', 12, 16, 219, 17, 25, 26.00, timestamp(date("2016-05-04")), date("2016-05-04")),
 ('t1b', null, 16, 319, 17, 25, 26.00, timestamp(date("2017-05-04")), null),
 ('t2e', 8, null, 419, 17, 25, 26.00, timestamp(date("2014-06-04")), date("2014-06-04")),
 ('t1f', 19, null, 519, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t1b', 10, 12, 19, 17, 25, 26.00, timestamp(date("2014-06-04")), date("2014-06-04")),
 ('t1b', 8, 16, 19, 17, 25, 26.00, timestamp(date("2014-07-04")), date("2014-07-04")),
 ('t1c', 12, 16, 19, 17, 25, 26.00, timestamp(date("2014-08-04")), date("2014-08-05")),
 ('t1e', 8, null, 19, 17, 25, 26.00, timestamp(date("2014-09-04")), date("2014-09-04")),
 ('t1f', 19, null, 19, 17, 25, 26.00, timestamp(date("2014-10-04")), date("2014-10-04")),
 ('t1b', null, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), null)
-- !query 5 schema
struct<>
-- !query 5 output



-- !query 6
INSERT INTO t3 VALUES
 ('t3a', 6, 12, 110, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t3a', 6, 12, 10, 15, 20, 20.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t1b', 10, 12, 219, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t1b', 10, 12, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t1b', 8, 16, 319, 17, 25, 26.00, timestamp(date("2014-06-04")), date("2014-06-04")),
 ('t1b', 8, 16, 19, 17, 25, 26.00, timestamp(date("2014-07-04")), date("2014-07-04")),
 ('t3c', 17, 16, 519, 17, 25, 26.00, timestamp(date("2014-08-04")), date("2014-08-04")),
 ('t3c', 17, 16, 19, 17, 25, 26.00, timestamp(date("2014-09-04")), date("2014-09-05")),
 ('t1b', null, 16, 419, 17, 25, 26.00, timestamp(date("2014-10-04")), null),
 ('t1b', null, 16, 19, 17, 25, 26.00, timestamp(date("2014-11-04")), null),
 ('t3b', 8, null, 719, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t3b', 8, null, 19, 17, 25, 26.00, timestamp(date("2015-05-04")), date("2015-05-04"))
-- !query 6 schema
struct<>
-- !query 6 output



-- !query 7
select * from t1 where t1a in (select t2a from t2)
-- !query 7 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 7 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-05-04
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-05-05
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1e	10	NULL	19	17.0	25.0	26	2014-09-04 00:00:00	2014-09-04
t1e	10	NULL	25	17.0	25.0	26	2014-08-04 00:00:00	2014-08-04


-- !query 8
select * from t1 where t1b in (select t2b from t2 where t1a = t2a)
-- !query 8 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 8 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-05-04


-- !query 9
select t1a, t1b from t1 where t1c in (select t2b from t2 where t1a != t2a)
-- !query 9 schema
struct<t1a:string,t1b:smallint>
-- !query 9 output
t1a	16
t1a	16
t1a	6
t1a	6


-- !query 10
select t1a, t1b from t1 where t1c in (select t2b from t2 where t1a = t2a or t1b > t2b)
-- !query 10 schema
struct<t1a:string,t1b:smallint>
-- !query 10 output
t1a	16
t1a	16


-- !query 11
select t1a, t1b from t1 where t1c in (select t2b from t2 where t2i in (select t3i from t3 where t2c = t3c))
-- !query 11 schema
struct<t1a:string,t1b:smallint>
-- !query 11 output
t1a	6
t1a	6


-- !query 12
select t1a, t1b from t1 where t1c in (select t2b from t2 where t2a in
                      (select t3a from t3 where t2c = t3c and t2b is not NULL))
-- !query 12 schema
struct<t1a:string,t1b:smallint>
-- !query 12 output
t1a	6
t1a	6


-- !query 13
select distinct(t1a), t1b, t1h from t1 where t1a not in (select t2a from t2)
-- !query 13 schema
struct<t1a:string,t1b:smallint,t1h:timestamp>
-- !query 13 output
t1a	16	2014-06-04 00:00:00
t1a	16	2014-07-04 00:00:00
t1a	6	2014-04-04 00:00:00
t1d	10	2015-05-04 00:00:00
t1d	NULL	2014-06-04 00:00:00
t1d	NULL	2014-07-04 00:00:00


-- !query 14
select t1d, t1h, t1i from t1 where t1d not in (select t2d from t2 where t2h > t1h or t2i > t1i)
-- !query 14 schema
struct<t1d:bigint,t1h:timestamp,t1i:date>
-- !query 14 output
10	2014-04-04 00:00:00	2014-04-04
10	2014-04-04 00:00:00	2014-04-04


-- !query 15
select distinct(t1a), t1b from t1 where t1b not in (select t2b from t2 where t1a < t2a and t2b > 8)
-- !query 15 schema
struct<t1a:string,t1b:smallint>
-- !query 15 output
t1a	16
t1a	6
t1b	8
t1c	8
t1d	10
t1e	10


-- !query 16
select t1a, t1b from t1 where t1c not in (select t2b from t2 where t2a not in
                      (select t3a from t3 where t2c = t3c and t2b is NULL))
-- !query 16 schema
struct<t1a:string,t1b:smallint>
-- !query 16 output
t1a	16
t1a	16
t1a	6
t1a	6
t1b	8
t1c	8
t1d	10
t1d	NULL
t1d	NULL
t1e	10
t1e	10
t1e	10


-- !query 17
select t1a, t1b from t1 where t1h not in (select t2h from t2 where t2a = t1a) and t1b not in (
                      (select min(t3b) from t3 where t3d = t1d))
-- !query 17 schema
struct<t1a:string,t1b:smallint>
-- !query 17 output
t1a	16
t1e	10


-- !query 18
DROP TABLE t1
-- !query 18 schema
struct<>
-- !query 18 output



-- !query 19
DROP TABLE t2
-- !query 19 schema
struct<>
-- !query 19 output



-- !query 20
DROP TABLE t3
-- !query 20 schema
struct<>
-- !query 20 output



-- !query 21
USE default
-- !query 21 schema
struct<>
-- !query 21 output



-- !query 22
DROP DATABASE indb
-- !query 22 schema
struct<>
-- !query 22 output

