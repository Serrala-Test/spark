-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW inner_table(a, b) AS VALUES
    (1, 1),
    (2, 2),
    (3, 3),
    (4, 4),
    (5, 5),
    (8, 8),
    (9, 9)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW outer_table(a, b) AS VALUES
    (1, 1),
    (2, 1),
    (3, 3),
    (6, 6),
    (7, 7),
    (9, 9)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW no_match_table(a, b) AS VALUES
    (1000, 1000)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW join_table(a, b) AS VALUES
    (1, 1),
    (2, 1),
    (3, 3),
    (7, 8),
    (5, 6)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW null_table(a, b) AS SELECT CAST(null AS int), CAST(null as int)
-- !query schema
struct<>
-- !query output



-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	1


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	1


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	NULL


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	46


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(no_match_table.a) AS aggFunctionAlias FROM no_match_table RIGHT OUTER JOIN join_table ON no_match_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT null_table.a FROM null_table INNER JOIN join_table ON null_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	5


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(no_match_table.a) AS aggFunctionAlias FROM no_match_table LEFT OUTER JOIN join_table ON no_match_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(null_table.a) AS aggFunctionAlias FROM null_table GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	32


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(no_match_table.a) AS aggFunctionAlias FROM no_match_table INNER JOIN join_table ON no_match_table.a = join_table.a GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	6
7	7	6
6	6	6
3	3	6
2	1	6
1	1	6


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	2


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT no_match_table.a FROM no_match_table ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	2


-- !query
SELECT null_table.a, null_table.b, (SELECT inner_table.a FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	4


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	1


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	11


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT null_table.a FROM null_table ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	5
7	7	5
6	6	5
3	3	5
2	1	5
1	1	5


-- !query
SELECT outer_table.a, outer_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	1


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	4


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(no_match_table.a) AS aggFunctionAlias FROM no_match_table INNER JOIN join_table ON no_match_table.a = join_table.a GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT no_match_table.a FROM no_match_table INNER JOIN join_table ON no_match_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT null_table.a, null_table.b FROM null_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(null_table.a) AS aggFunctionAlias FROM null_table GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	5
7	7	5
6	6	5
3	3	5
2	1	5
1	1	5


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(null_table.a) AS aggFunctionAlias FROM null_table RIGHT OUTER JOIN join_table ON null_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	4


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	3


-- !query
SELECT outer_table.a, outer_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT null_table.a, null_table.b FROM null_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	1


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	5
7	7	5
6	6	5
3	3	5
2	1	5
1	1	5


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(null_table.a) AS aggFunctionAlias FROM null_table LEFT OUTER JOIN join_table ON null_table.a = join_table.a GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT inner_table.a FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	5


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(no_match_table.a) AS aggFunctionAlias FROM no_match_table GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT inner_table.a FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	28


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT no_match_table.a FROM no_match_table INNER JOIN join_table ON no_match_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	3
7	7	3
6	6	3
3	3	3
2	1	3
1	1	3


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1018
7	7	1018
6	6	1018
3	3	1018
2	1	1018
1	1	1018


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	15


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	5


-- !query
SELECT null_table.a, null_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	3


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	3


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(no_match_table.a) AS aggFunctionAlias FROM no_match_table GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	2
7	7	2
6	6	2
3	3	2
2	1	2
1	1	2


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	11


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	9


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(null_table.a) AS aggFunctionAlias FROM null_table LEFT OUTER JOIN join_table ON null_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(no_match_table.a) AS aggFunctionAlias FROM no_match_table GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(no_match_table.a) AS aggFunctionAlias FROM no_match_table RIGHT OUTER JOIN join_table ON no_match_table.a = join_table.a GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(null_table.a) AS aggFunctionAlias FROM null_table INNER JOIN join_table ON null_table.a = join_table.a GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	28
7	7	28
6	6	28
3	3	28
2	1	28
1	1	28


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	11


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(no_match_table.a) AS aggFunctionAlias FROM no_match_table INNER JOIN join_table ON no_match_table.a = join_table.a GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT null_table.a, null_table.b, (SELECT inner_table.a FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	9


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(no_match_table.a) AS aggFunctionAlias FROM no_match_table INNER JOIN join_table ON no_match_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	32
7	7	32
6	6	32
3	3	32
2	1	32
1	1	32


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT inner_table.a FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	1


-- !query
SELECT null_table.a, null_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	9


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	9


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	11
7	7	11
6	6	11
3	3	11
2	1	11
1	1	11


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(no_match_table.a) AS aggFunctionAlias FROM no_match_table RIGHT OUTER JOIN join_table ON no_match_table.a = join_table.a GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(no_match_table.a) AS aggFunctionAlias FROM no_match_table RIGHT OUTER JOIN join_table ON no_match_table.a = join_table.a GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	7


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT inner_table.a FROM inner_table ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	9


-- !query
SELECT null_table.a, null_table.b, (SELECT inner_table.a FROM inner_table ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	9


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	15


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	1


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT inner_table.a FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	9


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	5


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	2
7	7	2
6	6	2
3	3	2
2	1	2
1	1	2


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(no_match_table.a) AS aggFunctionAlias FROM no_match_table LEFT OUTER JOIN join_table ON no_match_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(no_match_table.a) AS aggFunctionAlias FROM no_match_table) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	5


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT inner_table.a FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(null_table.a) AS aggFunctionAlias FROM null_table INNER JOIN join_table ON null_table.a = join_table.a GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	9


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	7


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	9


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(null_table.a) AS aggFunctionAlias FROM null_table LEFT OUTER JOIN join_table ON null_table.a = join_table.a GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	3


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT null_table.a FROM null_table RIGHT OUTER JOIN join_table ON null_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	15
7	7	15
6	6	15
3	3	15
2	1	15
1	1	15


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT inner_table.a FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT null_table.a FROM null_table INNER JOIN join_table ON null_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	32


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	2
7	7	2
6	6	2
3	3	2
2	1	2
1	1	2


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	10


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	2
7	7	2
6	6	2
3	3	2
2	1	2
1	1	2


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT inner_table.a FROM inner_table ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT inner_table.a FROM inner_table ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	9


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	2


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(null_table.a) AS aggFunctionAlias FROM null_table LEFT OUTER JOIN join_table ON null_table.a = join_table.a GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT inner_table.a FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT inner_table.a FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT inner_table.a FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	5


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	3
7	7	3
6	6	3
3	3	3
2	1	3
1	1	3


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	7


-- !query
SELECT outer_table.a, outer_table.b, (SELECT inner_table.a FROM inner_table ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	7
7	7	7
6	6	7
3	3	7
2	1	7
1	1	7


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(no_match_table.a) AS aggFunctionAlias FROM no_match_table LEFT OUTER JOIN join_table ON no_match_table.a = join_table.a GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	4
7	7	4
6	6	4
3	3	4
2	1	4
1	1	4


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	3


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT inner_table.a FROM inner_table ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT no_match_table.a FROM no_match_table RIGHT OUTER JOIN join_table ON no_match_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(no_match_table.a) AS aggFunctionAlias FROM no_match_table LEFT OUTER JOIN join_table ON no_match_table.a = join_table.a GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	2


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	15


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT no_match_table.a FROM no_match_table RIGHT OUTER JOIN join_table ON no_match_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	5
7	7	5
6	6	5
3	3	5
2	1	5
1	1	5


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	1


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	28


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(null_table.a) AS aggFunctionAlias FROM null_table GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(null_table.a) AS aggFunctionAlias FROM null_table RIGHT OUTER JOIN join_table ON null_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(null_table.a) AS aggFunctionAlias FROM null_table LEFT OUTER JOIN join_table ON null_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT outer_table.a, outer_table.b, (SELECT inner_table.a FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	5
7	7	5
6	6	5
3	3	5
2	1	5
1	1	5


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	46
7	7	46
6	6	46
3	3	46
2	1	46
1	1	46


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	4


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(null_table.a) AS aggFunctionAlias FROM null_table INNER JOIN join_table ON null_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	9


-- !query
SELECT null_table.a, null_table.b, (SELECT inner_table.a FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	5


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	2
7	7	2
6	6	2
3	3	2
2	1	2
1	1	2


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(null_table.a) AS aggFunctionAlias FROM null_table INNER JOIN join_table ON null_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(no_match_table.a) AS aggFunctionAlias FROM no_match_table) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT outer_table.a, outer_table.b, (SELECT null_table.a FROM null_table LEFT OUTER JOIN join_table ON null_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	32


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT null_table.a, null_table.b FROM null_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT inner_table.a FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	7


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	15


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	11
7	7	11
6	6	11
3	3	11
2	1	11
1	1	11


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(null_table.a) AS aggFunctionAlias FROM null_table) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(null_table.a) AS aggFunctionAlias FROM null_table RIGHT OUTER JOIN join_table ON null_table.a = join_table.a GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT no_match_table.a FROM no_match_table LEFT OUTER JOIN join_table ON no_match_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(no_match_table.a) AS aggFunctionAlias FROM no_match_table RIGHT OUTER JOIN join_table ON no_match_table.a = join_table.a GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(no_match_table.a) AS aggFunctionAlias FROM no_match_table INNER JOIN join_table ON no_match_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	1


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	4


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(null_table.a) AS aggFunctionAlias FROM null_table RIGHT OUTER JOIN join_table ON null_table.a = join_table.a GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	1


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT inner_table.a FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
1000	1000	5


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	1


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(no_match_table.a) AS aggFunctionAlias FROM no_match_table GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT inner_table.a FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	32


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT null_table.a, null_table.b FROM null_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(null_table.a) AS aggFunctionAlias FROM null_table GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	3


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	3
7	7	3
6	6	3
3	3	3
2	1	3
1	1	3


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(no_match_table.a) AS aggFunctionAlias FROM no_match_table RIGHT OUTER JOIN join_table ON no_match_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	15
7	7	15
6	6	15
3	3	15
2	1	15
1	1	15


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(no_match_table.a) AS aggFunctionAlias FROM no_match_table LEFT OUTER JOIN join_table ON no_match_table.a = join_table.a GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	7
7	7	7
6	6	7
3	3	7
2	1	7
1	1	7


-- !query
SELECT outer_table.a, outer_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT null_table.a, null_table.b FROM null_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	1


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	1


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	3


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	9


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	46


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	4
7	7	4
6	6	4
3	3	4
2	1	4
1	1	4


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT inner_table.a FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	5
7	7	5
6	6	5
3	3	5
2	1	5
1	1	5


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT null_table.a FROM null_table ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	4


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT DISTINCT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(null_table.a) AS aggFunctionAlias FROM null_table INNER JOIN join_table ON null_table.a = join_table.a GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(null_table.a) AS aggFunctionAlias FROM null_table RIGHT OUTER JOIN join_table ON null_table.a = join_table.a GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT outer_table.a, outer_table.b, (SELECT no_match_table.a FROM no_match_table LEFT OUTER JOIN join_table ON no_match_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(null_table.a) AS aggFunctionAlias FROM null_table RIGHT OUTER JOIN join_table ON null_table.a = join_table.a GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT null_table.a, null_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	9


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	18
7	7	18
6	6	18
3	3	18
2	1	18
1	1	18


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	3
7	7	3
6	6	3
3	3	3
2	1	3
1	1	3


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT null_table.a FROM null_table LEFT OUTER JOIN join_table ON null_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	4
7	7	4
6	6	4
3	3	4
2	1	4
1	1	4


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(null_table.a) AS aggFunctionAlias FROM null_table) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	5


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	10
7	7	10
6	6	10
3	3	10
2	1	10
1	1	10


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	2


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table INNER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	5


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT null_table.a FROM null_table RIGHT OUTER JOIN join_table ON null_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	10


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(no_match_table.a) AS aggFunctionAlias FROM no_match_table INNER JOIN join_table ON no_match_table.a = join_table.a GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT null_table.a, null_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
NULL	NULL	3


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT innerSubqueryAlias.a FROM (SELECT null_table.a, null_table.b FROM null_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT COUNT(inner_table.a) AS aggFunctionAlias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	2
7	7	2
6	6	2
3	3	2
2	1	2
1	1	2


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT null_table.a, null_table.b FROM null_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0


-- !query
SELECT null_table.a, null_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	2


-- !query
SELECT outer_table.a, outer_table.b, (SELECT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table UNION SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	2
7	7	2
6	6	2
3	3	2
2	1	2
1	1	2


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	32
7	7	32
6	6	32
3	3	32
2	1	32
1	1	32


-- !query
SELECT null_table.a, null_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a GROUP BY inner_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM null_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
NULL	NULL	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT COUNT(innerSubqueryAlias.a) AS aggFunctionAlias FROM (SELECT inner_table.a, inner_table.b FROM inner_table INTERSECT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias GROUP BY innerSubqueryAlias.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1
7	7	1
6	6	1
3	3	1
2	1	1
1	1	1


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT inner_table.a FROM inner_table LEFT OUTER JOIN join_table ON inner_table.a = join_table.a ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	9
7	7	9
6	6	9
3	3	9
2	1	9
1	1	9


-- !query
SELECT no_match_table.a, no_match_table.b, (SELECT SUM(inner_table.a) AS aggFunctionAlias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.a = join_table.a) AS subqueryAlias FROM no_match_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
1000	1000	11


-- !query
SELECT outer_table.a, outer_table.b, (SELECT no_match_table.a FROM no_match_table ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(no_match_table.a) AS aggFunctionAlias FROM no_match_table LEFT OUTER JOIN join_table ON no_match_table.a = join_table.a GROUP BY no_match_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000


-- !query
SELECT outer_table.a, outer_table.b, (SELECT SUM(null_table.a) AS aggFunctionAlias FROM null_table LEFT OUTER JOIN join_table ON null_table.a = join_table.a GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT DISTINCT SUM(null_table.a) AS aggFunctionAlias FROM null_table INNER JOIN join_table ON null_table.a = join_table.a GROUP BY null_table.b ORDER BY aggFunctionAlias DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	NULL
7	7	NULL
6	6	NULL
3	3	NULL
2	1	NULL
1	1	NULL


-- !query
SELECT outer_table.a, outer_table.b, (SELECT innerSubqueryAlias.a FROM (SELECT no_match_table.a, no_match_table.b FROM no_match_table EXCEPT SELECT join_table.a, join_table.b FROM join_table) AS innerSubqueryAlias ORDER BY a DESC NULLS FIRST LIMIT 1) AS subqueryAlias FROM outer_table ORDER BY a DESC NULLS FIRST, b DESC NULLS FIRST, subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:int>
-- !query output
9	9	1000
7	7	1000
6	6	1000
3	3	1000
2	1	1000
1	1	1000
