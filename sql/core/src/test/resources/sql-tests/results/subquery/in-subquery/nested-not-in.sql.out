-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 21


-- !query 0
CREATE TEMPORARY VIEW EMP AS SELECT * FROM VALUES
  (100, "emp 1", 10),
  (200, "emp 2", NULL),
  (300, "emp 3", 20),
  (400, "emp 4", 30),
  (500, "emp 5", NULL),
  (600, "emp 6", 100),
  (800, "emp 8", 70)
AS EMP(id, emp_name, dept_id)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
CREATE TEMPORARY VIEW DEPT AS SELECT * FROM VALUES
  (10, "dept 1", "CA"),
  (20, "dept 2", "NY"),
  (30, "dept 3", "TX"),
  (40, "dept 4 - unassigned", "OR"),
  (50, "dept 5 - unassigned", "NJ"),
  (70, "dept 7", "FL")
AS DEPT(dept_id, dept_name, state)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
CREATE TEMPORARY VIEW BONUS AS SELECT * FROM VALUES
  ("emp 1", 10.00D),
  ("emp 1", 20.00D),
  ("emp 2", 300.00D),
  ("emp 2", 100.00D),
  ("emp 3", 300.00D),
  ("emp 4", 100.00D),
  ("emp 5", 1000.00D),
  ("emp 6 - no dept", 500.00D)
AS BONUS(emp_name, bonus_amt)
-- !query 2 schema
struct<>
-- !query 2 output



-- !query 3
CREATE TEMPORARY VIEW ADDRESS AS SELECT * FROM VALUES
  (100, "emp 1", "addr1"),
  (200, null, "addr2"),
  (null, "emp 3", "addr3"),
  (null, null, "addr4"),
  (600, "emp 6", "addr6"),
  (800, "emp 8", "addr8")
AS ADDRESS(id, emp_name, address)
-- !query 3 schema
struct<>
-- !query 3 output



-- !query 4
CREATE TEMPORARY VIEW S1 AS SELECT * FROM VALUES
  (null, null), (5, 5), (8, 8), (11, 11) AS s1(a, b)
-- !query 4 schema
struct<>
-- !query 4 output



-- !query 5
CREATE TEMPORARY VIEW S2 AS SELECT * FROM VALUES
  (7, 7), (8, 8), (11, 11), (null, null) AS s2(c, d)
-- !query 5 schema
struct<>
-- !query 5 output



-- !query 6
SELECT id, 
       dept_id 
FROM   emp 
WHERE  id = 600
       OR id = 500 
       OR dept_id NOT IN (SELECT dept_id 
                          FROM   emp)
-- !query 6 schema
struct<id:int,dept_id:int>
-- !query 6 output
500	NULL
600	100


-- !query 7
SELECT id, 
       dept_id 
FROM   emp 
WHERE  id = 800 
       OR (dept_id IS NOT NULL 
           AND dept_id NOT IN (SELECT dept_id 
                                FROM   emp))
-- !query 7 schema
struct<id:int,dept_id:int>
-- !query 7 output
800	70


-- !query 8
SELECT id,
       dept_id
FROM   emp
WHERE  id = 100
       OR dept_id NOT IN (SELECT dept_id
                           FROM   emp
                           WHERE dept_id IS NOT NULL)
-- !query 8 schema
struct<id:int,dept_id:int>
-- !query 8 output
100	10


-- !query 9
SELECT id, 
       dept_id 
FROM   emp 
WHERE  id = 200 
       OR (dept_id IS NOT NULL        
       AND dept_id + 100 NOT IN (SELECT dept_id 
                           FROM   emp
                           WHERE dept_id IS NOT NULL))
-- !query 9 schema
struct<id:int,dept_id:int>
-- !query 9 output
100	10
200	NULL
300	20
400	30
600	100
800	70


-- !query 10
SELECT id, 
       dept_id, 
       emp_name 
FROM   emp 
WHERE  emp_name IN (SELECT emp_name 
                    FROM   bonus) 
        OR (dept_id IS NOT NULL 
            AND dept_id NOT IN (SELECT dept_id 
                                FROM   dept))
-- !query 10 schema
struct<id:int,dept_id:int,emp_name:string>
-- !query 10 output
100	10	emp 1
200	NULL	emp 2
300	20	emp 3
400	30	emp 4
500	NULL	emp 5
600	100	emp 6


-- !query 11
SELECT id, 
       dept_id, 
       emp_name 
FROM   emp 
WHERE  EXISTS (SELECT emp_name 
               FROM   bonus 
               WHERE  emp.emp_name = bonus.emp_name) 
       OR (dept_id IS NOT NULL 
           AND dept_id NOT IN (SELECT dept_id 
                               FROM   dept))
-- !query 11 schema
struct<id:int,dept_id:int,emp_name:string>
-- !query 11 output
100	10	emp 1
200	NULL	emp 2
300	20	emp 3
400	30	emp 4
500	NULL	emp 5
600	100	emp 6


-- !query 12
SELECT id,
       dept_id,
       emp_name
FROM   emp
WHERE  dept_id = 10
OR (id, emp_name) NOT IN (SELECT id, emp_name FROM address)
-- !query 12 schema
struct<id:int,dept_id:int,emp_name:string>
-- !query 12 output
100	10	emp 1


-- !query 13
SELECT id, 
       dept_id, 
       emp_name 
FROM   emp 
WHERE  dept_id = 10 
        OR (( id, emp_name ) NOT IN (SELECT id, 
                                             emp_name 
                                      FROM   address 
                                      WHERE  id IS NOT NULL 
                                             AND emp_name IS NOT NULL) 
             AND id > 400 )
-- !query 13 schema
struct<id:int,dept_id:int,emp_name:string>
-- !query 13 output
100	10	emp 1
500	NULL	emp 5


-- !query 14
SELECT id, 
       dept_id, 
       emp_name 
FROM   emp 
WHERE  dept_id = 10 
       OR emp_name NOT IN (SELECT emp_name 
                                  FROM   address 
                                  WHERE  id IS NOT NULL 
                                  AND emp_name IS NOT NULL
                                  AND emp.id = address.id)
-- !query 14 schema
struct<id:int,dept_id:int,emp_name:string>
-- !query 14 output
100	10	emp 1
200	NULL	emp 2
300	20	emp 3
400	30	emp 4
500	NULL	emp 5


-- !query 15
SELECT id, 
       dept_id, 
       emp_name 
FROM   emp 
WHERE  id NOT IN (SELECT id 
                         FROM   address 
                         WHERE  id IS NOT NULL 
                         AND emp_name IS NOT NULL
                         AND id >= 400)
       OR emp_name NOT IN (SELECT emp_name 
                                  FROM   address 
                                  WHERE  id IS NOT NULL 
                                  AND emp_name IS NOT NULL
                                  AND emp.id = address.id
                                  AND id < 400)
-- !query 15 schema
struct<id:int,dept_id:int,emp_name:string>
-- !query 15 output
100	10	emp 1
200	NULL	emp 2
300	20	emp 3
400	30	emp 4
500	NULL	emp 5
600	100	emp 6
800	70	emp 8


-- !query 16
SELECT * 
FROM   s1 
WHERE  NOT (a NOT IN (SELECT c 
                      FROM   s2))
-- !query 16 schema
struct<a:int,b:int>
-- !query 16 output
11	11
8	8


-- !query 17
SELECT * 
FROM   s1 
WHERE  NOT (a > 5 
            OR a IN (SELECT c 
                     FROM   s2))
-- !query 17 schema
struct<a:int,b:int>
-- !query 17 output



-- !query 18
SELECT * 
FROM   s1 
WHERE  NOT (a > 5 
            OR a NOT IN (SELECT c 
                         FROM   s2))
-- !query 18 schema
struct<a:int,b:int>
-- !query 18 output



-- !query 19
SELECT * 
FROM   s1 
WHERE  NOT (a > 5 
            AND a IN (SELECT c 
                      FROM   s2))
-- !query 19 schema
struct<a:int,b:int>
-- !query 19 output
5	5


-- !query 20
SELECT * 
FROM   s1 
WHERE  NOT (a > 5 
            AND a NOT IN (SELECT c 
                          FROM   s2))
-- !query 20 schema
struct<a:int,b:int>
-- !query 20 output
11	11
5	5
8	8
