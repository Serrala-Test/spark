-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW inner_view(a, b) AS VALUES
    (1, 1),
    (2, 2),
    (3, 3),
    (4, 4),
    (5, 5),
    (8, 8),
    (9, 9)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW outer_view(a, b) AS VALUES
    (1, 1),
    (2, 1),
    (3, 3),
    (6, 6),
    (7, 7),
    (9, 9)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW no_match_view(a, b) AS VALUES
    (1000, 1000)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW join_view(a, b) AS VALUES
    (1, 1),
    (2, 1),
    (3, 3),
    (7, 8),
    (5, 6)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW null_view(a, b) AS SELECT CAST(null AS int), CAST(null as int)
-- !query schema
struct<>
-- !query output



-- !query
SELECT
  (
    SELECT
      COUNT(null_view.a) AS aggFunctionAlias
    FROM
      null_view
    WHERE
      null_view.a = no_match_view.a
  )
FROM
  no_match_view
-- !query schema
struct<scalarsubquery(a):bigint>
-- !query output
0


-- !query
SELECT
  outer_view.a,
  outer_view.b,
  (
    SELECT
      COUNT(innerSubqueryAlias.a) AS aggFunctionAlias
    FROM
      (
        SELECT
          null_view.a,
          null_view.b
        FROM
          null_view
        INTERSECT
        SELECT
          join_view.a,
          join_view.b
        FROM
          join_view
      ) AS innerSubqueryAlias
    WHERE
      innerSubqueryAlias.a = outer_view.a
  ) AS subqueryAlias
FROM
  outer_view
ORDER BY
  a DESC NULLS FIRST,
  b DESC NULLS FIRST,
  subqueryAlias DESC NULLS FIRST
-- !query schema
struct<a:int,b:int,subqueryAlias:bigint>
-- !query output
9	9	0
7	7	0
6	6	0
3	3	0
2	1	0
1	1	0
