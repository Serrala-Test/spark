-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 30


-- !query 0
CREATE DATABASE indb
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
CREATE TABLE t1(t1a String, t1b Short, t1c Int, t1d Long, t1e float, t1f double, t1g DECIMAL, t1h TIMESTAMP, t1i Date)
using parquet
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
CREATE TABLE t2(t2a String, t2b Short, t2c Int, t2d Long, t2e float, t2f double, t2g DECIMAL, t2h TIMESTAMP, t2i Date)
using parquet
-- !query 2 schema
struct<>
-- !query 2 output



-- !query 3
CREATE TABLE t3(t3a String, t3b Short, t3c Int, t3d Long, t3e float, t3f double, t3g DECIMAL, t3h TIMESTAMP, t3i Date)
using parquet
-- !query 3 schema
struct<>
-- !query 3 output



-- !query 4
INSERT INTO t1 VALUES
 ('t1a', 6, 8, 10, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t1b', 8, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t1a', 16, 12, 21, 15, 20, 20.00, timestamp(date("2014-06-04")), date("2014-06-04")),
 ('t1a', 16, 12, 10, 15, 20, 20.00, timestamp(date("2014-07-04")), date("2014-07-04")),
 ('t1c', 8, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-05")),
 ('t1d', null, 16, 22, 17, 25, 26.00, timestamp(date("2014-06-04")), null),
 ('t1d', null, 16, 19, 17, 25, 26.00, timestamp(date("2014-07-04")), null),
 ('t1e', 10, null, 25, 17, 25, 26.00, timestamp(date("2014-08-04")), date("2014-08-04")),
 ('t1e', 10, null, 19, 17, 25, 26.00, timestamp(date("2014-09-04")), date("2014-09-04")),
 ('t1d', 10, null, 12, 17, 25, 26.00, timestamp(date("2015-05-04")), date("2015-05-04")),
 ('t1a', 6, 8, 10, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t1e', 10, null, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-0=4"))
-- !query 4 schema
struct<>
-- !query 4 output



-- !query 5
INSERT INTO t2 VALUES
 ('t2a', 6, 12, 14, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t1b', 10, 12, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t1b', 8, 16, 119, 17, 25, 26.00, timestamp(date("2015-05-04")), date("2015-05-04")),
 ('t1c', 12, 16, 219, 17, 25, 26.00, timestamp(date("2016-05-04")), date("2016-05-04")),
 ('t1b', null, 16, 319, 17, 25, 26.00, timestamp(date("2017-05-04")), null),
 ('t2e', 8, null, 419, 17, 25, 26.00, timestamp(date("2014-06-04")), date("2014-06-04")),
 ('t1f', 19, null, 519, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t1b', 10, 12, 19, 17, 25, 26.00, timestamp(date("2014-06-04")), date("2014-06-04")),
 ('t1b', 8, 16, 19, 17, 25, 26.00, timestamp(date("2014-07-04")), date("2014-07-04")),
 ('t1c', 12, 16, 19, 17, 25, 26.00, timestamp(date("2014-08-04")), date("2014-08-05")),
 ('t1e', 8, null, 19, 17, 25, 26.00, timestamp(date("2014-09-04")), date("2014-09-04")),
 ('t1f', 19, null, 19, 17, 25, 26.00, timestamp(date("2014-10-04")), date("2014-10-04")),
 ('t1b', null, 16, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), null)
-- !query 5 schema
struct<>
-- !query 5 output



-- !query 6
INSERT INTO t3 VALUES
 ('t3a', 6, 12, 110, 15, 20, 20.00, timestamp(date("2014-04-04")), date("2014-04-04")),
 ('t3a', 6, 12, 10, 15, 20, 20.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t1b', 10, 12, 219, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t1b', 10, 12, 19, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t1b', 8, 16, 319, 17, 25, 26.00, timestamp(date("2014-06-04")), date("2014-06-04")),
 ('t1b', 8, 16, 19, 17, 25, 26.00, timestamp(date("2014-07-04")), date("2014-07-04")),
 ('t3c', 17, 16, 519, 17, 25, 26.00, timestamp(date("2014-08-04")), date("2014-08-04")),
 ('t3c', 17, 16, 19, 17, 25, 26.00, timestamp(date("2014-09-04")), date("2014-09-05")),
 ('t1b', null, 16, 419, 17, 25, 26.00, timestamp(date("2014-10-04")), null),
 ('t1b', null, 16, 19, 17, 25, 26.00, timestamp(date("2014-11-04")), null),
 ('t3b', 8, null, 719, 17, 25, 26.00, timestamp(date("2014-05-04")), date("2014-05-04")),
 ('t3b', 8, null, 19, 17, 25, 26.00, timestamp(date("2015-05-04")), date("2015-05-04"))
-- !query 6 schema
struct<>
-- !query 6 output



-- !query 7
select t1a, avg(t1b) from t1 where t1a in (select t2a from t2) group by t1a
-- !query 7 schema
struct<t1a:string,avg(t1b):double>
-- !query 7 output
t1b	8.0
t1c	8.0
t1e	10.0


-- !query 8
select t1a, max(t1b) from t1 where t1b in (select t2b from t2 where t1a = t2a) group by t1a, t1d
-- !query 8 schema
struct<t1a:string,max(t1b):smallint>
-- !query 8 output
t1b	8


-- !query 9
select t1a, t1b from t1 where t1c in (select t2c from t2 where t1a = t2a) group by t1a, t1b
-- !query 9 schema
struct<t1a:string,t1b:smallint>
-- !query 9 output
t1b	8
t1c	8


-- !query 10
select t1a, sum(distinct(t1b)) from t1 where t1c in (select t2c from t2 where t1a = t2a) or
t1c in (select t3c from t3 where t1a = t3a) group by t1a, t1c
-- !query 10 schema
struct<t1a:string,sum(DISTINCT t1b):bigint>
-- !query 10 output
t1b	8
t1c	8


-- !query 11
select t1a, sum(distinct(t1b)) from t1 where t1c in (select t2c from t2 where t1a = t2a) and
t1c in (select t3c from t3 where t1a = t3a) group by t1a, t1c
-- !query 11 schema
struct<t1a:string,sum(DISTINCT t1b):bigint>
-- !query 11 output
t1b	8


-- !query 12
select t1a, count(distinct(t1b)) from t1 where t1c in (select t2c from t2 where t1a = t2a)
group by t1a, t1c having t1a = "t1b"
-- !query 12 schema
struct<t1a:string,count(DISTINCT t1b):bigint>
-- !query 12 output
t1b	1


-- !query 13
select * from t1 where t1b in (select max(t2b) from t2 group by t2a)
-- !query 13 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 13 output
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1a	6	8	10	15.0	20.0	20	2014-04-04 00:00:00	2014-04-04
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-05-04
t1c	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-05-05
t1d	10	NULL	12	17.0	25.0	26	2015-05-04 00:00:00	2015-05-04
t1e	10	NULL	19	17.0	25.0	26	2014-05-04 00:00:00	NULL
t1e	10	NULL	19	17.0	25.0	26	2014-09-04 00:00:00	2014-09-04
t1e	10	NULL	25	17.0	25.0	26	2014-08-04 00:00:00	2014-08-04


-- !query 14
select * from (select t2a, t2b from t2 where t2a in (select t1a from t1 where t1b = t2b) group by t2a, t2b) t2
-- !query 14 schema
struct<t2a:string,t2b:smallint>
-- !query 14 output
t1b	8


-- !query 15
select count(distinct(*)) from t1 where t1b in (select min(t2b) from t2 where t1a = t2a and t1c = t2c group by t2a)
-- !query 15 schema
struct<count(DISTINCT t1a, t1b, t1c, t1d, t1e, t1f, t1g, t1h, t1i):bigint>
-- !query 15 output
1


-- !query 16
select t1a, t1b from t1 where t1c in (select max(t2c) from t2 where t1a = t2a group by t2a, t2c having t2c > 8)
-- !query 16 schema
struct<t1a:string,t1b:smallint>
-- !query 16 output
t1b	8
t1c	8


-- !query 17
select t1a, t1b from t1 where t1c in (select t2c from t2 where t2a in
( select min(t3a) from t3 where t3a = t2a group by t3b) group by t2c)
-- !query 17 schema
struct<t1a:string,t1b:smallint>
-- !query 17 output
t1a	16
t1a	16
t1b	8
t1c	8
t1d	NULL
t1d	NULL


-- !query 18
select * from t1 where t1a in
(select min(t2a) from t2 where t2a = t2a and t2c >= 1 group by t2c having t2c in
(select t3c from t3 group by t3c, t3b having t2b > 6 and t3b > t2b ))
-- !query 18 schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(10,0),t1h:timestamp,t1i:date>
-- !query 18 output
t1b	8	16	19	17.0	25.0	26	2014-05-04 00:00:00	2014-05-04


-- !query 19
select * from (select * from t2 where t2a in (select t1a from t1 where t1b = t2b)) t2 where t2a in
(select t2a from t2 where t2a = t2a and t2c > 1 group by t2a having t2c > 8)
-- !query 19 schema
struct<t2a:string,t2b:smallint,t2c:int,t2d:bigint,t2e:float,t2f:double,t2g:decimal(10,0),t2h:timestamp,t2i:date>
-- !query 19 output
t1b	8	16	119	17.0	25.0	26	2015-05-04 00:00:00	2015-05-04
t1b	8	16	19	17.0	25.0	26	2014-07-04 00:00:00	2014-07-04


-- !query 20
select t1a, min(t1b) from t1 where t1c in (select min(t2c) from t2 where t2b = t1b group by t2a) group by t1a
-- !query 20 schema
struct<t1a:string,min(t1b):smallint>
-- !query 20 output
t1b	8
t1c	8


-- !query 21
select t1a, min(t1b) from t1 where t1c in (select min(t2c) from t2 where t2b in (select min(t3b) from t3
where t2a = t3a group by t3a) group by t2c) group by t1a, t1d
-- !query 21 schema
struct<t1a:string,min(t1b):smallint>
-- !query 21 output
t1b	8
t1c	8
t1d	NULL
t1d	NULL


-- !query 22
select t1a, min(t1b) from t1 where t1c in (select min(t2c) from t2 where t2b = t1b group by t2a) and
t1d in (select t3d from t3 where t1c = t3c group by t3d) group by t1a
-- !query 22 schema
struct<t1a:string,min(t1b):smallint>
-- !query 22 output
t1b	8
t1c	8


-- !query 23
select t1a, min(t1b) from t1 where t1c in (select min(t2c) from t2 where t2b = t1b group by t2a) or
t1d in (select t3d from t3 where t1c = t3c group by t3d) group by t1a
-- !query 23 schema
struct<t1a:string,min(t1b):smallint>
-- !query 23 output
t1a	16
t1b	8
t1c	8
t1d	NULL


-- !query 24
select t1a, min(t1b) from t1 where t1c in (select min(t2c) from t2 where t2b = t1b group by t2a having t2a > t1a) or
t1d in (select t3d from t3 where t1c = t3c group by t3d having t3d = t1d) group by t1a having min(t1b) is NOT NULL
-- !query 24 schema
struct<t1a:string,min(t1b):smallint>
-- !query 24 output
t1a	16
t1b	8
t1c	8


-- !query 25
DROP TABLE t1
-- !query 25 schema
struct<>
-- !query 25 output



-- !query 26
DROP TABLE t2
-- !query 26 schema
struct<>
-- !query 26 output



-- !query 27
DROP TABLE t3
-- !query 27 schema
struct<>
-- !query 27 output



-- !query 28
USE default
-- !query 28 schema
struct<>
-- !query 28 output



-- !query 29
DROP DATABASE indb
-- !query 29 schema
struct<>
-- !query 29 output

