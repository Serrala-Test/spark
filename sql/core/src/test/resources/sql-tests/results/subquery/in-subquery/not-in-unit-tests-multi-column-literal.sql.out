-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 11


-- !query 0
CREATE TEMPORARY VIEW m AS SELECT * FROM VALUES
  (null, null),
  (null, 1.0),
  (2, 3.0),
  (4, 5.0)
  AS m(a, b)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
-- Case 2
  -- (subquery contains a row with null in all columns -> row not returned)
SELECT *
FROM   m
WHERE  (a, b) NOT IN ((CAST (null AS INT), CAST (null AS DECIMAL(2, 1))))
-- !query 1 schema
struct<a:int,b:decimal(2,1)>
-- !query 1 output



-- !query 2
-- Case 3
  -- (probe-side columns are all null -> row not returned)
SELECT *
FROM   m
WHERE  a IS NULL AND b IS NULL -- Matches only (null, null)
       AND (a, b) NOT IN ((0, 1.0), (2, 3.0), (4, CAST(null AS DECIMAL(2, 1))))
-- !query 2 schema
struct<a:int,b:decimal(2,1)>
-- !query 2 output



-- !query 3
-- Case 4
  -- (one column null, other column matches a row in the subquery result -> row not returned)
SELECT *
FROM   m
WHERE  b = 1.0 -- Matches (null, 1.0)
       AND (a, b) NOT IN ((0, 1.0), (2, 3.0), (4, CAST(null AS DECIMAL(2, 1))))
-- !query 3 schema
struct<a:int,b:decimal(2,1)>
-- !query 3 output



-- !query 4
-- Case 5
  -- (one null column with no match -> row is returned)
SELECT *
FROM   m
WHERE  b = 1.0 -- Matches (null, 1.0)
       AND (a, b) NOT IN ((2, 3.0))
-- !query 4 schema
struct<a:int,b:decimal(2,1)>
-- !query 4 output



-- !query 5
-- Case 6
  -- (no null columns with match -> row not returned)
SELECT *
FROM   m
WHERE  b = 3.0 -- Matches (2, 3.0)
       AND (a, b) NOT IN ((2, 3.0))
-- !query 5 schema
struct<a:int,b:decimal(2,1)>
-- !query 5 output



-- !query 6
-- Case 7
  -- (no null columns with no match -> row is returned)
SELECT *
FROM   m
WHERE  b = 5.0 -- Matches (4, 5.0)
       AND (a, b) NOT IN ((2, 3.0))
-- !query 6 schema
struct<a:int,b:decimal(2,1)>
-- !query 6 output
4	5


-- !query 7
set spark.sql.legacy.inOperator.falseForNullField=true
-- !query 7 schema
struct<key:string,value:string>
-- !query 7 output
spark.sql.legacy.inOperator.falseForNullField	true


-- !query 8
-- Case 2 (old behavior)
  -- (subquery contains a row with null in all columns -> rows returned)
SELECT *
FROM   m
WHERE  (a, b) NOT IN ((CAST (null AS INT), CAST (null AS DECIMAL(2, 1))))
-- !query 8 schema
struct<a:int,b:decimal(2,1)>
-- !query 8 output
2	3
4	5
NULL	1


-- !query 9
-- Case 3 (old behavior)
  -- (probe-side columns are all null -> row returned)
SELECT *
FROM   m
WHERE  a IS NULL AND b IS NULL -- Matches only (null, null)
       AND (a, b) NOT IN ((0, 1.0), (2, 3.0), (4, CAST(null AS DECIMAL(2, 1))))
-- !query 9 schema
struct<a:int,b:decimal(2,1)>
-- !query 9 output
NULL	NULL


-- !query 10
-- Case 4 (old behavior)
  -- (one column null, other column matches a row in the subquery result -> row returned)
SELECT *
FROM   m
WHERE  b = 1.0 -- Matches (null, 1.0)
       AND (a, b) NOT IN ((0, 1.0), (2, 3.0), (4, CAST(null AS DECIMAL(2, 1))))
-- !query 10 schema
struct<a:int,b:decimal(2,1)>
-- !query 10 output
NULL	1
