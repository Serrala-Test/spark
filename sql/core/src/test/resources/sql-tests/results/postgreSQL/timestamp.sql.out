-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 41


-- !query
CREATE TABLE TIMESTAMP_TBL (d1 timestamp) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TIMESTAMP_TBL VALUES (timestamp'now')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TIMESTAMP_TBL VALUES (timestamp'now')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TIMESTAMP_TBL VALUES (timestamp'today')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TIMESTAMP_TBL VALUES (timestamp'yesterday')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TIMESTAMP_TBL VALUES (timestamp'tomorrow')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TIMESTAMP_TBL VALUES (timestamp'tomorrow EST')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TIMESTAMP_TBL VALUES (timestamp'tomorrow Zulu')
-- !query schema
struct<>
-- !query output



-- !query
SELECT count(*) AS One FROM TIMESTAMP_TBL WHERE d1 = timestamp 'today'
-- !query schema
struct<One:bigint>
-- !query output
1


-- !query
SELECT count(*) AS Three FROM TIMESTAMP_TBL WHERE d1 = timestamp 'tomorrow'
-- !query schema
struct<Three:bigint>
-- !query output
3


-- !query
SELECT count(*) AS One FROM TIMESTAMP_TBL WHERE d1 = timestamp 'yesterday'
-- !query schema
struct<One:bigint>
-- !query output
1


-- !query
TRUNCATE TABLE TIMESTAMP_TBL
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TIMESTAMP_TBL VALUES (timestamp'epoch')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TIMESTAMP_TBL VALUES (timestamp('1997-01-02'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TIMESTAMP_TBL VALUES (timestamp('1997-01-02 03:04:05'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TIMESTAMP_TBL VALUES (timestamp('1997-02-10 17:32:01-08'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TIMESTAMP_TBL VALUES (timestamp('2001-09-22T18:19:20'))
-- !query schema
struct<>
-- !query output



-- !query
SELECT '' AS `64`, d1 FROM TIMESTAMP_TBL
-- !query schema
struct<64:string,d1:timestamp>
-- !query output
	1969-12-31 16:00:00
	1997-01-02 00:00:00
	1997-01-02 03:04:05
	1997-02-10 17:32:01
	2001-09-22 18:19:20


-- !query
SELECT '' AS `48`, d1 FROM TIMESTAMP_TBL
   WHERE d1 > timestamp '1997-01-02'
-- !query schema
struct<48:string,d1:timestamp>
-- !query output
	1997-01-02 03:04:05
	1997-02-10 17:32:01
	2001-09-22 18:19:20


-- !query
SELECT '' AS `15`, d1 FROM TIMESTAMP_TBL
   WHERE d1 < timestamp '1997-01-02'
-- !query schema
struct<15:string,d1:timestamp>
-- !query output
	1969-12-31 16:00:00


-- !query
SELECT '' AS one, d1 FROM TIMESTAMP_TBL
   WHERE d1 = timestamp '1997-01-02'
-- !query schema
struct<one:string,d1:timestamp>
-- !query output
	1997-01-02 00:00:00


-- !query
SELECT '' AS `63`, d1 FROM TIMESTAMP_TBL
   WHERE d1 != timestamp '1997-01-02'
-- !query schema
struct<63:string,d1:timestamp>
-- !query output
	1969-12-31 16:00:00
	1997-01-02 03:04:05
	1997-02-10 17:32:01
	2001-09-22 18:19:20


-- !query
SELECT '' AS `16`, d1 FROM TIMESTAMP_TBL
   WHERE d1 <= timestamp '1997-01-02'
-- !query schema
struct<16:string,d1:timestamp>
-- !query output
	1969-12-31 16:00:00
	1997-01-02 00:00:00


-- !query
SELECT '' AS `49`, d1 FROM TIMESTAMP_TBL
   WHERE d1 >= timestamp '1997-01-02'
-- !query schema
struct<49:string,d1:timestamp>
-- !query output
	1997-01-02 00:00:00
	1997-01-02 03:04:05
	1997-02-10 17:32:01
	2001-09-22 18:19:20


-- !query
SELECT '' AS `54`, d1 - timestamp '1997-01-02' AS diff
   FROM TIMESTAMP_TBL WHERE d1 BETWEEN '1902-01-01' AND '2038-01-01'
-- !query schema
struct<54:string,diff:interval>
-- !query output
	-236720 hours
	0 seconds
	3 hours 4 minutes 5 seconds
	41393 hours 19 minutes 20 seconds
	953 hours 32 minutes 1 seconds


-- !query
SELECT '' AS date_trunc_week, date_trunc( 'week', timestamp '2004-02-29 15:44:17.71393' ) AS week_trunc
-- !query schema
struct<date_trunc_week:string,week_trunc:timestamp>
-- !query output
	2004-02-23 00:00:00


-- !query
SELECT '' AS `54`, d1 - timestamp '1997-01-02' AS diff
  FROM TIMESTAMP_TBL
  WHERE d1 BETWEEN timestamp '1902-01-01'
   AND timestamp '2038-01-01'
-- !query schema
struct<54:string,diff:interval>
-- !query output
	-236720 hours
	0 seconds
	3 hours 4 minutes 5 seconds
	41393 hours 19 minutes 20 seconds
	953 hours 32 minutes 1 seconds


-- !query
SELECT '' AS `54`, d1 as `timestamp`,
    date_part( 'year', d1) AS `year`, date_part( 'month', d1) AS `month`,
    date_part( 'day', d1) AS `day`, date_part( 'hour', d1) AS `hour`,
    date_part( 'minute', d1) AS `minute`, date_part( 'second', d1) AS `second`
    FROM TIMESTAMP_TBL WHERE d1 BETWEEN '1902-01-01' AND '2038-01-01'
-- !query schema
struct<54:string,timestamp:timestamp,year:int,month:int,day:int,hour:int,minute:int,second:decimal(8,6)>
-- !query output
	1969-12-31 16:00:00	1969	12	31	16	0	0.000000
	1997-01-02 00:00:00	1997	1	2	0	0	0.000000
	1997-01-02 03:04:05	1997	1	2	3	4	5.000000
	1997-02-10 17:32:01	1997	2	10	17	32	1.000000
	2001-09-22 18:19:20	2001	9	22	18	19	20.000000


-- !query
SELECT '' AS to_char_1, to_char(d1, 'DAY Day day DY Dy dy MONTH Month month RM MON Mon mon')
FROM TIMESTAMP_TBL
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
cannot resolve 'to_char(spark_catalog.default.timestamp_tbl.d1, 'DAY Day day DY Dy dy MONTH Month month RM MON Mon mon')' due to data type mismatch: argument 1 requires decimal type, however, 'spark_catalog.default.timestamp_tbl.d1' is of timestamp type.; line 1 pos 24


-- !query
SELECT '' AS to_char_2, to_char(d1, 'FMDAY FMDay FMday FMMONTH FMMonth FMmonth FMRM')
FROM TIMESTAMP_TBL
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
cannot resolve 'to_char(spark_catalog.default.timestamp_tbl.d1, 'FMDAY FMDay FMday FMMONTH FMMonth FMmonth FMRM')' due to data type mismatch: argument 1 requires decimal type, however, 'spark_catalog.default.timestamp_tbl.d1' is of timestamp type.; line 1 pos 24


-- !query
SELECT '' AS to_char_3, to_char(d1, 'Y,YYY YYYY YYY YY Y CC Q MM WW DDD DD D J')
FROM TIMESTAMP_TBL
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
cannot resolve 'to_char(spark_catalog.default.timestamp_tbl.d1, 'Y,YYY YYYY YYY YY Y CC Q MM WW DDD DD D J')' due to data type mismatch: argument 1 requires decimal type, however, 'spark_catalog.default.timestamp_tbl.d1' is of timestamp type.; line 1 pos 24


-- !query
SELECT '' AS to_char_4, to_char(d1, 'FMY,YYY FMYYYY FMYYY FMYY FMY FMCC FMQ FMMM FMWW FMDDD FMDD FMD FMJ')
FROM TIMESTAMP_TBL
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
cannot resolve 'to_char(spark_catalog.default.timestamp_tbl.d1, 'FMY,YYY FMYYYY FMYYY FMYY FMY FMCC FMQ FMMM FMWW FMDDD FMDD FMD FMJ')' due to data type mismatch: argument 1 requires decimal type, however, 'spark_catalog.default.timestamp_tbl.d1' is of timestamp type.; line 1 pos 24


-- !query
SELECT '' AS to_char_5, to_char(d1, 'HH HH12 HH24 MI SS SSSS')
FROM TIMESTAMP_TBL
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
cannot resolve 'to_char(spark_catalog.default.timestamp_tbl.d1, 'HH HH12 HH24 MI SS SSSS')' due to data type mismatch: argument 1 requires decimal type, however, 'spark_catalog.default.timestamp_tbl.d1' is of timestamp type.; line 1 pos 24


-- !query
SELECT '' AS to_char_6, to_char(d1, E'"HH:MI:SS is" HH:MI:SS "\\"text between quote marks\\""')
FROM TIMESTAMP_TBL
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException

Literals of type 'E' are currently not supported.(line 1, pos 36)

== SQL ==
SELECT '' AS to_char_6, to_char(d1, E'"HH:MI:SS is" HH:MI:SS "\\"text between quote marks\\""')
------------------------------------^^^
FROM TIMESTAMP_TBL


-- !query
SELECT '' AS to_char_7, to_char(d1, 'HH24--text--MI--text--SS')
FROM TIMESTAMP_TBL
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
cannot resolve 'to_char(spark_catalog.default.timestamp_tbl.d1, 'HH24--text--MI--text--SS')' due to data type mismatch: argument 1 requires decimal type, however, 'spark_catalog.default.timestamp_tbl.d1' is of timestamp type.; line 1 pos 24


-- !query
SELECT '' AS to_char_8, to_char(d1, 'YYYYTH YYYYth Jth')
FROM TIMESTAMP_TBL
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
cannot resolve 'to_char(spark_catalog.default.timestamp_tbl.d1, 'YYYYTH YYYYth Jth')' due to data type mismatch: argument 1 requires decimal type, however, 'spark_catalog.default.timestamp_tbl.d1' is of timestamp type.; line 1 pos 24


-- !query
SELECT '' AS to_char_9, to_char(d1, 'YYYY A.D. YYYY a.d. YYYY bc HH:MI:SS P.M. HH:MI:SS p.m. HH:MI:SS pm')
FROM TIMESTAMP_TBL
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
cannot resolve 'to_char(spark_catalog.default.timestamp_tbl.d1, 'YYYY A.D. YYYY a.d. YYYY bc HH:MI:SS P.M. HH:MI:SS p.m. HH:MI:SS pm')' due to data type mismatch: argument 1 requires decimal type, however, 'spark_catalog.default.timestamp_tbl.d1' is of timestamp type.; line 1 pos 24


-- !query
SELECT '' AS to_char_10, to_char(d1, 'IYYY IYY IY I IW IDDD ID')
FROM TIMESTAMP_TBL
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
cannot resolve 'to_char(spark_catalog.default.timestamp_tbl.d1, 'IYYY IYY IY I IW IDDD ID')' due to data type mismatch: argument 1 requires decimal type, however, 'spark_catalog.default.timestamp_tbl.d1' is of timestamp type.; line 1 pos 25


-- !query
SELECT '' AS to_char_11, to_char(d1, 'FMIYYY FMIYY FMIY FMI FMIW FMIDDD FMID')
FROM TIMESTAMP_TBL
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
cannot resolve 'to_char(spark_catalog.default.timestamp_tbl.d1, 'FMIYYY FMIYY FMIY FMI FMIW FMIDDD FMID')' due to data type mismatch: argument 1 requires decimal type, however, 'spark_catalog.default.timestamp_tbl.d1' is of timestamp type.; line 1 pos 25


-- !query
SELECT make_timestamp(2014,12,28,6,30,45.887)
-- !query schema
struct<make_timestamp(2014, 12, 28, 6, 30, 45.887):timestamp>
-- !query output
2014-12-28 06:30:45.887


-- !query
DROP TABLE TIMESTAMP_TBL
-- !query schema
struct<>
-- !query output

