-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE CASE_TBL (
  i integer,
  f double
) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE CASE2_TBL (
  i integer,
  j integer
) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE_TBL VALUES (1, 10.1)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE_TBL VALUES (2, 20.2)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE_TBL VALUES (3, -30.3)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE_TBL VALUES (4, NULL)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE2_TBL VALUES (1, -1)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE2_TBL VALUES (2, -2)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE2_TBL VALUES (3, -3)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE2_TBL VALUES (2, -4)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE2_TBL VALUES (1, NULL)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE2_TBL VALUES (NULL, -6)
-- !query schema
struct<>
-- !query output



-- !query
SELECT '3' AS `One`,
  CASE
    WHEN 1 < 2 THEN 3
  END AS `Simple WHEN`
-- !query schema
struct<One:string,Simple WHEN:int>
-- !query output
3	3


-- !query
SELECT '<NULL>' AS `One`,
  CASE
    WHEN 1 > 2 THEN 3
  END AS `Simple default`
-- !query schema
struct<One:string,Simple default:int>
-- !query output
<NULL>	NULL


-- !query
SELECT '3' AS `One`,
  CASE
    WHEN 1 < 2 THEN 3
    ELSE 4
  END AS `Simple ELSE`
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
SparkContext has been shutdown


-- !query
SELECT '4' AS `One`,
  CASE
    WHEN 1 > 2 THEN 3
    ELSE 4
  END AS `ELSE default`
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
SparkContext has been shutdown


-- !query
SELECT '6' AS `One`,
  CASE
    WHEN 1 > 2 THEN 3
    WHEN 4 < 5 THEN 6
    ELSE 7
  END AS `Two WHEN with default`
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
SparkContext has been shutdown


-- !query
SELECT '7' AS `None`,
  CASE WHEN rand() < 0 THEN 1
  END AS `NULL on no matches`
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
SparkContext has been shutdown


-- !query
SELECT CASE WHEN 1=0 THEN 1/0 WHEN 1=1 THEN 1 ELSE 2/0 END
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
SparkContext has been shutdown


-- !query
SELECT CASE 1 WHEN 0 THEN 1/0 WHEN 1 THEN 1 ELSE 2/0 END
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
SparkContext has been shutdown


-- !query
SELECT CASE WHEN i > 100 THEN 1/0 ELSE 0 END FROM case_tbl
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
Cannot call methods on a stopped SparkContext.
This stopped SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)

The currently active SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)


-- !query
SELECT CASE 'a' WHEN 'a' THEN 1 ELSE 2 END
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
SparkContext has been shutdown


-- !query
SELECT '' AS `Five`,
  CASE
    WHEN i >= 3 THEN i
  END AS `>= 3 or Null`
  FROM CASE_TBL
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
Cannot call methods on a stopped SparkContext.
This stopped SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)

The currently active SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)


-- !query
SELECT '' AS `Five`,
  CASE WHEN i >= 3 THEN (i + i)
       ELSE i
  END AS `Simplest Math`
  FROM CASE_TBL
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
Cannot call methods on a stopped SparkContext.
This stopped SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)

The currently active SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)


-- !query
SELECT '' AS `Five`, i AS `Value`,
  CASE WHEN (i < 0) THEN 'small'
       WHEN (i = 0) THEN 'zero'
       WHEN (i = 1) THEN 'one'
       WHEN (i = 2) THEN 'two'
       ELSE 'big'
  END AS `Category`
  FROM CASE_TBL
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
Cannot call methods on a stopped SparkContext.
This stopped SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)

The currently active SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)


-- !query
SELECT '' AS `Five`,
  CASE WHEN ((i < 0) or (i < 0)) THEN 'small'
       WHEN ((i = 0) or (i = 0)) THEN 'zero'
       WHEN ((i = 1) or (i = 1)) THEN 'one'
       WHEN ((i = 2) or (i = 2)) THEN 'two'
       ELSE 'big'
  END AS `Category`
  FROM CASE_TBL
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
Cannot call methods on a stopped SparkContext.
This stopped SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)

The currently active SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)


-- !query
SELECT * FROM CASE_TBL WHERE COALESCE(f,i) = 4
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
Cannot call methods on a stopped SparkContext.
This stopped SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)

The currently active SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)


-- !query
SELECT * FROM CASE_TBL WHERE NULLIF(f,i) = 2
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
Cannot call methods on a stopped SparkContext.
This stopped SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)

The currently active SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)


-- !query
SELECT COALESCE(a.f, b.i, b.j)
  FROM CASE_TBL a, CASE2_TBL b
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
Cannot call methods on a stopped SparkContext.
This stopped SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)

The currently active SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)


-- !query
SELECT *
  FROM CASE_TBL a, CASE2_TBL b
  WHERE COALESCE(a.f, b.i, b.j) = 2
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
Cannot call methods on a stopped SparkContext.
This stopped SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)

The currently active SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)


-- !query
SELECT '' AS Five, NULLIF(a.i,b.i) AS `NULLIF(a.i,b.i)`,
  NULLIF(b.i, 4) AS `NULLIF(b.i,4)`
  FROM CASE_TBL a, CASE2_TBL b
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
Cannot call methods on a stopped SparkContext.
This stopped SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)

The currently active SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)


-- !query
SELECT '' AS `Two`, *
  FROM CASE_TBL a, CASE2_TBL b
  WHERE COALESCE(f,b.i) = 2
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
Cannot call methods on a stopped SparkContext.
This stopped SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)

The currently active SparkContext was created at:

org.apache.spark.sql.SQLQueryTestSuite.beforeAll(SQLQueryTestSuite.scala:797)
org.scalatest.BeforeAndAfterAll.liftedTree1$1(BeforeAndAfterAll.scala:212)
org.scalatest.BeforeAndAfterAll.run(BeforeAndAfterAll.scala:210)
org.scalatest.BeforeAndAfterAll.run$(BeforeAndAfterAll.scala:208)
org.apache.spark.SparkFunSuite.run(SparkFunSuite.scala:69)
org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:321)
org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:517)
sbt.ForkMain$Run.lambda$runTest$1(ForkMain.java:414)
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
java.base/java.lang.Thread.run(Thread.java:829)


-- !query
SELECT CASE
  (CASE vol('bar')
    WHEN 'foo' THEN 'it was foo!'
    WHEN vol(null) THEN 'null input'
    WHEN 'bar' THEN 'it was bar!' END
  )
  WHEN 'it was foo!' THEN 'foo recognized'
  WHEN 'it was bar!' THEN 'bar recognized'
  ELSE 'unrecognized' END
-- !query schema
struct<>
-- !query output
java.lang.IllegalStateException
SparkContext has been shutdown


-- !query
DROP TABLE CASE_TBL
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE CASE2_TBL
-- !query schema
struct<>
-- !query output

