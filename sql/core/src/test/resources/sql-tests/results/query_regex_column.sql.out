-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 33


-- !query 0
CREATE OR REPLACE TEMPORARY VIEW testData AS SELECT * FROM VALUES
(1, "1", "11"), (2, "2", "22"), (3, "3", "33"), (4, "4", "44"), (5, "5", "55"), (6, "6", "66")
AS testData(key, value1, value2)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
CREATE OR REPLACE TEMPORARY VIEW testData2 AS SELECT * FROM VALUES
(1, 1, 1, 2), (1, 2, 1, 2), (2, 1, 2, 3), (2, 2, 2, 3), (3, 1, 3, 4), (3, 2, 3, 4)
AS testData2(A, B, c, d)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
SELECT `(a)?+.+` FROM testData2 WHERE a = 1
-- !query 2 schema
struct<>
-- !query 2 output
org.apache.spark.sql.AnalysisException
cannot resolve '`(a)?+.+`' given input columns: [testdata2.A, testdata2.B, testdata2.c, testdata2.d]; line 1 pos 7


-- !query 3
SELECT t.`(a)?+.+` FROM testData2 t WHERE a = 1
-- !query 3 schema
struct<>
-- !query 3 output
org.apache.spark.sql.AnalysisException
cannot resolve 't.`(a)?+.+`' given input columns: [t.A, t.B, t.c, t.d]; line 1 pos 7


-- !query 4
SELECT `(a|b)` FROM testData2 WHERE a = 2
-- !query 4 schema
struct<>
-- !query 4 output
org.apache.spark.sql.AnalysisException
cannot resolve '`(a|b)`' given input columns: [testdata2.A, testdata2.B, testdata2.c, testdata2.d]; line 1 pos 7


-- !query 5
SELECT `(a|b)?+.+` FROM testData2 WHERE a = 2
-- !query 5 schema
struct<>
-- !query 5 output
org.apache.spark.sql.AnalysisException
cannot resolve '`(a|b)?+.+`' given input columns: [testdata2.A, testdata2.B, testdata2.c, testdata2.d]; line 1 pos 7


-- !query 6
SELECT SUM(`(a|b)?+.+`) FROM testData2
-- !query 6 schema
struct<>
-- !query 6 output
org.apache.spark.sql.AnalysisException
cannot resolve '`(a|b)?+.+`' given input columns: [testdata2.A, testdata2.B, testdata2.c, testdata2.d]; line 1 pos 11


-- !query 7
SELECT SUM(`(a)`) FROM testData2
-- !query 7 schema
struct<>
-- !query 7 output
org.apache.spark.sql.AnalysisException
cannot resolve '`(a)`' given input columns: [testdata2.A, testdata2.B, testdata2.c, testdata2.d]; line 1 pos 11


-- !query 8
set spark.sql.parser.quotedRegexColumnNames=true
-- !query 8 schema
struct<key:string,value:string>
-- !query 8 output
spark.sql.parser.quotedRegexColumnNames	true


-- !query 9
SELECT `(a)?+.+` FROM testData2 WHERE a = 1
-- !query 9 schema
struct<B:int,c:int,d:int>
-- !query 9 output
1	1	2
2	1	2


-- !query 10
SELECT `(A)?+.+` FROM testData2 WHERE a = 1
-- !query 10 schema
struct<B:int,c:int,d:int>
-- !query 10 output
1	1	2
2	1	2


-- !query 11
SELECT t.`(a)?+.+` FROM testData2 t WHERE a = 1
-- !query 11 schema
struct<B:int,c:int,d:int>
-- !query 11 output
1	1	2
2	1	2


-- !query 12
SELECT t.`(A)?+.+` FROM testData2 t WHERE a = 1
-- !query 12 schema
struct<B:int,c:int,d:int>
-- !query 12 output
1	1	2
2	1	2


-- !query 13
SELECT `(a|B)` FROM testData2 WHERE a = 2
-- !query 13 schema
struct<A:int,B:int>
-- !query 13 output
2	1
2	2


-- !query 14
SELECT `(A|b)` FROM testData2 WHERE a = 2
-- !query 14 schema
struct<A:int,B:int>
-- !query 14 output
2	1
2	2


-- !query 15
SELECT `(a|B)?+.+` FROM testData2 WHERE a = 2
-- !query 15 schema
struct<c:int,d:int>
-- !query 15 output
2	3
2	3


-- !query 16
SELECT `(A|b)?+.+` FROM testData2 WHERE a = 2
-- !query 16 schema
struct<c:int,d:int>
-- !query 16 output
2	3
2	3


-- !query 17
SELECT `(e|f)` FROM testData2
-- !query 17 schema
struct<>
-- !query 17 output



-- !query 18
SELECT t.`(e|f)` FROM testData2 t
-- !query 18 schema
struct<>
-- !query 18 output



-- !query 19
SELECT p.`(KEY)?+.+`, b, testdata2.`(b)?+.+` FROM testData p join testData2 ON p.key = testData2.a WHERE key < 3
-- !query 19 schema
struct<value1:string,value2:string,b:int,A:int,c:int,d:int>
-- !query 19 output
1	11	1	1	1	2
1	11	2	1	1	2
2	22	1	2	2	3
2	22	2	2	2	3


-- !query 20
SELECT p.`(key)?+.+`, b, testdata2.`(b)?+.+` FROM testData p join testData2 ON p.key = testData2.a WHERE key < 3
-- !query 20 schema
struct<value1:string,value2:string,b:int,A:int,c:int,d:int>
-- !query 20 output
1	11	1	1	1	2
1	11	2	1	1	2
2	22	1	2	2	3
2	22	2	2	2	3


-- !query 21
set spark.sql.caseSensitive=true
-- !query 21 schema
struct<key:string,value:string>
-- !query 21 output
spark.sql.caseSensitive	true


-- !query 22
CREATE OR REPLACE TEMPORARY VIEW testdata3 AS SELECT * FROM VALUES
(0, 1), (1, 2), (2, 3), (3, 4)
AS testdata3(a, b)
-- !query 22 schema
struct<>
-- !query 22 output



-- !query 23
SELECT `(A)?+.+` FROM testdata3
-- !query 23 schema
struct<a:int,b:int>
-- !query 23 output
0	1
1	2
2	3
3	4


-- !query 24
SELECT `(a)?+.+` FROM testdata3
-- !query 24 schema
struct<b:int>
-- !query 24 output
1
2
3
4


-- !query 25
SELECT `(A)?+.+` FROM testdata3 WHERE a > 1
-- !query 25 schema
struct<a:int,b:int>
-- !query 25 output
2	3
3	4


-- !query 26
SELECT `(a)?+.+` FROM testdata3 where `a` > 1
-- !query 26 schema
struct<b:int>
-- !query 26 output
3
4


-- !query 27
SELECT SUM(`a`) FROM testdata3
-- !query 27 schema
struct<sum(a):bigint>
-- !query 27 output
6


-- !query 28
SELECT SUM(`(a)`) FROM testdata3
-- !query 28 schema
struct<sum(a):bigint>
-- !query 28 output
6


-- !query 29
SELECT SUM(`(a)?+.+`) FROM testdata3
-- !query 29 schema
struct<sum(b):bigint>
-- !query 29 output
10


-- !query 30
SELECT SUM(a) FROM testdata3 GROUP BY `a`
-- !query 30 schema
struct<sum(a):bigint>
-- !query 30 output
0
1
2
3


-- !query 31
SELECT SUM(a) FROM testdata3 GROUP BY `(a)`
-- !query 31 schema
struct<>
-- !query 31 output
org.apache.spark.sql.AnalysisException
cannot resolve '`(a)`' given input columns: [testdata3.a, testdata3.b]; line 1 pos 38


-- !query 32
SELECT SUM(a) FROM testdata3 GROUP BY `(a)?+.+`
-- !query 32 schema
struct<>
-- !query 32 output
org.apache.spark.sql.AnalysisException
cannot resolve '`(a)?+.+`' given input columns: [testdata3.a, testdata3.b]; line 1 pos 38
