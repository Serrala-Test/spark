-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 25


-- !query 0
CREATE OR REPLACE TEMPORARY VIEW testData AS SELECT * FROM VALUES
(1, "1", "11"), (2, "2", "22"), (3, "3", "33"), (4, "4", "44"), (5, "5", "55"), (6, "6", "66")
AS testData(key, value1, value2)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
CREATE OR REPLACE TEMPORARY VIEW testData2 AS SELECT * FROM VALUES
(1, 1, 1, 2), (1, 2, 1, 2), (2, 1, 2, 3), (2, 2, 2, 3), (3, 1, 3, 4), (3, 2, 3, 4)
AS testData2(A, B, c, d)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
SELECT `(a)?+.+` FROM testData2 WHERE a = 1
-- !query 2 schema
struct<>
-- !query 2 output
org.apache.spark.sql.AnalysisException
cannot resolve '`(a)?+.+`' given input columns: [testdata2.A, testdata2.B, testdata2.c, testdata2.d]; line 1 pos 7


-- !query 3
SELECT t.`(a)?+.+` FROM testData2 t WHERE a = 1
-- !query 3 schema
struct<>
-- !query 3 output
org.apache.spark.sql.AnalysisException
cannot resolve 't.`(a)?+.+`' given input columns: [t.A, t.B, t.c, t.d]; line 1 pos 7


-- !query 4
SELECT `(a|b)` FROM testData2 WHERE a = 2
-- !query 4 schema
struct<>
-- !query 4 output
org.apache.spark.sql.AnalysisException
cannot resolve '`(a|b)`' given input columns: [testdata2.A, testdata2.B, testdata2.c, testdata2.d]; line 1 pos 7


-- !query 5
SELECT `(a|b)?+.+` FROM testData2 WHERE a = 2
-- !query 5 schema
struct<>
-- !query 5 output
org.apache.spark.sql.AnalysisException
cannot resolve '`(a|b)?+.+`' given input columns: [testdata2.A, testdata2.B, testdata2.c, testdata2.d]; line 1 pos 7


-- !query 6
set spark.sql.parser.quotedRegexColumnNames=true
-- !query 6 schema
struct<key:string,value:string>
-- !query 6 output
spark.sql.parser.quotedRegexColumnNames	true


-- !query 7
SELECT `(a)?+.+` FROM testData2 WHERE a = 1
-- !query 7 schema
struct<B:int,c:int,d:int>
-- !query 7 output
1	1	2
2	1	2


-- !query 8
SELECT `(A)?+.+` FROM testData2 WHERE a = 1
-- !query 8 schema
struct<B:int,c:int,d:int>
-- !query 8 output
1	1	2
2	1	2


-- !query 9
SELECT t.`(a)?+.+` FROM testData2 t WHERE a = 1
-- !query 9 schema
struct<B:int,c:int,d:int>
-- !query 9 output
1	1	2
2	1	2


-- !query 10
SELECT t.`(A)?+.+` FROM testData2 t WHERE a = 1
-- !query 10 schema
struct<B:int,c:int,d:int>
-- !query 10 output
1	1	2
2	1	2


-- !query 11
SELECT `(a|B)` FROM testData2 WHERE a = 2
-- !query 11 schema
struct<A:int,B:int>
-- !query 11 output
2	1
2	2


-- !query 12
SELECT `(A|b)` FROM testData2 WHERE a = 2
-- !query 12 schema
struct<A:int,B:int>
-- !query 12 output
2	1
2	2


-- !query 13
SELECT `(a|B)?+.+` FROM testData2 WHERE a = 2
-- !query 13 schema
struct<c:int,d:int>
-- !query 13 output
2	3
2	3


-- !query 14
SELECT `(A|b)?+.+` FROM testData2 WHERE a = 2
-- !query 14 schema
struct<c:int,d:int>
-- !query 14 output
2	3
2	3


-- !query 15
SELECT `(e|f)` FROM testData2
-- !query 15 schema
struct<>
-- !query 15 output



-- !query 16
SELECT t.`(e|f)` FROM testData2 t
-- !query 16 schema
struct<>
-- !query 16 output



-- !query 17
SELECT p.`(KEY)?+.+`, b, testdata2.`(b)?+.+` FROM testData p join testData2 ON p.key = testData2.a WHERE key < 3
-- !query 17 schema
struct<value1:string,value2:string,b:int,A:int,c:int,d:int>
-- !query 17 output
1	11	1	1	1	2
1	11	2	1	1	2
2	22	1	2	2	3
2	22	2	2	2	3


-- !query 18
SELECT p.`(key)?+.+`, b, testdata2.`(b)?+.+` FROM testData p join testData2 ON p.key = testData2.a WHERE key < 3
-- !query 18 schema
struct<value1:string,value2:string,b:int,A:int,c:int,d:int>
-- !query 18 output
1	11	1	1	1	2
1	11	2	1	1	2
2	22	1	2	2	3
2	22	2	2	2	3


-- !query 19
set spark.sql.caseSensitive=true
-- !query 19 schema
struct<key:string,value:string>
-- !query 19 output
spark.sql.caseSensitive	true


-- !query 20
CREATE OR REPLACE TEMPORARY VIEW testdata3 AS SELECT * FROM VALUES
(0, 1), (1, 2), (2, 3), (3, 4)
AS testdata3(a, b)
-- !query 20 schema
struct<>
-- !query 20 output



-- !query 21
SELECT `(A)?+.+` FROM testdata3
-- !query 21 schema
struct<a:int,b:int>
-- !query 21 output
0	1
1	2
2	3
3	4


-- !query 22
SELECT `(a)?+.+` FROM testdata3
-- !query 22 schema
struct<b:int>
-- !query 22 output
1
2
3
4


-- !query 23
SELECT `(A)?+.+` FROM testdata3 WHERE a > 1
-- !query 23 schema
struct<a:int,b:int>
-- !query 23 output
2	3
3	4


-- !query 24
SELECT `(a)?+.+` FROM testdata3 where `a` > 1
-- !query 24 schema
struct<b:int>
-- !query 24 output
3
4
