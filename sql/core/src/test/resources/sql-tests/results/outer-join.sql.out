-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 32


-- !query 0
CREATE OR REPLACE TEMPORARY VIEW lowerCaseData AS SELECT * FROM VALUES
(1, "a"),
(2, "b"),
(3, "c"),
(4, "d")
as lowerCaseData(n, l)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
CREATE OR REPLACE TEMPORARY VIEW upperCaseData AS SELECT * FROM VALUES
(1, "A"),
(2, "B"),
(3, "C"),
(4, "D"),
(5, "E"),
(6, "F")
as upperCaseData(N, L)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
CREATE OR REPLACE TEMPORARY VIEW nullData AS SELECT * FROM VALUES
(201, null),
(86, "val_86"),
(null, "val_null"),
(165, "val_165"),
(null, null),
(330, "val_330"),
(165, null)
as nullData(key, value)
-- !query 2 schema
struct<>
-- !query 2 output



-- !query 3
CREATE OR REPLACE TEMPORARY VIEW duplicateRowData AS SELECT * FROM VALUES
(251, "val_251"),
(86, "val_86"),
(165, "val_165"),
(330, "val_330"),
(165, "val_165")
as duplicateRowData(key, value)
-- !query 3 schema
struct<>
-- !query 3 output



-- !query 4
SELECT * FROM
  (SELECT * FROM upperCaseData WHERE N <= 4) leftTable FULL OUTER JOIN
  (SELECT * FROM upperCaseData WHERE N >= 3) rightTable
    ON leftTable.N = rightTable.N
-- !query 4 schema
struct<N:int,L:string,N:int,L:string>
-- !query 4 output
1	A	NULL	NULL
2	B	NULL	NULL
3	C	3	C
4	D	4	D
NULL	NULL	5	E
NULL	NULL	6	F


-- !query 5
SELECT * FROM lowercasedata l RIGHT OUTER JOIN uppercasedata u ON l.n = u.N
-- !query 5 schema
struct<n:int,l:string,N:int,L:string>
-- !query 5 output
1	a	1	A
2	b	2	B
3	c	3	C
4	d	4	D
NULL	NULL	5	E
NULL	NULL	6	F


-- !query 6
SELECT * FROM uppercasedata u LEFT OUTER JOIN lowercasedata l ON l.n = u.N
-- !query 6 schema
struct<N:int,L:string,n:int,l:string>
-- !query 6 output
1	A	1	a
2	B	2	b
3	C	3	c
4	D	4	d
5	E	NULL	NULL
6	F	NULL	NULL


-- !query 7
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
  SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
  FROM
  (
    SELECT src1.key AS c1, src1.value AS c2
    FROM duplicateRowData src1 WHERE src1.key > 100 and src1.key < 300
  ) a
  LEFT OUTER JOIN
  (
    SELECT src2.key AS c3, src2.value AS c4
    FROM duplicateRowData src2 WHERE src2.key > 200 and src2.key < 400
  ) b
  ON (a.c1 = b.c3)
) c
-- !query 7 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 7 output
165	val_165	NULL	NULL
165	val_165	NULL	NULL
251	val_251	251	val_251


-- !query 8
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
  SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
  FROM
  (
    SELECT src1.key AS c1, src1.value AS c2
    FROM duplicateRowData src1 WHERE src1.key > 100 and src1.key < 300
  ) a
  RIGHT OUTER JOIN
  (
    SELECT src2.key AS c3, src2.value AS c4
    FROM duplicateRowData src2 WHERE src2.key > 200 and src2.key < 400
  ) b
  ON (a.c1 = b.c3)
) c
-- !query 8 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 8 output
251	val_251	251	val_251
NULL	NULL	330	val_330


-- !query 9
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
 SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
 FROM
 (
   SELECT src1.key AS c1, src1.value AS c2
   FROM duplicateRowData src1 WHERE src1.key > 100 and src1.key < 300
 ) a
 FULL OUTER JOIN
 (
   SELECT src2.key AS c3, src2.value AS c4
   FROM duplicateRowData src2 WHERE src2.key > 200 and src2.key < 400
 ) b
 ON (a.c1 = b.c3)
) c
-- !query 9 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 9 output
165	val_165	NULL	NULL
165	val_165	NULL	NULL
251	val_251	251	val_251
NULL	NULL	330	val_330


-- !query 10
SELECT c.c1, c.c2, c.c3, c.c4, c.c5, c.c6
FROM (
  SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4, c.c5 AS c5, c.c6 AS c6
  FROM
  (
    SELECT src1.key AS c1, src1.value AS c2
    FROM duplicateRowData src1 WHERE src1.key > 10 and src1.key < 150
  ) a
  FULL OUTER JOIN
  (
    SELECT src2.key AS c3, src2.value AS c4
    FROM duplicateRowData src2 WHERE src2.key > 150 and src2.key < 300
  ) b
  ON (a.c1 = b.c3)
  LEFT OUTER JOIN
  (
    SELECT src3.key AS c5, src3.value AS c6
    FROM duplicateRowData src3 WHERE src3.key > 200 and src3.key < 400
  ) c
  ON (a.c1 = c.c5)
) c
-- !query 10 schema
struct<c1:int,c2:string,c3:int,c4:string,c5:int,c6:string>
-- !query 10 output
86	val_86	NULL	NULL	NULL	NULL
NULL	NULL	165	val_165	NULL	NULL
NULL	NULL	165	val_165	NULL	NULL
NULL	NULL	251	val_251	NULL	NULL


-- !query 11
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
 SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
 FROM
 (
   SELECT src1.key AS c1, src1.value AS c2
   FROM duplicateRowData src1 WHERE src1.key > 100 and src1.key < 300
 ) a
 LEFT OUTER JOIN
 (
   SELECT src2.key AS c3, src2.value AS c4
   FROM duplicateRowData src2 WHERE src2.key > 200 and src2.key < 400
 ) b
 ON (a.c1 = b.c3)
) c
where c.c3 IS NULL AND c.c1 IS NOT NULL
-- !query 11 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 11 output
165	val_165	NULL	NULL
165	val_165	NULL	NULL


-- !query 12
SELECT a.key, a.value, b.key, b.value
FROM
  (
    SELECT src1.key as key, count(src1.value) AS value
    FROM duplicateRowData src1 group by src1.key
  ) a
  FULL OUTER JOIN
  (
    SELECT src2.key as key, count(distinct(src2.value)) AS value
    FROM nullData src2 group by src2.key
  ) b
ON (a.key = b.key)
-- !query 12 schema
struct<key:int,value:bigint,key:int,value:bigint>
-- !query 12 output
165	2	165	1
251	1	NULL	NULL
330	1	330	1
86	1	86	1
NULL	NULL	201	0
NULL	NULL	NULL	1


-- !query 13
SELECT a.key, a.value, b.key, b.value1, b.value2
FROM
  (
    SELECT src1.key as key, count(src1.value) AS value
    FROM duplicateRowData src1 group by src1.key
  ) a
  FULL OUTER JOIN
  (
    SELECT src2.key as key, count(distinct(src2.value)) AS value1,
      count(distinct(src2.key)) AS value2
    FROM nullData src2 group by src2.key
  ) b
ON (a.key = b.key)
-- !query 13 schema
struct<key:int,value:bigint,key:int,value1:bigint,value2:bigint>
-- !query 13 output
165	2	165	1	1
251	1	NULL	NULL	NULL
330	1	330	1	1
86	1	86	1	1
NULL	NULL	201	0	1
NULL	NULL	NULL	1	0


-- !query 14
SELECT a.k1,a.v1,a.k2,a.v2,a.k3,a.v3
FROM (
  SELECT src1.key as k1, src1.value as v1, src2.key as k2, src2.value as v2 , src3.key as k3,
    src3.value as v3
  FROM duplicateRowData src1 JOIN duplicateRowData src2 ON (src1.key = src2.key AND src1.key < 200)
    RIGHT OUTER JOIN duplicateRowData src3 ON (src1.key = src3.key AND src3.key < 300)
  SORT BY k1,v1,k2,v2,k3,v3
)a
-- !query 14 schema
struct<k1:int,v1:string,k2:int,v2:string,k3:int,v3:string>
-- !query 14 output
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
86	val_86	86	val_86	86	val_86
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330


-- !query 15
SELECT a.k1,a.v1,a.k2,a.v2,a.k3,a.v3
FROM (
  SELECT src1.key as k1, src1.value as v1, src2.key as k2, src2.value as v2 , src3.key as k3,
    src3.value as v3
  FROM duplicateRowData src1
    JOIN duplicateRowData src2
      ON (src1.key = src2.key AND src1.key < 200 AND src2.key < 100)
    RIGHT OUTER JOIN duplicateRowData src3
      ON (src1.key = src3.key AND src3.key < 300)
  SORT BY k1,v1,k2,v2,k3,v3
)a
-- !query 15 schema
struct<k1:int,v1:string,k2:int,v2:string,k3:int,v3:string>
-- !query 15 output
86	val_86	86	val_86	86	val_86
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330


-- !query 16
SELECT *
FROM
  duplicateRowData src1
  LEFT OUTER JOIN duplicateRowData src2
    ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
  RIGHT OUTER JOIN duplicateRowData src3
    ON (src2.key = src3.key AND src3.key < 200)
SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 16 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 16 output
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330
NULL	NULL	NULL	NULL	86	val_86


-- !query 17
SELECT * FROM duplicateRowData src1
 LEFT OUTER JOIN duplicateRowData src2
   ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 RIGHT OUTER JOIN duplicateRowData src3
   ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 17 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 17 output
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330
NULL	NULL	NULL	NULL	86	val_86


-- !query 18
SELECT * FROM duplicateRowData src1
 RIGHT OUTER JOIN duplicateRowData src2
   ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 RIGHT OUTER JOIN duplicateRowData src3
   ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 18 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 18 output
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	86	val_86	86	val_86
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330


-- !query 19
SELECT * FROM duplicateRowData src1
 LEFT OUTER JOIN duplicateRowData src2
   ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 LEFT OUTER JOIN duplicateRowData src3
   ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 19 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 19 output
165	val_165	NULL	NULL	NULL	NULL
165	val_165	NULL	NULL	NULL	NULL
251	val_251	NULL	NULL	NULL	NULL
330	val_330	NULL	NULL	NULL	NULL
86	val_86	NULL	NULL	NULL	NULL


-- !query 20
SELECT * FROM duplicateRowData src1
 RIGHT OUTER JOIN duplicateRowData src2
   ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 LEFT OUTER JOIN duplicateRowData src3
   ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 20 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 20 output
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	251	val_251	NULL	NULL
NULL	NULL	330	val_330	NULL	NULL
NULL	NULL	86	val_86	86	val_86


-- !query 21
SELECT * FROM duplicateRowData src1
 JOIN duplicateRowData src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 LEFT OUTER JOIN duplicateRowData src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 21 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 21 output



-- !query 22
SELECT * FROM duplicateRowData src1
 JOIN duplicateRowData src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 RIGHT OUTER JOIN duplicateRowData src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 22 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 22 output
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330
NULL	NULL	NULL	NULL	86	val_86


-- !query 23
SELECT * FROM duplicateRowData src1
 LEFT OUTER JOIN duplicateRowData src2
   ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 JOIN duplicateRowData src3
   ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 23 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 23 output



-- !query 24
SELECT * FROM duplicateRowData src1
 RIGHT OUTER JOIN duplicateRowData src2
   ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 JOIN duplicateRowData src3
   ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 24 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 24 output
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	86	val_86	86	val_86


-- !query 25
FROM
(SELECT duplicateRowData.* FROM duplicateRowData sort by key) x
LEFT OUTER JOIN
(SELECT nullData.* FROM nullData sort by value) Y
ON (x.key = Y.key)
select Y.key,Y.value
-- !query 25 schema
struct<key:int,value:string>
-- !query 25 output
165	NULL
165	NULL
165	val_165
165	val_165
330	val_330
86	val_86
NULL	NULL


-- !query 26
FROM
(SELECT duplicateRowData.* FROM duplicateRowData sort by key) x
RIGHT OUTER JOIN
(SELECT nullData.* FROM nullData sort by value) Y
ON (x.key = Y.key)
select Y.key,Y.value
-- !query 26 schema
struct<key:int,value:string>
-- !query 26 output
165	NULL
165	NULL
165	val_165
165	val_165
201	NULL
330	val_330
86	val_86
NULL	NULL
NULL	val_null


-- !query 27
FROM
(SELECT duplicateRowData.* FROM duplicateRowData sort by key) x
JOIN
(SELECT duplicateRowData.* FROM duplicateRowData sort by value) Y
ON (x.key = Y.key)
LEFT OUTER JOIN
(SELECT duplicateRowData.* FROM duplicateRowData sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 27 schema
struct<key:int,value:string>
-- !query 27 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 28
FROM
(SELECT nullData.* FROM nullData sort by key) x
LEFT OUTER JOIN
(SELECT duplicateRowData.* FROM duplicateRowData sort by value) Y
ON (x.key = Y.key)
LEFT OUTER JOIN
(SELECT nullData.* FROM nullData sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 28 schema
struct<key:int,value:string>
-- !query 28 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
330	val_330
86	val_86
NULL	NULL
NULL	NULL
NULL	NULL


-- !query 29
FROM
(SELECT nullData.* FROM nullData sort by key) x
LEFT OUTER JOIN
(SELECT nullData.* FROM nullData sort by value) Y
ON (x.key = Y.key)
RIGHT OUTER JOIN
(SELECT duplicateRowData.* FROM duplicateRowData sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 29 schema
struct<key:int,value:string>
-- !query 29 output
165	NULL
165	NULL
165	NULL
165	NULL
165	val_165
165	val_165
165	val_165
165	val_165
330	val_330
86	val_86
NULL	NULL


-- !query 30
FROM
(SELECT duplicateRowData.* FROM duplicateRowData sort by key) x
RIGHT OUTER JOIN
(SELECT nullData.* FROM nullData sort by value) Y
ON (x.key = Y.key)
RIGHT OUTER JOIN
(SELECT duplicateRowData.* FROM duplicateRowData sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 30 schema
struct<key:int,value:string>
-- !query 30 output
165	NULL
165	NULL
165	NULL
165	NULL
165	val_165
165	val_165
165	val_165
165	val_165
330	val_330
86	val_86
NULL	NULL


-- !query 31
FROM
(SELECT duplicateRowData.* FROM duplicateRowData sort by key) x
RIGHT OUTER JOIN
(SELECT nullData.* FROM nullData sort by value) Y
ON (x.key = Y.key)
JOIN
(SELECT duplicateRowData.* FROM duplicateRowData sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 31 schema
struct<key:int,value:string>
-- !query 31 output
165	NULL
165	NULL
165	NULL
165	NULL
165	val_165
165	val_165
165	val_165
165	val_165
330	val_330
86	val_86
