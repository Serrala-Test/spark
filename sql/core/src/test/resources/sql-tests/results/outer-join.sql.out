-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 28


-- !query 0
SELECT * FROM
  (SELECT * FROM upperCaseData WHERE N <= 4) leftTable FULL OUTER JOIN
  (SELECT * FROM upperCaseData WHERE N >= 3) rightTable
    ON leftTable.N = rightTable.N
-- !query 0 schema
struct<N:int,L:string,N:int,L:string>
-- !query 0 output
1	A	NULL	NULL
2	B	NULL	NULL
3	C	3	C
4	D	4	D
NULL	NULL	5	E
NULL	NULL	6	F


-- !query 1
SELECT * FROM lowercasedata l RIGHT OUTER JOIN uppercasedata u ON l.n = u.N
-- !query 1 schema
struct<n:int,l:string,N:int,L:string>
-- !query 1 output
1	a	1	A
2	b	2	B
3	c	3	C
4	d	4	D
NULL	NULL	5	E
NULL	NULL	6	F


-- !query 2
SELECT * FROM uppercasedata u LEFT OUTER JOIN lowercasedata l ON l.n = u.N
-- !query 2 schema
struct<N:int,L:string,n:int,l:string>
-- !query 2 output
1	A	1	a
2	B	2	b
3	C	3	c
4	D	4	d
5	E	NULL	NULL
6	F	NULL	NULL


-- !query 3
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
  SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
  FROM
  (
    SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 100 and src1.key < 300
  ) a
  LEFT OUTER JOIN
  (
    SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 200 and src2.key < 400
  ) b
  ON (a.c1 = b.c3)
) c
-- !query 3 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 3 output
165	val_165	NULL	NULL
165	val_165	NULL	NULL
251	val_251	251	val_251


-- !query 4
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
  SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
  FROM
  (
    SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 100 and src1.key < 300
  ) a
  RIGHT OUTER JOIN
  (
    SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 200 and src2.key < 400
  ) b
  ON (a.c1 = b.c3)
) c
-- !query 4 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 4 output
251	val_251	251	val_251
NULL	NULL	330	val_330


-- !query 5
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
 SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
 FROM
 (
   SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 100 and src1.key < 300
 ) a
 FULL OUTER JOIN
 (
   SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 200 and src2.key < 400
 ) b
 ON (a.c1 = b.c3)
) c
-- !query 5 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 5 output
165	val_165	NULL	NULL
165	val_165	NULL	NULL
251	val_251	251	val_251
NULL	NULL	330	val_330


-- !query 6
SELECT c.c1, c.c2, c.c3, c.c4, c.c5, c.c6
FROM (
  SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4, c.c5 AS c5, c.c6 AS c6
  FROM
  (
    SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 10 and src1.key < 150
  ) a
  FULL OUTER JOIN
  (
    SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 150 and src2.key < 300
  ) b
  ON (a.c1 = b.c3)
  LEFT OUTER JOIN
  (
    SELECT src3.key AS c5, src3.value AS c6 FROM src src3 WHERE src3.key > 200 and src3.key < 400
  ) c
  ON (a.c1 = c.c5)
) c
-- !query 6 schema
struct<c1:int,c2:string,c3:int,c4:string,c5:int,c6:string>
-- !query 6 output
86	val_86	NULL	NULL	NULL	NULL
NULL	NULL	165	val_165	NULL	NULL
NULL	NULL	165	val_165	NULL	NULL
NULL	NULL	251	val_251	NULL	NULL


-- !query 7
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
 SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
 FROM
 (
   SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 100 and src1.key < 300
 ) a
 LEFT OUTER JOIN
 (
   SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 200 and src2.key < 400
 ) b
 ON (a.c1 = b.c3)
) c
where c.c3 IS NULL AND c.c1 IS NOT NULL
-- !query 7 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 7 output
165	val_165	NULL	NULL
165	val_165	NULL	NULL


-- !query 8
SELECT a.key, a.value, b.key, b.value
FROM
  (
    SELECT src1.key as key, count(src1.value) AS value FROM src src1 group by src1.key
  ) a
  FULL OUTER JOIN
  (
    SELECT src2.key as key, count(distinct(src2.value)) AS value
    FROM src1 src2 group by src2.key
  ) b
ON (a.key = b.key)
-- !query 8 schema
struct<key:int,value:bigint,key:int,value:bigint>
-- !query 8 output
165	2	165	1
251	1	NULL	NULL
330	1	330	1
86	1	86	1
NULL	NULL	201	0
NULL	NULL	NULL	1


-- !query 9
SELECT a.key, a.value, b.key, b.value1, b.value2
FROM
  (
    SELECT src1.key as key, count(src1.value) AS value FROM src src1 group by src1.key
  ) a
  FULL OUTER JOIN
  (
    SELECT src2.key as key, count(distinct(src2.value)) AS value1,
      count(distinct(src2.key)) AS value2
    FROM src1 src2 group by src2.key
  ) b
ON (a.key = b.key)
-- !query 9 schema
struct<key:int,value:bigint,key:int,value1:bigint,value2:bigint>
-- !query 9 output
165	2	165	1	1
251	1	NULL	NULL	NULL
330	1	330	1	1
86	1	86	1	1
NULL	NULL	201	0	1
NULL	NULL	NULL	1	0


-- !query 10
SELECT a.k1,a.v1,a.k2,a.v2,a.k3,a.v3
FROM (
  SELECT src1.key as k1, src1.value as v1, src2.key as k2, src2.value as v2 , src3.key as k3, src3.value as v3
  FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key < 200)
    RIGHT OUTER JOIN src src3 ON (src1.key = src3.key AND src3.key < 300)
  SORT BY k1,v1,k2,v2,k3,v3
)a
-- !query 10 schema
struct<k1:int,v1:string,k2:int,v2:string,k3:int,v3:string>
-- !query 10 output
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
86	val_86	86	val_86	86	val_86
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330


-- !query 11
SELECT a.k1,a.v1,a.k2,a.v2,a.k3,a.v3
FROM (
  SELECT src1.key as k1, src1.value as v1, src2.key as k2, src2.value as v2 , src3.key as k3, src3.value as v3
  FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key < 100)
    RIGHT OUTER JOIN src src3 ON (src1.key = src3.key AND src3.key < 300)
  SORT BY k1,v1,k2,v2,k3,v3
)a
-- !query 11 schema
struct<k1:int,v1:string,k2:int,v2:string,k3:int,v3:string>
-- !query 11 output
86	val_86	86	val_86	86	val_86
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330


-- !query 12
SELECT *
FROM
  src src1
  LEFT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
  RIGHT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 12 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 12 output
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330
NULL	NULL	NULL	NULL	86	val_86


-- !query 13
SELECT * FROM src src1
 LEFT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 RIGHT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 13 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 13 output
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330
NULL	NULL	NULL	NULL	86	val_86


-- !query 14
SELECT * FROM src src1
 RIGHT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 RIGHT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 14 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 14 output
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	86	val_86	86	val_86
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330


-- !query 15
SELECT * FROM src src1
 LEFT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 LEFT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 15 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 15 output
165	val_165	NULL	NULL	NULL	NULL
165	val_165	NULL	NULL	NULL	NULL
251	val_251	NULL	NULL	NULL	NULL
330	val_330	NULL	NULL	NULL	NULL
86	val_86	NULL	NULL	NULL	NULL


-- !query 16
SELECT * FROM src src1
 RIGHT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 LEFT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 16 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 16 output
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	251	val_251	NULL	NULL
NULL	NULL	330	val_330	NULL	NULL
NULL	NULL	86	val_86	86	val_86


-- !query 17
SELECT * FROM src src1
 JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 LEFT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 17 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 17 output



-- !query 18
SELECT * FROM src src1
 JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 RIGHT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 18 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 18 output
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330
NULL	NULL	NULL	NULL	86	val_86


-- !query 19
SELECT * FROM src src1
 LEFT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 19 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 19 output



-- !query 20
SELECT * FROM src src1
 RIGHT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 20 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 20 output
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	86	val_86	86	val_86


-- !query 21
FROM
(SELECT src.* FROM src sort by key) x
LEFT OUTER JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
select Y.key,Y.value
-- !query 21 schema
struct<key:int,value:string>
-- !query 21 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 22
FROM
(SELECT src.* FROM src sort by key) x
RIGHT OUTER JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
select Y.key,Y.value
-- !query 22 schema
struct<key:int,value:string>
-- !query 22 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 23
FROM
(SELECT src.* FROM src sort by key) x
JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
LEFT OUTER JOIN
(SELECT src.* FROM src sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 23 schema
struct<key:int,value:string>
-- !query 23 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 24
FROM
(SELECT src.* FROM src sort by key) x
LEFT OUTER JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
LEFT OUTER JOIN
(SELECT src.* FROM src sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 24 schema
struct<key:int,value:string>
-- !query 24 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 25
FROM
(SELECT src.* FROM src sort by key) x
LEFT OUTER JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
RIGHT OUTER JOIN
(SELECT src.* FROM src sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 25 schema
struct<key:int,value:string>
-- !query 25 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 26
FROM
(SELECT src.* FROM src sort by key) x
RIGHT OUTER JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
RIGHT OUTER JOIN
(SELECT src.* FROM src sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 26 schema
struct<key:int,value:string>
-- !query 26 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 27
FROM
(SELECT src.* FROM src sort by key) x
RIGHT OUTER JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
JOIN
(SELECT src.* FROM src sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 27 schema
struct<key:int,value:string>
-- !query 27 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86
