-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 14


-- !query 0
select concat_ws()
-- !query 0 schema
struct<>
-- !query 0 output
org.apache.spark.sql.AnalysisException
requirement failed: concat_ws requires at least one argument.; line 1 pos 7


-- !query 1
select format_string()
-- !query 1 schema
struct<>
-- !query 1 output
org.apache.spark.sql.AnalysisException
requirement failed: format_string() should take at least 1 argument; line 1 pos 7


-- !query 2
select 'a' || 'b' || 'c'
-- !query 2 schema
struct<concat(concat(a, b), c):string>
-- !query 2 output
abc


-- !query 3
EXPLAIN EXTENDED SELECT (col1 || col2 || col3 || col4) col
FROM (SELECT id col1, id col2, id col3, id col4 FROM range(10))
-- !query 3 schema
struct<plan:string>
-- !query 3 output
== Parsed Logical Plan ==
'Project [concat(concat(concat('col1, 'col2), 'col3), 'col4) AS col#x]
+- 'SubqueryAlias __auto_generated_subquery_name
   +- 'Project ['id AS col1#x, 'id AS col2#x, 'id AS col3#x, 'id AS col4#x]
      +- 'UnresolvedTableValuedFunction range, [10]

== Analyzed Logical Plan ==
col: string
Project [concat(concat(concat(cast(col1#xL as string), cast(col2#xL as string)), cast(col3#xL as string)), cast(col4#xL as string)) AS col#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Project [id#xL AS col1#xL, id#xL AS col2#xL, id#xL AS col3#xL, id#xL AS col4#xL]
      +- Range (0, 10, step=1, splits=None)

== Optimized Logical Plan ==
Project [concat(cast(id#xL as string), cast(id#xL as string), cast(id#xL as string), cast(id#xL as string)) AS col#x]
+- Range (0, 10, step=1, splits=None)

== Physical Plan ==
*Project [concat(cast(id#xL as string), cast(id#xL as string), cast(id#xL as string), cast(id#xL as string)) AS col#x]
+- *Range (0, 10, step=1, splits=2)


-- !query 4
select replace('abc', 'b', '123')
-- !query 4 schema
struct<replace(abc, b, 123):string>
-- !query 4 output
a123c


-- !query 5
select replace('abc', 'b')
-- !query 5 schema
struct<replace(abc, b, ):string>
-- !query 5 output
ac


-- !query 6
select length(uuid()), (uuid() <> uuid())
-- !query 6 schema
struct<length(uuid()):int,(NOT (uuid() = uuid())):boolean>
-- !query 6 output
36	true


-- !query 7
select position('bar' in 'foobarbar'), position(null, 'foobarbar'), position('aaads', null)
-- !query 7 schema
struct<locate(bar, foobarbar, 1):int,locate(CAST(NULL AS STRING), foobarbar, 1):int,locate(aaads, CAST(NULL AS STRING), 1):int>
-- !query 7 output
4	NULL	NULL


-- !query 8
select left("abcd", 2), left("abcd", 5), left("abcd", '2'), left("abcd", null)
-- !query 8 schema
struct<left('abcd', 2):string,left('abcd', 5):string,left('abcd', '2'):string,left('abcd', NULL):string>
-- !query 8 output
ab	abcd	ab	NULL


-- !query 9
select left(null, -2), left("abcd", -2), left("abcd", 0), left("abcd", 'a')
-- !query 9 schema
struct<left(NULL, -2):string,left('abcd', -2):string,left('abcd', 0):string,left('abcd', 'a'):string>
-- !query 9 output
NULL			NULL


-- !query 10
select right("abcd", 2), right("abcd", 5), right("abcd", '2'), right("abcd", null)
-- !query 10 schema
struct<right('abcd', 2):string,right('abcd', 5):string,right('abcd', '2'):string,right('abcd', NULL):string>
-- !query 10 output
cd	abcd	cd	NULL


-- !query 11
select right(null, -2), right("abcd", -2), right("abcd", 0), right("abcd", 'a')
-- !query 11 schema
struct<right(NULL, -2):string,right('abcd', -2):string,right('abcd', 0):string,right('abcd', 'a'):string>
-- !query 11 output
NULL			NULL


-- !query 12
SELECT (col1 || col2 || col3 || col4) col
FROM (
  SELECT
    CAST('a' || id AS BINARY) col1,
    CAST('b' || id AS BINARY) col2,
    CAST('c' || id AS BINARY) col3,
    CAST('d' || id AS BINARY) col4
  FROM range(10)
)
-- !query 12 schema
struct<col:binary>
-- !query 12 output
a0b0c0d0
a1b1c1d1
a2b2c2d2
a3b3c3d3
a4b4c4d4
a5b5c5d5
a6b6c6d6
a7b7c7d7
a8b8c8d8
a9b9c9d9


-- !query 13
SELECT (col1 || col2 || col3 || col4) col
FROM (
  SELECT
    'a' || id col1,
    'b' || id col2,
    CAST('c' || id AS BINARY) col3,
    CAST('d' || id AS BINARY) col4
  FROM range(10)
)
-- !query 13 schema
struct<col:string>
-- !query 13 output
a0b0c0d0
a1b1c1d1
a2b2c2d2
a3b3c3d3
a4b4c4d4
a5b5c5d5
a6b6c6d6
a7b7c7d7
a8b8c8d8
a9b9c9d9
