-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 9


-- !query 0
SELECT a.k1, a.v1, a.k2, a.v2
FROM (
SELECT src1.key as k1, src1.value as v1,
       src2.key as k2, src2.value as v2 FROM
  (SELECT * FROM src WHERE src.key < 200) src1
    JOIN
  (SELECT * FROM src WHERE src.key < 200) src2
  SORT BY k1, v1, k2, v2
) a
-- !query 0 schema
struct<k1:int,v1:string,k2:int,v2:string>
-- !query 0 output
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	86	val_86
165	val_165	86	val_86
86	val_86	165	val_165
86	val_86	165	val_165
86	val_86	86	val_86


-- !query 1
SELECT src1.key, src2.value
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
-- !query 1 schema
struct<key:int,value:string>
-- !query 1 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 2
SELECT src1.key, src3.value
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
  JOIN src src3 ON (src1.key + src2.key = src3.key)
-- !query 2 schema
struct<key:int,value:string>
-- !query 2 output
165	val_330
165	val_330
165	val_330
165	val_330


-- !query 3
SELECT src1.key, src3.value
FROM src src1 JOIN src src2 ON (src1.key = src2.key) JOIN src src3 ON (src1.key = src3.key)
-- !query 3 schema
struct<key:int,value:string>
-- !query 3 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 4
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
 SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
 FROM
 (
   SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 100 and src1.key < 300
 ) a
 LEFT OUTER JOIN
 (
   SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 200 and src2.key < 400
 ) b
 ON (a.c1 = b.c3)
) c
-- !query 4 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 4 output
165	val_165	NULL	NULL
165	val_165	NULL	NULL
251	val_251	251	val_251


-- !query 5
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
 SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
 FROM
 (
   SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 100 and src1.key < 300
 ) a
 RIGHT OUTER JOIN
 (
   SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 200 and src2.key < 400
 ) b
 ON (a.c1 = b.c3)
) c
-- !query 5 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 5 output
251	val_251	251	val_251
NULL	NULL	330	val_330


-- !query 6
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
 SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
 FROM
 (
   SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 100 and src1.key < 300
 ) a
 FULL OUTER JOIN
 (
   SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 200 and src2.key < 400
 ) b
 ON (a.c1 = b.c3)
) c
-- !query 6 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 6 output
165	val_165	NULL	NULL
165	val_165	NULL	NULL
251	val_251	251	val_251
NULL	NULL	330	val_330


-- !query 7
SELECT c.c1, c.c2, c.c3, c.c4, c.c5, c.c6
FROM (
  SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4, c.c5 AS c5, c.c6 AS c6
  FROM
  (
    SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 10 and src1.key < 150
  ) a
  FULL OUTER JOIN
  (
    SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 150 and src2.key < 300
  ) b
  ON (a.c1 = b.c3)
  LEFT OUTER JOIN
  (
    SELECT src3.key AS c5, src3.value AS c6 FROM src src3 WHERE src3.key > 200 and src3.key < 400
  ) c
  ON (a.c1 = c.c5)
) c
-- !query 7 schema
struct<c1:int,c2:string,c3:int,c4:string,c5:int,c6:string>
-- !query 7 output
86	val_86	NULL	NULL	NULL	NULL
NULL	NULL	165	val_165	NULL	NULL
NULL	NULL	165	val_165	NULL	NULL
NULL	NULL	251	val_251	NULL	NULL


-- !query 8
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
 SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
 FROM
 (
   SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 100 and src1.key < 300
 ) a
 LEFT OUTER JOIN
 (
   SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 200 and src2.key < 400
 ) b
 ON (a.c1 = b.c3)
) c
where c.c3 IS NULL AND c.c1 IS NOT NULL
-- !query 8 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 8 output
165	val_165	NULL	NULL
165	val_165	NULL	NULL
