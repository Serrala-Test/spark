-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 34


-- !query 0
SELECT a.k1, a.v1, a.k2, a.v2
FROM (
SELECT src1.key as k1, src1.value as v1,
       src2.key as k2, src2.value as v2 FROM
  (SELECT * FROM duplicateRowData WHERE duplicateRowData.key < 200) src1
    JOIN
  (SELECT * FROM duplicateRowData WHERE duplicateRowData.key < 200) src2
  SORT BY k1, v1, k2, v2
) a
-- !query 0 schema
struct<k1:int,v1:string,k2:int,v2:string>
-- !query 0 output
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	86	val_86
165	val_165	86	val_86
86	val_86	165	val_165
86	val_86	165	val_165
86	val_86	86	val_86


-- !query 1
SELECT src1.key, src2.value
FROM duplicateRowData src1 JOIN duplicateRowData src2 ON (src1.key = src2.key)
-- !query 1 schema
struct<key:int,value:string>
-- !query 1 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 2
SELECT src1.key, src3.value
FROM duplicateRowData src1 JOIN duplicateRowData src2 ON (src1.key = src2.key)
  JOIN duplicateRowData src3 ON (src1.key + src2.key = src3.key)
-- !query 2 schema
struct<key:int,value:string>
-- !query 2 output
165	val_330
165	val_330
165	val_330
165	val_330


-- !query 3
SELECT src1.key, src3.value
FROM duplicateRowData src1 JOIN duplicateRowData src2 ON (src1.key = src2.key)
  JOIN duplicateRowData src3 ON (src1.key = src3.key)
-- !query 3 schema
struct<key:int,value:string>
-- !query 3 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 4
SELECT src1.key, src2.value
FROM srcpart src1 JOIN duplicateRowData src2 ON (src1.key = src2.key)
WHERE src1.ds = '2008-04-08' and src1.hr = '12'
-- !query 4 schema
struct<key:int,value:string>
-- !query 4 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 5
FROM
(SELECT duplicateRowData.* from duplicateRowData) x
JOIN
(SELECT duplicateRowData.* from duplicateRowData) Y
ON (x.key = Y.key)
select Y.key, Y.value
-- !query 5 schema
struct<key:int,value:string>
-- !query 5 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 6
SELECT src1.c1, src2.c4
FROM
  (SELECT duplicateRowData.key as c1, duplicateRowData.value as c2 from duplicateRowData) src1
  JOIN
  (SELECT duplicateRowData.key as c3, duplicateRowData.value as c4 from duplicateRowData) src2
  ON src1.c1 = src2.c3 AND src1.c1 < 200
-- !query 6 schema
struct<c1:int,c4:string>
-- !query 6 output
165	val_165
165	val_165
165	val_165
165	val_165
86	val_86


-- !query 7
SELECT src1.c1, src2.c4
FROM
  (SELECT duplicateRowData.key as c1, duplicateRowData.value as c2 from duplicateRowData) src1
  JOIN
  (SELECT duplicateRowData.key as c3, duplicateRowData.value as c4 from duplicateRowData) src2
  ON src1.c1 = src2.c3 AND src1.c1 < 200
  JOIN
  (SELECT duplicateRowData.key as c5, duplicateRowData.value as c6 from duplicateRowData) src3
  ON src1.c1 = src3.c5 AND src3.c5 < 100
-- !query 7 schema
struct<c1:int,c4:string>
-- !query 7 output
86	val_86


-- !query 8
SELECT src1.c1, src2.c4
FROM
  (SELECT duplicateRowData.key as c1, duplicateRowData.value as c2 from duplicateRowData) src1
  JOIN
  (SELECT duplicateRowData.key as c3, duplicateRowData.value as c4 from duplicateRowData) src2
  ON src1.c1 = src2.c3 AND src1.c1 < 250
  JOIN
  (SELECT duplicateRowData.key as c5, duplicateRowData.value as c6 from duplicateRowData) src3
  ON src1.c1 + src2.c3 = src3.c5 AND src3.c5 < 400
-- !query 8 schema
struct<c1:int,c4:string>
-- !query 8 output
165	val_165
165	val_165
165	val_165
165	val_165


-- !query 9
FROM duplicateRowData JOIN srcpart
ON duplicateRowData.key = srcpart.key AND srcpart.ds = '2008-04-08' and duplicateRowData.key > 200
SELECT duplicateRowData.key, srcpart.value
-- !query 9 schema
struct<key:int,value:string>
-- !query 9 output
251	val_251
251	val_251
330	val_330
330	val_330


-- !query 10
SELECT a.k1, a.v1, a.k2, a.v2
  FROM (
  SELECT src1.key as k1, src1.value as v1, src2.key as k2, src2.value as v2
  FROM duplicateRowData src1 JOIN duplicateRowData src2 ON (src1.key = src2.key)
  SORT BY k1, v1, k2, v2
  ) a
-- !query 10 schema
struct<k1:int,v1:string,k2:int,v2:string>
-- !query 10 output
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
251	val_251	251	val_251
330	val_330	330	val_330
86	val_86	86	val_86


-- !query 11
SELECT subq.key, tab.value
FROM
(select a.key, a.value from duplicateRowData a where a.key > 100 ) subq
JOIN duplicateRowData tab
ON (subq.key = tab.key and subq.key > 150 and subq.value = tab.value)
where tab.key < 200
-- !query 11 schema
struct<key:int,value:string>
-- !query 11 output
165	val_165
165	val_165
165	val_165
165	val_165


-- !query 12
SELECT src1.*, src2.*
FROM duplicateRowData src1 JOIN duplicateRowData src2 ON (src1.key = src2.key)
-- !query 12 schema
struct<key:int,value:string,key:int,value:string>
-- !query 12 output
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
251	val_251	251	val_251
330	val_330	330	val_330
86	val_86	86	val_86


-- !query 13
SELECT src1.key, src2.value
FROM srcpart src1 JOIN duplicateRowData src2 ON (src1.key = src2.key)
where (src1.ds = '2008-04-08' or src1.ds = '2008-04-09' )and (src1.hr = '12' or src1.hr = '11')
-- !query 13 schema
struct<key:int,value:string>
-- !query 13 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
251	val_251
251	val_251
251	val_251
330	val_330
330	val_330
330	val_330
330	val_330
86	val_86
86	val_86
86	val_86
86	val_86


-- !query 14
SELECT src5.src1_value
FROM
  (SELECT src3.*, src4.value as src4_value, src4.key as src4_key
  FROM duplicateRowData src4
    JOIN (SELECT src2.*, src1.key as src1_key, src1.value as src1_value
      FROM duplicateRowData src1
        JOIN duplicateRowData src2 ON src1.key = src2.key) src3
    ON src3.src1_key = src4.key) src5
-- !query 14 schema
struct<src1_value:string>
-- !query 14 output
val_165
val_165
val_165
val_165
val_165
val_165
val_165
val_165
val_251
val_330
val_86


-- !query 15
SELECT  *  FROM duplicateRowData src1 JOIN duplicateRowData src2
WHERE src1.key < 200 and src2.key < 200
SORT BY src1.key, src1.value, src2.key, src2.value
-- !query 15 schema
struct<key:int,value:string,key:int,value:string>
-- !query 15 output
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	86	val_86
165	val_165	86	val_86
86	val_86	165	val_165
86	val_86	165	val_165
86	val_86	86	val_86


-- !query 16
WITH tst1 AS (SELECT a.key, count(1) as cnt FROM duplicateRowData a group by a.key)
SELECT sum(a.cnt) FROM tst1 a JOIN tst1 b ON a.key = b.key
-- !query 16 schema
struct<sum(cnt):bigint>
-- !query 16 output
5


-- !query 17
SELECT x.key, count(1)
FROM nullData x JOIN duplicateRowData y
ON (x.key = y.key) group by x.key order by x.key
-- !query 17 schema
struct<key:int,count(1):bigint>
-- !query 17 output
86	1
165	4
330	1


-- !query 18
SELECT count(1)
FROM
(
  SELECT duplicateRowData.key, duplicateRowData.value from duplicateRowData
  UNION ALL
  SELECT DISTINCT duplicateRowData.key, duplicateRowData.value from duplicateRowData
) src_12
JOIN
(
  SELECT duplicateRowData.key as k, duplicateRowData.value as v from duplicateRowData
) src3
ON src_12.key = src3.k AND src3.k < 300
-- !query 18 schema
struct<count(1):bigint>
-- !query 18 output
10


-- !query 19
FROM
(SELECT duplicateRowData.* FROM duplicateRowData sort by key) x
JOIN
(SELECT duplicateRowData.* FROM duplicateRowData sort by value) Y
ON (x.key = Y.key)
select Y.key,Y.value
-- !query 19 schema
struct<key:int,value:string>
-- !query 19 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 20
FROM
(SELECT duplicateRowData.* FROM duplicateRowData sort by key) x
JOIN
(SELECT duplicateRowData.* FROM duplicateRowData sort by value) Y
ON (x.key = Y.key)
JOIN
(SELECT duplicateRowData.* FROM duplicateRowData sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 20 schema
struct<key:int,value:string>
-- !query 20 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 21
SELECT x.key, x.value, subq1.value
FROM
( SELECT x.key as key, x.value as value from duplicateRowData x where x.key < 200
     UNION ALL
  SELECT x1.key as key, x1.value as value from duplicateRowData x1 where x1.key > 100
) subq1
JOIN nullData x ON (x.key = subq1.key)
-- !query 21 schema
struct<key:int,value:string,value:string>
-- !query 21 output
165	NULL	val_165
165	NULL	val_165
165	NULL	val_165
165	NULL	val_165
165	val_165	val_165
165	val_165	val_165
165	val_165	val_165
165	val_165	val_165
330	val_330	val_330
86	val_86	val_86


-- !query 22
SELECT x.key, x.value, subq1.cnt
FROM
( SELECT x.key as key, count(1) as cnt from duplicateRowData x where x.key < 200 group by x.key
     UNION ALL
  SELECT x1.key as key, count(1) as cnt from duplicateRowData x1 where x1.key > 100 group by x1.key
) subq1
JOIN nullData x ON (x.key = subq1.key)
-- !query 22 schema
struct<key:int,value:string,cnt:bigint>
-- !query 22 output
165	NULL	2
165	NULL	2
165	val_165	2
165	val_165	2
330	val_330	1
86	val_86	1


-- !query 23
SELECT x.key, COUNT(*)
FROM duplicateRowData x JOIN duplicateRowData y ON x.key = y.key
GROUP BY x.key
-- !query 23 schema
struct<key:int,count(1):bigint>
-- !query 23 output
165	4
251	1
330	1
86	1


-- !query 24
SELECT * FROM uppercasedata u JOIN lowercasedata l WHERE u.n = l.N
-- !query 24 schema
struct<N:int,L:string,n:int,l:string>
-- !query 24 output
1	A	1	a
2	B	2	b
3	C	3	c
4	D	4	d


-- !query 25
SELECT * FROM uppercasedata u JOIN lowercasedata l ON u.n = l.N
-- !query 25 schema
struct<N:int,L:string,n:int,l:string>
-- !query 25 output
1	A	1	a
2	B	2	b
3	C	3	c
4	D	4	d


-- !query 26
SELECT * FROM
  (SELECT * FROM duplicateColumnValueData WHERE a = 1) x JOIN
  (SELECT * FROM duplicateColumnValueData WHERE a = 1) y
WHERE x.a = y.a
-- !query 26 schema
struct<a:int,b:int,a:int,b:int>
-- !query 26 output
1	1	1	1
1	1	1	2
1	2	1	1
1	2	1	2


-- !query 27
SELECT * FROM
  (SELECT * FROM duplicateColumnValueData WHERE a = 1) x JOIN
  (SELECT * FROM duplicateColumnValueData WHERE a = 2) y
WHERE x.a = y.a
-- !query 27 schema
struct<a:int,b:int,a:int,b:int>
-- !query 27 output



-- !query 28
SELECT * FROM upperCaseData JOIN lowerCaseData ON lowerCaseData.n = upperCaseData.N
-- !query 28 schema
struct<N:int,L:string,n:int,l:string>
-- !query 28 output
1	A	1	a
2	B	2	b
3	C	3	c
4	D	4	d


-- !query 29
SELECT upperCaseData.N, upperCaseData.L FROM upperCaseData JOIN lowerCaseData
  ON lowerCaseData.n = upperCaseData.N
-- !query 29 schema
struct<N:int,L:string>
-- !query 29 output
1	A
2	B
3	C
4	D


-- !query 30
SELECT a.key, b.key, c.key
FROM uniqueRowData a,uniqueRowData b,uniqueRowData c
where a.key = b.key and a.key = c.key and a.key < 5
-- !query 30 schema
struct<key:int,key:int,key:int>
-- !query 30 output
1	1	1
2	2	2
3	3	3
4	4	4


-- !query 31
SELECT x.key, x.value, y.key, y.value, count(1) FROM
  (SELECT * FROM uniqueRowData UNION ALL
   SELECT * FROM uniqueRowData UNION ALL
   SELECT * FROM uniqueRowData UNION ALL
   SELECT * FROM uniqueRowData) x JOIN
  (SELECT * FROM uniqueRowData UNION ALL
   SELECT * FROM uniqueRowData UNION ALL
   SELECT * FROM uniqueRowData UNION ALL
   SELECT * FROM uniqueRowData) y
WHERE x.key = y.key group by x.key, x.value, y.key, y.value
-- !query 31 schema
struct<key:int,value:string,key:int,value:string,count(1):bigint>
-- !query 31 output
1	1	1	1	16
10	10	10	10	16
100	100	100	100	16
11	11	11	11	16
12	12	12	12	16
13	13	13	13	16
14	14	14	14	16
15	15	15	15	16
16	16	16	16	16
17	17	17	17	16
18	18	18	18	16
19	19	19	19	16
2	2	2	2	16
20	20	20	20	16
21	21	21	21	16
22	22	22	22	16
23	23	23	23	16
24	24	24	24	16
25	25	25	25	16
26	26	26	26	16
27	27	27	27	16
28	28	28	28	16
29	29	29	29	16
3	3	3	3	16
30	30	30	30	16
31	31	31	31	16
32	32	32	32	16
33	33	33	33	16
34	34	34	34	16
35	35	35	35	16
36	36	36	36	16
37	37	37	37	16
38	38	38	38	16
39	39	39	39	16
4	4	4	4	16
40	40	40	40	16
41	41	41	41	16
42	42	42	42	16
43	43	43	43	16
44	44	44	44	16
45	45	45	45	16
46	46	46	46	16
47	47	47	47	16
48	48	48	48	16
49	49	49	49	16
5	5	5	5	16
50	50	50	50	16
51	51	51	51	16
52	52	52	52	16
53	53	53	53	16
54	54	54	54	16
55	55	55	55	16
56	56	56	56	16
57	57	57	57	16
58	58	58	58	16
59	59	59	59	16
6	6	6	6	16
60	60	60	60	16
61	61	61	61	16
62	62	62	62	16
63	63	63	63	16
64	64	64	64	16
65	65	65	65	16
66	66	66	66	16
67	67	67	67	16
68	68	68	68	16
69	69	69	69	16
7	7	7	7	16
70	70	70	70	16
71	71	71	71	16
72	72	72	72	16
73	73	73	73	16
74	74	74	74	16
75	75	75	75	16
76	76	76	76	16
77	77	77	77	16
78	78	78	78	16
79	79	79	79	16
8	8	8	8	16
80	80	80	80	16
81	81	81	81	16
82	82	82	82	16
83	83	83	83	16
84	84	84	84	16
85	85	85	85	16
86	86	86	86	16
87	87	87	87	16
88	88	88	88	16
89	89	89	89	16
9	9	9	9	16
90	90	90	90	16
91	91	91	91	16
92	92	92	92	16
93	93	93	93	16
94	94	94	94	16
95	95	95	95	16
96	96	96	96	16
97	97	97	97	16
98	98	98	98	16
99	99	99	99	16


-- !query 32
SeleCT * from
  (select * from upperCaseData WherE N <= 4) leftTable fuLL OUtER joiN
  (sElEcT * FROM upperCaseData whERe N >= 3) rightTable
    oN leftTable.N = rightTable.N
-- !query 32 schema
struct<N:int,L:string,N:int,L:string>
-- !query 32 output
1	A	NULL	NULL
2	B	NULL	NULL
3	C	3	C
4	D	4	D
NULL	NULL	5	E
NULL	NULL	6	F


-- !query 33
SELECT * FROM nullData as a JOIN nullData as b on a.value <=> b.value
-- !query 33 schema
struct<key:int,value:string,key:int,value:string>
-- !query 33 output
165	NULL	165	NULL
165	NULL	201	NULL
165	NULL	NULL	NULL
165	val_165	165	val_165
201	NULL	165	NULL
201	NULL	201	NULL
201	NULL	NULL	NULL
330	val_330	330	val_330
86	val_86	86	val_86
NULL	NULL	165	NULL
NULL	NULL	201	NULL
NULL	NULL	NULL	NULL
NULL	val_null	NULL	val_null
