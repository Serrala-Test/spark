-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 46


-- !query 0
SELECT a.k1, a.v1, a.k2, a.v2
FROM (
SELECT src1.key as k1, src1.value as v1,
       src2.key as k2, src2.value as v2 FROM
  (SELECT * FROM src WHERE src.key < 200) src1
    JOIN
  (SELECT * FROM src WHERE src.key < 200) src2
  SORT BY k1, v1, k2, v2
) a
-- !query 0 schema
struct<k1:int,v1:string,k2:int,v2:string>
-- !query 0 output
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	86	val_86
165	val_165	86	val_86
86	val_86	165	val_165
86	val_86	165	val_165
86	val_86	86	val_86


-- !query 1
SELECT src1.key, src2.value
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
-- !query 1 schema
struct<key:int,value:string>
-- !query 1 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 2
SELECT src1.key, src3.value
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
  JOIN src src3 ON (src1.key + src2.key = src3.key)
-- !query 2 schema
struct<key:int,value:string>
-- !query 2 output
165	val_330
165	val_330
165	val_330
165	val_330


-- !query 3
SELECT src1.key, src3.value
FROM src src1 JOIN src src2 ON (src1.key = src2.key) JOIN src src3 ON (src1.key = src3.key)
-- !query 3 schema
struct<key:int,value:string>
-- !query 3 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 4
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
  SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
  FROM
  (
    SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 100 and src1.key < 300
  ) a
  LEFT OUTER JOIN
  (
    SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 200 and src2.key < 400
  ) b
  ON (a.c1 = b.c3)
) c
-- !query 4 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 4 output
165	val_165	NULL	NULL
165	val_165	NULL	NULL
251	val_251	251	val_251


-- !query 5
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
  SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
  FROM
  (
    SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 100 and src1.key < 300
  ) a
  RIGHT OUTER JOIN
  (
    SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 200 and src2.key < 400
  ) b
  ON (a.c1 = b.c3)
) c
-- !query 5 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 5 output
251	val_251	251	val_251
NULL	NULL	330	val_330


-- !query 6
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
 SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
 FROM
 (
   SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 100 and src1.key < 300
 ) a
 FULL OUTER JOIN
 (
   SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 200 and src2.key < 400
 ) b
 ON (a.c1 = b.c3)
) c
-- !query 6 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 6 output
165	val_165	NULL	NULL
165	val_165	NULL	NULL
251	val_251	251	val_251
NULL	NULL	330	val_330


-- !query 7
SELECT c.c1, c.c2, c.c3, c.c4, c.c5, c.c6
FROM (
  SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4, c.c5 AS c5, c.c6 AS c6
  FROM
  (
    SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 10 and src1.key < 150
  ) a
  FULL OUTER JOIN
  (
    SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 150 and src2.key < 300
  ) b
  ON (a.c1 = b.c3)
  LEFT OUTER JOIN
  (
    SELECT src3.key AS c5, src3.value AS c6 FROM src src3 WHERE src3.key > 200 and src3.key < 400
  ) c
  ON (a.c1 = c.c5)
) c
-- !query 7 schema
struct<c1:int,c2:string,c3:int,c4:string,c5:int,c6:string>
-- !query 7 output
86	val_86	NULL	NULL	NULL	NULL
NULL	NULL	165	val_165	NULL	NULL
NULL	NULL	165	val_165	NULL	NULL
NULL	NULL	251	val_251	NULL	NULL


-- !query 8
SELECT c.c1, c.c2, c.c3, c.c4
FROM (
 SELECT a.c1 AS c1, a.c2 AS c2, b.c3 AS c3, b.c4 AS c4
 FROM
 (
   SELECT src1.key AS c1, src1.value AS c2 FROM src src1 WHERE src1.key > 100 and src1.key < 300
 ) a
 LEFT OUTER JOIN
 (
   SELECT src2.key AS c3, src2.value AS c4 FROM src src2 WHERE src2.key > 200 and src2.key < 400
 ) b
 ON (a.c1 = b.c3)
) c
where c.c3 IS NULL AND c.c1 IS NOT NULL
-- !query 8 schema
struct<c1:int,c2:string,c3:int,c4:string>
-- !query 8 output
165	val_165	NULL	NULL
165	val_165	NULL	NULL


-- !query 9
SELECT src1.key, src2.value
FROM srcpart src1 JOIN src src2 ON (src1.key = src2.key)
WHERE src1.ds = '2008-04-08' and src1.hr = '12'
-- !query 9 schema
struct<key:int,value:string>
-- !query 9 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 10
FROM
(SELECT src.* FROM src) x
JOIN
(SELECT src.* FROM src) Y
ON (x.key = Y.key)
select Y.key, Y.value
-- !query 10 schema
struct<key:int,value:string>
-- !query 10 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 11
SELECT src1.c1, src2.c4
FROM
  (SELECT src.key as c1, src.value as c2 from src) src1
  JOIN
  (SELECT src.key as c3, src.value as c4 from src) src2
  ON src1.c1 = src2.c3 AND src1.c1 < 200
-- !query 11 schema
struct<c1:int,c4:string>
-- !query 11 output
165	val_165
165	val_165
165	val_165
165	val_165
86	val_86


-- !query 12
SELECT src1.c1, src2.c4
FROM
  (SELECT src.key as c1, src.value as c2 from src) src1
  JOIN
  (SELECT src.key as c3, src.value as c4 from src) src2
  ON src1.c1 = src2.c3 AND src1.c1 < 200
  JOIN
  (SELECT src.key as c5, src.value as c6 from src) src3
  ON src1.c1 = src3.c5 AND src3.c5 < 100
-- !query 12 schema
struct<c1:int,c4:string>
-- !query 12 output
86	val_86


-- !query 13
SELECT src1.c1, src2.c4
FROM
  (SELECT src.key as c1, src.value as c2 from src) src1
  JOIN
  (SELECT src.key as c3, src.value as c4 from src) src2
  ON src1.c1 = src2.c3 AND src1.c1 < 250
  JOIN
  (SELECT src.key as c5, src.value as c6 from src) src3
  ON src1.c1 + src2.c3 = src3.c5 AND src3.c5 < 400
-- !query 13 schema
struct<c1:int,c4:string>
-- !query 13 output
165	val_165
165	val_165
165	val_165
165	val_165


-- !query 14
FROM src JOIN srcpart ON src.key = srcpart.key AND srcpart.ds = '2008-04-08' and src.key > 200
SELECT src.key, srcpart.value
-- !query 14 schema
struct<key:int,value:string>
-- !query 14 output
251	val_251
251	val_251
330	val_330
330	val_330


-- !query 15
SELECT a.k1, a.v1, a.k2, a.v2
  FROM (
  SELECT src1.key as k1, src1.value as v1, src2.key as k2, src2.value as v2
  FROM src src1 JOIN src src2 ON (src1.key = src2.key)
  SORT BY k1, v1, k2, v2
  ) a
-- !query 15 schema
struct<k1:int,v1:string,k2:int,v2:string>
-- !query 15 output
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
251	val_251	251	val_251
330	val_330	330	val_330
86	val_86	86	val_86


-- !query 16
SELECT subq.key, tab.value
FROM
(select a.key, a.value from src a where a.key > 100 ) subq
JOIN src tab
ON (subq.key = tab.key and subq.key > 150 and subq.value = tab.value)
where tab.key < 200
-- !query 16 schema
struct<key:int,value:string>
-- !query 16 output
165	val_165
165	val_165
165	val_165
165	val_165


-- !query 17
SELECT src1.*, src2.*
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
-- !query 17 schema
struct<key:int,value:string,key:int,value:string>
-- !query 17 output
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
251	val_251	251	val_251
330	val_330	330	val_330
86	val_86	86	val_86


-- !query 18
SELECT a.key, a.value, b.key, b.value
FROM
  (
    SELECT src1.key as key, count(src1.value) AS value FROM src src1 group by src1.key
  ) a
  FULL OUTER JOIN
  (
    SELECT src2.key as key, count(distinct(src2.value)) AS value
    FROM src1 src2 group by src2.key
  ) b
ON (a.key = b.key)
-- !query 18 schema
struct<key:int,value:bigint,key:int,value:bigint>
-- !query 18 output
165	2	165	1
251	1	NULL	NULL
330	1	330	1
86	1	86	1
NULL	NULL	201	0
NULL	NULL	NULL	1


-- !query 19
SELECT a.key, a.value, b.key, b.value1, b.value2
FROM
  (
    SELECT src1.key as key, count(src1.value) AS value FROM src src1 group by src1.key
  ) a
  FULL OUTER JOIN
  (
    SELECT src2.key as key, count(distinct(src2.value)) AS value1,
      count(distinct(src2.key)) AS value2
    FROM src1 src2 group by src2.key
  ) b
ON (a.key = b.key)
-- !query 19 schema
struct<key:int,value:bigint,key:int,value1:bigint,value2:bigint>
-- !query 19 output
165	2	165	1	1
251	1	NULL	NULL	NULL
330	1	330	1	1
86	1	86	1	1
NULL	NULL	201	0	1
NULL	NULL	NULL	1	0


-- !query 20
SELECT src1.key, src2.value
FROM srcpart src1 JOIN src src2 ON (src1.key = src2.key)
where (src1.ds = '2008-04-08' or src1.ds = '2008-04-09' )and (src1.hr = '12' or src1.hr = '11')
-- !query 20 schema
struct<key:int,value:string>
-- !query 20 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
251	val_251
251	val_251
251	val_251
330	val_330
330	val_330
330	val_330
330	val_330
86	val_86
86	val_86
86	val_86
86	val_86


-- !query 21
SELECT a.k1,a.v1,a.k2,a.v2,a.k3,a.v3
FROM (
  SELECT src1.key as k1, src1.value as v1, src2.key as k2, src2.value as v2 , src3.key as k3, src3.value as v3
  FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key < 200)
    RIGHT OUTER JOIN src src3 ON (src1.key = src3.key AND src3.key < 300)
  SORT BY k1,v1,k2,v2,k3,v3
)a
-- !query 21 schema
struct<k1:int,v1:string,k2:int,v2:string,k3:int,v3:string>
-- !query 21 output
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
165	val_165	165	val_165	165	val_165
86	val_86	86	val_86	86	val_86
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330


-- !query 22
SELECT a.k1,a.v1,a.k2,a.v2,a.k3,a.v3
FROM (
  SELECT src1.key as k1, src1.value as v1, src2.key as k2, src2.value as v2 , src3.key as k3, src3.value as v3
  FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key < 100)
    RIGHT OUTER JOIN src src3 ON (src1.key = src3.key AND src3.key < 300)
  SORT BY k1,v1,k2,v2,k3,v3
)a
-- !query 22 schema
struct<k1:int,v1:string,k2:int,v2:string,k3:int,v3:string>
-- !query 22 output
86	val_86	86	val_86	86	val_86
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330


-- !query 23
SELECT *
FROM
  src src1
  LEFT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
  RIGHT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 23 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 23 output
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330
NULL	NULL	NULL	NULL	86	val_86


-- !query 24
SELECT src5.src1_value
FROM
  (SELECT src3.*, src4.value as src4_value, src4.key as src4_key
  FROM src src4
    JOIN (SELECT src2.*, src1.key as src1_key, src1.value as src1_value
      FROM src src1
        JOIN src src2 ON src1.key = src2.key) src3
    ON src3.src1_key = src4.key) src5
-- !query 24 schema
struct<src1_value:string>
-- !query 24 output
val_165
val_165
val_165
val_165
val_165
val_165
val_165
val_165
val_251
val_330
val_86


-- !query 25
SELECT  *  FROM src src1 JOIN src src2
WHERE src1.key < 200 and src2.key < 200
SORT BY src1.key, src1.value, src2.key, src2.value
-- !query 25 schema
struct<key:int,value:string,key:int,value:string>
-- !query 25 output
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	86	val_86
165	val_165	86	val_86
86	val_86	165	val_165
86	val_86	165	val_165
86	val_86	86	val_86


-- !query 26
WITH tst1 AS (SELECT a.key, count(1) as cnt FROM src a group by a.key)
SELECT sum(a.cnt) FROM tst1 a JOIN tst1 b ON a.key = b.key
-- !query 26 schema
struct<sum(cnt):bigint>
-- !query 26 output
5


-- !query 27
SELECT x.key, count(1) FROM src1 x JOIN src y ON (x.key = y.key) group by x.key order by x.key
-- !query 27 schema
struct<key:int,count(1):bigint>
-- !query 27 output
86	1
165	4
330	1


-- !query 28
SELECT count(1)
FROM
(
  SELECT src.key, src.value from src
  UNION ALL
  SELECT DISTINCT src.key, src.value from src
) src_12
JOIN
(
  SELECT src.key as k, src.value as v from src
) src3
ON src_12.key = src3.k AND src3.k < 300
-- !query 28 schema
struct<count(1):bigint>
-- !query 28 output
10


-- !query 29
SELECT * FROM src src1
 LEFT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 RIGHT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 29 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 29 output
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330
NULL	NULL	NULL	NULL	86	val_86


-- !query 30
SELECT * FROM src src1
 RIGHT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 RIGHT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 30 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 30 output
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	86	val_86	86	val_86
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330


-- !query 31
SELECT * FROM src src1
 LEFT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 LEFT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 31 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 31 output
165	val_165	NULL	NULL	NULL	NULL
165	val_165	NULL	NULL	NULL	NULL
251	val_251	NULL	NULL	NULL	NULL
330	val_330	NULL	NULL	NULL	NULL
86	val_86	NULL	NULL	NULL	NULL


-- !query 32
SELECT * FROM src src1
 RIGHT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 LEFT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 32 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 32 output
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	251	val_251	NULL	NULL
NULL	NULL	330	val_330	NULL	NULL
NULL	NULL	86	val_86	86	val_86


-- !query 33
SELECT * FROM src src1
 JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 LEFT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 33 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 33 output



-- !query 34
SELECT * FROM src src1
 JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 RIGHT OUTER JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 34 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 34 output
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	165	val_165
NULL	NULL	NULL	NULL	251	val_251
NULL	NULL	NULL	NULL	330	val_330
NULL	NULL	NULL	NULL	86	val_86


-- !query 35
SELECT * FROM src src1
 LEFT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 35 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 35 output



-- !query 36
SELECT * FROM src src1
 RIGHT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key < 200 AND src2.key > 200)
 JOIN src src3 ON (src2.key = src3.key AND src3.key < 200)
 SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
-- !query 36 schema
struct<key:int,value:string,key:int,value:string,key:int,value:string>
-- !query 36 output
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	165	val_165	165	val_165
NULL	NULL	86	val_86	86	val_86


-- !query 37
FROM
(SELECT src.* FROM src sort by key) x
JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
select Y.key,Y.value
-- !query 37 schema
struct<key:int,value:string>
-- !query 37 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 38
FROM
(SELECT src.* FROM src sort by key) x
LEFT OUTER JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
select Y.key,Y.value
-- !query 38 schema
struct<key:int,value:string>
-- !query 38 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 39
FROM
(SELECT src.* FROM src sort by key) x
RIGHT OUTER JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
select Y.key,Y.value
-- !query 39 schema
struct<key:int,value:string>
-- !query 39 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 40
FROM
(SELECT src.* FROM src sort by key) x
JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
JOIN
(SELECT src.* FROM src sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 40 schema
struct<key:int,value:string>
-- !query 40 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 41
FROM
(SELECT src.* FROM src sort by key) x
JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
LEFT OUTER JOIN
(SELECT src.* FROM src sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 41 schema
struct<key:int,value:string>
-- !query 41 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 42
FROM
(SELECT src.* FROM src sort by key) x
LEFT OUTER JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
LEFT OUTER JOIN
(SELECT src.* FROM src sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 42 schema
struct<key:int,value:string>
-- !query 42 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 43
FROM
(SELECT src.* FROM src sort by key) x
LEFT OUTER JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
RIGHT OUTER JOIN
(SELECT src.* FROM src sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 43 schema
struct<key:int,value:string>
-- !query 43 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 44
FROM
(SELECT src.* FROM src sort by key) x
RIGHT OUTER JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
RIGHT OUTER JOIN
(SELECT src.* FROM src sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 44 schema
struct<key:int,value:string>
-- !query 44 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 45
FROM
(SELECT src.* FROM src sort by key) x
RIGHT OUTER JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
JOIN
(SELECT src.* FROM src sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 45 schema
struct<key:int,value:string>
-- !query 45 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86
