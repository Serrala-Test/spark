-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 31


-- !query 0
SELECT a.k1, a.v1, a.k2, a.v2
FROM (
SELECT src1.key as k1, src1.value as v1,
       src2.key as k2, src2.value as v2 FROM
  (SELECT * FROM src WHERE src.key < 200) src1
    JOIN
  (SELECT * FROM src WHERE src.key < 200) src2
  SORT BY k1, v1, k2, v2
) a
-- !query 0 schema
struct<k1:int,v1:string,k2:int,v2:string>
-- !query 0 output
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	86	val_86
165	val_165	86	val_86
86	val_86	165	val_165
86	val_86	165	val_165
86	val_86	86	val_86


-- !query 1
SELECT src1.key, src2.value
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
-- !query 1 schema
struct<key:int,value:string>
-- !query 1 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 2
SELECT src1.key, src3.value
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
  JOIN src src3 ON (src1.key + src2.key = src3.key)
-- !query 2 schema
struct<key:int,value:string>
-- !query 2 output
165	val_330
165	val_330
165	val_330
165	val_330


-- !query 3
SELECT src1.key, src3.value
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
 JOIN src src3 ON (src1.key = src3.key)
-- !query 3 schema
struct<key:int,value:string>
-- !query 3 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 4
SELECT src1.key, src2.value
FROM srcpart src1 JOIN src src2 ON (src1.key = src2.key)
WHERE src1.ds = '2008-04-08' and src1.hr = '12'
-- !query 4 schema
struct<key:int,value:string>
-- !query 4 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 5
FROM
(SELECT src.* FROM src) x
JOIN
(SELECT src.* FROM src) Y
ON (x.key = Y.key)
select Y.key, Y.value
-- !query 5 schema
struct<key:int,value:string>
-- !query 5 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 6
SELECT src1.c1, src2.c4
FROM
  (SELECT src.key as c1, src.value as c2 from src) src1
  JOIN
  (SELECT src.key as c3, src.value as c4 from src) src2
  ON src1.c1 = src2.c3 AND src1.c1 < 200
-- !query 6 schema
struct<c1:int,c4:string>
-- !query 6 output
165	val_165
165	val_165
165	val_165
165	val_165
86	val_86


-- !query 7
SELECT src1.c1, src2.c4
FROM
  (SELECT src.key as c1, src.value as c2 from src) src1
  JOIN
  (SELECT src.key as c3, src.value as c4 from src) src2
  ON src1.c1 = src2.c3 AND src1.c1 < 200
  JOIN
  (SELECT src.key as c5, src.value as c6 from src) src3
  ON src1.c1 = src3.c5 AND src3.c5 < 100
-- !query 7 schema
struct<c1:int,c4:string>
-- !query 7 output
86	val_86


-- !query 8
SELECT src1.c1, src2.c4
FROM
  (SELECT src.key as c1, src.value as c2 from src) src1
  JOIN
  (SELECT src.key as c3, src.value as c4 from src) src2
  ON src1.c1 = src2.c3 AND src1.c1 < 250
  JOIN
  (SELECT src.key as c5, src.value as c6 from src) src3
  ON src1.c1 + src2.c3 = src3.c5 AND src3.c5 < 400
-- !query 8 schema
struct<c1:int,c4:string>
-- !query 8 output
165	val_165
165	val_165
165	val_165
165	val_165


-- !query 9
FROM src JOIN srcpart ON src.key = srcpart.key AND srcpart.ds = '2008-04-08' and src.key > 200
SELECT src.key, srcpart.value
-- !query 9 schema
struct<key:int,value:string>
-- !query 9 output
251	val_251
251	val_251
330	val_330
330	val_330


-- !query 10
SELECT a.k1, a.v1, a.k2, a.v2
  FROM (
  SELECT src1.key as k1, src1.value as v1, src2.key as k2, src2.value as v2
  FROM src src1 JOIN src src2 ON (src1.key = src2.key)
  SORT BY k1, v1, k2, v2
  ) a
-- !query 10 schema
struct<k1:int,v1:string,k2:int,v2:string>
-- !query 10 output
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
251	val_251	251	val_251
330	val_330	330	val_330
86	val_86	86	val_86


-- !query 11
SELECT subq.key, tab.value
FROM
(select a.key, a.value from src a where a.key > 100 ) subq
JOIN src tab
ON (subq.key = tab.key and subq.key > 150 and subq.value = tab.value)
where tab.key < 200
-- !query 11 schema
struct<key:int,value:string>
-- !query 11 output
165	val_165
165	val_165
165	val_165
165	val_165


-- !query 12
SELECT src1.*, src2.*
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
-- !query 12 schema
struct<key:int,value:string,key:int,value:string>
-- !query 12 output
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
251	val_251	251	val_251
330	val_330	330	val_330
86	val_86	86	val_86


-- !query 13
SELECT src1.key, src2.value
FROM srcpart src1 JOIN src src2 ON (src1.key = src2.key)
where (src1.ds = '2008-04-08' or src1.ds = '2008-04-09' )and (src1.hr = '12' or src1.hr = '11')
-- !query 13 schema
struct<key:int,value:string>
-- !query 13 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
251	val_251
251	val_251
251	val_251
330	val_330
330	val_330
330	val_330
330	val_330
86	val_86
86	val_86
86	val_86
86	val_86


-- !query 14
SELECT src5.src1_value
FROM
  (SELECT src3.*, src4.value as src4_value, src4.key as src4_key
  FROM src src4
    JOIN (SELECT src2.*, src1.key as src1_key, src1.value as src1_value
      FROM src src1
        JOIN src src2 ON src1.key = src2.key) src3
    ON src3.src1_key = src4.key) src5
-- !query 14 schema
struct<src1_value:string>
-- !query 14 output
val_165
val_165
val_165
val_165
val_165
val_165
val_165
val_165
val_251
val_330
val_86


-- !query 15
SELECT  *  FROM src src1 JOIN src src2
WHERE src1.key < 200 and src2.key < 200
SORT BY src1.key, src1.value, src2.key, src2.value
-- !query 15 schema
struct<key:int,value:string,key:int,value:string>
-- !query 15 output
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	165	val_165
165	val_165	86	val_86
165	val_165	86	val_86
86	val_86	165	val_165
86	val_86	165	val_165
86	val_86	86	val_86


-- !query 16
WITH tst1 AS (SELECT a.key, count(1) as cnt FROM src a group by a.key)
SELECT sum(a.cnt) FROM tst1 a JOIN tst1 b ON a.key = b.key
-- !query 16 schema
struct<sum(cnt):bigint>
-- !query 16 output
5


-- !query 17
SELECT x.key, count(1) FROM src1 x JOIN src y ON (x.key = y.key) group by x.key order by x.key
-- !query 17 schema
struct<key:int,count(1):bigint>
-- !query 17 output
86	1
165	4
330	1


-- !query 18
SELECT count(1)
FROM
(
  SELECT src.key, src.value from src
  UNION ALL
  SELECT DISTINCT src.key, src.value from src
) src_12
JOIN
(
  SELECT src.key as k, src.value as v from src
) src3
ON src_12.key = src3.k AND src3.k < 300
-- !query 18 schema
struct<count(1):bigint>
-- !query 18 output
10


-- !query 19
FROM
(SELECT src.* FROM src sort by key) x
JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
select Y.key,Y.value
-- !query 19 schema
struct<key:int,value:string>
-- !query 19 output
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 20
FROM
(SELECT src.* FROM src sort by key) x
JOIN
(SELECT src.* FROM src sort by value) Y
ON (x.key = Y.key)
JOIN
(SELECT src.* FROM src sort by value) Z
ON (x.key = Z.key)
select Y.key,Y.value
-- !query 20 schema
struct<key:int,value:string>
-- !query 20 output
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
165	val_165
251	val_251
330	val_330
86	val_86


-- !query 21
SELECT x.key, x.value, subq1.value
FROM
( SELECT x.key as key, x.value as value from src x where x.key < 200
     UNION ALL
  SELECT x1.key as key, x1.value as value from src x1 where x1.key > 100
) subq1
JOIN src1 x ON (x.key = subq1.key)
-- !query 21 schema
struct<key:int,value:string,value:string>
-- !query 21 output
165	NULL	val_165
165	NULL	val_165
165	NULL	val_165
165	NULL	val_165
165	val_165	val_165
165	val_165	val_165
165	val_165	val_165
165	val_165	val_165
330	val_330	val_330
86	val_86	val_86


-- !query 22
SELECT x.key, x.value, subq1.cnt
FROM
( SELECT x.key as key, count(1) as cnt from src x where x.key < 200 group by x.key
     UNION ALL
  SELECT x1.key as key, count(1) as cnt from src x1 where x1.key > 100 group by x1.key
) subq1
JOIN src1 x ON (x.key = subq1.key)
-- !query 22 schema
struct<key:int,value:string,cnt:bigint>
-- !query 22 output
165	NULL	2
165	NULL	2
165	val_165	2
165	val_165	2
330	val_330	1
86	val_86	1


-- !query 23
SELECT x.key, COUNT(*)
FROM src x JOIN src y ON x.key = y.key
GROUP BY x.key
-- !query 23 schema
struct<key:int,count(1):bigint>
-- !query 23 output
165	4
251	1
330	1
86	1


-- !query 24
SELECT * FROM uppercasedata u JOIN lowercasedata l WHERE u.n = l.N
-- !query 24 schema
struct<N:int,L:string,n:int,l:string>
-- !query 24 output
1	A	1	a
2	B	2	b
3	C	3	c
4	D	4	d


-- !query 25
SELECT * FROM uppercasedata u JOIN lowercasedata l ON u.n = l.N
-- !query 25 schema
struct<N:int,L:string,n:int,l:string>
-- !query 25 output
1	A	1	a
2	B	2	b
3	C	3	c
4	D	4	d


-- !query 26
SELECT * FROM
  (SELECT * FROM testdata2 WHERE a = 1) x JOIN
  (SELECT * FROM testdata2 WHERE a = 1) y
WHERE x.a = y.a
-- !query 26 schema
struct<a:int,b:int,a:int,b:int>
-- !query 26 output
1	1	1	1
1	1	1	2
1	2	1	1
1	2	1	2


-- !query 27
SELECT * FROM
  (SELECT * FROM testData2 WHERE a = 1) x JOIN
  (SELECT * FROM testData2 WHERE a = 2) y
WHERE x.a = y.a
-- !query 27 schema
struct<a:int,b:int,a:int,b:int>
-- !query 27 output



-- !query 28
SELECT * FROM upperCaseData JOIN lowerCaseData ON lowerCaseData.n = upperCaseData.N
-- !query 28 schema
struct<N:int,L:string,n:int,l:string>
-- !query 28 output
1	A	1	a
2	B	2	b
3	C	3	c
4	D	4	d


-- !query 29
SELECT upperCaseData.N, upperCaseData.L FROM upperCaseData JOIN lowerCaseData
  ON lowerCaseData.n = upperCaseData.N
-- !query 29 schema
struct<N:int,L:string>
-- !query 29 output
1	A
2	B
3	C
4	D


-- !query 30
SELECT a.key, b.key, c.key
FROM testData a,testData b,testData c
where a.key = b.key and a.key = c.key and a.key < 5
-- !query 30 schema
struct<key:int,key:int,key:int>
-- !query 30 output
1	1	1
2	2	2
3	3	3
4	4	4
