-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 28


-- !query 0
CREATE TABLE t (a STRING, b INT, c STRING, d STRING) USING parquet
  PARTITIONED BY (c, d) CLUSTERED BY (a) SORTED BY (b ASC) INTO 2 BUCKETS
  COMMENT 'table_comment'
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
CREATE TEMPORARY VIEW temp_v AS SELECT * FROM t
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
CREATE VIEW v AS SELECT * FROM t
-- !query 2 schema
struct<>
-- !query 2 output



-- !query 3
ALTER TABLE t ADD PARTITION (c='Us', d=1)
-- !query 3 schema
struct<>
-- !query 3 output



-- !query 4
DESCRIBE t
-- !query 4 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 4 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query 5
DESC t
-- !query 5 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 5 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query 6
DESC TABLE t
-- !query 6 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 6 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query 7
DESC FORMATTED t
-- !query 7 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 7 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Table               	`default`.`t`       	                    
Created[removed by SQLQueryTestSuite]
Last Access[removed by SQLQueryTestSuite]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Comment             	table_comment       	                    
Location[removed by SQLQueryTestSuite]sql/core/spark-warehouse/t	                    
Partition Provider  	Catalog             	                    
Partition Columns   	[`c`, `d`]          	                    
Schema              	root
 |-- a: string (nullable = true)
 |-- b: integer (nullable = true)
 |-- c: string (nullable = true)
 |-- d: string (nullable = true)


-- !query 8
DESC EXTENDED t
-- !query 8 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 8 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Table               	`default`.`t`       	                    
Created[removed by SQLQueryTestSuite]
Last Access[removed by SQLQueryTestSuite]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Comment             	table_comment       	                    
Location[removed by SQLQueryTestSuite]sql/core/spark-warehouse/t	                    
Partition Provider  	Catalog             	                    
Partition Columns   	[`c`, `d`]          	                    
Schema              	root
 |-- a: string (nullable = true)
 |-- b: integer (nullable = true)
 |-- c: string (nullable = true)
 |-- d: string (nullable = true)


-- !query 9
DESC t PARTITION (c='Us', d=1)
-- !query 9 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 9 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query 10
DESC EXTENDED t PARTITION (c='Us', d=1)
-- !query 10 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 10 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[c=Us, d=1]         	                    
Location[removed by SQLQueryTestSuite]sql/core/spark-warehouse/t/c=Us/d=1	                    
                    	                    	                    
# Table Storage Information	                    	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Location[removed by SQLQueryTestSuite]sql/core/spark-warehouse/t


-- !query 11
DESC FORMATTED t PARTITION (c='Us', d=1)
-- !query 11 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 11 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[c=Us, d=1]         	                    
Location[removed by SQLQueryTestSuite]sql/core/spark-warehouse/t/c=Us/d=1	                    
                    	                    	                    
# Table Storage Information	                    	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Location[removed by SQLQueryTestSuite]sql/core/spark-warehouse/t


-- !query 12
DESC t PARTITION (c='Us', d=2)
-- !query 12 schema
struct<>
-- !query 12 output
org.apache.spark.sql.catalyst.analysis.NoSuchPartitionException
Partition not found in table 't' database 'default':
c -> Us
d -> 2;


-- !query 13
DESC t PARTITION (c='Us')
-- !query 13 schema
struct<>
-- !query 13 output
org.apache.spark.sql.AnalysisException
Partition spec is invalid. The spec (c) must match the partition spec (c, d) defined in table '`default`.`t`';


-- !query 14
DESC t PARTITION (c='Us', d)
-- !query 14 schema
struct<>
-- !query 14 output
org.apache.spark.sql.catalyst.parser.ParseException

PARTITION specification is incomplete: `d`(line 1, pos 0)

== SQL ==
DESC t PARTITION (c='Us', d)
^^^


-- !query 15
DESC temp_v
-- !query 15 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 15 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 16
DESC TABLE temp_v
-- !query 16 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 16 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 17
DESC FORMATTED temp_v
-- !query 17 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 17 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 18
DESC EXTENDED temp_v
-- !query 18 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 18 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 19
DESC temp_v PARTITION (c='Us', d=1)
-- !query 19 schema
struct<>
-- !query 19 output
org.apache.spark.sql.AnalysisException
DESC PARTITION is not allowed on a temporary view: temp_v;


-- !query 20
DESC v
-- !query 20 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 20 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 21
DESC TABLE v
-- !query 21 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 21 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 22
DESC FORMATTED v
-- !query 22 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 22 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Table               	`default`.`v`       	                    
Created[removed by SQLQueryTestSuite]
Last Access[removed by SQLQueryTestSuite]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Default Database	default             	                    
View Query Output Columns	[a, b, c, d]        	                    
Properties          	[view.query.out.col.3=d, view.query.out.col.0=a, view.query.out.numCols=4, view.default.database=default, view.query.out.col.1=b, view.query.out.col.2=c]	                    
Schema              	root
 |-- a: string (nullable = true)
 |-- b: integer (nullable = true)
 |-- c: string (nullable = true)
 |-- d: string (nullable = true)


-- !query 23
DESC EXTENDED v
-- !query 23 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 23 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Table               	`default`.`v`       	                    
Created[removed by SQLQueryTestSuite]
Last Access[removed by SQLQueryTestSuite]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Default Database	default             	                    
View Query Output Columns	[a, b, c, d]        	                    
Properties          	[view.query.out.col.3=d, view.query.out.col.0=a, view.query.out.numCols=4, view.default.database=default, view.query.out.col.1=b, view.query.out.col.2=c]	                    
Schema              	root
 |-- a: string (nullable = true)
 |-- b: integer (nullable = true)
 |-- c: string (nullable = true)
 |-- d: string (nullable = true)


-- !query 24
DESC v PARTITION (c='Us', d=1)
-- !query 24 schema
struct<>
-- !query 24 output
org.apache.spark.sql.AnalysisException
DESC PARTITION is not allowed on a view: v;


-- !query 25
DROP TABLE t
-- !query 25 schema
struct<>
-- !query 25 output



-- !query 26
DROP VIEW temp_v
-- !query 26 schema
struct<>
-- !query 26 output



-- !query 27
DROP VIEW v
-- !query 27 schema
struct<>
-- !query 27 output

