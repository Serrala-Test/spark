-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 11


-- !query 0
CREATE TABLE t (a STRING, b INT) PARTITIONED BY (c STRING, d STRING)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
ALTER TABLE t ADD PARTITION (c='Us', d=1)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
DESC t
-- !query 2 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 2 output
# Partition Information	                    	                    
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
c                   	string              	                    
d                   	string              	                    
d                   	string


-- !query 3
DESC EXTENDED t
-- !query 3 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 3 output
# Detailed Table Information	CatalogTable(
	Table: `default`.`t`
	Created: Fri Sep 23 12:30:40 PDT 2016
	Last Access: Wed Dec 31 15:59:59 PST 1969
	Type: MANAGED
	Schema: [StructField(a,StringType,true), StructField(b,IntegerType,true), StructField(c,StringType,true), StructField(d,StringType,true)]
	Provider: hive
	Partition Columns: [`c`, `d`]
	Storage(InputFormat: org.apache.hadoop.mapred.TextInputFormat, OutputFormat: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat))	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
c                   	string              	                    
d                   	string              	                    
d                   	string


-- !query 4
DESC FORMATTED t
-- !query 4 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 4 output
# Detailed Table Information	                    	                    
# Partition Information	                    	                    
# Storage Information	                    	                    
# col_name          	data_type           	comment             
Compressed:         	No                  	                    
Create Time:        	Fri Sep 23 12:30:40 PDT 2016	                    
Database:           	default             	                    
InputFormat:        	org.apache.hadoop.mapred.TextInputFormat	                    
Last Access Time:   	Wed Dec 31 15:59:59 PST 1969	                    
Location:           	                    	                    
OutputFormat:       	org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat	                    
Owner:              	                    	                    
Storage Desc Parameters:	                    	                    
Table Parameters:   	                    	                    
Table Type:         	MANAGED             	                    
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
c                   	string              	                    
d                   	string              	                    
d                   	string


-- !query 5
DESC t PARTITION (c='Us', d=1)
-- !query 5 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 5 output
# Partition Information	                    	                    
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
c                   	string              	                    
d                   	string              	                    
d                   	string


-- !query 6
DESC EXTENDED t PARTITION (c='Us', d=1)
-- !query 6 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 6 output
# Partition Information	                    	                    
# col_name          	data_type           	comment             
Detailed Partition Information CatalogPartition(
	Partition Values: [Us, 1]
	Storage(InputFormat: org.apache.hadoop.mapred.TextInputFormat, OutputFormat: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat)
	Partition Parameters:{})	                    	                    
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
c                   	string              	                    
d                   	string              	                    
d                   	string


-- !query 7
DESC FORMATTED t PARTITION (c='Us', d=1)
-- !query 7 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 7 output
# Detailed Partition Information	                    	                    
# Partition Information	                    	                    
# Storage Information	                    	                    
# col_name          	data_type           	comment             
Compressed:         	No                  	                    
Create Time:        	UNKNOWN             	                    
Database:           	default             	                    
InputFormat:        	org.apache.hadoop.mapred.TextInputFormat	                    
Last Access Time:   	UNKNOWN             	                    
Location:           	                    	                    
OutputFormat:       	org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat	                    
Partition Parameters:	                    	                    
Partition Value:    	[Us, 1]             	                    
Protect Mode:       	None                	                    
Storage Desc Parameters:	                    	                    
Table:              	t                   	                    
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
c                   	string              	                    
d                   	string              	                    
d                   	string


-- !query 8
DESC t PARTITION (c='Us', d=2)
-- !query 8 schema
struct<>
-- !query 8 output
org.apache.spark.sql.catalyst.analysis.NoSuchPartitionException
Partition not found in table 't' database 'default':
c -> Us
d -> 2;


-- !query 9
DESC t PARTITION (c='Us')
-- !query 9 schema
struct<>
-- !query 9 output
org.apache.spark.sql.AnalysisException
Partition spec is invalid. The spec (c) must match the partition spec (c, d) defined in table '`default`.`t`';


-- !query 10
DESC t PARTITION (c='Us', d)
-- !query 10 schema
struct<>
-- !query 10 output
org.apache.spark.sql.catalyst.parser.ParseException

Unsupported SQL statement
== SQL ==
DESC t PARTITION (c='Us', d)
