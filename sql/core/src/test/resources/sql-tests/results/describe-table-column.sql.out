-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 15


-- !query 0
CREATE TEMPORARY VIEW desc_col_temp_table (key int COMMENT 'column_comment') USING PARQUET
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
DESC desc_col_temp_table key
-- !query 1 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 1 output
col_name 	data_type 	comment        	
key      	int       	column_comment


-- !query 2
DESC EXTENDED desc_col_temp_table key
-- !query 2 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 2 output
col_name 	data_type 	comment        	
key      	int       	column_comment


-- !query 3
DESC FORMATTED desc_col_temp_table key
-- !query 3 schema
struct<col_name:string,data_type:string,min:string,max:string,num_nulls:string,distinct_count:string,avg_col_len:string,max_col_len:string,comment:string>
-- !query 3 output
col_name 	data_type 	min  	max  	num_nulls 	distinct_count 	avg_col_len 	max_col_len 	comment        	
key      	int       	NULL 	NULL 	NULL      	NULL           	NULL        	NULL        	column_comment


-- !query 4
DESC FORMATTED desc_col_temp_table desc_col_temp_table.key
-- !query 4 schema
struct<col_name:string,data_type:string,min:string,max:string,num_nulls:string,distinct_count:string,avg_col_len:string,max_col_len:string,comment:string>
-- !query 4 output
col_name 	data_type 	min  	max  	num_nulls 	distinct_count 	avg_col_len 	max_col_len 	comment        	
key      	int       	NULL 	NULL 	NULL      	NULL           	NULL        	NULL        	column_comment


-- !query 5
DESC desc_col_temp_table key1
-- !query 5 schema
struct<>
-- !query 5 output
org.apache.spark.sql.AnalysisException
Column key1 does not exist;


-- !query 6
CREATE TABLE desc_col_table (key int COMMENT 'column_comment') USING PARQUET
-- !query 6 schema
struct<>
-- !query 6 output



-- !query 7
ANALYZE TABLE desc_col_table COMPUTE STATISTICS FOR COLUMNS key
-- !query 7 schema
struct<>
-- !query 7 output



-- !query 8
DESC desc_col_table key
-- !query 8 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 8 output
col_name 	data_type 	comment        	
key      	int       	column_comment


-- !query 9
DESC EXTENDED desc_col_table key
-- !query 9 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 9 output
col_name 	data_type 	comment        	
key      	int       	column_comment


-- !query 10
DESC FORMATTED desc_col_table key
-- !query 10 schema
struct<col_name:string,data_type:string,min:string,max:string,num_nulls:string,distinct_count:string,avg_col_len:string,max_col_len:string,comment:string>
-- !query 10 output
col_name 	data_type 	min  	max  	num_nulls 	distinct_count 	avg_col_len 	max_col_len 	comment        	
key      	int       	NULL 	NULL 	0         	0              	4           	4           	column_comment


-- !query 11
CREATE TABLE desc_col_complex_table (`a.b` int, col struct<x:int, y:string>) USING PARQUET
-- !query 11 schema
struct<>
-- !query 11 output



-- !query 12
DESC FORMATTED desc_col_complex_table `a.b`
-- !query 12 schema
struct<col_name:string,data_type:string,min:string,max:string,num_nulls:string,distinct_count:string,avg_col_len:string,max_col_len:string,comment:string>
-- !query 12 output
col_name 	data_type 	min  	max  	num_nulls 	distinct_count 	avg_col_len 	max_col_len 	comment 	
a.b      	int       	NULL 	NULL 	NULL      	NULL           	NULL        	NULL        	NULL


-- !query 13
DESC FORMATTED desc_col_complex_table col
-- !query 13 schema
struct<col_name:string,data_type:string,min:string,max:string,num_nulls:string,distinct_count:string,avg_col_len:string,max_col_len:string,comment:string>
-- !query 13 output
col_name 	data_type              	min  	max  	num_nulls 	distinct_count 	avg_col_len 	max_col_len 	comment 	
col      	struct<x:int,y:string> 	NULL 	NULL 	NULL      	NULL           	NULL        	NULL        	NULL


-- !query 14
DESC FORMATTED desc_col_complex_table col.x
-- !query 14 schema
struct<>
-- !query 14 output
org.apache.spark.sql.AnalysisException
Nested column is not supported: col.x;
