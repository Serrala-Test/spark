-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 28


-- !query 0
-- boolean and transitions
     -- null because strict
     -- and actual computations

     -- boolean or transitions
     -- null because strict
     -- actual computations








explain
  select min(unique1) from tenk1
-- !query 0 schema
struct<plan:string>
-- !query 0 output
== Physical Plan ==
*HashAggregate(keys=[], functions=[min(unique1#x)])
+- *HashAggregate(keys=[], functions=[partial_min(unique1#x)])
   +- *Project [unique1#x]
      +- *BatchScan[unique1#x] CSVScan Location: InMemoryFileIndex[file:/Users/yumwang/SPARK-27883/spark/sql/core/target/scala-2.12/test-classes/t..., ReadSchema: struct<unique1:int>


-- !query 1
select min(unique1) from tenk1
-- !query 1 schema
struct<min(unique1):int>
-- !query 1 output
0


-- !query 2
explain
  select max(unique1) from tenk1
-- !query 2 schema
struct<plan:string>
-- !query 2 output
== Physical Plan ==
*HashAggregate(keys=[], functions=[max(unique1#x)])
+- *HashAggregate(keys=[], functions=[partial_max(unique1#x)])
   +- *Project [unique1#x]
      +- *BatchScan[unique1#x] CSVScan Location: InMemoryFileIndex[file:/Users/yumwang/SPARK-27883/spark/sql/core/target/scala-2.12/test-classes/t..., ReadSchema: struct<unique1:int>


-- !query 3
select max(unique1) from tenk1
-- !query 3 schema
struct<max(unique1):int>
-- !query 3 output
9999


-- !query 4
explain
  select max(unique1) from tenk1 where unique1 < 42
-- !query 4 schema
struct<plan:string>
-- !query 4 output
== Physical Plan ==
*HashAggregate(keys=[], functions=[max(unique1#x)])
+- *HashAggregate(keys=[], functions=[partial_max(unique1#x)])
   +- *Project [unique1#x]
      +- *Filter (isnotnull(unique1#x) AND (unique1#x < 42))
         +- *BatchScan[unique1#x] CSVScan Location: InMemoryFileIndex[file:/Users/yumwang/SPARK-27883/spark/sql/core/target/scala-2.12/test-classes/t..., ReadSchema: struct<unique1:int>


-- !query 5
select max(unique1) from tenk1 where unique1 < 42
-- !query 5 schema
struct<max(unique1):int>
-- !query 5 output
41


-- !query 6
explain
  select max(unique1) from tenk1 where unique1 > 42
-- !query 6 schema
struct<plan:string>
-- !query 6 output
== Physical Plan ==
*HashAggregate(keys=[], functions=[max(unique1#x)])
+- *HashAggregate(keys=[], functions=[partial_max(unique1#x)])
   +- *Project [unique1#x]
      +- *Filter (isnotnull(unique1#x) AND (unique1#x > 42))
         +- *BatchScan[unique1#x] CSVScan Location: InMemoryFileIndex[file:/Users/yumwang/SPARK-27883/spark/sql/core/target/scala-2.12/test-classes/t..., ReadSchema: struct<unique1:int>


-- !query 7
select max(unique1) from tenk1 where unique1 > 42
-- !query 7 schema
struct<max(unique1):int>
-- !query 7 output
9999


-- !query 8
explain
  select max(unique1) from tenk1 where unique1 > 42000
-- !query 8 schema
struct<plan:string>
-- !query 8 output
== Physical Plan ==
*HashAggregate(keys=[], functions=[max(unique1#x)])
+- *HashAggregate(keys=[], functions=[partial_max(unique1#x)])
   +- *Project [unique1#x]
      +- *Filter (isnotnull(unique1#x) AND (unique1#x > 42000))
         +- *BatchScan[unique1#x] CSVScan Location: InMemoryFileIndex[file:/Users/yumwang/SPARK-27883/spark/sql/core/target/scala-2.12/test-classes/t..., ReadSchema: struct<unique1:int>


-- !query 9
select max(unique1) from tenk1 where unique1 > 42000
-- !query 9 schema
struct<max(unique1):int>
-- !query 9 output
NULL


-- !query 10
explain
  select max(tenthous) from tenk1 where thousand = 33
-- !query 10 schema
struct<plan:string>
-- !query 10 output
== Physical Plan ==
*HashAggregate(keys=[], functions=[max(tenthous#x)])
+- *HashAggregate(keys=[], functions=[partial_max(tenthous#x)])
   +- *Project [tenthous#x]
      +- *Filter (isnotnull(thousand#x) AND (thousand#x = 33))
         +- *BatchScan[thousand#x, tenthous#x] CSVScan Location: InMemoryFileIndex[file:/Users/yumwang/SPARK-27883/spark/sql/core/target/scala-2.12/test-classes/t..., ReadSchema: struct<thousand:int,tenthous:int>


-- !query 11
select max(tenthous) from tenk1 where thousand = 33
-- !query 11 schema
struct<max(tenthous):int>
-- !query 11 output
9033


-- !query 12
explain
  select min(tenthous) from tenk1 where thousand = 33
-- !query 12 schema
struct<plan:string>
-- !query 12 output
== Physical Plan ==
*HashAggregate(keys=[], functions=[min(tenthous#x)])
+- *HashAggregate(keys=[], functions=[partial_min(tenthous#x)])
   +- *Project [tenthous#x]
      +- *Filter (isnotnull(thousand#x) AND (thousand#x = 33))
         +- *BatchScan[thousand#x, tenthous#x] CSVScan Location: InMemoryFileIndex[file:/Users/yumwang/SPARK-27883/spark/sql/core/target/scala-2.12/test-classes/t..., ReadSchema: struct<thousand:int,tenthous:int>


-- !query 13
select min(tenthous) from tenk1 where thousand = 33
-- !query 13 schema
struct<min(tenthous):int>
-- !query 13 output
33


-- !query 14
explain
  select f1, (select min(unique1) from tenk1 where unique1 > f1) AS gt
    from int4_tbl
-- !query 14 schema
struct<plan:string>
-- !query 14 output
== Physical Plan ==
org.apache.spark.sql.AnalysisException: Table or view not found: int4_tbl; line 3 pos 9


-- !query 15
select f1, (select min(unique1) from tenk1 where unique1 > f1) AS gt
  from int4_tbl
-- !query 15 schema
struct<>
-- !query 15 output
org.apache.spark.sql.AnalysisException
Table or view not found: int4_tbl; line 2 pos 7


-- !query 16
explain
  select distinct max(unique2) from tenk1
-- !query 16 schema
struct<plan:string>
-- !query 16 output
== Physical Plan ==
*HashAggregate(keys=[max(unique2)#x], functions=[])
+- *HashAggregate(keys=[max(unique2)#x], functions=[])
   +- *HashAggregate(keys=[], functions=[max(unique2#x)])
      +- *HashAggregate(keys=[], functions=[partial_max(unique2#x)])
         +- *Project [unique2#x]
            +- *BatchScan[unique2#x] CSVScan Location: InMemoryFileIndex[file:/Users/yumwang/SPARK-27883/spark/sql/core/target/scala-2.12/test-classes/t..., ReadSchema: struct<unique2:int>


-- !query 17
select distinct max(unique2) from tenk1
-- !query 17 schema
struct<max(unique2):int>
-- !query 17 output
9999


-- !query 18
explain
  select max(unique2) from tenk1 order by 1
-- !query 18 schema
struct<plan:string>
-- !query 18 output
== Physical Plan ==
*Sort [max(unique2)#x ASC NULLS FIRST], true, 0
+- *HashAggregate(keys=[], functions=[max(unique2#x)])
   +- *HashAggregate(keys=[], functions=[partial_max(unique2#x)])
      +- *Project [unique2#x]
         +- *BatchScan[unique2#x] CSVScan Location: InMemoryFileIndex[file:/Users/yumwang/SPARK-27883/spark/sql/core/target/scala-2.12/test-classes/t..., ReadSchema: struct<unique2:int>


-- !query 19
select max(unique2) from tenk1 order by 1
-- !query 19 schema
struct<max(unique2):int>
-- !query 19 output
9999


-- !query 20
explain
  select max(unique2) from tenk1 order by max(unique2)
-- !query 20 schema
struct<plan:string>
-- !query 20 output
== Physical Plan ==
*Sort [max(unique2)#x ASC NULLS FIRST], true, 0
+- *HashAggregate(keys=[], functions=[max(unique2#x)])
   +- *HashAggregate(keys=[], functions=[partial_max(unique2#x)])
      +- *Project [unique2#x]
         +- *BatchScan[unique2#x] CSVScan Location: InMemoryFileIndex[file:/Users/yumwang/SPARK-27883/spark/sql/core/target/scala-2.12/test-classes/t..., ReadSchema: struct<unique2:int>


-- !query 21
select max(unique2) from tenk1 order by max(unique2)
-- !query 21 schema
struct<max(unique2):int>
-- !query 21 output
9999


-- !query 22
explain
  select max(unique2) from tenk1 order by max(unique2)+1
-- !query 22 schema
struct<plan:string>
-- !query 22 output
== Physical Plan ==
*Project [max(unique2)#x]
+- *Sort [aggOrder#x ASC NULLS FIRST], true, 0
   +- *HashAggregate(keys=[], functions=[max(unique2#x)])
      +- *HashAggregate(keys=[], functions=[partial_max(unique2#x)])
         +- *Project [unique2#x]
            +- *BatchScan[unique2#x] CSVScan Location: InMemoryFileIndex[file:/Users/yumwang/SPARK-27883/spark/sql/core/target/scala-2.12/test-classes/t..., ReadSchema: struct<unique2:int>


-- !query 23
select max(unique2) from tenk1 order by max(unique2)+1
-- !query 23 schema
struct<max(unique2):int>
-- !query 23 output
9999


-- !query 24
explain
  select max(unique2), generate_series(1,3) as g from tenk1 order by g desc
-- !query 24 schema
struct<plan:string>
-- !query 24 output
== Physical Plan ==
org.apache.spark.sql.AnalysisException: Undefined function: 'generate_series'. This function is neither a registered temporary function nor a permanent function registered in the database 'default'.; line 2 pos 23


-- !query 25
select max(unique2), generate_series(1,3) as g from tenk1 order by g desc
-- !query 25 schema
struct<>
-- !query 25 output
org.apache.spark.sql.AnalysisException
Undefined function: 'generate_series'. This function is neither a registered temporary function nor a permanent function registered in the database 'default'.; line 1 pos 21


-- !query 26
explain
  select max(100) from tenk1
-- !query 26 schema
struct<plan:string>
-- !query 26 output
== Physical Plan ==
*HashAggregate(keys=[], functions=[max(100)])
+- *HashAggregate(keys=[], functions=[partial_max(100)])
   +- *Project
      +- *BatchScan[] CSVScan Location: InMemoryFileIndex[file:/Users/yumwang/SPARK-27883/spark/sql/core/target/scala-2.12/test-classes/t..., ReadSchema: struct<>


-- !query 27
select max(100) from tenk1
-- !query 27 schema
struct<max(100):int>
-- !query 27 output
100
