-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 11


-- !query 0
create temporary view varchar_tbl as select * from values
  ('a'),
  ('A'),
  ('1'),
  ('2'),
  ('3'),
  (''),
  -- ('cd'),
  ('c')
  as varchar_tbl(f1)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
select concat_ws(',', collect_list(a)) from (values('aaaa'),('bbbb'),('cccc')) g(a)
-- !query 1 schema
struct<concat_ws(,, collect_list(a)):string>
-- !query 1 output
aaaa,bbbb,cccc


-- !query 2
select concat_ws(',', collect_list(a)) from (values('aaaa'),(null),('bbbb'),('cccc')) g(a)
-- !query 2 schema
struct<concat_ws(,, collect_list(a)):string>
-- !query 2 output
aaaa,bbbb,cccc


-- !query 3
select concat_ws('AB', collect_list(a)) from (values(null),(null),('bbbb'),('cccc')) g(a)
-- !query 3 schema
struct<concat_ws(AB, collect_list(a)):string>
-- !query 3 output
bbbbABcccc


-- !query 4
select concat_ws(',', collect_list(a)) from (values(null),(null)) g(a)
-- !query 4 schema
struct<concat_ws(,, collect_list(a)):string>
-- !query 4 output



-- !query 5
select concat_ws(',', sort_array(array_distinct(collect_list(f1)))) from varchar_tbl
-- !query 5 schema
struct<concat_ws(,, sort_array(array_distinct(collect_list(f1)), true)):string>
-- !query 5 output
,1,2,3,A,a,c


-- !query 6
select min(CASE WHEN unique1> 100 THEN unique1 END) from tenk1
-- !query 6 schema
struct<min(CASE WHEN (unique1 > 100) THEN unique1 END):int>
-- !query 6 output
101


-- !query 7
select sum(CASE WHEN ten > 0 THEN cast(1/ten as integer) END) from tenk1
-- !query 7 schema
struct<sum(CASE WHEN (ten > 0) THEN CAST((CAST(1 AS DOUBLE) / CAST(ten AS DOUBLE)) AS INT) END):bigint>
-- !query 7 output
1000


-- !query 8
select ten, sum(distinct CASE WHEN four > 10 THEN four END)  from onek a
group by ten
having exists (select 1 from onek b where sum(distinct a.four) = b.four)
-- !query 8 schema
struct<ten:int,sum(DISTINCT CASE WHEN (four > 10) THEN four END):bigint>
-- !query 8 output
0	NULL
2	NULL
4	NULL
6	NULL
8	NULL


-- !query 9
select max(CASE WHEN bar > '0' THEN foo END)
from (values ('a', 'b')) AS v(foo,bar)
-- !query 9 schema
struct<max(CASE WHEN (bar > 0) THEN foo END):string>
-- !query 9 output
a


-- !query 10
select (select count(*)
        from (values (1)) t0(inner_c))
from (values (2),(3)) t1(outer_c)
-- !query 10 schema
struct<scalarsubquery():bigint>
-- !query 10 output
1
1
