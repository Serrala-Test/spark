-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 30


-- !query
CREATE NAMESPACE IF NOT EXISTS table_valued_command
-- !query schema
struct<>
-- !query output



-- !query
USE NAMESPACE table_valued_command
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE test_show_tables(a INT, b STRING, c INT) using parquet
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE test_show_table_properties (a INT, b STRING, c INT) USING parquet TBLPROPERTIES('p1'='v1', 'p2'='v2')
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE test_show_partitions(a String, b Int, c String, d String) USING parquet PARTITIONED BY (c, d)
-- !query schema
struct<>
-- !query output



-- !query
ALTER TABLE test_show_partitions ADD PARTITION (c='Us', d=1)
-- !query schema
struct<>
-- !query output



-- !query
ALTER TABLE test_show_partitions ADD PARTITION (c='Us', d=2)
-- !query schema
struct<>
-- !query output



-- !query
ALTER TABLE test_show_partitions ADD PARTITION (c='Cn', d=1)
-- !query schema
struct<>
-- !query output



-- !query
SHOW NAMESPACES
-- !query schema
struct<namespace:string>
-- !query output
default
table_valued_command


-- !query
SELECT * FROM command('SHOW NAMESPACES')
-- !query schema
struct<namespace:string>
-- !query output
default
table_valued_command


-- !query
SELECT * FROM command('SHOW NAMESPACES') WHERE namespace = 'table_valued_command'
-- !query schema
struct<namespace:string>
-- !query output
table_valued_command


-- !query
SHOW TABLES
-- !query schema
struct<namespace:string,tableName:string,isTemporary:boolean>
-- !query output
test_show_partitions
test_show_table_properties
test_show_tables


-- !query
SELECT * FROM command('SHOW TABLES')
-- !query schema
struct<namespace:string,tableName:string,isTemporary:boolean>
-- !query output
test_show_partitions
test_show_table_properties
test_show_tables


-- !query
SELECT * FROM command('SHOW TABLES') WHERE tableName = 'test_show_tables'
-- !query schema
struct<namespace:string,tableName:string,isTemporary:boolean>
-- !query output
table_valued_command	test_show_tables	false


-- !query
SHOW TBLPROPERTIES test_show_table_properties
-- !query schema
struct<key:string,value:string>
-- !query output
p1	v1
p2	v2


-- !query
SELECT * FROM command('SHOW TBLPROPERTIES test_show_table_properties')
-- !query schema
struct<key:string,value:string>
-- !query output
p1	v1
p2	v2


-- !query
SELECT * FROM command('SHOW TBLPROPERTIES test_show_table_properties') WHERE key = 'p1'
-- !query schema
struct<key:string,value:string>
-- !query output
p1	v1


-- !query
SHOW PARTITIONS test_show_partitions
-- !query schema
struct<partition:string>
-- !query output
c=Cn/d=1
c=Us/d=1
c=Us/d=2


-- !query
SELECT * FROM command('SHOW PARTITIONS test_show_partitions')
-- !query schema
struct<partition:string>
-- !query output
c=Cn/d=1
c=Us/d=1
c=Us/d=2


-- !query
SELECT * FROM command('SHOW PARTITIONS test_show_partitions') WHERE partition = 'c=Us/d=1'
-- !query schema
struct<partition:string>
-- !query output
c=Us/d=1


-- !query
SHOW COLUMNS in test_show_tables
-- !query schema
struct<col_name:string>
-- !query output
a
b
c


-- !query
SELECT * FROM command('SHOW COLUMNS in test_show_tables')
-- !query schema
struct<col_name:string>
-- !query output
a
b
c


-- !query
SELECT * FROM command('SHOW COLUMNS in test_show_tables') WHERE col_name = 'a'
-- !query schema
struct<col_name:string>
-- !query output
a


-- !query
SHOW CREATE TABLE test_show_tables
-- !query schema
struct<createtab_stmt:string>
-- !query output
CREATE TABLE `table_valued_command`.`test_show_tables` (
  `a` INT,
  `b` STRING,
  `c` INT)
USING parquet


-- !query
SELECT * FROM command('SHOW CREATE TABLE test_show_tables')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table valued command does not support command SHOW CREATE TABLE test_show_tables


-- !query
DROP TABLE test_show_partitions
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE test_show_table_properties
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE test_show_tables
-- !query schema
struct<>
-- !query output



-- !query
USE default
-- !query schema
struct<>
-- !query output



-- !query
DROP NAMESPACE table_valued_command
-- !query schema
struct<>
-- !query output

