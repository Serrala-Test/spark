-- Automatically generated by SQLQueryTestSuite
-- !query
create table t1(ucs_basic string collate ucs_basic, ucs_basic_lcase string collate ucs_basic_lcase) using parquet
-- !query schema
struct<>
-- !query output



-- !query
insert into t1 values('aaa', 'aaa')
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkIllegalArgumentException
{
  "errorClass" : "UNSUPPORTED_DATATYPE",
  "sqlState" : "0A000",
  "messageParameters" : {
    "typeName" : "{\"type\":\"struct\",\"fields\":[{\"name\":\"ucs_basic\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ucs_basic_lcase\",\"type\":\"string COLLATE UCS_BASIC_LCASE\",\"nullable\":true,\"metadata\":{}}]}[1.1] failure: 'TimestampType' expected but '{' found\n\n{\"type\":\"struct\",\"fields\":[{\"name\":\"ucs_basic\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ucs_basic_lcase\",\"type\":\"string COLLATE UCS_BASIC_LCASE\",\"nullable\":true,\"metadata\":{}}]}\n^"
  }
}


-- !query
insert into t1 values('AAA', 'AAA')
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkIllegalArgumentException
{
  "errorClass" : "UNSUPPORTED_DATATYPE",
  "sqlState" : "0A000",
  "messageParameters" : {
    "typeName" : "{\"type\":\"struct\",\"fields\":[{\"name\":\"ucs_basic\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ucs_basic_lcase\",\"type\":\"string COLLATE UCS_BASIC_LCASE\",\"nullable\":true,\"metadata\":{}}]}[1.1] failure: 'TimestampType' expected but '{' found\n\n{\"type\":\"struct\",\"fields\":[{\"name\":\"ucs_basic\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ucs_basic_lcase\",\"type\":\"string COLLATE UCS_BASIC_LCASE\",\"nullable\":true,\"metadata\":{}}]}\n^"
  }
}


-- !query
insert into t1 values('bbb', 'bbb')
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkIllegalArgumentException
{
  "errorClass" : "UNSUPPORTED_DATATYPE",
  "sqlState" : "0A000",
  "messageParameters" : {
    "typeName" : "{\"type\":\"struct\",\"fields\":[{\"name\":\"ucs_basic\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ucs_basic_lcase\",\"type\":\"string COLLATE UCS_BASIC_LCASE\",\"nullable\":true,\"metadata\":{}}]}[1.1] failure: 'TimestampType' expected but '{' found\n\n{\"type\":\"struct\",\"fields\":[{\"name\":\"ucs_basic\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ucs_basic_lcase\",\"type\":\"string COLLATE UCS_BASIC_LCASE\",\"nullable\":true,\"metadata\":{}}]}\n^"
  }
}


-- !query
insert into t1 values('BBB', 'BBB')
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkIllegalArgumentException
{
  "errorClass" : "UNSUPPORTED_DATATYPE",
  "sqlState" : "0A000",
  "messageParameters" : {
    "typeName" : "{\"type\":\"struct\",\"fields\":[{\"name\":\"ucs_basic\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ucs_basic_lcase\",\"type\":\"string COLLATE UCS_BASIC_LCASE\",\"nullable\":true,\"metadata\":{}}]}[1.1] failure: 'TimestampType' expected but '{' found\n\n{\"type\":\"struct\",\"fields\":[{\"name\":\"ucs_basic\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ucs_basic_lcase\",\"type\":\"string COLLATE UCS_BASIC_LCASE\",\"nullable\":true,\"metadata\":{}}]}\n^"
  }
}


-- !query
select count(*) from t1 group by ucs_basic
-- !query schema
struct<count(1):bigint>
-- !query output



-- !query
select count(*) from t1 group by ucs_basic_lcase
-- !query schema
struct<count(1):bigint>
-- !query output



-- !query
select * from t1 where ucs_basic = 'aaa'
-- !query schema
struct<ucs_basic:string,ucs_basic_lcase:string COLLATE UCS_BASIC_LCASE>
-- !query output



-- !query
select * from t1 where ucs_basic_lcase = 'aaa' collate ucs_basic_lcase
-- !query schema
struct<ucs_basic:string,ucs_basic_lcase:string COLLATE UCS_BASIC_LCASE>
-- !query output



-- !query
select * from t1 where ucs_basic < 'bbb'
-- !query schema
struct<ucs_basic:string,ucs_basic_lcase:string COLLATE UCS_BASIC_LCASE>
-- !query output



-- !query
select * from t1 where ucs_basic_lcase < 'bbb' collate ucs_basic_lcase
-- !query schema
struct<ucs_basic:string,ucs_basic_lcase:string COLLATE UCS_BASIC_LCASE>
-- !query output



-- !query
drop table t1
-- !query schema
struct<>
-- !query output



-- !query
create table t1 (c1 struct<ucs_basic: string collate ucs_basic, ucs_basic_lcase: string collate ucs_basic_lcase>) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t1 VALUES (named_struct('ucs_basic', 'aaa', 'ucs_basic_lcase', 'aaa'))
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkIllegalArgumentException
{
  "errorClass" : "UNSUPPORTED_DATATYPE",
  "sqlState" : "0A000",
  "messageParameters" : {
    "typeName" : "{\"type\":\"struct\",\"fields\":[{\"name\":\"c1\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"ucs_basic\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ucs_basic_lcase\",\"type\":\"string COLLATE UCS_BASIC_LCASE\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":false,\"metadata\":{}}]}[1.1] failure: 'TimestampType' expected but '{' found\n\n{\"type\":\"struct\",\"fields\":[{\"name\":\"c1\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"ucs_basic\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ucs_basic_lcase\",\"type\":\"string COLLATE UCS_BASIC_LCASE\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":false,\"metadata\":{}}]}\n^"
  }
}


-- !query
INSERT INTO t1 VALUES (named_struct('ucs_basic', 'AAA', 'ucs_basic_lcase', 'AAA'))
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkIllegalArgumentException
{
  "errorClass" : "UNSUPPORTED_DATATYPE",
  "sqlState" : "0A000",
  "messageParameters" : {
    "typeName" : "{\"type\":\"struct\",\"fields\":[{\"name\":\"c1\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"ucs_basic\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ucs_basic_lcase\",\"type\":\"string COLLATE UCS_BASIC_LCASE\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":false,\"metadata\":{}}]}[1.1] failure: 'TimestampType' expected but '{' found\n\n{\"type\":\"struct\",\"fields\":[{\"name\":\"c1\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"ucs_basic\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ucs_basic_lcase\",\"type\":\"string COLLATE UCS_BASIC_LCASE\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":false,\"metadata\":{}}]}\n^"
  }
}


-- !query
select count(*) from t1 group by c1.ucs_basic
-- !query schema
struct<count(1):bigint>
-- !query output



-- !query
select count(*) from t1 group by c1.ucs_basic_lcase
-- !query schema
struct<count(1):bigint>
-- !query output



-- !query
drop table t1
-- !query schema
struct<>
-- !query output

