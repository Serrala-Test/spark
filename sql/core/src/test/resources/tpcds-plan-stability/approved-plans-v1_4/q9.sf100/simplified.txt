WholeStageCodegen (1)
  Project
    Subquery #1
      WholeStageCodegen (2)
        HashAggregate [count,sum,count,sum,count] [count(1),avg(UnscaledValue(ss_ext_discount_amt)),avg(UnscaledValue(ss_net_paid)),count(1),avg(ss_ext_discount_amt),avg(ss_net_paid),count,sum,count,sum,count]
          InputAdapter
            Exchange #1
              WholeStageCodegen (1)
                HashAggregate [ss_ext_discount_amt,ss_net_paid] [count,sum,count,sum,count,count,sum,count,sum,count]
                  Project [ss_ext_discount_amt,ss_net_paid]
                    Filter [ss_quantity]
                      ColumnarToRow
                        InputAdapter
                          Scan parquet default.store_sales [ss_quantity,ss_ext_discount_amt,ss_net_paid,ss_sold_date_sk]
    ReusedSubquery [count(1),avg(ss_ext_discount_amt),avg(ss_net_paid)] #1
    ReusedSubquery [count(1),avg(ss_ext_discount_amt),avg(ss_net_paid)] #1
    Subquery #2
      WholeStageCodegen (2)
        HashAggregate [count,sum,count,sum,count] [count(1),avg(UnscaledValue(ss_ext_discount_amt)),avg(UnscaledValue(ss_net_paid)),count(1),avg(ss_ext_discount_amt),avg(ss_net_paid),count,sum,count,sum,count]
          InputAdapter
            Exchange #2
              WholeStageCodegen (1)
                HashAggregate [ss_ext_discount_amt,ss_net_paid] [count,sum,count,sum,count,count,sum,count,sum,count]
                  Project [ss_ext_discount_amt,ss_net_paid]
                    Filter [ss_quantity]
                      ColumnarToRow
                        InputAdapter
                          Scan parquet default.store_sales [ss_quantity,ss_ext_discount_amt,ss_net_paid,ss_sold_date_sk]
    ReusedSubquery [count(1),avg(ss_ext_discount_amt),avg(ss_net_paid)] #2
    ReusedSubquery [count(1),avg(ss_ext_discount_amt),avg(ss_net_paid)] #2
    Subquery #3
      WholeStageCodegen (2)
        HashAggregate [count,sum,count,sum,count] [count(1),avg(UnscaledValue(ss_ext_discount_amt)),avg(UnscaledValue(ss_net_paid)),count(1),avg(ss_ext_discount_amt),avg(ss_net_paid),count,sum,count,sum,count]
          InputAdapter
            Exchange #3
              WholeStageCodegen (1)
                HashAggregate [ss_ext_discount_amt,ss_net_paid] [count,sum,count,sum,count,count,sum,count,sum,count]
                  Project [ss_ext_discount_amt,ss_net_paid]
                    Filter [ss_quantity]
                      ColumnarToRow
                        InputAdapter
                          Scan parquet default.store_sales [ss_quantity,ss_ext_discount_amt,ss_net_paid,ss_sold_date_sk]
    ReusedSubquery [count(1),avg(ss_ext_discount_amt),avg(ss_net_paid)] #3
    ReusedSubquery [count(1),avg(ss_ext_discount_amt),avg(ss_net_paid)] #3
    Subquery #4
      WholeStageCodegen (2)
        HashAggregate [count,sum,count,sum,count] [count(1),avg(UnscaledValue(ss_ext_discount_amt)),avg(UnscaledValue(ss_net_paid)),count(1),avg(ss_ext_discount_amt),avg(ss_net_paid),count,sum,count,sum,count]
          InputAdapter
            Exchange #4
              WholeStageCodegen (1)
                HashAggregate [ss_ext_discount_amt,ss_net_paid] [count,sum,count,sum,count,count,sum,count,sum,count]
                  Project [ss_ext_discount_amt,ss_net_paid]
                    Filter [ss_quantity]
                      ColumnarToRow
                        InputAdapter
                          Scan parquet default.store_sales [ss_quantity,ss_ext_discount_amt,ss_net_paid,ss_sold_date_sk]
    ReusedSubquery [count(1),avg(ss_ext_discount_amt),avg(ss_net_paid)] #4
    ReusedSubquery [count(1),avg(ss_ext_discount_amt),avg(ss_net_paid)] #4
    Subquery #5
      WholeStageCodegen (2)
        HashAggregate [count,sum,count,sum,count] [count(1),avg(UnscaledValue(ss_ext_discount_amt)),avg(UnscaledValue(ss_net_paid)),count(1),avg(ss_ext_discount_amt),avg(ss_net_paid),count,sum,count,sum,count]
          InputAdapter
            Exchange #5
              WholeStageCodegen (1)
                HashAggregate [ss_ext_discount_amt,ss_net_paid] [count,sum,count,sum,count,count,sum,count,sum,count]
                  Project [ss_ext_discount_amt,ss_net_paid]
                    Filter [ss_quantity]
                      ColumnarToRow
                        InputAdapter
                          Scan parquet default.store_sales [ss_quantity,ss_ext_discount_amt,ss_net_paid,ss_sold_date_sk]
    ReusedSubquery [count(1),avg(ss_ext_discount_amt),avg(ss_net_paid)] #5
    ReusedSubquery [count(1),avg(ss_ext_discount_amt),avg(ss_net_paid)] #5
    Filter [r_reason_sk]
      ColumnarToRow
        InputAdapter
          Scan parquet default.reason [r_reason_sk]
