WholeStageCodegen (9)
  HashAggregate [sum] [sum(UnscaledValue(cs_ext_discount_amt)),excess discount amount,sum]
    InputAdapter
      Exchange #1
        WholeStageCodegen (8)
          HashAggregate [cs_ext_discount_amt] [sum,sum]
            Project [cs_ext_discount_amt]
              BroadcastHashJoin [cs_sold_date_sk,d_date_sk]
                Project [cs_ext_discount_amt,cs_sold_date_sk]
                  SortMergeJoin [i_item_sk,cs_item_sk,cs_ext_discount_amt,(1.3 * avg(cs_ext_discount_amt))]
                    InputAdapter
                      WholeStageCodegen (3)
                        Sort [i_item_sk]
                          InputAdapter
                            Exchange [i_item_sk] #2
                              WholeStageCodegen (2)
                                Project [cs_ext_discount_amt,cs_sold_date_sk,i_item_sk]
                                  BroadcastHashJoin [cs_item_sk,i_item_sk]
                                    Project [cs_item_sk,cs_ext_discount_amt,cs_sold_date_sk]
                                      Filter [cs_item_sk,cs_ext_discount_amt,cs_sold_date_sk]
                                        Subquery #1
                                          ObjectHashAggregate [buf] [bloom_filter_agg(xxhash64(d_date_sk, 42), 1000000, 8388608, 0, 0),bloomFilter,buf]
                                            Exchange #3
                                              ObjectHashAggregate [d_date_sk] [buf,buf]
                                                WholeStageCodegen (1)
                                                  Project [d_date_sk]
                                                    Filter [d_date,d_date_sk]
                                                      InputAdapter
                                                        BatchScan default.date_dim [d_date_sk,d_date]
                                        InputAdapter
                                          BatchScan default.catalog_sales [cs_item_sk,cs_ext_discount_amt,cs_sold_date_sk]
                                    InputAdapter
                                      BroadcastExchange #4
                                        WholeStageCodegen (1)
                                          Project [i_item_sk]
                                            Filter [i_manufact_id,i_item_sk]
                                              InputAdapter
                                                BatchScan default.item [i_item_sk,i_manufact_id]
                    InputAdapter
                      WholeStageCodegen (6)
                        Sort [cs_item_sk]
                          Filter [(1.3 * avg(cs_ext_discount_amt))]
                            HashAggregate [cs_item_sk,sum,count] [avg(UnscaledValue(cs_ext_discount_amt)),(1.3 * avg(cs_ext_discount_amt)),sum,count]
                              InputAdapter
                                Exchange [cs_item_sk] #5
                                  WholeStageCodegen (5)
                                    HashAggregate [cs_item_sk,cs_ext_discount_amt] [sum,count,sum,count]
                                      Project [cs_item_sk,cs_ext_discount_amt]
                                        BroadcastHashJoin [cs_sold_date_sk,d_date_sk]
                                          Project [cs_item_sk,cs_ext_discount_amt,cs_sold_date_sk]
                                            Filter [cs_sold_date_sk,cs_item_sk]
                                              InputAdapter
                                                BatchScan default.catalog_sales [cs_item_sk,cs_ext_discount_amt,cs_sold_date_sk]
                                          InputAdapter
                                            BroadcastExchange #6
                                              WholeStageCodegen (4)
                                                Project [d_date_sk]
                                                  Filter [d_date,d_date_sk]
                                                    InputAdapter
                                                      BatchScan default.date_dim [d_date_sk,d_date]
                InputAdapter
                  ReusedExchange [d_date_sk] #6
