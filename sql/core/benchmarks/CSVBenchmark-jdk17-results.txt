================================================================================================
Benchmark to measure CSV read/write performance
================================================================================================

OpenJDK 64-Bit Server VM 17.0.3+7-LTS on Mac OS X 12.2.1
Apple M1 Pro
Parsing quoted values:                    Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
One quoted string                                 13646          13846         198          0.0      272929.6       1.0X

OpenJDK 64-Bit Server VM 17.0.3+7-LTS on Mac OS X 12.2.1
Apple M1 Pro
Wide rows with 1000 columns:              Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
Select 1000 columns                               51867          52000         208          0.0       51866.8       1.0X
Select 100 columns                                14383          14468         128          0.1       14382.8       3.6X
Select one column                                 12292          12426         143          0.1       12291.9       4.2X
count()                                            2880           3236         541          0.3        2879.6      18.0X
Select 100 columns, one bad input field           27681          29004        1483          0.0       27680.9       1.9X
Select 100 columns, corrupt record field          31000          32090        1339          0.0       30999.9       1.7X

OpenJDK 64-Bit Server VM 17.0.3+7-LTS on Mac OS X 12.2.1
Apple M1 Pro
Count a dataset with 10 columns:          Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
Select 10 columns + count()                        7256           7351          84          1.4         725.6       1.0X
Select 1 column + count()                          4432           4509         124          2.3         443.2       1.6X
count()                                            1217           1240          35          8.2         121.7       6.0X

OpenJDK 64-Bit Server VM 17.0.3+7-LTS on Mac OS X 12.2.1
Apple M1 Pro
Write dates and timestamps:               Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
Create a dataset of timestamps                      947            999          52         10.6          94.7       1.0X
to_csv(timestamp)                                  5927           6138         199          1.7         592.7       0.2X
write timestamps to files                          4878           4900          32          2.0         487.8       0.2X
Create a dataset of dates                          1045           1058          21          9.6         104.5       0.9X
to_csv(date)                                       3335           4125         685          3.0         333.5       0.3X
write dates to files                               3119           3132          13          3.2         311.9       0.3X

OpenJDK 64-Bit Server VM 17.0.3+7-LTS on Mac OS X 12.2.1
Apple M1 Pro
Read dates and timestamps:                Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
read timestamp text from files                      833            845          15         12.0          83.3       1.0X
read timestamps from files                        14196          14309         174          0.7        1419.6       0.1X
infer timestamps from files                       28471          28895         380          0.4        2847.1       0.0X
read date text from files                           727            729           2         13.7          72.7       1.1X
read date from files                               4445           4468          21          2.2         444.5       0.2X
infer date from files                             10708          10844         135          0.9        1070.8       0.1X
timestamp strings                                  1880           1906          43          5.3         188.0       0.4X
parse timestamps from Dataset[String]             12685          12727          38          0.8        1268.5       0.1X
infer timestamps from Dataset[String]             24282          24352          70          0.4        2428.2       0.0X
date strings                                       1584           1587           4          6.3         158.4       0.5X
parse dates from Dataset[String]                   6217           6395         156          1.6         621.7       0.1X
from_csv(timestamp)                               11871          12354         634          0.8        1187.1       0.1X
from_csv(date)                                     5513           5649         120          1.8         551.3       0.2X

OpenJDK 64-Bit Server VM 17.0.3+7-LTS on Mac OS X 12.2.1
Apple M1 Pro
Filters pushdown:                         Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
w/o filters                                        9889          10026         126          0.0       98887.6       1.0X
pushdown disabled                                 10015          10045          35          0.0      100153.8       1.0X
w/ filters                                          813            828          13          0.1        8131.4      12.2X


