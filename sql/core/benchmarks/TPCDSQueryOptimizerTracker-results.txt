================================================================================================
q1
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [c_customer_id#0 ASC NULLS FIRST], true
      +- 'Project [c_customer_id#0]
         +- 'Join Inner, (ctr_customer_sk#0L = cast(c_customer_sk#0 as bigint))
            :- 'Project [ctr_customer_sk#0L]
            :  +- 'Join Inner, (cast(s_store_sk#0 as bigint) = ctr_store_sk#0L)
            :     :- 'Project [ctr_customer_sk#0L, ctr_store_sk#0L]
            :     :  +- 'Join Inner, ((cast(ctr_total_return#0 as decimal(24,7)) > (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#0) && (ctr_store_sk#0L = ctr_store_sk#2L#0L))
            :     :     :- 'Filter isnotnull(ctr_total_return#0)
            :     :     :  +- 'Aggregate [sr_customer_sk#0L, sr_store_sk#0L], [sr_customer_sk#0L AS ctr_customer_sk#0L, sr_store_sk#0L AS ctr_store_sk#0L, MakeDecimal(sum(UnscaledValue(sr_return_amt#0)),17,2) AS ctr_total_return#0]
            :     :     :     +- 'Project [sr_customer_sk#0L, sr_store_sk#0L, sr_return_amt#0]
            :     :     :        +- 'Join Inner, (sr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
            :     :     :           :- Project [sr_returned_date_sk#0L, sr_customer_sk#0L, sr_store_sk#0L, sr_return_amt#0]
            :     :     :           :  +- Filter ((isnotnull(sr_returned_date_sk#0L) && isnotnull(sr_store_sk#0L)) && isnotnull(sr_customer_sk#0L))
            :     :     :           :     +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
            :     :     :           +- Project [d_date_sk#0]
            :     :     :              +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
            :     :     :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     +- 'Filter isnotnull((CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#0)
            :     :        +- 'Aggregate [ctr_store_sk#0L], [CheckOverflow((promote_precision(avg(ctr_total_return#0)) * 1.200000), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#0, ctr_store_sk#0L AS ctr_store_sk#2L#0L]
            :     :           +- 'Aggregate [sr_customer_sk#0L, sr_store_sk#0L], [sr_store_sk#0L AS ctr_store_sk#0L, MakeDecimal(sum(UnscaledValue(sr_return_amt#0)),17,2) AS ctr_total_return#0]
            :     :              +- 'Project [sr_customer_sk#0L, sr_store_sk#0L, sr_return_amt#0]
            :     :                 +- 'Join Inner, (sr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
            :     :                    :- Project [sr_returned_date_sk#0L, sr_customer_sk#0L, sr_store_sk#0L, sr_return_amt#0]
            :     :                    :  +- Filter (isnotnull(sr_returned_date_sk#0L) && isnotnull(sr_store_sk#0L))
            :     :                    :     +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
            :     :                    +- Project [d_date_sk#0]
            :     :                       +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
            :     :                          +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     +- Project [s_store_sk#0]
            :        +- Filter ((isnotnull(s_state#0) && (s_state#0 = TN)) && isnotnull(s_store_sk#0))
            :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            +- Project [c_customer_sk#0, c_customer_id#0]
               +- Filter isnotnull(c_customer_sk#0)
                  +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet


================================================================================================
q2
================================================================================================

'Sort [d_week_seq1#0 ASC NULLS FIRST], true
+- 'Project [d_week_seq1#0, round(CheckOverflow((promote_precision(sun_sales1#0) / promote_precision(sun_sales2#0)), DecimalType(37,20)), 2) AS round((sun_sales1 / sun_sales2), 2)#0, round(CheckOverflow((promote_precision(mon_sales1#0) / promote_precision(mon_sales2#0)), DecimalType(37,20)), 2) AS round((mon_sales1 / mon_sales2), 2)#0, round(CheckOverflow((promote_precision(tue_sales1#0) / promote_precision(tue_sales2#0)), DecimalType(37,20)), 2) AS round((tue_sales1 / tue_sales2), 2)#0, round(CheckOverflow((promote_precision(wed_sales1#0) / promote_precision(wed_sales2#0)), DecimalType(37,20)), 2) AS round((wed_sales1 / wed_sales2), 2)#0, round(CheckOverflow((promote_precision(thu_sales1#0) / promote_precision(thu_sales2#0)), DecimalType(37,20)), 2) AS round((thu_sales1 / thu_sales2), 2)#0, round(CheckOverflow((promote_precision(fri_sales1#0) / promote_precision(fri_sales2#0)), DecimalType(37,20)), 2) AS round((fri_sales1 / fri_sales2), 2)#0, round(CheckOverflow((promote_precision(sat_sales1#0) / promote_precision(sat_sales2#0)), DecimalType(37,20)), 2) AS round((sat_sales1 / sat_sales2), 2)#0]
   +- 'Join Inner, (d_week_seq1#0 = (d_week_seq2#0 - 53))
      :- 'Project [d_week_seq#0 AS d_week_seq1#0, sun_sales#0 AS sun_sales1#0, mon_sales#0 AS mon_sales1#0, tue_sales#0 AS tue_sales1#0, wed_sales#0 AS wed_sales1#0, thu_sales#0 AS thu_sales1#0, fri_sales#0 AS fri_sales1#0, sat_sales#0 AS sat_sales1#0]
      :  +- 'Join Inner, (d_week_seq#0 = d_week_seq#0)
      :     :- 'Aggregate [d_week_seq#0], [d_week_seq#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Sunday) THEN sales_price#0 ELSE null END)),17,2) AS sun_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Monday) THEN sales_price#0 ELSE null END)),17,2) AS mon_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Tuesday) THEN sales_price#0 ELSE null END)),17,2) AS tue_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Wednesday) THEN sales_price#0 ELSE null END)),17,2) AS wed_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Thursday) THEN sales_price#0 ELSE null END)),17,2) AS thu_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Friday) THEN sales_price#0 ELSE null END)),17,2) AS fri_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Saturday) THEN sales_price#0 ELSE null END)),17,2) AS sat_sales#0]
      :     :  +- 'Project [sales_price#0, d_week_seq#0, d_day_name#0]
      :     :     +- 'Join Inner, (d_date_sk#0 = sold_date_sk#0)
      :     :        :- Union
      :     :        :  :- Project [ws_sold_date_sk#0 AS sold_date_sk#0, ws_ext_sales_price#0 AS sales_price#0]
      :     :        :  :  +- Filter isnotnull(ws_sold_date_sk#0)
      :     :        :  :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
      :     :        :  +- Project [cs_sold_date_sk#0 AS sold_date_sk#0, cs_ext_sales_price#0 AS sales_price#0]
      :     :        :     +- Filter isnotnull(cs_sold_date_sk#0)
      :     :        :        +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
      :     :        +- Project [d_date_sk#0, d_week_seq#0, d_day_name#0]
      :     :           +- Filter (isnotnull(d_date_sk#0) && isnotnull(d_week_seq#0))
      :     :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :     +- Project [d_week_seq#0]
      :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_week_seq#0))
      :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      +- 'Project [d_week_seq#0 AS d_week_seq2#0, sun_sales#0 AS sun_sales2#0, mon_sales#0 AS mon_sales2#0, tue_sales#0 AS tue_sales2#0, wed_sales#0 AS wed_sales2#0, thu_sales#0 AS thu_sales2#0, fri_sales#0 AS fri_sales2#0, sat_sales#0 AS sat_sales2#0]
         +- 'Join Inner, (d_week_seq#0 = d_week_seq#0)
            :- 'Aggregate [d_week_seq#0], [d_week_seq#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Sunday) THEN sales_price#0 ELSE null END)),17,2) AS sun_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Monday) THEN sales_price#0 ELSE null END)),17,2) AS mon_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Tuesday) THEN sales_price#0 ELSE null END)),17,2) AS tue_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Wednesday) THEN sales_price#0 ELSE null END)),17,2) AS wed_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Thursday) THEN sales_price#0 ELSE null END)),17,2) AS thu_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Friday) THEN sales_price#0 ELSE null END)),17,2) AS fri_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Saturday) THEN sales_price#0 ELSE null END)),17,2) AS sat_sales#0]
            :  +- 'Project [sales_price#0, d_week_seq#0, d_day_name#0]
            :     +- 'Join Inner, (d_date_sk#0 = sold_date_sk#0)
            :        :- Union
            :        :  :- Project [ws_sold_date_sk#0 AS sold_date_sk#0, ws_ext_sales_price#0 AS sales_price#0]
            :        :  :  +- Filter isnotnull(ws_sold_date_sk#0)
            :        :  :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :        :  +- Project [cs_sold_date_sk#0 AS sold_date_sk#0, cs_ext_sales_price#0 AS sales_price#0]
            :        :     +- Filter isnotnull(cs_sold_date_sk#0)
            :        :        +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :        +- Project [d_date_sk#0, d_week_seq#0, d_day_name#0]
            :           +- Filter (isnotnull(d_date_sk#0) && isnotnull(d_week_seq#0))
            :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- Project [d_week_seq#0]
               +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_week_seq#0))
                  +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q3
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [d_year#0 ASC NULLS FIRST, sum_agg#0 DESC NULLS LAST, brand_id#0 ASC NULLS FIRST], true
      +- 'Aggregate [d_year#0, i_brand#0, i_brand_id#0], [d_year#0, i_brand_id#0 AS brand_id#0, i_brand#0 AS brand#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS sum_agg#0]
         +- 'Project [d_year#0, ss_ext_sales_price#0, i_brand_id#0, i_brand#0]
            +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :- 'Project [d_year#0, ss_item_sk#0, ss_ext_sales_price#0]
               :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
               :     :- Project [d_date_sk#0, d_year#0]
               :     :  +- Filter ((isnotnull(d_moy#0) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
               :     :     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ext_sales_price#0]
               :        +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0))
               :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               +- Project [i_item_sk#0, i_brand_id#0, i_brand#0]
                  +- Filter ((isnotnull(i_manufact_id#0) && (i_manufact_id#0 = 128)) && isnotnull(i_item_sk#0))
                     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q4
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [customer_id#0 ASC NULLS FIRST, customer_first_name#0 ASC NULLS FIRST, customer_last_name#0 ASC NULLS FIRST, customer_preferred_cust_flag#0 ASC NULLS FIRST, customer_birth_country#0 ASC NULLS FIRST, customer_login#0 ASC NULLS FIRST, customer_email_address#0 ASC NULLS FIRST], true
      +- 'Project [customer_id#0, customer_first_name#0, customer_last_name#0, customer_preferred_cust_flag#0, customer_birth_country#0, customer_login#0, customer_email_address#0]
         +- 'Join Inner, ((customer_id#0 = customer_id#0) && (CASE WHEN (year_total#0 > 0.000000) THEN CheckOverflow((promote_precision(year_total#0) / promote_precision(year_total#0)), DecimalType(38,14)) ELSE null END > CASE WHEN (year_total#0 > 0.000000) THEN CheckOverflow((promote_precision(year_total#0) / promote_precision(year_total#0)), DecimalType(38,14)) ELSE null END))
            :- 'Project [customer_id#0, customer_id#0, customer_first_name#0, customer_last_name#0, customer_preferred_cust_flag#0, customer_birth_country#0, customer_login#0, customer_email_address#0, year_total#0, year_total#0, year_total#0]
            :  +- 'Join Inner, (customer_id#0 = customer_id#0)
            :     :- 'Project [customer_id#0, customer_id#0, customer_first_name#0, customer_last_name#0, customer_preferred_cust_flag#0, customer_birth_country#0, customer_login#0, customer_email_address#0, year_total#0, year_total#0]
            :     :  +- 'Join Inner, ((customer_id#0 = customer_id#0) && (CASE WHEN (year_total#0 > 0.000000) THEN CheckOverflow((promote_precision(year_total#0) / promote_precision(year_total#0)), DecimalType(38,14)) ELSE null END > CASE WHEN (year_total#0 > 0.000000) THEN CheckOverflow((promote_precision(year_total#0) / promote_precision(year_total#0)), DecimalType(38,14)) ELSE null END))
            :     :     :- 'Project [customer_id#0, year_total#0, customer_id#0, customer_first_name#0, customer_last_name#0, customer_preferred_cust_flag#0, customer_birth_country#0, customer_login#0, customer_email_address#0, year_total#0, year_total#0]
            :     :     :  +- 'Join Inner, (customer_id#0 = customer_id#0)
            :     :     :     :- 'Join Inner, (customer_id#0 = customer_id#0)
            :     :     :     :  :- 'Union
            :     :     :     :  :  :- 'Filter isnotnull(customer_id#0)
            :     :     :     :  :  :  +- 'Filter (isnotnull(year_total#0) && (year_total#0 > 0.000000))
            :     :     :     :  :  :     +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, d_year#0], [c_customer_id#0 AS customer_id#0, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#0 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#0 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#0 as decimal(10,2)))), DecimalType(10,2))) / 2.00), DecimalType(14,6))) AS year_total#0]
            :     :     :     :  :  :        +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ss_ext_discount_amt#0, ss_ext_sales_price#0, ss_ext_wholesale_cost#0, ss_ext_list_price#0, d_year#0]
            :     :     :     :  :  :           +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :  :  :              :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ss_sold_date_sk#0, ss_ext_discount_amt#0, ss_ext_sales_price#0, ss_ext_wholesale_cost#0, ss_ext_list_price#0]
            :     :     :     :  :  :              :  +- 'Join Inner, (c_customer_sk#0 = ss_customer_sk#0)
            :     :     :     :  :  :              :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
            :     :     :     :  :  :              :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :     :     :     :  :  :              :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :     :     :     :  :  :              :     +- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_ext_discount_amt#0, ss_ext_sales_price#0, ss_ext_wholesale_cost#0, ss_ext_list_price#0]
            :     :     :     :  :  :              :        +- Filter (isnotnull(ss_customer_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :     :  :  :              :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :     :  :  :              +- Project [d_date_sk#0, d_year#0]
            :     :     :     :  :  :                 +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :  :  :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :  :  :- Filter isnotnull(customer_id#0)
            :     :     :     :  :  :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :     :     :     :  :  +- Filter isnotnull(customer_id#0)
            :     :     :     :  :     +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :     :     :     :  +- 'Union
            :     :     :     :     :- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, d_year#0], [c_customer_id#0 AS customer_id#0, c_first_name#0 AS customer_first_name#0, c_last_name#0 AS customer_last_name#0, c_preferred_cust_flag#0 AS customer_preferred_cust_flag#0, c_birth_country#0 AS customer_birth_country#0, c_login#0 AS customer_login#0, c_email_address#0 AS customer_email_address#0, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#0 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#0 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#0 as decimal(10,2)))), DecimalType(10,2))) / 2.00), DecimalType(14,6))) AS year_total#0]
            :     :     :     :     :  +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ss_ext_discount_amt#0, ss_ext_sales_price#0, ss_ext_wholesale_cost#0, ss_ext_list_price#0, d_year#0]
            :     :     :     :     :     +- 'Filter isnotnull(c_customer_id#0)
            :     :     :     :     :        +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :           :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ss_sold_date_sk#0, ss_ext_discount_amt#0, ss_ext_sales_price#0, ss_ext_wholesale_cost#0, ss_ext_list_price#0]
            :     :     :     :     :           :  +- 'Join Inner, (c_customer_sk#0 = ss_customer_sk#0)
            :     :     :     :     :           :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
            :     :     :     :     :           :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :     :     :     :     :           :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :     :     :     :     :           :     +- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_ext_discount_amt#0, ss_ext_sales_price#0, ss_ext_wholesale_cost#0, ss_ext_list_price#0]
            :     :     :     :     :           :        +- Filter (isnotnull(ss_customer_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :     :     :           :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :     :     :           +- Project [d_date_sk#0, d_year#0]
            :     :     :     :     :              +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :     :     :     :     :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :- Filter isnotnull(customer_id#0)
            :     :     :     :     :  +- LocalRelation <empty>, [customer_id#0, customer_first_name#0, customer_last_name#0, customer_preferred_cust_flag#0, customer_birth_country#0, customer_login#0, customer_email_address#0, year_total#0]
            :     :     :     :     +- Filter isnotnull(customer_id#0)
            :     :     :     :        +- LocalRelation <empty>, [customer_id#0, customer_first_name#0, customer_last_name#0, customer_preferred_cust_flag#0, customer_birth_country#0, customer_login#0, customer_email_address#0, year_total#0]
            :     :     :     +- 'Union
            :     :     :        :- Filter isnotnull(customer_id#0)
            :     :     :        :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :     :     :        :- 'Filter isnotnull(customer_id#0)
            :     :     :        :  +- 'Filter (isnotnull(year_total#0) && (year_total#0 > 0.000000))
            :     :     :        :     +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, d_year#0], [c_customer_id#0 AS customer_id#0, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#0 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#0 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#0 as decimal(10,2)))), DecimalType(10,2))) / 2.00), DecimalType(14,6))) AS year_total#0]
            :     :     :        :        +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, cs_ext_discount_amt#0, cs_ext_sales_price#0, cs_ext_wholesale_cost#0, cs_ext_list_price#0, d_year#0]
            :     :     :        :           +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :        :              :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, cs_sold_date_sk#0, cs_ext_discount_amt#0, cs_ext_sales_price#0, cs_ext_wholesale_cost#0, cs_ext_list_price#0]
            :     :     :        :              :  +- 'Join Inner, (c_customer_sk#0 = cs_bill_customer_sk#0)
            :     :     :        :              :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
            :     :     :        :              :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :     :     :        :              :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :     :     :        :              :     +- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_ext_discount_amt#0, cs_ext_sales_price#0, cs_ext_wholesale_cost#0, cs_ext_list_price#0]
            :     :     :        :              :        +- Filter (isnotnull(cs_bill_customer_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :        :              :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :        :              +- Project [d_date_sk#0, d_year#0]
            :     :     :        :                 +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
            :     :     :        :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :        +- Filter isnotnull(customer_id#0)
            :     :     :           +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :     :     +- 'Union
            :     :        :- Filter isnotnull(customer_id#0)
            :     :        :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :     :        :- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, d_year#0], [c_customer_id#0 AS customer_id#0, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#0 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#0 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#0 as decimal(10,2)))), DecimalType(10,2))) / 2.00), DecimalType(14,6))) AS year_total#0]
            :     :        :  +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, cs_ext_discount_amt#0, cs_ext_sales_price#0, cs_ext_wholesale_cost#0, cs_ext_list_price#0, d_year#0]
            :     :        :     +- 'Filter isnotnull(c_customer_id#0)
            :     :        :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :        :           :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, cs_sold_date_sk#0, cs_ext_discount_amt#0, cs_ext_sales_price#0, cs_ext_wholesale_cost#0, cs_ext_list_price#0]
            :     :        :           :  +- 'Join Inner, (c_customer_sk#0 = cs_bill_customer_sk#0)
            :     :        :           :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
            :     :        :           :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :     :        :           :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :     :        :           :     +- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_ext_discount_amt#0, cs_ext_sales_price#0, cs_ext_wholesale_cost#0, cs_ext_list_price#0]
            :     :        :           :        +- Filter (isnotnull(cs_bill_customer_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :        :           :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :        :           +- Project [d_date_sk#0, d_year#0]
            :     :        :              +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :     :        :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :        +- Filter isnotnull(customer_id#0)
            :     :           +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :     +- 'Union
            :        :- Filter isnotnull(customer_id#0)
            :        :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :        :- Filter isnotnull(customer_id#0)
            :        :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :        +- 'Filter isnotnull(customer_id#0)
            :           +- 'Filter (isnotnull(year_total#0) && (year_total#0 > 0.000000))
            :              +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, d_year#0], [c_customer_id#0 AS customer_id#0, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#0 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#0 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#0 as decimal(10,2)))), DecimalType(10,2))) / 2.00), DecimalType(14,6))) AS year_total#0]
            :                 +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ws_ext_discount_amt#0, ws_ext_sales_price#0, ws_ext_wholesale_cost#0, ws_ext_list_price#0, d_year#0]
            :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :                       :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ws_sold_date_sk#0, ws_ext_discount_amt#0, ws_ext_sales_price#0, ws_ext_wholesale_cost#0, ws_ext_list_price#0]
            :                       :  +- 'Join Inner, (c_customer_sk#0 = ws_bill_customer_sk#0)
            :                       :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
            :                       :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :                       :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :                       :     +- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0, ws_ext_discount_amt#0, ws_ext_sales_price#0, ws_ext_wholesale_cost#0, ws_ext_list_price#0]
            :                       :        +- Filter (isnotnull(ws_bill_customer_sk#0) && isnotnull(ws_sold_date_sk#0))
            :                       :           +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                       +- Project [d_date_sk#0, d_year#0]
            :                          +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
            :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- 'Union
               :- Filter isnotnull(customer_id#0)
               :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
               :- Filter isnotnull(customer_id#0)
               :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
               +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, d_year#0], [c_customer_id#0 AS customer_id#0, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#0 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#0 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#0 as decimal(10,2)))), DecimalType(10,2))) / 2.00), DecimalType(14,6))) AS year_total#0]
                  +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ws_ext_discount_amt#0, ws_ext_sales_price#0, ws_ext_wholesale_cost#0, ws_ext_list_price#0, d_year#0]
                     +- 'Filter isnotnull(c_customer_id#0)
                        +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                           :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ws_sold_date_sk#0, ws_ext_discount_amt#0, ws_ext_sales_price#0, ws_ext_wholesale_cost#0, ws_ext_list_price#0]
                           :  +- 'Join Inner, (c_customer_sk#0 = ws_bill_customer_sk#0)
                           :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
                           :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
                           :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                           :     +- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0, ws_ext_discount_amt#0, ws_ext_sales_price#0, ws_ext_wholesale_cost#0, ws_ext_list_price#0]
                           :        +- Filter (isnotnull(ws_bill_customer_sk#0) && isnotnull(ws_sold_date_sk#0))
                           :           +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                           +- Project [d_date_sk#0, d_year#0]
                              +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
                                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q5
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [channel#0 ASC NULLS FIRST, id#0 ASC NULLS FIRST], true
      +- 'Aggregate [channel#0, id#0, spark_grouping_id#0], [channel#0, id#0, sum(sales#0) AS sales#0, sum(returns#0) AS returns#0, sum(profit#0) AS profit#0]
         +- 'Expand [List(sales#0, returns#0, profit#0, channel#0, id#0, 0), List(sales#0, returns#0, profit#0, channel#0, null, 1), List(sales#0, returns#0, profit#0, null, null, 3)], [sales#0, returns#0, profit#0, channel#0, id#0, spark_grouping_id#0]
            +- 'Union
               :- 'Aggregate [s_store_id#0], [MakeDecimal(sum(UnscaledValue(sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(return_amt#0)),17,2) AS RETURNS#0, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#0)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#0)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#0, store channel AS channel#0, concat(store, s_store_id#0) AS id#0]
               :  +- 'Project [sales_price#0, profit#0, return_amt#0, net_loss#0, s_store_id#0]
               :     +- 'Join Inner, (store_sk#0L = cast(s_store_sk#0 as bigint))
               :        :- 'Project [store_sk#0L, sales_price#0, profit#0, return_amt#0, net_loss#0]
               :        :  +- 'Join Inner, (date_sk#0L = cast(d_date_sk#0 as bigint))
               :        :     :- Union
               :        :     :  :- Project [cast(ss_store_sk#0 as bigint) AS store_sk#0L, cast(ss_sold_date_sk#0 as bigint) AS date_sk#0L, ss_ext_sales_price#0 AS sales_price#0, ss_net_profit#0 AS profit#0, 0.00 AS return_amt#0, 0.00 AS net_loss#0]
               :        :     :  :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && (isnotnull(cast(ss_sold_date_sk#0 as bigint)) && isnotnull(cast(ss_store_sk#0 as bigint))))
               :        :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :        :     :  +- Project [sr_store_sk#0L AS store_sk#0L, sr_returned_date_sk#0L AS date_sk#0L, 0.00 AS sales_price#0, 0.00 AS profit#0, sr_return_amt#0 AS return_amt#0, sr_net_loss#0 AS net_loss#0]
               :        :     :     +- Filter (isnotnull(sr_returned_date_sk#0L) && isnotnull(sr_store_sk#0L))
               :        :     :        +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               :        :     +- Project [d_date_sk#0]
               :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 11192)) && (d_date#0 <= 11206)) && isnotnull(d_date_sk#0))
               :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :        +- Project [s_store_sk#0, s_store_id#0]
               :           +- Filter isnotnull(s_store_sk#0)
               :              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :- 'Aggregate [cp_catalog_page_id#0], [MakeDecimal(sum(UnscaledValue(sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(return_amt#0)),17,2) AS RETURNS#0, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#0)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#0)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#0, catalog channel AS channel#0, concat(catalog_page, cp_catalog_page_id#0) AS id#0]
               :  +- 'Project [sales_price#0, profit#0, return_amt#0, net_loss#0, cp_catalog_page_id#0]
               :     +- 'Join Inner, (page_sk#0 = cp_catalog_page_sk#0)
               :        :- 'Project [page_sk#0, sales_price#0, profit#0, return_amt#0, net_loss#0]
               :        :  +- 'Join Inner, (date_sk#0 = d_date_sk#0)
               :        :     :- Union
               :        :     :  :- Project [cs_catalog_page_sk#0 AS page_sk#0, cs_sold_date_sk#0 AS date_sk#0, cs_ext_sales_price#0 AS sales_price#0, cs_net_profit#0 AS profit#0, 0.00 AS return_amt#0, 0.00 AS net_loss#0]
               :        :     :  :  +- Filter (isnotnull(cs_sold_date_sk#0) && isnotnull(cs_catalog_page_sk#0))
               :        :     :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :        :     :  +- Project [cr_catalog_page_sk#0 AS page_sk#0, cr_returned_date_sk#0 AS date_sk#0, 0.00 AS sales_price#0, 0.00 AS profit#0, cr_return_amount#0 AS return_amt#0, cr_net_loss#0 AS net_loss#0]
               :        :     :     +- Filter (isnotnull(cr_returned_date_sk#0) && isnotnull(cr_catalog_page_sk#0))
               :        :     :        +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
               :        :     +- Project [d_date_sk#0]
               :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 11192)) && (d_date#0 <= 11206)) && isnotnull(d_date_sk#0))
               :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :        +- Project [cp_catalog_page_sk#0, cp_catalog_page_id#0]
               :           +- Filter isnotnull(cp_catalog_page_sk#0)
               :              +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#0,cp_start_date_sk#0,cp_end_date_sk#0,cp_department#0,cp_catalog_number#0,cp_catalog_page_number#0,cp_description#0,cp_type#0] parquet
               +- 'Aggregate [web_site_id#0], [MakeDecimal(sum(UnscaledValue(sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(return_amt#0)),17,2) AS RETURNS#0, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#0)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#0)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#0, web channel AS channel#0, concat(web_site, web_site_id#0) AS id#0]
                  +- 'Project [sales_price#0, profit#0, return_amt#0, net_loss#0, web_site_id#0]
                     +- 'Join Inner, (wsr_web_site_sk#0 = web_site_sk#0)
                        :- 'Project [wsr_web_site_sk#0, sales_price#0, profit#0, return_amt#0, net_loss#0]
                        :  +- 'Join Inner, (date_sk#0L = cast(d_date_sk#0 as bigint))
                        :     :- 'Union
                        :     :  :- Project [ws_web_site_sk#0 AS wsr_web_site_sk#0, cast(ws_sold_date_sk#0 as bigint) AS date_sk#0L, ws_ext_sales_price#0 AS sales_price#0, ws_net_profit#0 AS profit#0, 0.00 AS return_amt#0, 0.00 AS net_loss#0]
                        :     :  :  +- Filter (isnotnull(ws_sold_date_sk#0) && (isnotnull(cast(ws_sold_date_sk#0 as bigint)) && isnotnull(ws_web_site_sk#0)))
                        :     :  :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                        :     :  +- 'Project [ws_web_site_sk#0 AS wsr_web_site_sk#0, wr_returned_date_sk#0L AS date_sk#0L, 0.00 AS sales_price#0, 0.00 AS profit#0, wr_return_amt#0 AS return_amt#0, wr_net_loss#0 AS net_loss#0]
                        :     :     +- 'Join Inner, ((wr_item_sk#0L = cast(ws_item_sk#0 as bigint)) && (wr_order_number#0L = cast(ws_order_number#0 as bigint)))
                        :     :        :- Project [wr_returned_date_sk#0L, wr_item_sk#0L, wr_order_number#0L, wr_return_amt#0, wr_net_loss#0]
                        :     :        :  +- Filter (isnotnull(wr_item_sk#0L) && isnotnull(wr_order_number#0L))
                        :     :        :     +- Filter isnotnull(wr_returned_date_sk#0L)
                        :     :        :        +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
                        :     :        +- Project [ws_item_sk#0, ws_web_site_sk#0, ws_order_number#0]
                        :     :           +- Filter ((isnotnull(ws_item_sk#0) && isnotnull(ws_order_number#0)) && isnotnull(ws_web_site_sk#0))
                        :     :              +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                        :     +- Project [d_date_sk#0]
                        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 11192)) && (d_date#0 <= 11206)) && isnotnull(d_date_sk#0))
                        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        +- Project [web_site_sk#0, web_site_id#0]
                           +- Filter isnotnull(web_site_sk#0)
                              +- Relation[web_site_sk#0,web_site_id#0,web_rec_start_date#0,web_rec_end_date#0,web_name#0,web_open_date_sk#0,web_close_date_sk#0,web_class#0,web_manager#0,web_mkt_id#0,web_mkt_class#0,web_mkt_desc#0,web_market_manager#0,web_company_id#0,web_company_name#0,web_street_number#0,web_street_name#0,web_street_type#0,web_suite_number#0,web_city#0,web_county#0,web_state#0,web_zip#0,web_country#0,... 2 more fields] parquet


================================================================================================
q6
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [cnt#0L ASC NULLS FIRST], true
      +- 'Project [state#0, cnt#0L]
         +- 'Filter (count(1)#0L >= 10)
            +- 'Aggregate [ca_state#0], [ca_state#0 AS state#0, count(1) AS cnt#0L, count(1) AS count(1)#0L]
               +- 'Project [ca_state#0]
                  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                     :- 'Project [ca_state#0, ss_item_sk#0]
                     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                     :     :- 'Project [ca_state#0, ss_sold_date_sk#0, ss_item_sk#0]
                     :     :  +- 'Join Inner, (c_customer_sk#0 = ss_customer_sk#0)
                     :     :     :- 'Project [ca_state#0, c_customer_sk#0]
                     :     :     :  +- 'Join Inner, (ca_address_sk#0 = c_current_addr_sk#0)
                     :     :     :     :- Project [ca_address_sk#0, ca_state#0]
                     :     :     :     :  +- Filter isnotnull(ca_address_sk#0)
                     :     :     :     :     +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                     :     :     :     +- Project [c_customer_sk#0, c_current_addr_sk#0]
                     :     :     :        +- Filter (isnotnull(c_current_addr_sk#0) && isnotnull(c_customer_sk#0))
                     :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                     :     :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0]
                     :     :        +- Filter ((isnotnull(ss_customer_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_item_sk#0))
                     :     :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                     :     +- Project [d_date_sk#0]
                     :        +- Filter ((isnotnull(d_month_seq#0) && (d_month_seq#0 = scalar-subquery#0 [])) && isnotnull(d_date_sk#0))
                     :           :  +- Aggregate [d_month_seq#27], [d_month_seq#27]
                     :           :     +- Project [d_month_seq#27]
                     :           :        +- Filter (((isnotnull(d_year#30) && isnotnull(d_moy#32)) && (d_year#30 = 2000)) && (d_moy#32 = 1))
                     :           :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     +- 'Project [i_item_sk#0]
                        +- 'Filter (cast(i_current_price#0 as decimal(14,7)) > CheckOverflow((1.200000 * promote_precision(avg(i_current_price)#0)), DecimalType(14,7)))
                           +- 'Join LeftOuter, (i_category#315#0 = i_category#0)
                              :- Project [i_item_sk#0, i_current_price#0, i_category#0]
                              :  +- Filter (isnotnull(i_current_price#0) && isnotnull(i_item_sk#0))
                              :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              +- Aggregate [i_category#0], [cast((avg(UnscaledValue(i_current_price#0)) / 100.0) as decimal(11,6)) AS avg(i_current_price)#0, i_category#0 AS i_category#315#0]
                                 +- Project [i_current_price#0, i_category#0]
                                    +- Filter isnotnull(i_category#0)
                                       +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q7
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_item_id#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_item_id#0], [i_item_id#0, avg(cast(ss_quantity#0 as bigint)) AS agg1#0, cast((avg(UnscaledValue(ss_list_price#0)) / 100.0) as decimal(11,6)) AS agg2#0, cast((avg(UnscaledValue(ss_coupon_amt#0)) / 100.0) as decimal(11,6)) AS agg3#0, cast((avg(UnscaledValue(ss_sales_price#0)) / 100.0) as decimal(11,6)) AS agg4#0]
         +- 'Project [ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0, i_item_id#0]
            +- 'Join Inner, (ss_promo_sk#0 = p_promo_sk#0)
               :- 'Project [ss_promo_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0, i_item_id#0]
               :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :     :- 'Project [ss_item_sk#0, ss_promo_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
               :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_promo_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
               :     :     :  +- 'Join Inner, (ss_cdemo_sk#0 = cd_demo_sk#0)
               :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_cdemo_sk#0, ss_promo_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
               :     :     :     :  +- Filter (((isnotnull(ss_cdemo_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_item_sk#0)) && isnotnull(ss_promo_sk#0))
               :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     :     +- Project [cd_demo_sk#0]
               :     :     :        +- Filter ((((((isnotnull(cd_education_status#0) && isnotnull(cd_marital_status#0)) && isnotnull(cd_gender#0)) && (cd_gender#0 = M)) && (cd_marital_status#0 = S)) && (cd_education_status#0 = College)) && isnotnull(cd_demo_sk#0))
               :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
               :     :     +- Project [d_date_sk#0]
               :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
               :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [i_item_sk#0, i_item_id#0]
               :        +- Filter isnotnull(i_item_sk#0)
               :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               +- Project [p_promo_sk#0]
                  +- Filter (((p_channel_email#0 = N) || (p_channel_event#0 = N)) && isnotnull(p_promo_sk#0))
                     +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet


================================================================================================
q8
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [s_store_name#0 ASC NULLS FIRST], true
      +- 'Aggregate [s_store_name#0], [s_store_name#0, MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS sum(ss_net_profit)#0]
         +- 'Project [ss_net_profit#0, s_store_name#0]
            +- 'Join Inner, (substring(s_zip#0, 1, 2) = substring(ca_zip#0, 1, 2))
               :- 'Project [ss_net_profit#0, s_store_name#0, s_zip#0]
               :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :     :- 'Project [ss_store_sk#0, ss_net_profit#0]
               :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :     :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_net_profit#0]
               :     :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0))
               :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     +- Project [d_date_sk#0]
               :     :        +- Filter ((((isnotnull(d_qoy#0) && isnotnull(d_year#0)) && (d_qoy#0 = 2)) && (d_year#0 = 1998)) && isnotnull(d_date_sk#0))
               :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [s_store_sk#0, s_store_name#0, s_zip#0]
               :        +- Filter (isnotnull(s_store_sk#0) && isnotnull(s_zip#0))
               :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               +- 'Aggregate [ca_zip#0], [ca_zip#0]
                  +- 'Join LeftSemi, (ca_zip#0 <=> ca_zip#0)
                     :- Project [substring(ca_zip#0, 1, 5) AS ca_zip#0]
                     :  +- Filter (isnotnull(ca_zip#0) && (substring(ca_zip#0, 1, 5) INSET (56910,69952,63792,39371,74351,11101,25003,97189,57834,73134,62377,51200,32754,22752,86379,14171,91110,40162,98569,28709,13394,66162,25733,25782,26065,18383,51949,87343,50298,83849,33786,64528,23470,67030,46136,25280,46820,77721,99076,18426,31880,17871,98235,45748,49156,18652,72013,51622,43848,78567,41248,13695,44165,67853,54917,53179,64034,10567,71791,68908,55565,59402,64147,85816,57855,61547,27700,68100,28810,58263,15723,83933,51103,58058,90578,82276,81096,81426,96451,77556,38607,76638,18906,62971,57047,48425,35576,11928,30625,83444,73520,51650,57647,60099,30122,94983,24128,10445,41368,26233,26859,21756,24676,19849,36420,38193,58470,39127,13595,87501,24317,15455,69399,98025,81019,48033,11376,39516,67875,92712,14867,38122,29741,42961,30469,51211,56458,15559,16021,33123,33282,33515,72823,54601,76698,56240,72175,60279,20004,68806,72325,28488,43933,50412,45200,22246,78668,79777,96765,67301,73273,49448,82636,23932,47305,29839,39192,18799,61265,37125,58943,64457,88424,24610,84935,89360,68893,30431,28898,10336,90257,59166,46081,26105,96888,36634,86284,35258,39972,22927,73241,53268,24206,27385,99543,31671,14663,30903,39861,24996,63089,88086,83921,21076,67897,66708,45721,60576,25103,52867,30450,36233,30010,96576,73171,56571,56575,64544,13955,78451,43285,18119,16725,83041,76107,79994,54364,35942,56691,19769,63435,34102,18845,22744,13354,75691,45549,23968,31387,83144,13375,15765,28577,88190,19736,73650,37930,25989,83926,94898,51798,39736,22437,55253,38415,71256,18376,42029,25858,44438,19515,38935,51649,71954,15882,18767,63193,25486,49130,37126,40604,34425,17043,12305,11634,26653,94167,36446,10516,67473,66864,72425,63981,18842,22461,42666,47770,69035,70372,28587,45266,15371,15798,45375,90225,16807,31016,68014,21337,19505,50016,10144,84093,21286,19430,34322,91068,94945,72305,24671,58048,65084,28545,21195,20548,22245,77191,96976,48583,76231,15734,61810,11356,68621,68786,98359,41367,26689,69913,76614,68101,88885,50308,79077,18270,28915,29178,53672,62878,10390,14922,68341,56529,41766,68309,56616,15126,61860,97789,11489,45692,41918,72151,72550,27156,36495,70738,17879,53535,17920,68880,78890,35850,14089,58078,65164,27068,26231,13376,57665,32213,77610,87816,21309,15146,86198,91137,55307,67467,40558,94627,82136,22351,89091,20260,23006,91393,47537,62496,98294,18840,71286,81312,31029,70466,35458,14060,22685,28286,25631,19512,40081,63837,14328,35474,22152,76232,51061,86057,17183) && isnotnull(substring(ca_zip#0, 1, 5))))
                     :     +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                     +- 'Project [ca_zip#0]
                        +- 'Filter (count(1)#0L > 10)
                           +- 'Aggregate [ca_zip#0], [substring(ca_zip#0, 1, 5) AS ca_zip#0, count(1) AS count(1)#0L]
                              +- 'Project [ca_zip#0]
                                 +- 'Join Inner, (ca_address_sk#0 = c_current_addr_sk#0)
                                    :- Project [ca_address_sk#0, ca_zip#0]
                                    :  +- Filter isnotnull(ca_address_sk#0)
                                    :     +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                                    +- Project [c_current_addr_sk#0]
                                       +- Filter ((isnotnull(c_preferred_cust_flag#0) && (c_preferred_cust_flag#0 = Y)) && isnotnull(c_current_addr_sk#0))
                                          +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet


================================================================================================
q9
================================================================================================

Project [CASE WHEN (scalar-subquery#0 [] > 62316685) THEN scalar-subquery#0 [] ELSE scalar-subquery#0 [] END AS bucket1#0, CASE WHEN (scalar-subquery#0 [] > 19045798) THEN scalar-subquery#0 [] ELSE scalar-subquery#0 [] END AS bucket2#0, CASE WHEN (scalar-subquery#0 [] > 365541424) THEN scalar-subquery#0 [] ELSE scalar-subquery#0 [] END AS bucket3#0, CASE WHEN (scalar-subquery#0 [] > 216357808) THEN scalar-subquery#0 [] ELSE scalar-subquery#0 [] END AS bucket4#0, CASE WHEN (scalar-subquery#0 [] > 184483884) THEN scalar-subquery#0 [] ELSE scalar-subquery#0 [] END AS bucket5#0]
:  :- Aggregate [count(1) AS count(1)#715L]
:  :  +- Project
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 1)) && (ss_quantity#290 <= 20))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  :- Aggregate [cast((avg(UnscaledValue(ss_ext_discount_amt#294)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#717]
:  :  +- Project [ss_ext_discount_amt#294]
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 1)) && (ss_quantity#290 <= 20))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  :- Aggregate [cast((avg(UnscaledValue(ss_net_paid#300)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#719]
:  :  +- Project [ss_net_paid#300]
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 1)) && (ss_quantity#290 <= 20))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  :- Aggregate [count(1) AS count(1)#721L]
:  :  +- Project
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 21)) && (ss_quantity#290 <= 40))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  :- Aggregate [cast((avg(UnscaledValue(ss_ext_discount_amt#294)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#723]
:  :  +- Project [ss_ext_discount_amt#294]
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 21)) && (ss_quantity#290 <= 40))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  :- Aggregate [cast((avg(UnscaledValue(ss_net_paid#300)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#725]
:  :  +- Project [ss_net_paid#300]
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 21)) && (ss_quantity#290 <= 40))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  :- Aggregate [count(1) AS count(1)#727L]
:  :  +- Project
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 41)) && (ss_quantity#290 <= 60))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  :- Aggregate [cast((avg(UnscaledValue(ss_ext_discount_amt#294)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#729]
:  :  +- Project [ss_ext_discount_amt#294]
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 41)) && (ss_quantity#290 <= 60))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  :- Aggregate [cast((avg(UnscaledValue(ss_net_paid#300)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#731]
:  :  +- Project [ss_net_paid#300]
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 41)) && (ss_quantity#290 <= 60))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  :- Aggregate [count(1) AS count(1)#733L]
:  :  +- Project
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 61)) && (ss_quantity#290 <= 80))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  :- Aggregate [cast((avg(UnscaledValue(ss_ext_discount_amt#294)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#735]
:  :  +- Project [ss_ext_discount_amt#294]
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 61)) && (ss_quantity#290 <= 80))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  :- Aggregate [cast((avg(UnscaledValue(ss_net_paid#300)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#737]
:  :  +- Project [ss_net_paid#300]
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 61)) && (ss_quantity#290 <= 80))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  :- Aggregate [count(1) AS count(1)#739L]
:  :  +- Project
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 81)) && (ss_quantity#290 <= 100))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  :- Aggregate [cast((avg(UnscaledValue(ss_ext_discount_amt#294)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#741]
:  :  +- Project [ss_ext_discount_amt#294]
:  :     +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 81)) && (ss_quantity#290 <= 100))
:  :        +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
:  +- Aggregate [cast((avg(UnscaledValue(ss_net_paid#300)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#743]
:     +- Project [ss_net_paid#300]
:        +- Filter ((isnotnull(ss_quantity#290) && (ss_quantity#290 >= 81)) && (ss_quantity#290 <= 100))
:           +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
+- Filter (isnotnull(r_reason_sk#0) && (r_reason_sk#0 = 1))
   +- Relation[r_reason_sk#0,r_reason_id#0,r_reason_desc#0] parquet


================================================================================================
q10
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [cd_gender#0 ASC NULLS FIRST, cd_marital_status#0 ASC NULLS FIRST, cd_education_status#0 ASC NULLS FIRST, cd_purchase_estimate#0 ASC NULLS FIRST, cd_credit_rating#0 ASC NULLS FIRST, cd_dep_count#0 ASC NULLS FIRST, cd_dep_employed_count#0 ASC NULLS FIRST, cd_dep_college_count#0 ASC NULLS FIRST], true
      +- 'Aggregate [cd_gender#0, cd_marital_status#0, cd_education_status#0, cd_purchase_estimate#0, cd_credit_rating#0, cd_dep_count#0, cd_dep_employed_count#0, cd_dep_college_count#0], [cd_gender#0, cd_marital_status#0, cd_education_status#0, count(1) AS cnt1#0L, cd_purchase_estimate#0, count(1) AS cnt2#0L, cd_credit_rating#0, count(1) AS cnt3#0L, cd_dep_count#0, count(1) AS cnt4#0L, cd_dep_employed_count#0, count(1) AS cnt5#0L, cd_dep_college_count#0, count(1) AS cnt6#0L]
         +- 'Project [cd_gender#0, cd_marital_status#0, cd_education_status#0, cd_purchase_estimate#0, cd_credit_rating#0, cd_dep_count#0, cd_dep_employed_count#0, cd_dep_college_count#0]
            +- 'Join Inner, (cd_demo_sk#0 = c_current_cdemo_sk#0)
               :- 'Project [c_current_cdemo_sk#0]
               :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
               :     :- 'Project [c_current_cdemo_sk#0, c_current_addr_sk#0]
               :     :  +- 'Filter (exists#0 || exists#0)
               :     :     +- 'Join ExistenceJoin(exists#779), (c_customer_sk#0 = cs_ship_customer_sk#0)
               :     :        :- 'Join ExistenceJoin(exists#778), (c_customer_sk#0 = ws_bill_customer_sk#0)
               :     :        :  :- 'Join LeftSemi, (c_customer_sk#0 = ss_customer_sk#0)
               :     :        :  :  :- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_addr_sk#0]
               :     :        :  :  :  +- Filter isnotnull(c_customer_sk#0)
               :     :        :  :  :     +- Filter (isnotnull(c_current_addr_sk#0) && isnotnull(c_current_cdemo_sk#0))
               :     :        :  :  :        +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
               :     :        :  :  +- 'Project [ss_customer_sk#0]
               :     :        :  :     +- 'Filter isnotnull(ss_customer_sk#0)
               :     :        :  :        +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :        :  :           :- Project [ss_sold_date_sk#0, ss_customer_sk#0]
               :     :        :  :           :  +- Filter isnotnull(ss_sold_date_sk#0)
               :     :        :  :           :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :        :  :           +- Project [d_date_sk#0]
               :     :        :  :              +- Filter (((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2002)) && (d_moy#0 >= 1)) && (d_moy#0 <= 4)) && isnotnull(d_date_sk#0))
               :     :        :  :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :        :  +- 'Project [ws_bill_customer_sk#0]
               :     :        :     +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :     :        :        :- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0]
               :     :        :        :  +- Filter isnotnull(ws_sold_date_sk#0)
               :     :        :        :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :        :        +- Project [d_date_sk#0]
               :     :        :           +- Filter (((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2002)) && (d_moy#0 >= 1)) && (d_moy#0 <= 4)) && isnotnull(d_date_sk#0))
               :     :        :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :        +- 'Project [cs_ship_customer_sk#0]
               :     :           +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :     :              :- Project [cs_sold_date_sk#0, cs_ship_customer_sk#0]
               :     :              :  +- Filter isnotnull(cs_sold_date_sk#0)
               :     :              :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :              +- Project [d_date_sk#0]
               :     :                 +- Filter (((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2002)) && (d_moy#0 >= 1)) && (d_moy#0 <= 4)) && isnotnull(d_date_sk#0))
               :     :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [ca_address_sk#0]
               :        +- Filter (ca_county#0 IN (Rush County,Toole County,Jefferson County,Dona Ana County,La Porte County) && isnotnull(ca_address_sk#0))
               :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               +- Filter isnotnull(cd_demo_sk#0)
                  +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet


================================================================================================
q11
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [customer_preferred_cust_flag#0 ASC NULLS FIRST], true
      +- 'Project [customer_preferred_cust_flag#0]
         +- 'Join Inner, ((customer_id#0 = customer_id#0) && (CASE WHEN (year_total#0 > 0.00) THEN CheckOverflow((promote_precision(year_total#0) / promote_precision(year_total#0)), DecimalType(38,20)) ELSE null END > CASE WHEN (year_total#0 > 0.00) THEN CheckOverflow((promote_precision(year_total#0) / promote_precision(year_total#0)), DecimalType(38,20)) ELSE null END))
            :- 'Project [customer_id#0, year_total#0, customer_preferred_cust_flag#0, year_total#0, year_total#0]
            :  +- 'Join Inner, (customer_id#0 = customer_id#0)
            :     :- 'Project [customer_id#0, year_total#0, customer_preferred_cust_flag#0, year_total#0]
            :     :  +- 'Join Inner, (customer_id#0 = customer_id#0)
            :     :     :- 'Union
            :     :     :  :- 'Filter isnotnull(customer_id#0)
            :     :     :  :  +- 'Filter (isnotnull(year_total#0) && (year_total#0 > 0.00))
            :     :     :  :     +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, d_year#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0], [c_customer_id#0 AS customer_id#0, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ss_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#0 as decimal(8,2)))), DecimalType(8,2)))),18,2) AS year_total#0]
            :     :     :  :        +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ss_ext_discount_amt#0, ss_ext_list_price#0, d_year#0]
            :     :     :  :           +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :  :              :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ss_sold_date_sk#0, ss_ext_discount_amt#0, ss_ext_list_price#0]
            :     :     :  :              :  +- 'Join Inner, (c_customer_sk#0 = ss_customer_sk#0)
            :     :     :  :              :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
            :     :     :  :              :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :     :     :  :              :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :     :     :  :              :     +- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_ext_discount_amt#0, ss_ext_list_price#0]
            :     :     :  :              :        +- Filter (isnotnull(ss_customer_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :  :              :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :  :              +- Project [d_date_sk#0, d_year#0]
            :     :     :  :                 +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
            :     :     :  :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :  +- Filter isnotnull(customer_id#0)
            :     :     :     +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :     :     +- 'Union
            :     :        :- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, d_year#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0], [c_customer_id#0 AS customer_id#0, c_preferred_cust_flag#0 AS customer_preferred_cust_flag#0, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ss_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#0 as decimal(8,2)))), DecimalType(8,2)))),18,2) AS year_total#0]
            :     :        :  +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ss_ext_discount_amt#0, ss_ext_list_price#0, d_year#0]
            :     :        :     +- 'Filter isnotnull(c_customer_id#0)
            :     :        :        +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :        :           :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ss_sold_date_sk#0, ss_ext_discount_amt#0, ss_ext_list_price#0]
            :     :        :           :  +- 'Join Inner, (c_customer_sk#0 = ss_customer_sk#0)
            :     :        :           :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
            :     :        :           :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :     :        :           :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :     :        :           :     +- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_ext_discount_amt#0, ss_ext_list_price#0]
            :     :        :           :        +- Filter (isnotnull(ss_customer_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :        :           :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :        :           +- Project [d_date_sk#0, d_year#0]
            :     :        :              +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :     :        :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :        +- Filter isnotnull(customer_id#0)
            :     :           +- LocalRelation <empty>, [customer_id#0, customer_preferred_cust_flag#0, year_total#0]
            :     +- 'Union
            :        :- Filter isnotnull(customer_id#0)
            :        :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :        +- 'Filter isnotnull(customer_id#0)
            :           +- 'Filter (isnotnull(year_total#0) && (year_total#0 > 0.00))
            :              +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, d_year#0], [c_customer_id#0 AS customer_id#0, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ws_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#0 as decimal(8,2)))), DecimalType(8,2)))),18,2) AS year_total#0]
            :                 +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ws_ext_discount_amt#0, ws_ext_list_price#0, d_year#0]
            :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :                       :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ws_sold_date_sk#0, ws_ext_discount_amt#0, ws_ext_list_price#0]
            :                       :  +- 'Join Inner, (c_customer_sk#0 = ws_bill_customer_sk#0)
            :                       :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
            :                       :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :                       :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :                       :     +- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0, ws_ext_discount_amt#0, ws_ext_list_price#0]
            :                       :        +- Filter (isnotnull(ws_bill_customer_sk#0) && isnotnull(ws_sold_date_sk#0))
            :                       :           +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                       +- Project [d_date_sk#0, d_year#0]
            :                          +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
            :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- 'Union
               :- Filter isnotnull(customer_id#0)
               :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
               +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, d_year#0], [c_customer_id#0 AS customer_id#0, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ws_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#0 as decimal(8,2)))), DecimalType(8,2)))),18,2) AS year_total#0]
                  +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ws_ext_discount_amt#0, ws_ext_list_price#0, d_year#0]
                     +- 'Filter isnotnull(c_customer_id#0)
                        +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                           :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ws_sold_date_sk#0, ws_ext_discount_amt#0, ws_ext_list_price#0]
                           :  +- 'Join Inner, (c_customer_sk#0 = ws_bill_customer_sk#0)
                           :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
                           :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
                           :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                           :     +- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0, ws_ext_discount_amt#0, ws_ext_list_price#0]
                           :        +- Filter (isnotnull(ws_bill_customer_sk#0) && isnotnull(ws_sold_date_sk#0))
                           :           +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                           +- Project [d_date_sk#0, d_year#0]
                              +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
                                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q12
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Project [i_item_desc#0, i_category#0, i_class#0, i_current_price#0, itemrevenue#0, revenueratio#0]
      +- 'Sort [i_category#0 ASC NULLS FIRST, i_class#0 ASC NULLS FIRST, i_item_id#0 ASC NULLS FIRST, i_item_desc#0 ASC NULLS FIRST, revenueratio#0 ASC NULLS FIRST], true
         +- 'Project [i_item_desc#0, i_category#0, i_class#0, i_current_price#0, itemrevenue#0, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(_w0#0) * 100.00), DecimalType(21,2)) as decimal(27,2))) / promote_precision(_we0#0)), DecimalType(38,17)) AS revenueratio#0, i_item_id#0]
            +- 'Window [sum(_w1#0) windowspecdefinition(i_class#0, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#0], [i_class#0]
               +- 'Aggregate [i_item_id#0, i_item_desc#0, i_category#0, i_class#0, i_current_price#0], [i_item_desc#0, i_category#0, i_class#0, i_current_price#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS itemrevenue#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS _w0#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS _w1#0, i_item_id#0]
                  +- 'Project [ws_ext_sales_price#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                     +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                        :- 'Project [ws_sold_date_sk#0, ws_ext_sales_price#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                        :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                        :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_ext_sales_price#0]
                        :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                        :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                        :     +- Project [i_item_sk#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                        :        +- Filter (i_category#0 IN (Sports,Books,Home) && isnotnull(i_item_sk#0))
                        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        +- Project [d_date_sk#0]
                           +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10644)) && (d_date#0 <= 10674)) && isnotnull(d_date_sk#0))
                              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q13
================================================================================================

'Aggregate [avg(cast(ss_quantity#0 as bigint)) AS avg(ss_quantity)#0, cast((avg(UnscaledValue(ss_ext_sales_price#0)) / 100.0) as decimal(11,6)) AS avg(ss_ext_sales_price)#0, cast((avg(UnscaledValue(ss_ext_wholesale_cost#0)) / 100.0) as decimal(11,6)) AS avg(ss_ext_wholesale_cost)#0, MakeDecimal(sum(UnscaledValue(ss_ext_wholesale_cost#0)),17,2) AS sum(ss_ext_wholesale_cost)#0]
+- 'Project [ss_quantity#0, ss_ext_sales_price#0, ss_ext_wholesale_cost#0]
   +- 'Join Inner, ((ss_hdemo_sk#0 = hd_demo_sk#0) && (((((((cd_marital_status#0 = M) && (cd_education_status#0 = Advanced Degree)) && (ss_sales_price#0 >= 100.00)) && (ss_sales_price#0 <= 150.00)) && (hd_dep_count#0 = 3)) || (((((cd_marital_status#0 = S) && (cd_education_status#0 = College)) && (ss_sales_price#0 >= 50.00)) && (ss_sales_price#0 <= 100.00)) && (hd_dep_count#0 = 1))) || (((((cd_marital_status#0 = W) && (cd_education_status#0 = 2 yr Degree)) && (ss_sales_price#0 >= 150.00)) && (ss_sales_price#0 <= 200.00)) && (hd_dep_count#0 = 1))))
      :- 'Project [ss_hdemo_sk#0, ss_quantity#0, ss_sales_price#0, ss_ext_sales_price#0, ss_ext_wholesale_cost#0, cd_marital_status#0, cd_education_status#0]
      :  +- 'Join Inner, (cd_demo_sk#0 = ss_cdemo_sk#0)
      :     :- 'Project [ss_cdemo_sk#0, ss_hdemo_sk#0, ss_quantity#0, ss_sales_price#0, ss_ext_sales_price#0, ss_ext_wholesale_cost#0]
      :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
      :     :     :- 'Project [ss_sold_date_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_quantity#0, ss_sales_price#0, ss_ext_sales_price#0, ss_ext_wholesale_cost#0]
      :     :     :  +- 'Join Inner, ((ss_addr_sk#0 = ca_address_sk#0) && ((((ca_state#0 IN (TX,OH) && (ss_net_profit#0 >= 100.00)) && (ss_net_profit#0 <= 200.00)) || ((ca_state#0 IN (OR,NM,KY) && (ss_net_profit#0 >= 150.00)) && (ss_net_profit#0 <= 300.00))) || ((ca_state#0 IN (VA,TX,MS) && (ss_net_profit#0 >= 50.00)) && (ss_net_profit#0 <= 250.00))))
      :     :     :     :- 'Project [ss_sold_date_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_quantity#0, ss_sales_price#0, ss_ext_sales_price#0, ss_ext_wholesale_cost#0, ss_net_profit#0]
      :     :     :     :  +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
      :     :     :     :     :- Project [ss_sold_date_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0, ss_ext_sales_price#0, ss_ext_wholesale_cost#0, ss_net_profit#0]
      :     :     :     :     :  +- Filter ((((isnotnull(ss_store_sk#0) && isnotnull(ss_addr_sk#0)) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_cdemo_sk#0)) && isnotnull(ss_hdemo_sk#0))
      :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :     :     :     :     +- Project [s_store_sk#0]
      :     :     :     :        +- Filter isnotnull(s_store_sk#0)
      :     :     :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
      :     :     :     +- Project [ca_address_sk#0, ca_state#0]
      :     :     :        +- Filter ((isnotnull(ca_country#0) && (ca_country#0 = United States)) && isnotnull(ca_address_sk#0))
      :     :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
      :     :     +- Project [d_date_sk#0]
      :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
      :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :     +- Project [cd_demo_sk#0, cd_marital_status#0, cd_education_status#0]
      :        +- Filter isnotnull(cd_demo_sk#0)
      :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
      +- Project [hd_demo_sk#0, hd_dep_count#0]
         +- Filter isnotnull(hd_demo_sk#0)
            +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet


================================================================================================
q14a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [channel#0 ASC NULLS FIRST, i_brand_id#0 ASC NULLS FIRST, i_class_id#0 ASC NULLS FIRST, i_category_id#0 ASC NULLS FIRST], true
      +- 'Aggregate [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, spark_grouping_id#0], [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(sales#0) AS sum(sales)#0, sum(number_sales#0L) AS sum(number_sales)#0L]
         +- 'Expand [List(sales#0, number_sales#0L, channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, 0), List(sales#0, number_sales#0L, channel#0, i_brand_id#0, i_class_id#0, null, 1), List(sales#0, number_sales#0L, channel#0, i_brand_id#0, null, null, 3), List(sales#0, number_sales#0L, channel#0, null, null, null, 7), List(sales#0, number_sales#0L, null, null, null, null, 15)], [sales#0, number_sales#0L, channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, spark_grouping_id#0]
            +- 'Union
               :- 'Project [sales#0, number_sales#0L, channel#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
               :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#885 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#890]
               :     :     +- Union
               :     :        :- Project [ss_quantity#290 AS quantity#884, ss_list_price#292 AS list_price#885]
               :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
               :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
               :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
               :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
               :     :        :     +- Project [d_date_sk#24]
               :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
               :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               :     :        :- Project [cs_quantity#183 AS quantity#886, cs_list_price#185 AS list_price#887]
               :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
               :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
               :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
               :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
               :     :        :     +- Project [d_date_sk#24]
               :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
               :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               :     :        +- Project [ws_quantity#149 AS quantity#888, ws_list_price#151 AS list_price#889]
               :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
               :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
               :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
               :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
               :     :              +- Project [d_date_sk#24]
               :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
               :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [store AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0]
               :        +- 'Project [ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :           +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :              :- 'Project [ss_sold_date_sk#0, ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :              :     :- 'Join LeftSemi, (ss_item_sk#0 = ss_item_sk#0)
               :              :     :  :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_quantity#0, ss_list_price#0]
               :              :     :  :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
               :              :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
               :              :     :     +- 'Filter isnotnull(i_item_sk#0)
               :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
               :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
               :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
               :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
               :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
               :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
               :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
               :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
               :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
               :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
               :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :     :                 :     :     +- Project [d_date_sk#0]
               :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
               :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
               :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
               :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
               :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
               :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :     :                 :           +- Project [d_date_sk#0]
               :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
               :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
               :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
               :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
               :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
               :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :     :                       +- Project [d_date_sk#0]
               :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
               :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
               :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :        :  +- Filter isnotnull(i_item_sk#0)
               :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
               :              :           +- 'Filter isnotnull(i_item_sk#0)
               :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
               :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
               :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
               :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
               :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
               :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
               :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
               :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
               :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
               :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
               :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :                       :     :     +- Project [d_date_sk#0]
               :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
               :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
               :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
               :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
               :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
               :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :                       :           +- Project [d_date_sk#0]
               :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
               :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
               :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
               :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
               :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                             :        +- Filter isnotnull(i_item_sk#0)
               :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :                             +- Project [d_date_sk#0]
               :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
               :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :              +- Project [d_date_sk#0]
               :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
               :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :- 'Project [sales#0, number_sales#0L, channel#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
               :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#885 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#890]
               :     :     +- Union
               :     :        :- Project [ss_quantity#290 AS quantity#884, ss_list_price#292 AS list_price#885]
               :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
               :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
               :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
               :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
               :     :        :     +- Project [d_date_sk#24]
               :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
               :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               :     :        :- Project [cs_quantity#183 AS quantity#886, cs_list_price#185 AS list_price#887]
               :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
               :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
               :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
               :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
               :     :        :     +- Project [d_date_sk#24]
               :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
               :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               :     :        +- Project [ws_quantity#149 AS quantity#888, ws_list_price#151 AS list_price#889]
               :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
               :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
               :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
               :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
               :     :              +- Project [d_date_sk#24]
               :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
               :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [catalog AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0]
               :        +- 'Project [cs_quantity#0, cs_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :           +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :              :- 'Project [cs_sold_date_sk#0, cs_quantity#0, cs_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
               :              :     :- 'Join LeftSemi, (cs_item_sk#0 = ss_item_sk#0)
               :              :     :  :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0]
               :              :     :  :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
               :              :     :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
               :              :     :     +- 'Filter isnotnull(i_item_sk#0)
               :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
               :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
               :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
               :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
               :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
               :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
               :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
               :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
               :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
               :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
               :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :     :                 :     :     +- Project [d_date_sk#0]
               :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
               :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
               :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
               :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
               :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
               :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :     :                 :           +- Project [d_date_sk#0]
               :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
               :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
               :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
               :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
               :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
               :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :     :                       +- Project [d_date_sk#0]
               :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
               :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
               :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :        :  +- Filter isnotnull(i_item_sk#0)
               :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
               :              :           +- 'Filter isnotnull(i_item_sk#0)
               :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
               :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
               :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
               :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
               :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
               :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
               :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
               :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
               :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
               :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
               :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :                       :     :     +- Project [d_date_sk#0]
               :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
               :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
               :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
               :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
               :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
               :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :                       :           +- Project [d_date_sk#0]
               :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
               :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
               :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
               :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
               :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
               :              :                             :        +- Filter isnotnull(i_item_sk#0)
               :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :              :                             +- Project [d_date_sk#0]
               :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
               :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :              +- Project [d_date_sk#0]
               :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
               :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               +- 'Project [sales#0, number_sales#0L, channel#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
                     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#885 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#890]
                     :     +- Union
                     :        :- Project [ss_quantity#290 AS quantity#884, ss_list_price#292 AS list_price#885]
                     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
                     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
                     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
                     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
                     :        :     +- Project [d_date_sk#24]
                     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
                     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                     :        :- Project [cs_quantity#183 AS quantity#886, cs_list_price#185 AS list_price#887]
                     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
                     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
                     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
                     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
                     :        :     +- Project [d_date_sk#24]
                     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
                     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                     :        +- Project [ws_quantity#149 AS quantity#888, ws_list_price#151 AS list_price#889]
                     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
                     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
                     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
                     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
                     :              +- Project [d_date_sk#24]
                     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
                     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [web AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0]
                        +- 'Project [ws_quantity#0, ws_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                           +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                              :- 'Project [ws_sold_date_sk#0, ws_quantity#0, ws_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                              :     :- 'Join LeftSemi, (ws_item_sk#0 = ss_item_sk#0)
                              :     :  :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_quantity#0, ws_list_price#0]
                              :     :  :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                              :     :  :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
                              :     :     +- 'Filter isnotnull(i_item_sk#0)
                              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
                              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
                              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
                              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              :     :                 :     :     +- Project [d_date_sk#0]
                              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
                              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
                              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              :     :                 :           +- Project [d_date_sk#0]
                              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
                              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :     :                       :        +- Filter isnotnull(i_item_sk#0)
                              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              :     :                       +- Project [d_date_sk#0]
                              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
                              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :        :  +- Filter isnotnull(i_item_sk#0)
                              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
                              :           +- 'Filter isnotnull(i_item_sk#0)
                              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
                              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
                              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
                              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              :                       :     :     +- Project [d_date_sk#0]
                              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
                              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :                       :           :        +- Filter isnotnull(i_item_sk#0)
                              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              :                       :           +- Project [d_date_sk#0]
                              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
                              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                              :                             :        +- Filter isnotnull(i_item_sk#0)
                              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              :                             +- Project [d_date_sk#0]
                              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              +- Project [d_date_sk#0]
                                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
                                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q14b
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [channel#0 ASC NULLS FIRST, i_brand_id#0 ASC NULLS FIRST, i_class_id#0 ASC NULLS FIRST, i_category_id#0 ASC NULLS FIRST], true
      +- 'Join Inner, (((i_brand_id#0 = i_brand_id#0) && (i_class_id#0 = i_class_id#0)) && (i_category_id#0 = i_category_id#0))
         :- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
         :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
         :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#972 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#973 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#978]
         :     :     +- Union
         :     :        :- Project [ss_quantity#290 AS quantity#972, ss_list_price#292 AS list_price#973]
         :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
         :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
         :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
         :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
         :     :        :     +- Project [d_date_sk#24]
         :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
         :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
         :     :        :- Project [cs_quantity#183 AS quantity#974, cs_list_price#185 AS list_price#975]
         :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
         :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
         :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
         :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
         :     :        :     +- Project [d_date_sk#24]
         :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
         :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
         :     :        +- Project [ws_quantity#149 AS quantity#976, ws_list_price#151 AS list_price#977]
         :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
         :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
         :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
         :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
         :     :              +- Project [d_date_sk#24]
         :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
         :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
         :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [store AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0]
         :        +- 'Project [ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :           +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
         :              :- 'Project [ss_sold_date_sk#0, ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
         :              :     :- 'Join LeftSemi, (ss_item_sk#0 = ss_item_sk#0)
         :              :     :  :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_quantity#0, ss_list_price#0]
         :              :     :  :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
         :              :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
         :              :     :     +- 'Filter isnotnull(i_item_sk#0)
         :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
         :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
         :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
         :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
         :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
         :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
         :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
         :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
         :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
         :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
         :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
         :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_brand_id#0))
         :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :     :                 :     :     +- Project [d_date_sk#0]
         :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
         :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
         :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
         :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
         :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
         :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
         :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
         :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :     :                 :           +- Project [d_date_sk#0]
         :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
         :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
         :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
         :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
         :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
         :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
         :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
         :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :     :                       +- Project [d_date_sk#0]
         :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
         :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
         :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :        :  +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_class_id#0))
         :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
         :              :           +- 'Filter isnotnull(i_item_sk#0)
         :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
         :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
         :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
         :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
         :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
         :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
         :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
         :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
         :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
         :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
         :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
         :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_brand_id#0))
         :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :                       :     :     +- Project [d_date_sk#0]
         :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
         :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
         :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
         :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
         :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
         :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
         :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
         :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :                       :           +- Project [d_date_sk#0]
         :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
         :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
         :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
         :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
         :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
         :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
         :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                             :        +- Filter isnotnull(i_item_sk#0)
         :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :                             +- Project [d_date_sk#0]
         :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
         :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :              +- Project [d_date_sk#0]
         :                 +- Filter ((isnotnull(d_week_seq#0) && (d_week_seq#0 = scalar-subquery#0 [])) && isnotnull(d_date_sk#0))
         :                    :  +- Project [d_week_seq#28]
         :                    :     +- Filter (((((isnotnull(d_year#30) && isnotnull(d_dom#33)) && isnotnull(d_moy#32)) && (d_year#30 = 2000)) && (d_moy#32 = 12)) && (d_dom#33 = 11))
         :                    :        +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
         :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         +- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
               :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#972 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#973 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#978]
               :     +- Union
               :        :- Project [ss_quantity#290 AS quantity#972, ss_list_price#292 AS list_price#973]
               :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
               :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
               :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
               :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
               :        :     +- Project [d_date_sk#24]
               :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
               :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               :        :- Project [cs_quantity#183 AS quantity#974, cs_list_price#185 AS list_price#975]
               :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
               :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
               :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
               :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
               :        :     +- Project [d_date_sk#24]
               :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
               :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               :        +- Project [ws_quantity#149 AS quantity#976, ws_list_price#151 AS list_price#977]
               :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
               :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
               :              :  +- Filter isnotnull(ws_sold_date_sk#131)
               :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
               :              +- Project [d_date_sk#24]
               :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
               :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [store AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0]
                  +- 'Project [ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                        :- 'Project [ss_sold_date_sk#0, ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                        :     :- 'Join LeftSemi, (ss_item_sk#0 = ss_item_sk#0)
                        :     :  :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_quantity#0, ss_list_price#0]
                        :     :  :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                        :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
                        :     :     +- 'Filter isnotnull(i_item_sk#0)
                        :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
                        :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                        :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                        :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                        :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                        :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                        :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
                        :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                        :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                        :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
                        :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                        :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_brand_id#0))
                        :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :     :                 :     :     +- Project [d_date_sk#0]
                        :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                        :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                        :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                        :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
                        :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                        :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                        :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
                        :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :     :                 :           +- Project [d_date_sk#0]
                        :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                        :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                        :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                        :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
                        :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                        :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                        :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                       :        +- Filter isnotnull(i_item_sk#0)
                        :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :     :                       +- Project [d_date_sk#0]
                        :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                        :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
                        :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :        :  +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_category_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_brand_id#0))
                        :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
                        :           +- 'Filter isnotnull(i_item_sk#0)
                        :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
                        :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                        :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                        :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                        :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                        :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                        :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
                        :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                        :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                        :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
                        :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                        :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_brand_id#0))
                        :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :                       :     :     +- Project [d_date_sk#0]
                        :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                        :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                        :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                        :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
                        :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                        :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                        :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                       :           :        +- Filter isnotnull(i_item_sk#0)
                        :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :                       :           +- Project [d_date_sk#0]
                        :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                        :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                        :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                        :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
                        :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                        :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                        :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                             :        +- Filter isnotnull(i_item_sk#0)
                        :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :                             +- Project [d_date_sk#0]
                        :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                        :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        +- Project [d_date_sk#0]
                           +- Filter ((isnotnull(d_week_seq#0) && (d_week_seq#0 = scalar-subquery#0 [])) && isnotnull(d_date_sk#0))
                              :  +- Project [d_week_seq#28]
                              :     +- Filter (((((isnotnull(d_year#30) && isnotnull(d_dom#33)) && isnotnull(d_moy#32)) && (d_year#30 = 1999)) && (d_moy#32 = 12)) && (d_dom#33 = 11))
                              :        +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q15
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [ca_zip#0 ASC NULLS FIRST], true
      +- 'Aggregate [ca_zip#0], [ca_zip#0, MakeDecimal(sum(UnscaledValue(cs_sales_price#0)),17,2) AS sum(cs_sales_price)#0]
         +- 'Project [cs_sales_price#0, ca_zip#0]
            +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :- 'Project [cs_sold_date_sk#0, cs_sales_price#0, ca_zip#0]
               :  +- 'Join Inner, ((c_current_addr_sk#0 = ca_address_sk#0) && ((substring(ca_zip#0, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || ca_state#0 IN (CA,WA,GA)) || (cs_sales_price#0 > 500.00)))
               :     :- 'Project [cs_sold_date_sk#0, cs_sales_price#0, c_current_addr_sk#0]
               :     :  +- 'Join Inner, (cs_bill_customer_sk#0 = c_customer_sk#0)
               :     :     :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_sales_price#0]
               :     :     :  +- Filter (isnotnull(cs_bill_customer_sk#0) && isnotnull(cs_sold_date_sk#0))
               :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :     +- Project [c_customer_sk#0, c_current_addr_sk#0]
               :     :        +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_current_addr_sk#0))
               :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
               :     +- Project [ca_address_sk#0, ca_state#0, ca_zip#0]
               :        +- Filter isnotnull(ca_address_sk#0)
               :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               +- Project [d_date_sk#0]
                  +- Filter ((((isnotnull(d_qoy#0) && isnotnull(d_year#0)) && (d_qoy#0 = 2)) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q16
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [order count #0L ASC NULLS FIRST], true
      +- 'Aggregate [count(distinct cs_order_number#0) AS order count #0L, MakeDecimal(sum(UnscaledValue(cs_ext_ship_cost#0)),17,2) AS total shipping cost #0, MakeDecimal(sum(UnscaledValue(cs_net_profit#0)),17,2) AS total net profit #0]
         +- 'Project [cs_order_number#0, cs_ext_ship_cost#0, cs_net_profit#0]
            +- 'Join Inner, (cs_call_center_sk#0 = cc_call_center_sk#0)
               :- 'Project [cs_call_center_sk#0, cs_order_number#0, cs_ext_ship_cost#0, cs_net_profit#0]
               :  +- 'Join Inner, (cs_ship_addr_sk#0 = ca_address_sk#0)
               :     :- 'Project [cs_ship_addr_sk#0, cs_call_center_sk#0, cs_order_number#0, cs_ext_ship_cost#0, cs_net_profit#0]
               :     :  +- 'Join Inner, (cs_ship_date_sk#0 = d_date_sk#0)
               :     :     :- 'Join LeftAnti, (cs_order_number#0 = cr_order_number#0)
               :     :     :  :- 'Project [cs_ship_date_sk#0, cs_ship_addr_sk#0, cs_call_center_sk#0, cs_order_number#0, cs_ext_ship_cost#0, cs_net_profit#0]
               :     :     :  :  +- 'Join LeftSemi, ((cs_order_number#0 = cs_order_number#182#0) && NOT (cs_warehouse_sk#0 = cs_warehouse_sk#179#0))
               :     :     :  :     :- Project [cs_ship_date_sk#0, cs_ship_addr_sk#0, cs_call_center_sk#0, cs_warehouse_sk#0, cs_order_number#0, cs_ext_ship_cost#0, cs_net_profit#0]
               :     :     :  :     :  +- Filter (isnotnull(cs_warehouse_sk#0) && isnotnull(cs_order_number#0))
               :     :     :  :     :     +- Filter ((isnotnull(cs_ship_date_sk#0) && isnotnull(cs_ship_addr_sk#0)) && isnotnull(cs_call_center_sk#0))
               :     :     :  :     :        +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :     :  :     +- Project [cs_warehouse_sk#0 AS cs_warehouse_sk#179#0, cs_order_number#0 AS cs_order_number#182#0]
               :     :     :  :        +- Filter (isnotnull(cs_warehouse_sk#0) && isnotnull(cs_order_number#0))
               :     :     :  :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :     :  +- Project [cr_order_number#0]
               :     :     :     +- Filter isnotnull(cr_order_number#0)
               :     :     :        +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
               :     :     +- Project [d_date_sk#0]
               :     :        +- Filter (((isnotnull(d_date#0) && (cast(d_date#0 as string) >= 2002-02-01)) && (d_date#0 <= 11779)) && isnotnull(d_date_sk#0))
               :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [ca_address_sk#0]
               :        +- Filter ((isnotnull(ca_state#0) && (ca_state#0 = GA)) && isnotnull(ca_address_sk#0))
               :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               +- Project [cc_call_center_sk#0]
                  +- Filter ((isnotnull(cc_county#0) && (cc_county#0 = Williamson County)) && isnotnull(cc_call_center_sk#0))
                     +- Relation[cc_call_center_sk#0,cc_call_center_id#0,cc_rec_start_date#0,cc_rec_end_date#0,cc_closed_date_sk#0,cc_open_date_sk#0,cc_name#0,cc_class#0,cc_employees#0,cc_sq_ft#0,cc_hours#0,cc_manager#0,cc_mkt_id#0,cc_mkt_class#0,cc_mkt_desc#0,cc_market_manager#0,cc_division#0,cc_division_name#0,cc_company#0,cc_company_name#0,cc_street_number#0,cc_street_name#0,cc_street_type#0,cc_suite_number#0,... 7 more fields] parquet


================================================================================================
q17
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_item_id#0 ASC NULLS FIRST, i_item_desc#0 ASC NULLS FIRST, s_state#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_item_id#0, i_item_desc#0, s_state#0], [i_item_id#0, i_item_desc#0, s_state#0, count(ss_quantity#0) AS store_sales_quantitycount#0L, avg(cast(ss_quantity#0 as bigint)) AS store_sales_quantityave#0, stddev_samp(cast(ss_quantity#0 as double)) AS store_sales_quantitystdev#0, (stddev_samp(cast(ss_quantity#0 as double)) / avg(cast(ss_quantity#0 as bigint))) AS store_sales_quantitycov#0, count(sr_return_quantity#0) AS as_store_returns_quantitycount#0L, avg(cast(sr_return_quantity#0 as bigint)) AS as_store_returns_quantityave#0, stddev_samp(cast(sr_return_quantity#0 as double)) AS as_store_returns_quantitystdev#0, (stddev_samp(cast(sr_return_quantity#0 as double)) / avg(cast(sr_return_quantity#0 as bigint))) AS store_returns_quantitycov#0, count(cs_quantity#0) AS catalog_sales_quantitycount#0L, avg(cast(cs_quantity#0 as bigint)) AS catalog_sales_quantityave#0, (stddev_samp(cast(cs_quantity#0 as double)) / avg(cast(cs_quantity#0 as bigint))) AS catalog_sales_quantitystdev#0, (stddev_samp(cast(cs_quantity#0 as double)) / avg(cast(cs_quantity#0 as bigint))) AS catalog_sales_quantitycov#0]
         +- 'Project [ss_quantity#0, sr_return_quantity#0, cs_quantity#0, s_state#0, i_item_id#0, i_item_desc#0]
            +- 'Join Inner, (i_item_sk#0 = ss_item_sk#0)
               :- 'Project [ss_item_sk#0, ss_quantity#0, sr_return_quantity#0, cs_quantity#0, s_state#0]
               :  +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
               :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, sr_return_quantity#0, cs_quantity#0]
               :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :     :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, sr_return_quantity#0, cs_sold_date_sk#0, cs_quantity#0]
               :     :     :  +- 'Join Inner, (sr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
               :     :     :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, sr_returned_date_sk#0L, sr_return_quantity#0, cs_sold_date_sk#0, cs_quantity#0]
               :     :     :     :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
               :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, sr_returned_date_sk#0L, sr_return_quantity#0, cs_sold_date_sk#0, cs_quantity#0]
               :     :     :     :     :  +- 'Join Inner, ((sr_customer_sk#0L = cast(cs_bill_customer_sk#0 as bigint)) && (sr_item_sk#0L = cast(cs_item_sk#0 as bigint)))
               :     :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, sr_returned_date_sk#0L, sr_item_sk#0L, sr_customer_sk#0L, sr_return_quantity#0]
               :     :     :     :     :     :  +- 'Join Inner, (((cast(ss_customer_sk#0 as bigint) = sr_customer_sk#0L) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L)) && (cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L))
               :     :     :     :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_ticket_number#0, ss_quantity#0]
               :     :     :     :     :     :     :  +- Filter ((((isnotnull(ss_customer_sk#0) && isnotnull(ss_ticket_number#0)) && isnotnull(ss_item_sk#0)) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0))
               :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     :     :     :     :     +- Project [sr_returned_date_sk#0L, sr_item_sk#0L, sr_customer_sk#0L, sr_ticket_number#0L, sr_return_quantity#0]
               :     :     :     :     :     :        +- Filter (((isnotnull(sr_ticket_number#0L) && isnotnull(sr_customer_sk#0L)) && isnotnull(sr_item_sk#0L)) && isnotnull(sr_returned_date_sk#0L))
               :     :     :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               :     :     :     :     :     +- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0]
               :     :     :     :     :        +- Filter ((isnotnull(cs_bill_customer_sk#0) && isnotnull(cs_item_sk#0)) && isnotnull(cs_sold_date_sk#0))
               :     :     :     :     :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :     :     :     +- Project [d_date_sk#0]
               :     :     :     :        +- Filter ((isnotnull(d_quarter_name#0) && (d_quarter_name#0 = 2001Q1)) && isnotnull(d_date_sk#0))
               :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     :     +- Project [d_date_sk#0]
               :     :     :        +- Filter (d_quarter_name#0 IN (2001Q1,2001Q2,2001Q3) && isnotnull(d_date_sk#0))
               :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     +- Project [d_date_sk#0]
               :     :        +- Filter (d_quarter_name#0 IN (2001Q1,2001Q2,2001Q3) && isnotnull(d_date_sk#0))
               :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [s_store_sk#0, s_state#0]
               :        +- Filter isnotnull(s_store_sk#0)
               :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               +- Project [i_item_sk#0, i_item_id#0, i_item_desc#0]
                  +- Filter isnotnull(i_item_sk#0)
                     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q18
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [ca_country#0 ASC NULLS FIRST, ca_state#0 ASC NULLS FIRST, ca_county#0 ASC NULLS FIRST, i_item_id#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_item_id#0, ca_country#0, ca_state#0, ca_county#0, spark_grouping_id#0], [i_item_id#0, ca_country#0, ca_state#0, ca_county#0, avg(cast(cs_quantity#0 as decimal(12,2))) AS agg1#0, avg(cast(cs_list_price#0 as decimal(12,2))) AS agg2#0, avg(cast(cs_coupon_amt#0 as decimal(12,2))) AS agg3#0, avg(cast(cs_sales_price#0 as decimal(12,2))) AS agg4#0, avg(cast(cs_net_profit#0 as decimal(12,2))) AS agg5#0, avg(cast(c_birth_year#0 as decimal(12,2))) AS agg6#0, avg(cast(cd_dep_count#0 as decimal(12,2))) AS agg7#0]
         +- 'Expand [List(cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, i_item_id#0, ca_country#0, ca_state#0, ca_county#0, 0), List(cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, i_item_id#0, ca_country#0, ca_state#0, null, 1), List(cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, i_item_id#0, ca_country#0, null, null, 3), List(cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, i_item_id#0, null, null, null, 7), List(cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, null, null, null, null, 15)], [cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, i_item_id#0, ca_country#0, ca_state#0, ca_county#0, spark_grouping_id#0]
            +- 'Project [cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, i_item_id#0, ca_country#0, ca_state#0, ca_county#0]
               +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                  :- 'Project [cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, ca_county#0, ca_state#0, ca_country#0]
                  :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                  :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, ca_county#0, ca_state#0, ca_country#0]
                  :     :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
                  :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_current_addr_sk#0, c_birth_year#0]
                  :     :     :  +- 'Join Inner, (c_current_cdemo_sk#0 = cd_demo_sk#0)
                  :     :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_current_cdemo_sk#0, c_current_addr_sk#0, c_birth_year#0]
                  :     :     :     :  +- 'Join Inner, (cs_bill_customer_sk#0 = c_customer_sk#0)
                  :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0]
                  :     :     :     :     :  +- 'Join Inner, (cs_bill_cdemo_sk#0 = cd_demo_sk#0)
                  :     :     :     :     :     :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_bill_cdemo_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0]
                  :     :     :     :     :     :  +- Filter (((isnotnull(cs_bill_cdemo_sk#0) && isnotnull(cs_bill_customer_sk#0)) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_item_sk#0))
                  :     :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                  :     :     :     :     :     +- Project [cd_demo_sk#0, cd_dep_count#0]
                  :     :     :     :     :        +- Filter ((((isnotnull(cd_gender#0) && isnotnull(cd_education_status#0)) && (cd_gender#0 = F)) && (cd_education_status#0 = Unknown)) && isnotnull(cd_demo_sk#0))
                  :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
                  :     :     :     :     +- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_addr_sk#0, c_birth_year#0]
                  :     :     :     :        +- Filter (((c_birth_month#0 IN (1,6,8,9,12,2) && isnotnull(c_customer_sk#0)) && isnotnull(c_current_cdemo_sk#0)) && isnotnull(c_current_addr_sk#0))
                  :     :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                  :     :     :     +- Project [cd_demo_sk#0]
                  :     :     :        +- Filter isnotnull(cd_demo_sk#0)
                  :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
                  :     :     +- Project [ca_address_sk#0, ca_county#0, ca_state#0, ca_country#0]
                  :     :        +- Filter (ca_state#0 IN (MS,IN,ND,OK,NM,VA) && isnotnull(ca_address_sk#0))
                  :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                  :     +- Project [d_date_sk#0]
                  :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 1998)) && isnotnull(d_date_sk#0))
                  :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  +- Project [i_item_sk#0, i_item_id#0]
                     +- Filter isnotnull(i_item_sk#0)
                        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q19
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [ext_price#0 DESC NULLS LAST, brand#0 ASC NULLS FIRST, brand_id#0 ASC NULLS FIRST, i_manufact_id#0 ASC NULLS FIRST, i_manufact#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_brand#0, i_brand_id#0, i_manufact_id#0, i_manufact#0], [i_brand_id#0 AS brand_id#0, i_brand#0 AS brand#0, i_manufact_id#0, i_manufact#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS ext_price#0]
         +- 'Project [ss_ext_sales_price#0, i_brand_id#0, i_brand#0, i_manufact_id#0, i_manufact#0]
            +- 'Join Inner, (NOT (substring(ca_zip#0, 1, 5) = substring(s_zip#0, 1, 5)) && (ss_store_sk#0 = s_store_sk#0))
               :- 'Project [ss_store_sk#0, ss_ext_sales_price#0, i_brand_id#0, i_brand#0, i_manufact_id#0, i_manufact#0, ca_zip#0]
               :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
               :     :- 'Project [ss_store_sk#0, ss_ext_sales_price#0, i_brand_id#0, i_brand#0, i_manufact_id#0, i_manufact#0, c_current_addr_sk#0]
               :     :  +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
               :     :     :- 'Project [ss_customer_sk#0, ss_store_sk#0, ss_ext_sales_price#0, i_brand_id#0, i_brand#0, i_manufact_id#0, i_manufact#0]
               :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :     :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_ext_sales_price#0]
               :     :     :     :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
               :     :     :     :     :- Project [d_date_sk#0]
               :     :     :     :     :  +- Filter ((((isnotnull(d_moy#0) && isnotnull(d_year#0)) && (d_moy#0 = 11)) && (d_year#0 = 1998)) && isnotnull(d_date_sk#0))
               :     :     :     :     :     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     :     :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_ext_sales_price#0]
               :     :     :     :        +- Filter (((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0)) && isnotnull(ss_customer_sk#0)) && isnotnull(ss_store_sk#0))
               :     :     :     :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_brand#0, i_manufact_id#0, i_manufact#0]
               :     :     :        +- Filter ((isnotnull(i_manager_id#0) && (i_manager_id#0 = 8)) && isnotnull(i_item_sk#0))
               :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :     :     +- Project [c_customer_sk#0, c_current_addr_sk#0]
               :     :        +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_current_addr_sk#0))
               :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
               :     +- Project [ca_address_sk#0, ca_zip#0]
               :        +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_zip#0))
               :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               +- Project [s_store_sk#0, s_zip#0]
                  +- Filter (isnotnull(s_zip#0) && isnotnull(s_store_sk#0))
                     +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet


================================================================================================
q20
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Project [i_item_desc#0, i_category#0, i_class#0, i_current_price#0, itemrevenue#0, revenueratio#0]
      +- 'Sort [i_category#0 ASC NULLS FIRST, i_class#0 ASC NULLS FIRST, i_item_id#0 ASC NULLS FIRST, i_item_desc#0 ASC NULLS FIRST, revenueratio#0 ASC NULLS FIRST], true
         +- 'Project [i_item_desc#0, i_category#0, i_class#0, i_current_price#0, itemrevenue#0, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(_w0#0) * 100.00), DecimalType(21,2)) as decimal(27,2))) / promote_precision(_we0#0)), DecimalType(38,17)) AS revenueratio#0, i_item_id#0]
            +- 'Window [sum(_w1#0) windowspecdefinition(i_class#0, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#0], [i_class#0]
               +- 'Aggregate [i_item_id#0, i_item_desc#0, i_category#0, i_class#0, i_current_price#0], [i_item_desc#0, i_category#0, i_class#0, i_current_price#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS itemrevenue#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS _w0#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS _w1#0, i_item_id#0]
                  +- 'Project [cs_ext_sales_price#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                     +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                        :- 'Project [cs_sold_date_sk#0, cs_ext_sales_price#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                        :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                        :     :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_ext_sales_price#0]
                        :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                        :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                        :     +- Project [i_item_sk#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                        :        +- Filter (i_category#0 IN (Sports,Books,Home) && isnotnull(i_item_sk#0))
                        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        +- Project [d_date_sk#0]
                           +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10644)) && (d_date#0 <= 10674)) && isnotnull(d_date_sk#0))
                              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q21
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [w_warehouse_name#0 ASC NULLS FIRST, i_item_id#0 ASC NULLS FIRST], true
      +- 'Filter ((CASE WHEN (inv_before#0L > 0) THEN (cast(inv_after#0L as double) / cast(inv_before#0L as double)) ELSE null END >= 0.666667) && (CASE WHEN (inv_before#0L > 0) THEN (cast(inv_after#0L as double) / cast(inv_before#0L as double)) ELSE null END <= 1.5))
         +- 'Aggregate [w_warehouse_name#0, i_item_id#0], [w_warehouse_name#0, i_item_id#0, sum(cast(CASE WHEN (d_date#0 < 11027) THEN inv_quantity_on_hand#0 ELSE 0 END as bigint)) AS inv_before#0L, sum(cast(CASE WHEN (d_date#0 >= 11027) THEN inv_quantity_on_hand#0 ELSE 0 END as bigint)) AS inv_after#0L]
            +- 'Project [inv_quantity_on_hand#0, w_warehouse_name#0, i_item_id#0, d_date#0]
               +- 'Join Inner, (inv_date_sk#0 = d_date_sk#0)
                  :- 'Project [inv_date_sk#0, inv_quantity_on_hand#0, w_warehouse_name#0, i_item_id#0]
                  :  +- 'Join Inner, (i_item_sk#0 = inv_item_sk#0)
                  :     :- 'Project [inv_date_sk#0, inv_item_sk#0, inv_quantity_on_hand#0, w_warehouse_name#0]
                  :     :  +- 'Join Inner, (inv_warehouse_sk#0 = w_warehouse_sk#0)
                  :     :     :- Filter ((isnotnull(inv_warehouse_sk#0) && isnotnull(inv_item_sk#0)) && isnotnull(inv_date_sk#0))
                  :     :     :  +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
                  :     :     +- Project [w_warehouse_sk#0, w_warehouse_name#0]
                  :     :        +- Filter isnotnull(w_warehouse_sk#0)
                  :     :           +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
                  :     +- Project [i_item_sk#0, i_item_id#0]
                  :        +- Filter (((isnotnull(i_current_price#0) && (i_current_price#0 >= 0.99)) && (i_current_price#0 <= 1.49)) && isnotnull(i_item_sk#0))
                  :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  +- Project [d_date_sk#0, d_date#0]
                     +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10997)) && (d_date#0 <= 11057)) && isnotnull(d_date_sk#0))
                        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q22
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [qoh#0 ASC NULLS FIRST, i_product_name#0 ASC NULLS FIRST, i_brand#0 ASC NULLS FIRST, i_class#0 ASC NULLS FIRST, i_category#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_product_name#0, i_brand#0, i_class#0, i_category#0, spark_grouping_id#0], [i_product_name#0, i_brand#0, i_class#0, i_category#0, avg(cast(inv_quantity_on_hand#0 as bigint)) AS qoh#0]
         +- 'Expand [List(inv_quantity_on_hand#0, i_product_name#0, i_brand#0, i_class#0, i_category#0, 0), List(inv_quantity_on_hand#0, i_product_name#0, i_brand#0, i_class#0, null, 1), List(inv_quantity_on_hand#0, i_product_name#0, i_brand#0, null, null, 3), List(inv_quantity_on_hand#0, i_product_name#0, null, null, null, 7), List(inv_quantity_on_hand#0, null, null, null, null, 15)], [inv_quantity_on_hand#0, i_product_name#0, i_brand#0, i_class#0, i_category#0, spark_grouping_id#0]
            +- 'Project [inv_quantity_on_hand#0, i_product_name#0, i_brand#0, i_class#0, i_category#0]
               +- 'Join Inner, (inv_warehouse_sk#0 = w_warehouse_sk#0)
                  :- 'Project [inv_warehouse_sk#0, inv_quantity_on_hand#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
                  :  +- 'Join Inner, (inv_item_sk#0 = i_item_sk#0)
                  :     :- 'Project [inv_item_sk#0, inv_warehouse_sk#0, inv_quantity_on_hand#0]
                  :     :  +- 'Join Inner, (inv_date_sk#0 = d_date_sk#0)
                  :     :     :- Filter ((isnotnull(inv_date_sk#0) && isnotnull(inv_item_sk#0)) && isnotnull(inv_warehouse_sk#0))
                  :     :     :  +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
                  :     :     +- Project [d_date_sk#0]
                  :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
                  :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
                  :        +- Filter isnotnull(i_item_sk#0)
                  :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  +- Project [w_warehouse_sk#0]
                     +- Filter isnotnull(w_warehouse_sk#0)
                        +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet


================================================================================================
q23a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Aggregate [sum(sales#0) AS sum(sales)#0]
      +- 'Union
         :- 'Project [CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2)) AS sales#0]
         :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
         :     :- 'Project [cs_sold_date_sk#0, cs_quantity#0, cs_list_price#0]
         :     :  +- 'Join LeftSemi, (cs_bill_customer_sk#0 = c_customer_sk#0)
         :     :     :- 'Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_quantity#0, cs_list_price#0]
         :     :     :  +- 'Filter isnotnull(cs_bill_customer_sk#0)
         :     :     :     +- 'Join LeftSemi, (cs_item_sk#0 = item_sk#0)
         :     :     :        :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0]
         :     :     :        :  +- Filter isnotnull(cs_item_sk#0)
         :     :     :        :     +- Filter isnotnull(cs_sold_date_sk#0)
         :     :     :        :        +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
         :     :     :        +- 'Project [item_sk#0]
         :     :     :           +- 'Filter (count(1)#0L > 4)
         :     :     :              +- 'Aggregate [substring(i_item_desc#0, 1, 30), i_item_sk#0, d_date#0], [i_item_sk#0 AS item_sk#0, count(1) AS count(1)#0L]
         :     :     :                 +- 'Project [d_date#0, i_item_sk#0, i_item_desc#0]
         :     :     :                    +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
         :     :     :                       :- 'Project [ss_item_sk#0, d_date#0]
         :     :     :                       :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
         :     :     :                       :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
         :     :     :                       :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0))
         :     :     :                       :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :     :     :                       :     +- Project [d_date_sk#0, d_date#0]
         :     :     :                       :        +- Filter (d_year#0 IN (2000,2001,2002,2003) && isnotnull(d_date_sk#0))
         :     :     :                       :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :     :     :                       +- Project [i_item_sk#0, i_item_desc#0]
         :     :     :                          +- Filter isnotnull(i_item_sk#0)
         :     :     :                             +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :     :     +- 'Project [c_customer_sk#0]
         :     :        +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(38,8)) > CheckOverflow((0.500000 * promote_precision(cast(scalar-subquery#0 [] as decimal(32,6)))), DecimalType(38,8))))
         :     :           :  +- Aggregate [max(csales#1535) AS tpcds_cmax#1536]
         :     :           :     +- Aggregate [c_customer_sk#82], [sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2))) AS csales#1535]
         :     :           :        +- Project [ss_quantity#290, ss_sales_price#293, c_customer_sk#82]
         :     :           :           +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
         :     :           :              :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_sales_price#293, c_customer_sk#82]
         :     :           :              :  +- Join Inner, (ss_customer_sk#283 = c_customer_sk#82)
         :     :           :              :     :- Project [ss_sold_date_sk#280, ss_customer_sk#283, ss_quantity#290, ss_sales_price#293]
         :     :           :              :     :  +- Filter (isnotnull(ss_customer_sk#283) && isnotnull(ss_sold_date_sk#280))
         :     :           :              :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
         :     :           :              :     +- Project [c_customer_sk#82]
         :     :           :              :        +- Filter isnotnull(c_customer_sk#82)
         :     :           :              :           +- Relation[c_customer_sk#82,c_customer_id#83,c_current_cdemo_sk#84,c_current_hdemo_sk#85,c_current_addr_sk#86,c_first_shipto_date_sk#87,c_first_sales_date_sk#88,c_salutation#89,c_first_name#90,c_last_name#91,c_preferred_cust_flag#92,c_birth_day#93,c_birth_month#94,c_birth_year#95,c_birth_country#96,c_login#97,c_email_address#98,c_last_review_date#99] parquet
         :     :           :              +- Project [d_date_sk#24]
         :     :           :                 +- Filter (d_year#30 IN (2000,2001,2002,2003) && isnotnull(d_date_sk#24))
         :     :           :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
         :     :           +- 'Aggregate [c_customer_sk#0], [c_customer_sk#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0]
         :     :              +- 'Project [ss_quantity#0, ss_sales_price#0, c_customer_sk#0]
         :     :                 +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
         :     :                    :- Project [ss_customer_sk#0, ss_quantity#0, ss_sales_price#0]
         :     :                    :  +- Filter isnotnull(ss_customer_sk#0)
         :     :                    :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :     :                    +- Project [c_customer_sk#0]
         :     :                       +- Filter isnotnull(c_customer_sk#0)
         :     :                          +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
         :     +- Project [d_date_sk#0]
         :        +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 2)) && isnotnull(d_date_sk#0))
         :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         +- 'Project [CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2)) AS sales#0]
            +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :- 'Project [ws_sold_date_sk#0, ws_quantity#0, ws_list_price#0]
               :  +- 'Join LeftSemi, (ws_bill_customer_sk#0 = c_customer_sk#0)
               :     :- 'Project [ws_sold_date_sk#0, ws_bill_customer_sk#0, ws_quantity#0, ws_list_price#0]
               :     :  +- 'Filter isnotnull(ws_bill_customer_sk#0)
               :     :     +- 'Join LeftSemi, (ws_item_sk#0 = item_sk#0)
               :     :        :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_bill_customer_sk#0, ws_quantity#0, ws_list_price#0]
               :     :        :  +- Filter isnotnull(ws_item_sk#0)
               :     :        :     +- Filter isnotnull(ws_sold_date_sk#0)
               :     :        :        +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :        +- 'Project [item_sk#0]
               :     :           +- 'Filter (count(1)#0L > 4)
               :     :              +- 'Aggregate [substring(i_item_desc#0, 1, 30), i_item_sk#0, d_date#0], [i_item_sk#0 AS item_sk#0, count(1) AS count(1)#0L]
               :     :                 +- 'Project [d_date#0, i_item_sk#0, i_item_desc#0]
               :     :                    +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :     :                       :- 'Project [ss_item_sk#0, d_date#0]
               :     :                       :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :                       :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
               :     :                       :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0))
               :     :                       :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :                       :     +- Project [d_date_sk#0, d_date#0]
               :     :                       :        +- Filter (d_year#0 IN (2000,2001,2002,2003) && isnotnull(d_date_sk#0))
               :     :                       :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :                       +- Project [i_item_sk#0, i_item_desc#0]
               :     :                          +- Filter isnotnull(i_item_sk#0)
               :     :                             +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :     +- 'Project [c_customer_sk#0]
               :        +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(38,8)) > CheckOverflow((0.500000 * promote_precision(cast(scalar-subquery#0 [] as decimal(32,6)))), DecimalType(38,8))))
               :           :  +- Aggregate [max(csales#1535) AS tpcds_cmax#1536]
               :           :     +- Aggregate [c_customer_sk#82], [sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2))) AS csales#1535]
               :           :        +- Project [ss_quantity#290, ss_sales_price#293, c_customer_sk#82]
               :           :           +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
               :           :              :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_sales_price#293, c_customer_sk#82]
               :           :              :  +- Join Inner, (ss_customer_sk#283 = c_customer_sk#82)
               :           :              :     :- Project [ss_sold_date_sk#280, ss_customer_sk#283, ss_quantity#290, ss_sales_price#293]
               :           :              :     :  +- Filter (isnotnull(ss_customer_sk#283) && isnotnull(ss_sold_date_sk#280))
               :           :              :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
               :           :              :     +- Project [c_customer_sk#82]
               :           :              :        +- Filter isnotnull(c_customer_sk#82)
               :           :              :           +- Relation[c_customer_sk#82,c_customer_id#83,c_current_cdemo_sk#84,c_current_hdemo_sk#85,c_current_addr_sk#86,c_first_shipto_date_sk#87,c_first_sales_date_sk#88,c_salutation#89,c_first_name#90,c_last_name#91,c_preferred_cust_flag#92,c_birth_day#93,c_birth_month#94,c_birth_year#95,c_birth_country#96,c_login#97,c_email_address#98,c_last_review_date#99] parquet
               :           :              +- Project [d_date_sk#24]
               :           :                 +- Filter (d_year#30 IN (2000,2001,2002,2003) && isnotnull(d_date_sk#24))
               :           :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               :           +- 'Aggregate [c_customer_sk#0], [c_customer_sk#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0]
               :              +- 'Project [ss_quantity#0, ss_sales_price#0, c_customer_sk#0]
               :                 +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
               :                    :- Project [ss_customer_sk#0, ss_quantity#0, ss_sales_price#0]
               :                    :  +- Filter isnotnull(ss_customer_sk#0)
               :                    :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :                    +- Project [c_customer_sk#0]
               :                       +- Filter isnotnull(c_customer_sk#0)
               :                          +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
               +- Project [d_date_sk#0]
                  +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 2)) && isnotnull(d_date_sk#0))
                     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q23b
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [c_last_name#0 ASC NULLS FIRST, c_first_name#0 ASC NULLS FIRST, sales#0 ASC NULLS FIRST], true
      +- 'Union
         :- 'Aggregate [c_last_name#0, c_first_name#0], [c_last_name#0, c_first_name#0, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0]
         :  +- 'Project [cs_quantity#0, cs_list_price#0, c_first_name#0, c_last_name#0]
         :     +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
         :        :- 'Project [cs_sold_date_sk#0, cs_quantity#0, cs_list_price#0, c_first_name#0, c_last_name#0]
         :        :  +- 'Join Inner, (cs_bill_customer_sk#0 = c_customer_sk#0)
         :        :     :- 'Join LeftSemi, (cs_bill_customer_sk#0 = c_customer_sk#82#0)
         :        :     :  :- 'Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_quantity#0, cs_list_price#0]
         :        :     :  :  +- 'Join LeftSemi, (cs_item_sk#0 = item_sk#0)
         :        :     :  :     :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0]
         :        :     :  :     :  +- Filter isnotnull(cs_item_sk#0)
         :        :     :  :     :     +- Filter (isnotnull(cs_bill_customer_sk#0) && isnotnull(cs_sold_date_sk#0))
         :        :     :  :     :        +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
         :        :     :  :     +- 'Project [item_sk#0]
         :        :     :  :        +- 'Filter (count(1)#0L > 4)
         :        :     :  :           +- 'Aggregate [substring(i_item_desc#0, 1, 30), i_item_sk#0, d_date#0], [i_item_sk#0 AS item_sk#0, count(1) AS count(1)#0L]
         :        :     :  :              +- 'Project [d_date#0, i_item_sk#0, i_item_desc#0]
         :        :     :  :                 +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
         :        :     :  :                    :- 'Project [ss_item_sk#0, d_date#0]
         :        :     :  :                    :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
         :        :     :  :                    :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
         :        :     :  :                    :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0))
         :        :     :  :                    :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :        :     :  :                    :     +- Project [d_date_sk#0, d_date#0]
         :        :     :  :                    :        +- Filter (d_year#0 IN (2000,2001,2002,2003) && isnotnull(d_date_sk#0))
         :        :     :  :                    :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :        :     :  :                    +- Project [i_item_sk#0, i_item_desc#0]
         :        :     :  :                       +- Filter isnotnull(i_item_sk#0)
         :        :     :  :                          +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :        :     :  +- 'Project [c_customer_sk#0 AS c_customer_sk#82#0]
         :        :     :     +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(38,8)) > CheckOverflow((0.500000 * promote_precision(cast(scalar-subquery#0 [] as decimal(32,6)))), DecimalType(38,8))))
         :        :     :        :  +- Aggregate [max(csales#1572) AS tpcds_cmax#1573]
         :        :     :        :     +- Aggregate [c_customer_sk#82], [sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2))) AS csales#1572]
         :        :     :        :        +- Project [ss_quantity#290, ss_sales_price#293, c_customer_sk#82]
         :        :     :        :           +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
         :        :     :        :              :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_sales_price#293, c_customer_sk#82]
         :        :     :        :              :  +- Join Inner, (ss_customer_sk#283 = c_customer_sk#82)
         :        :     :        :              :     :- Project [ss_sold_date_sk#280, ss_customer_sk#283, ss_quantity#290, ss_sales_price#293]
         :        :     :        :              :     :  +- Filter (isnotnull(ss_customer_sk#283) && isnotnull(ss_sold_date_sk#280))
         :        :     :        :              :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
         :        :     :        :              :     +- Project [c_customer_sk#82]
         :        :     :        :              :        +- Filter isnotnull(c_customer_sk#82)
         :        :     :        :              :           +- Relation[c_customer_sk#82,c_customer_id#83,c_current_cdemo_sk#84,c_current_hdemo_sk#85,c_current_addr_sk#86,c_first_shipto_date_sk#87,c_first_sales_date_sk#88,c_salutation#89,c_first_name#90,c_last_name#91,c_preferred_cust_flag#92,c_birth_day#93,c_birth_month#94,c_birth_year#95,c_birth_country#96,c_login#97,c_email_address#98,c_last_review_date#99] parquet
         :        :     :        :              +- Project [d_date_sk#24]
         :        :     :        :                 +- Filter (d_year#30 IN (2000,2001,2002,2003) && isnotnull(d_date_sk#24))
         :        :     :        :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
         :        :     :        +- 'Aggregate [c_customer_sk#0], [c_customer_sk#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0]
         :        :     :           +- 'Project [ss_quantity#0, ss_sales_price#0, c_customer_sk#0]
         :        :     :              +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
         :        :     :                 :- Project [ss_customer_sk#0, ss_quantity#0, ss_sales_price#0]
         :        :     :                 :  +- Filter isnotnull(ss_customer_sk#0)
         :        :     :                 :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :        :     :                 +- Project [c_customer_sk#0]
         :        :     :                    +- Filter isnotnull(c_customer_sk#0)
         :        :     :                       +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
         :        :     +- 'Join LeftSemi, (c_customer_sk#0 = c_customer_sk#82#0)
         :        :        :- Project [c_customer_sk#0, c_first_name#0, c_last_name#0]
         :        :        :  +- Filter isnotnull(c_customer_sk#0)
         :        :        :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
         :        :        +- 'Project [c_customer_sk#0 AS c_customer_sk#82#0]
         :        :           +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(38,8)) > CheckOverflow((0.500000 * promote_precision(cast(scalar-subquery#0 [] as decimal(32,6)))), DecimalType(38,8))))
         :        :              :  +- Aggregate [max(csales#1572) AS tpcds_cmax#1573]
         :        :              :     +- Aggregate [c_customer_sk#82], [sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2))) AS csales#1572]
         :        :              :        +- Project [ss_quantity#290, ss_sales_price#293, c_customer_sk#82]
         :        :              :           +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
         :        :              :              :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_sales_price#293, c_customer_sk#82]
         :        :              :              :  +- Join Inner, (ss_customer_sk#283 = c_customer_sk#82)
         :        :              :              :     :- Project [ss_sold_date_sk#280, ss_customer_sk#283, ss_quantity#290, ss_sales_price#293]
         :        :              :              :     :  +- Filter (isnotnull(ss_customer_sk#283) && isnotnull(ss_sold_date_sk#280))
         :        :              :              :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
         :        :              :              :     +- Project [c_customer_sk#82]
         :        :              :              :        +- Filter isnotnull(c_customer_sk#82)
         :        :              :              :           +- Relation[c_customer_sk#82,c_customer_id#83,c_current_cdemo_sk#84,c_current_hdemo_sk#85,c_current_addr_sk#86,c_first_shipto_date_sk#87,c_first_sales_date_sk#88,c_salutation#89,c_first_name#90,c_last_name#91,c_preferred_cust_flag#92,c_birth_day#93,c_birth_month#94,c_birth_year#95,c_birth_country#96,c_login#97,c_email_address#98,c_last_review_date#99] parquet
         :        :              :              +- Project [d_date_sk#24]
         :        :              :                 +- Filter (d_year#30 IN (2000,2001,2002,2003) && isnotnull(d_date_sk#24))
         :        :              :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
         :        :              +- 'Aggregate [c_customer_sk#0], [c_customer_sk#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0]
         :        :                 +- 'Project [ss_quantity#0, ss_sales_price#0, c_customer_sk#0]
         :        :                    +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
         :        :                       :- Project [ss_customer_sk#0, ss_quantity#0, ss_sales_price#0]
         :        :                       :  +- Filter isnotnull(ss_customer_sk#0)
         :        :                       :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :        :                       +- Project [c_customer_sk#0]
         :        :                          +- Filter isnotnull(c_customer_sk#0)
         :        :                             +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
         :        +- Project [d_date_sk#0]
         :           +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 2)) && isnotnull(d_date_sk#0))
         :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         +- 'Aggregate [c_last_name#0, c_first_name#0], [c_last_name#0, c_first_name#0, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0]
            +- 'Project [ws_quantity#0, ws_list_price#0, c_first_name#0, c_last_name#0]
               +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                  :- 'Project [ws_sold_date_sk#0, ws_quantity#0, ws_list_price#0, c_first_name#0, c_last_name#0]
                  :  +- 'Join Inner, (ws_bill_customer_sk#0 = c_customer_sk#0)
                  :     :- 'Join LeftSemi, (ws_bill_customer_sk#0 = c_customer_sk#82#0)
                  :     :  :- 'Project [ws_sold_date_sk#0, ws_bill_customer_sk#0, ws_quantity#0, ws_list_price#0]
                  :     :  :  +- 'Join LeftSemi, (ws_item_sk#0 = item_sk#0)
                  :     :  :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_bill_customer_sk#0, ws_quantity#0, ws_list_price#0]
                  :     :  :     :  +- Filter isnotnull(ws_item_sk#0)
                  :     :  :     :     +- Filter (isnotnull(ws_bill_customer_sk#0) && isnotnull(ws_sold_date_sk#0))
                  :     :  :     :        +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                  :     :  :     +- 'Project [item_sk#0]
                  :     :  :        +- 'Filter (count(1)#0L > 4)
                  :     :  :           +- 'Aggregate [substring(i_item_desc#0, 1, 30), i_item_sk#0, d_date#0], [i_item_sk#0 AS item_sk#0, count(1) AS count(1)#0L]
                  :     :  :              +- 'Project [d_date#0, i_item_sk#0, i_item_desc#0]
                  :     :  :                 +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                  :     :  :                    :- 'Project [ss_item_sk#0, d_date#0]
                  :     :  :                    :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                  :     :  :                    :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
                  :     :  :                    :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0))
                  :     :  :                    :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :     :  :                    :     +- Project [d_date_sk#0, d_date#0]
                  :     :  :                    :        +- Filter (d_year#0 IN (2000,2001,2002,2003) && isnotnull(d_date_sk#0))
                  :     :  :                    :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     :  :                    +- Project [i_item_sk#0, i_item_desc#0]
                  :     :  :                       +- Filter isnotnull(i_item_sk#0)
                  :     :  :                          +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  :     :  +- 'Project [c_customer_sk#0 AS c_customer_sk#82#0]
                  :     :     +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(38,8)) > CheckOverflow((0.500000 * promote_precision(cast(scalar-subquery#0 [] as decimal(32,6)))), DecimalType(38,8))))
                  :     :        :  +- Aggregate [max(csales#1572) AS tpcds_cmax#1573]
                  :     :        :     +- Aggregate [c_customer_sk#82], [sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2))) AS csales#1572]
                  :     :        :        +- Project [ss_quantity#290, ss_sales_price#293, c_customer_sk#82]
                  :     :        :           +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
                  :     :        :              :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_sales_price#293, c_customer_sk#82]
                  :     :        :              :  +- Join Inner, (ss_customer_sk#283 = c_customer_sk#82)
                  :     :        :              :     :- Project [ss_sold_date_sk#280, ss_customer_sk#283, ss_quantity#290, ss_sales_price#293]
                  :     :        :              :     :  +- Filter (isnotnull(ss_customer_sk#283) && isnotnull(ss_sold_date_sk#280))
                  :     :        :              :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
                  :     :        :              :     +- Project [c_customer_sk#82]
                  :     :        :              :        +- Filter isnotnull(c_customer_sk#82)
                  :     :        :              :           +- Relation[c_customer_sk#82,c_customer_id#83,c_current_cdemo_sk#84,c_current_hdemo_sk#85,c_current_addr_sk#86,c_first_shipto_date_sk#87,c_first_sales_date_sk#88,c_salutation#89,c_first_name#90,c_last_name#91,c_preferred_cust_flag#92,c_birth_day#93,c_birth_month#94,c_birth_year#95,c_birth_country#96,c_login#97,c_email_address#98,c_last_review_date#99] parquet
                  :     :        :              +- Project [d_date_sk#24]
                  :     :        :                 +- Filter (d_year#30 IN (2000,2001,2002,2003) && isnotnull(d_date_sk#24))
                  :     :        :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                  :     :        +- 'Aggregate [c_customer_sk#0], [c_customer_sk#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0]
                  :     :           +- 'Project [ss_quantity#0, ss_sales_price#0, c_customer_sk#0]
                  :     :              +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
                  :     :                 :- Project [ss_customer_sk#0, ss_quantity#0, ss_sales_price#0]
                  :     :                 :  +- Filter isnotnull(ss_customer_sk#0)
                  :     :                 :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :     :                 +- Project [c_customer_sk#0]
                  :     :                    +- Filter isnotnull(c_customer_sk#0)
                  :     :                       +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                  :     +- 'Join LeftSemi, (c_customer_sk#0 = c_customer_sk#82#0)
                  :        :- Project [c_customer_sk#0, c_first_name#0, c_last_name#0]
                  :        :  +- Filter isnotnull(c_customer_sk#0)
                  :        :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                  :        +- 'Project [c_customer_sk#0 AS c_customer_sk#82#0]
                  :           +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(38,8)) > CheckOverflow((0.500000 * promote_precision(cast(scalar-subquery#0 [] as decimal(32,6)))), DecimalType(38,8))))
                  :              :  +- Aggregate [max(csales#1572) AS tpcds_cmax#1573]
                  :              :     +- Aggregate [c_customer_sk#82], [sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2))) AS csales#1572]
                  :              :        +- Project [ss_quantity#290, ss_sales_price#293, c_customer_sk#82]
                  :              :           +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
                  :              :              :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_sales_price#293, c_customer_sk#82]
                  :              :              :  +- Join Inner, (ss_customer_sk#283 = c_customer_sk#82)
                  :              :              :     :- Project [ss_sold_date_sk#280, ss_customer_sk#283, ss_quantity#290, ss_sales_price#293]
                  :              :              :     :  +- Filter (isnotnull(ss_customer_sk#283) && isnotnull(ss_sold_date_sk#280))
                  :              :              :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
                  :              :              :     +- Project [c_customer_sk#82]
                  :              :              :        +- Filter isnotnull(c_customer_sk#82)
                  :              :              :           +- Relation[c_customer_sk#82,c_customer_id#83,c_current_cdemo_sk#84,c_current_hdemo_sk#85,c_current_addr_sk#86,c_first_shipto_date_sk#87,c_first_sales_date_sk#88,c_salutation#89,c_first_name#90,c_last_name#91,c_preferred_cust_flag#92,c_birth_day#93,c_birth_month#94,c_birth_year#95,c_birth_country#96,c_login#97,c_email_address#98,c_last_review_date#99] parquet
                  :              :              +- Project [d_date_sk#24]
                  :              :                 +- Filter (d_year#30 IN (2000,2001,2002,2003) && isnotnull(d_date_sk#24))
                  :              :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                  :              +- 'Aggregate [c_customer_sk#0], [c_customer_sk#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#293 as decimal(12,2)))), DecimalType(18,2)))#0]
                  :                 +- 'Project [ss_quantity#0, ss_sales_price#0, c_customer_sk#0]
                  :                    +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
                  :                       :- Project [ss_customer_sk#0, ss_quantity#0, ss_sales_price#0]
                  :                       :  +- Filter isnotnull(ss_customer_sk#0)
                  :                       :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :                       +- Project [c_customer_sk#0]
                  :                          +- Filter isnotnull(c_customer_sk#0)
                  :                             +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                  +- Project [d_date_sk#0]
                     +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 2)) && isnotnull(d_date_sk#0))
                        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q24a
================================================================================================

'Project [c_last_name#0, c_first_name#0, s_store_name#0, paid#0]
+- 'Filter (isnotnull(sum(netpaid#1605)#0) && (cast(sum(netpaid#1605)#0 as decimal(33,8)) > cast(scalar-subquery#0 [] as decimal(33,8))))
   :  +- Aggregate [CheckOverflow((0.050000 * promote_precision(avg(netpaid#1605))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#1609]
   :     +- Aggregate [c_last_name#91, c_first_name#90, s_store_name#58, ca_state#617, s_state#77, i_color#320, i_current_price#308, i_manager_id#323, i_units#321, i_size#318], [MakeDecimal(sum(UnscaledValue(ss_net_paid#300)),17,2) AS netpaid#1605]
   :        +- Project [ss_net_paid#300, s_store_name#58, s_state#77, i_current_price#308, i_size#318, i_color#320, i_units#321, i_manager_id#323, c_first_name#90, c_last_name#91, ca_state#617]
   :           +- Join Inner, ((c_birth_country#96 = upper(ca_country#619)) && (s_zip#78 = ca_zip#618))
   :              :- Project [ss_net_paid#300, s_store_name#58, s_state#77, s_zip#78, i_current_price#308, i_size#318, i_color#320, i_units#321, i_manager_id#323, c_first_name#90, c_last_name#91, c_birth_country#96]
   :              :  +- Join Inner, (ss_customer_sk#283 = c_customer_sk#82)
   :              :     :- Project [ss_customer_sk#283, ss_net_paid#300, s_store_name#58, s_state#77, s_zip#78, i_current_price#308, i_size#318, i_color#320, i_units#321, i_manager_id#323]
   :              :     :  +- Join Inner, (ss_item_sk#282 = i_item_sk#303)
   :              :     :     :- Project [ss_item_sk#282, ss_customer_sk#283, ss_net_paid#300, s_store_name#58, s_state#77, s_zip#78]
   :              :     :     :  +- Join Inner, (ss_store_sk#287 = s_store_sk#53)
   :              :     :     :     :- Project [ss_item_sk#282, ss_customer_sk#283, ss_store_sk#287, ss_net_paid#300]
   :              :     :     :     :  +- Join Inner, ((cast(ss_ticket_number#289 as bigint) = sr_ticket_number#13L) && (cast(ss_item_sk#282 as bigint) = sr_item_sk#6L))
   :              :     :     :     :     :- Project [ss_item_sk#282, ss_customer_sk#283, ss_store_sk#287, ss_ticket_number#289, ss_net_paid#300]
   :              :     :     :     :     :  +- Filter (((isnotnull(ss_ticket_number#289) && isnotnull(ss_item_sk#282)) && isnotnull(ss_store_sk#287)) && isnotnull(ss_customer_sk#283))
   :              :     :     :     :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
   :              :     :     :     :     +- Project [sr_item_sk#6L, sr_ticket_number#13L]
   :              :     :     :     :        +- Filter (isnotnull(sr_ticket_number#13L) && isnotnull(sr_item_sk#6L))
   :              :     :     :     :           +- Relation[sr_returned_date_sk#4L,sr_return_time_sk#5L,sr_item_sk#6L,sr_customer_sk#7L,sr_cdemo_sk#8L,sr_hdemo_sk#9L,sr_addr_sk#10L,sr_store_sk#11L,sr_reason_sk#12L,sr_ticket_number#13L,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet
   :              :     :     :     +- Project [s_store_sk#53, s_store_name#58, s_state#77, s_zip#78]
   :              :     :     :        +- Filter (((isnotnull(s_market_id#63) && (s_market_id#63 = 8)) && isnotnull(s_store_sk#53)) && isnotnull(s_zip#78))
   :              :     :     :           +- Relation[s_store_sk#53,s_store_id#54,s_rec_start_date#55,s_rec_end_date#56,s_closed_date_sk#57,s_store_name#58,s_number_employees#59,s_floor_space#60,s_hours#61,s_manager#62,s_market_id#63,s_geography_class#64,s_market_desc#65,s_market_manager#66,s_division_id#67,s_division_name#68,s_company_id#69,s_company_name#70,s_street_number#71,s_street_name#72,s_street_type#73,s_suite_number#74,s_city#75,s_county#76,... 5 more fields] parquet
   :              :     :     +- Project [i_item_sk#303, i_current_price#308, i_size#318, i_color#320, i_units#321, i_manager_id#323]
   :              :     :        +- Filter isnotnull(i_item_sk#303)
   :              :     :           +- Relation[i_item_sk#303,i_item_id#304,i_rec_start_date#305,i_rec_end_date#306,i_item_desc#307,i_current_price#308,i_wholesale_cost#309,i_brand_id#310,i_brand#311,i_class_id#312,i_class#313,i_category_id#314,i_category#315,i_manufact_id#316,i_manufact#317,i_size#318,i_formulation#319,i_color#320,i_units#321,i_container#322,i_manager_id#323,i_product_name#324] parquet
   :              :     +- Project [c_customer_sk#82, c_first_name#90, c_last_name#91, c_birth_country#96]
   :              :        +- Filter (isnotnull(c_customer_sk#82) && isnotnull(c_birth_country#96))
   :              :           +- Relation[c_customer_sk#82,c_customer_id#83,c_current_cdemo_sk#84,c_current_hdemo_sk#85,c_current_addr_sk#86,c_first_shipto_date_sk#87,c_first_sales_date_sk#88,c_salutation#89,c_first_name#90,c_last_name#91,c_preferred_cust_flag#92,c_birth_day#93,c_birth_month#94,c_birth_year#95,c_birth_country#96,c_login#97,c_email_address#98,c_last_review_date#99] parquet
   :              +- Project [ca_state#617, ca_zip#618, ca_country#619]
   :                 +- Filter isnotnull(ca_zip#618)
   :                    +- Relation[ca_address_sk#609,ca_address_id#610,ca_street_number#611,ca_street_name#612,ca_street_type#613,ca_suite_number#614,ca_city#615,ca_county#616,ca_state#617,ca_zip#618,ca_country#619,ca_gmt_offset#620,ca_location_type#621] parquet
   +- 'Aggregate [c_last_name#0, c_first_name#0, s_store_name#0], [c_last_name#0, c_first_name#0, s_store_name#0, sum(netpaid#0) AS paid#0, sum(netpaid#0) AS sum(netpaid#1605)#0]
      +- 'Aggregate [c_last_name#0, c_first_name#0, s_store_name#0, ca_state#0, s_state#0, i_color#0, i_current_price#0, i_manager_id#0, i_units#0, i_size#0], [c_last_name#0, c_first_name#0, s_store_name#0, MakeDecimal(sum(UnscaledValue(ss_net_paid#0)),17,2) AS netpaid#0]
         +- 'Project [ss_net_paid#0, s_store_name#0, s_state#0, i_current_price#0, i_size#0, i_color#0, i_units#0, i_manager_id#0, c_first_name#0, c_last_name#0, ca_state#0]
            +- 'Join Inner, ((c_birth_country#0 = upper(ca_country#0)) && (s_zip#0 = ca_zip#0))
               :- 'Project [ss_net_paid#0, s_store_name#0, s_state#0, s_zip#0, i_current_price#0, i_size#0, i_color#0, i_units#0, i_manager_id#0, c_first_name#0, c_last_name#0, c_birth_country#0]
               :  +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
               :     :- 'Project [ss_customer_sk#0, ss_net_paid#0, s_store_name#0, s_state#0, s_zip#0, i_current_price#0, i_size#0, i_color#0, i_units#0, i_manager_id#0]
               :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_net_paid#0, s_store_name#0, s_state#0, s_zip#0]
               :     :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :     :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_net_paid#0]
               :     :     :     :  +- 'Join Inner, ((cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L))
               :     :     :     :     :- Project [ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_ticket_number#0, ss_net_paid#0]
               :     :     :     :     :  +- Filter (((isnotnull(ss_ticket_number#0) && isnotnull(ss_item_sk#0)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_customer_sk#0))
               :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     :     :     +- Project [sr_item_sk#0L, sr_ticket_number#0L]
               :     :     :     :        +- Filter (isnotnull(sr_ticket_number#0L) && isnotnull(sr_item_sk#0L))
               :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               :     :     :     +- Project [s_store_sk#0, s_store_name#0, s_state#0, s_zip#0]
               :     :     :        +- Filter (((isnotnull(s_market_id#0) && (s_market_id#0 = 8)) && isnotnull(s_store_sk#0)) && isnotnull(s_zip#0))
               :     :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :     :     +- Project [i_item_sk#0, i_current_price#0, i_size#0, i_color#0, i_units#0, i_manager_id#0]
               :     :        +- Filter ((isnotnull(i_color#0) && (i_color#0 = pale)) && isnotnull(i_item_sk#0))
               :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :     +- Project [c_customer_sk#0, c_first_name#0, c_last_name#0, c_birth_country#0]
               :        +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_birth_country#0))
               :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
               +- Project [ca_state#0, ca_zip#0, ca_country#0]
                  +- Filter isnotnull(ca_zip#0)
                     +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet


================================================================================================
q24b
================================================================================================

'Project [c_last_name#0, c_first_name#0, s_store_name#0, paid#0]
+- 'Filter (isnotnull(sum(netpaid#1620)#0) && (cast(sum(netpaid#1620)#0 as decimal(33,8)) > cast(scalar-subquery#0 [] as decimal(33,8))))
   :  +- Aggregate [CheckOverflow((0.050000 * promote_precision(avg(netpaid#1620))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#1624]
   :     +- Aggregate [c_last_name#91, c_first_name#90, s_store_name#58, ca_state#617, s_state#77, i_color#320, i_current_price#308, i_manager_id#323, i_units#321, i_size#318], [MakeDecimal(sum(UnscaledValue(ss_net_paid#300)),17,2) AS netpaid#1620]
   :        +- Project [ss_net_paid#300, s_store_name#58, s_state#77, i_current_price#308, i_size#318, i_color#320, i_units#321, i_manager_id#323, c_first_name#90, c_last_name#91, ca_state#617]
   :           +- Join Inner, ((c_birth_country#96 = upper(ca_country#619)) && (s_zip#78 = ca_zip#618))
   :              :- Project [ss_net_paid#300, s_store_name#58, s_state#77, s_zip#78, i_current_price#308, i_size#318, i_color#320, i_units#321, i_manager_id#323, c_first_name#90, c_last_name#91, c_birth_country#96]
   :              :  +- Join Inner, (ss_customer_sk#283 = c_customer_sk#82)
   :              :     :- Project [ss_customer_sk#283, ss_net_paid#300, s_store_name#58, s_state#77, s_zip#78, i_current_price#308, i_size#318, i_color#320, i_units#321, i_manager_id#323]
   :              :     :  +- Join Inner, (ss_item_sk#282 = i_item_sk#303)
   :              :     :     :- Project [ss_item_sk#282, ss_customer_sk#283, ss_net_paid#300, s_store_name#58, s_state#77, s_zip#78]
   :              :     :     :  +- Join Inner, (ss_store_sk#287 = s_store_sk#53)
   :              :     :     :     :- Project [ss_item_sk#282, ss_customer_sk#283, ss_store_sk#287, ss_net_paid#300]
   :              :     :     :     :  +- Join Inner, ((cast(ss_ticket_number#289 as bigint) = sr_ticket_number#13L) && (cast(ss_item_sk#282 as bigint) = sr_item_sk#6L))
   :              :     :     :     :     :- Project [ss_item_sk#282, ss_customer_sk#283, ss_store_sk#287, ss_ticket_number#289, ss_net_paid#300]
   :              :     :     :     :     :  +- Filter (((isnotnull(ss_ticket_number#289) && isnotnull(ss_item_sk#282)) && isnotnull(ss_store_sk#287)) && isnotnull(ss_customer_sk#283))
   :              :     :     :     :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
   :              :     :     :     :     +- Project [sr_item_sk#6L, sr_ticket_number#13L]
   :              :     :     :     :        +- Filter (isnotnull(sr_ticket_number#13L) && isnotnull(sr_item_sk#6L))
   :              :     :     :     :           +- Relation[sr_returned_date_sk#4L,sr_return_time_sk#5L,sr_item_sk#6L,sr_customer_sk#7L,sr_cdemo_sk#8L,sr_hdemo_sk#9L,sr_addr_sk#10L,sr_store_sk#11L,sr_reason_sk#12L,sr_ticket_number#13L,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet
   :              :     :     :     +- Project [s_store_sk#53, s_store_name#58, s_state#77, s_zip#78]
   :              :     :     :        +- Filter (((isnotnull(s_market_id#63) && (s_market_id#63 = 8)) && isnotnull(s_store_sk#53)) && isnotnull(s_zip#78))
   :              :     :     :           +- Relation[s_store_sk#53,s_store_id#54,s_rec_start_date#55,s_rec_end_date#56,s_closed_date_sk#57,s_store_name#58,s_number_employees#59,s_floor_space#60,s_hours#61,s_manager#62,s_market_id#63,s_geography_class#64,s_market_desc#65,s_market_manager#66,s_division_id#67,s_division_name#68,s_company_id#69,s_company_name#70,s_street_number#71,s_street_name#72,s_street_type#73,s_suite_number#74,s_city#75,s_county#76,... 5 more fields] parquet
   :              :     :     +- Project [i_item_sk#303, i_current_price#308, i_size#318, i_color#320, i_units#321, i_manager_id#323]
   :              :     :        +- Filter isnotnull(i_item_sk#303)
   :              :     :           +- Relation[i_item_sk#303,i_item_id#304,i_rec_start_date#305,i_rec_end_date#306,i_item_desc#307,i_current_price#308,i_wholesale_cost#309,i_brand_id#310,i_brand#311,i_class_id#312,i_class#313,i_category_id#314,i_category#315,i_manufact_id#316,i_manufact#317,i_size#318,i_formulation#319,i_color#320,i_units#321,i_container#322,i_manager_id#323,i_product_name#324] parquet
   :              :     +- Project [c_customer_sk#82, c_first_name#90, c_last_name#91, c_birth_country#96]
   :              :        +- Filter (isnotnull(c_customer_sk#82) && isnotnull(c_birth_country#96))
   :              :           +- Relation[c_customer_sk#82,c_customer_id#83,c_current_cdemo_sk#84,c_current_hdemo_sk#85,c_current_addr_sk#86,c_first_shipto_date_sk#87,c_first_sales_date_sk#88,c_salutation#89,c_first_name#90,c_last_name#91,c_preferred_cust_flag#92,c_birth_day#93,c_birth_month#94,c_birth_year#95,c_birth_country#96,c_login#97,c_email_address#98,c_last_review_date#99] parquet
   :              +- Project [ca_state#617, ca_zip#618, ca_country#619]
   :                 +- Filter isnotnull(ca_zip#618)
   :                    +- Relation[ca_address_sk#609,ca_address_id#610,ca_street_number#611,ca_street_name#612,ca_street_type#613,ca_suite_number#614,ca_city#615,ca_county#616,ca_state#617,ca_zip#618,ca_country#619,ca_gmt_offset#620,ca_location_type#621] parquet
   +- 'Aggregate [c_last_name#0, c_first_name#0, s_store_name#0], [c_last_name#0, c_first_name#0, s_store_name#0, sum(netpaid#0) AS paid#0, sum(netpaid#0) AS sum(netpaid#1620)#0]
      +- 'Aggregate [c_last_name#0, c_first_name#0, s_store_name#0, ca_state#0, s_state#0, i_color#0, i_current_price#0, i_manager_id#0, i_units#0, i_size#0], [c_last_name#0, c_first_name#0, s_store_name#0, MakeDecimal(sum(UnscaledValue(ss_net_paid#0)),17,2) AS netpaid#0]
         +- 'Project [ss_net_paid#0, s_store_name#0, s_state#0, i_current_price#0, i_size#0, i_color#0, i_units#0, i_manager_id#0, c_first_name#0, c_last_name#0, ca_state#0]
            +- 'Join Inner, ((c_birth_country#0 = upper(ca_country#0)) && (s_zip#0 = ca_zip#0))
               :- 'Project [ss_net_paid#0, s_store_name#0, s_state#0, s_zip#0, i_current_price#0, i_size#0, i_color#0, i_units#0, i_manager_id#0, c_first_name#0, c_last_name#0, c_birth_country#0]
               :  +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
               :     :- 'Project [ss_customer_sk#0, ss_net_paid#0, s_store_name#0, s_state#0, s_zip#0, i_current_price#0, i_size#0, i_color#0, i_units#0, i_manager_id#0]
               :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_net_paid#0, s_store_name#0, s_state#0, s_zip#0]
               :     :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :     :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_net_paid#0]
               :     :     :     :  +- 'Join Inner, ((cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L))
               :     :     :     :     :- Project [ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_ticket_number#0, ss_net_paid#0]
               :     :     :     :     :  +- Filter (((isnotnull(ss_ticket_number#0) && isnotnull(ss_item_sk#0)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_customer_sk#0))
               :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     :     :     +- Project [sr_item_sk#0L, sr_ticket_number#0L]
               :     :     :     :        +- Filter (isnotnull(sr_ticket_number#0L) && isnotnull(sr_item_sk#0L))
               :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               :     :     :     +- Project [s_store_sk#0, s_store_name#0, s_state#0, s_zip#0]
               :     :     :        +- Filter (((isnotnull(s_market_id#0) && (s_market_id#0 = 8)) && isnotnull(s_store_sk#0)) && isnotnull(s_zip#0))
               :     :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :     :     +- Project [i_item_sk#0, i_current_price#0, i_size#0, i_color#0, i_units#0, i_manager_id#0]
               :     :        +- Filter ((isnotnull(i_color#0) && (i_color#0 = chiffon)) && isnotnull(i_item_sk#0))
               :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :     +- Project [c_customer_sk#0, c_first_name#0, c_last_name#0, c_birth_country#0]
               :        +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_birth_country#0))
               :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
               +- Project [ca_state#0, ca_zip#0, ca_country#0]
                  +- Filter isnotnull(ca_zip#0)
                     +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet


================================================================================================
q25
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_item_id#0 ASC NULLS FIRST, i_item_desc#0 ASC NULLS FIRST, s_store_id#0 ASC NULLS FIRST, s_store_name#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_item_id#0, i_item_desc#0, s_store_id#0, s_store_name#0], [i_item_id#0, i_item_desc#0, s_store_id#0, s_store_name#0, MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS store_sales_profit#0, MakeDecimal(sum(UnscaledValue(sr_net_loss#0)),17,2) AS store_returns_loss#0, MakeDecimal(sum(UnscaledValue(cs_net_profit#0)),17,2) AS catalog_sales_profit#0]
         +- 'Project [ss_net_profit#0, sr_net_loss#0, cs_net_profit#0, s_store_id#0, s_store_name#0, i_item_id#0, i_item_desc#0]
            +- 'Join Inner, (i_item_sk#0 = ss_item_sk#0)
               :- 'Project [ss_item_sk#0, ss_net_profit#0, sr_net_loss#0, cs_net_profit#0, s_store_id#0, s_store_name#0]
               :  +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
               :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_net_profit#0, sr_net_loss#0, cs_net_profit#0]
               :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :     :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_net_profit#0, sr_net_loss#0, cs_sold_date_sk#0, cs_net_profit#0]
               :     :     :  +- 'Join Inner, (sr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
               :     :     :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_net_profit#0, sr_returned_date_sk#0L, sr_net_loss#0, cs_sold_date_sk#0, cs_net_profit#0]
               :     :     :     :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
               :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_net_profit#0, sr_returned_date_sk#0L, sr_net_loss#0, cs_sold_date_sk#0, cs_net_profit#0]
               :     :     :     :     :  +- 'Join Inner, ((sr_customer_sk#0L = cast(cs_bill_customer_sk#0 as bigint)) && (sr_item_sk#0L = cast(cs_item_sk#0 as bigint)))
               :     :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_net_profit#0, sr_returned_date_sk#0L, sr_item_sk#0L, sr_customer_sk#0L, sr_net_loss#0]
               :     :     :     :     :     :  +- 'Join Inner, (((cast(ss_customer_sk#0 as bigint) = sr_customer_sk#0L) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L)) && (cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L))
               :     :     :     :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_ticket_number#0, ss_net_profit#0]
               :     :     :     :     :     :     :  +- Filter ((((isnotnull(ss_customer_sk#0) && isnotnull(ss_ticket_number#0)) && isnotnull(ss_item_sk#0)) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0))
               :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     :     :     :     :     +- Project [sr_returned_date_sk#0L, sr_item_sk#0L, sr_customer_sk#0L, sr_ticket_number#0L, sr_net_loss#0]
               :     :     :     :     :     :        +- Filter (((isnotnull(sr_ticket_number#0L) && isnotnull(sr_customer_sk#0L)) && isnotnull(sr_item_sk#0L)) && isnotnull(sr_returned_date_sk#0L))
               :     :     :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               :     :     :     :     :     +- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_net_profit#0]
               :     :     :     :     :        +- Filter ((isnotnull(cs_bill_customer_sk#0) && isnotnull(cs_item_sk#0)) && isnotnull(cs_sold_date_sk#0))
               :     :     :     :     :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :     :     :     +- Project [d_date_sk#0]
               :     :     :     :        +- Filter ((((isnotnull(d_moy#0) && isnotnull(d_year#0)) && (d_moy#0 = 4)) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
               :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     :     +- Project [d_date_sk#0]
               :     :     :        +- Filter (((((isnotnull(d_moy#0) && isnotnull(d_year#0)) && (d_moy#0 >= 4)) && (d_moy#0 <= 10)) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
               :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     +- Project [d_date_sk#0]
               :     :        +- Filter (((((isnotnull(d_moy#0) && isnotnull(d_year#0)) && (d_moy#0 >= 4)) && (d_moy#0 <= 10)) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
               :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [s_store_sk#0, s_store_id#0, s_store_name#0]
               :        +- Filter isnotnull(s_store_sk#0)
               :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               +- Project [i_item_sk#0, i_item_id#0, i_item_desc#0]
                  +- Filter isnotnull(i_item_sk#0)
                     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q26
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_item_id#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_item_id#0], [i_item_id#0, avg(cast(cs_quantity#0 as bigint)) AS agg1#0, cast((avg(UnscaledValue(cs_list_price#0)) / 100.0) as decimal(11,6)) AS agg2#0, cast((avg(UnscaledValue(cs_coupon_amt#0)) / 100.0) as decimal(11,6)) AS agg3#0, cast((avg(UnscaledValue(cs_sales_price#0)) / 100.0) as decimal(11,6)) AS agg4#0]
         +- 'Project [cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, i_item_id#0]
            +- 'Join Inner, (cs_promo_sk#0 = p_promo_sk#0)
               :- 'Project [cs_promo_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, i_item_id#0]
               :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
               :     :- 'Project [cs_item_sk#0, cs_promo_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0]
               :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0]
               :     :     :  +- 'Join Inner, (cs_bill_cdemo_sk#0 = cd_demo_sk#0)
               :     :     :     :- Project [cs_sold_date_sk#0, cs_bill_cdemo_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0]
               :     :     :     :  +- Filter (((isnotnull(cs_bill_cdemo_sk#0) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_item_sk#0)) && isnotnull(cs_promo_sk#0))
               :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :     :     +- Project [cd_demo_sk#0]
               :     :     :        +- Filter ((((((isnotnull(cd_education_status#0) && isnotnull(cd_marital_status#0)) && isnotnull(cd_gender#0)) && (cd_gender#0 = M)) && (cd_marital_status#0 = S)) && (cd_education_status#0 = College)) && isnotnull(cd_demo_sk#0))
               :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
               :     :     +- Project [d_date_sk#0]
               :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
               :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [i_item_sk#0, i_item_id#0]
               :        +- Filter isnotnull(i_item_sk#0)
               :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               +- Project [p_promo_sk#0]
                  +- Filter (((p_channel_email#0 = N) || (p_channel_event#0 = N)) && isnotnull(p_promo_sk#0))
                     +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet


================================================================================================
q27
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_item_id#0 ASC NULLS FIRST, s_state#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_item_id#0, s_state#0, spark_grouping_id#0], [i_item_id#0, s_state#0, cast((shiftright(spark_grouping_id#0, 0) & 1) as tinyint) AS g_state#0, avg(cast(ss_quantity#0 as bigint)) AS agg1#0, cast((avg(UnscaledValue(ss_list_price#0)) / 100.0) as decimal(11,6)) AS agg2#0, cast((avg(UnscaledValue(ss_coupon_amt#0)) / 100.0) as decimal(11,6)) AS agg3#0, cast((avg(UnscaledValue(ss_sales_price#0)) / 100.0) as decimal(11,6)) AS agg4#0]
         +- 'Expand [List(ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0, i_item_id#0, s_state#0, 0), List(ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0, i_item_id#0, null, 1), List(ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0, null, null, 3)], [ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0, i_item_id#0, s_state#0, spark_grouping_id#0]
            +- 'Project [ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0, i_item_id#0, s_state#0]
               +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                  :- 'Project [ss_item_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0, s_state#0]
                  :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                  :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
                  :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                  :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
                  :     :     :  +- 'Join Inner, (ss_cdemo_sk#0 = cd_demo_sk#0)
                  :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_cdemo_sk#0, ss_store_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
                  :     :     :     :  +- Filter (((isnotnull(ss_cdemo_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
                  :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :     :     :     +- Project [cd_demo_sk#0]
                  :     :     :        +- Filter ((((((isnotnull(cd_education_status#0) && isnotnull(cd_marital_status#0)) && isnotnull(cd_gender#0)) && (cd_gender#0 = M)) && (cd_marital_status#0 = S)) && (cd_education_status#0 = College)) && isnotnull(cd_demo_sk#0))
                  :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
                  :     :     +- Project [d_date_sk#0]
                  :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
                  :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     +- Project [s_store_sk#0, s_state#0]
                  :        +- Filter ((isnotnull(s_state#0) && (s_state#0 = TN)) && isnotnull(s_store_sk#0))
                  :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                  +- Project [i_item_sk#0, i_item_id#0]
                     +- Filter isnotnull(i_item_sk#0)
                        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q28
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Join Inner
      :- 'Join Inner
      :  :- 'Join Inner
      :  :  :- 'Join Inner
      :  :  :  :- 'Join Inner
      :  :  :  :  :- Aggregate [cast((avg(UnscaledValue(ss_list_price#0)) / 100.0) as decimal(11,6)) AS B1_LP#0, count(ss_list_price#0) AS B1_CNT#0L, count(distinct ss_list_price#0) AS B1_CNTD#0L]
      :  :  :  :  :  +- Project [ss_list_price#0]
      :  :  :  :  :     +- Filter (((isnotnull(ss_quantity#0) && (ss_quantity#0 >= 0)) && (ss_quantity#0 <= 5)) && ((((ss_list_price#0 >= 8.00) && (cast(ss_list_price#0 as decimal(12,2)) <= 18.00)) || ((ss_coupon_amt#0 >= 459.00) && (cast(ss_coupon_amt#0 as decimal(12,2)) <= 1459.00))) || ((ss_wholesale_cost#0 >= 57.00) && (cast(ss_wholesale_cost#0 as decimal(12,2)) <= 77.00))))
      :  :  :  :  :        +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :  :  :  :  +- Aggregate [cast((avg(UnscaledValue(ss_list_price#0)) / 100.0) as decimal(11,6)) AS B2_LP#0, count(ss_list_price#0) AS B2_CNT#0L, count(distinct ss_list_price#0) AS B2_CNTD#0L]
      :  :  :  :     +- Project [ss_list_price#0]
      :  :  :  :        +- Filter (((isnotnull(ss_quantity#0) && (ss_quantity#0 >= 6)) && (ss_quantity#0 <= 10)) && ((((ss_list_price#0 >= 90.00) && (cast(ss_list_price#0 as decimal(12,2)) <= 100.00)) || ((ss_coupon_amt#0 >= 2323.00) && (cast(ss_coupon_amt#0 as decimal(12,2)) <= 3323.00))) || ((ss_wholesale_cost#0 >= 31.00) && (cast(ss_wholesale_cost#0 as decimal(12,2)) <= 51.00))))
      :  :  :  :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :  :  :  +- Aggregate [cast((avg(UnscaledValue(ss_list_price#0)) / 100.0) as decimal(11,6)) AS B3_LP#0, count(ss_list_price#0) AS B3_CNT#0L, count(distinct ss_list_price#0) AS B3_CNTD#0L]
      :  :  :     +- Project [ss_list_price#0]
      :  :  :        +- Filter (((isnotnull(ss_quantity#0) && (ss_quantity#0 >= 11)) && (ss_quantity#0 <= 15)) && ((((ss_list_price#0 >= 142.00) && (cast(ss_list_price#0 as decimal(12,2)) <= 152.00)) || ((ss_coupon_amt#0 >= 12214.00) && (cast(ss_coupon_amt#0 as decimal(12,2)) <= 13214.00))) || ((ss_wholesale_cost#0 >= 79.00) && (cast(ss_wholesale_cost#0 as decimal(12,2)) <= 99.00))))
      :  :  :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :  :  +- Aggregate [cast((avg(UnscaledValue(ss_list_price#0)) / 100.0) as decimal(11,6)) AS B4_LP#0, count(ss_list_price#0) AS B4_CNT#0L, count(distinct ss_list_price#0) AS B4_CNTD#0L]
      :  :     +- Project [ss_list_price#0]
      :  :        +- Filter (((isnotnull(ss_quantity#0) && (ss_quantity#0 >= 16)) && (ss_quantity#0 <= 20)) && ((((ss_list_price#0 >= 135.00) && (cast(ss_list_price#0 as decimal(12,2)) <= 145.00)) || ((ss_coupon_amt#0 >= 6071.00) && (cast(ss_coupon_amt#0 as decimal(12,2)) <= 7071.00))) || ((ss_wholesale_cost#0 >= 38.00) && (cast(ss_wholesale_cost#0 as decimal(12,2)) <= 58.00))))
      :  :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :  +- Aggregate [cast((avg(UnscaledValue(ss_list_price#0)) / 100.0) as decimal(11,6)) AS B5_LP#0, count(ss_list_price#0) AS B5_CNT#0L, count(distinct ss_list_price#0) AS B5_CNTD#0L]
      :     +- Project [ss_list_price#0]
      :        +- Filter (((isnotnull(ss_quantity#0) && (ss_quantity#0 >= 21)) && (ss_quantity#0 <= 25)) && ((((ss_list_price#0 >= 122.00) && (cast(ss_list_price#0 as decimal(12,2)) <= 132.00)) || ((ss_coupon_amt#0 >= 836.00) && (cast(ss_coupon_amt#0 as decimal(12,2)) <= 1836.00))) || ((ss_wholesale_cost#0 >= 17.00) && (cast(ss_wholesale_cost#0 as decimal(12,2)) <= 37.00))))
      :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      +- Aggregate [cast((avg(UnscaledValue(ss_list_price#0)) / 100.0) as decimal(11,6)) AS B6_LP#0, count(ss_list_price#0) AS B6_CNT#0L, count(distinct ss_list_price#0) AS B6_CNTD#0L]
         +- Project [ss_list_price#0]
            +- Filter (((isnotnull(ss_quantity#0) && (ss_quantity#0 >= 26)) && (ss_quantity#0 <= 30)) && ((((ss_list_price#0 >= 154.00) && (cast(ss_list_price#0 as decimal(12,2)) <= 164.00)) || ((ss_coupon_amt#0 >= 7326.00) && (cast(ss_coupon_amt#0 as decimal(12,2)) <= 8326.00))) || ((ss_wholesale_cost#0 >= 7.00) && (cast(ss_wholesale_cost#0 as decimal(12,2)) <= 27.00))))
               +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet


================================================================================================
q29
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_item_id#0 ASC NULLS FIRST, i_item_desc#0 ASC NULLS FIRST, s_store_id#0 ASC NULLS FIRST, s_store_name#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_item_id#0, i_item_desc#0, s_store_id#0, s_store_name#0], [i_item_id#0, i_item_desc#0, s_store_id#0, s_store_name#0, sum(cast(ss_quantity#0 as bigint)) AS store_sales_quantity#0L, sum(cast(sr_return_quantity#0 as bigint)) AS store_returns_quantity#0L, sum(cast(cs_quantity#0 as bigint)) AS catalog_sales_quantity#0L]
         +- 'Project [ss_quantity#0, sr_return_quantity#0, cs_quantity#0, s_store_id#0, s_store_name#0, i_item_id#0, i_item_desc#0]
            +- 'Join Inner, (i_item_sk#0 = ss_item_sk#0)
               :- 'Project [ss_item_sk#0, ss_quantity#0, sr_return_quantity#0, cs_quantity#0, s_store_id#0, s_store_name#0]
               :  +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
               :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, sr_return_quantity#0, cs_quantity#0]
               :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :     :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, sr_return_quantity#0, cs_sold_date_sk#0, cs_quantity#0]
               :     :     :  +- 'Join Inner, (sr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
               :     :     :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, sr_returned_date_sk#0L, sr_return_quantity#0, cs_sold_date_sk#0, cs_quantity#0]
               :     :     :     :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
               :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, sr_returned_date_sk#0L, sr_return_quantity#0, cs_sold_date_sk#0, cs_quantity#0]
               :     :     :     :     :  +- 'Join Inner, ((sr_customer_sk#0L = cast(cs_bill_customer_sk#0 as bigint)) && (sr_item_sk#0L = cast(cs_item_sk#0 as bigint)))
               :     :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, sr_returned_date_sk#0L, sr_item_sk#0L, sr_customer_sk#0L, sr_return_quantity#0]
               :     :     :     :     :     :  +- 'Join Inner, (((cast(ss_customer_sk#0 as bigint) = sr_customer_sk#0L) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L)) && (cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L))
               :     :     :     :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_ticket_number#0, ss_quantity#0]
               :     :     :     :     :     :     :  +- Filter ((((isnotnull(ss_customer_sk#0) && isnotnull(ss_ticket_number#0)) && isnotnull(ss_item_sk#0)) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0))
               :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     :     :     :     :     +- Project [sr_returned_date_sk#0L, sr_item_sk#0L, sr_customer_sk#0L, sr_ticket_number#0L, sr_return_quantity#0]
               :     :     :     :     :     :        +- Filter (((isnotnull(sr_ticket_number#0L) && isnotnull(sr_customer_sk#0L)) && isnotnull(sr_item_sk#0L)) && isnotnull(sr_returned_date_sk#0L))
               :     :     :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               :     :     :     :     :     +- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0]
               :     :     :     :     :        +- Filter ((isnotnull(cs_bill_customer_sk#0) && isnotnull(cs_item_sk#0)) && isnotnull(cs_sold_date_sk#0))
               :     :     :     :     :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :     :     :     +- Project [d_date_sk#0]
               :     :     :     :        +- Filter ((((isnotnull(d_moy#0) && isnotnull(d_year#0)) && (d_moy#0 = 9)) && (d_year#0 = 1999)) && isnotnull(d_date_sk#0))
               :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     :     +- Project [d_date_sk#0]
               :     :     :        +- Filter (((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_moy#0 >= 9)) && (d_moy#0 <= 12)) && (d_year#0 = 1999)) && isnotnull(d_date_sk#0))
               :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     +- Project [d_date_sk#0]
               :     :        +- Filter (d_year#0 IN (1999,2000,2001) && isnotnull(d_date_sk#0))
               :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [s_store_sk#0, s_store_id#0, s_store_name#0]
               :        +- Filter isnotnull(s_store_sk#0)
               :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               +- Project [i_item_sk#0, i_item_id#0, i_item_desc#0]
                  +- Filter isnotnull(i_item_sk#0)
                     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q30
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [c_customer_id#0 ASC NULLS FIRST, c_salutation#0 ASC NULLS FIRST, c_first_name#0 ASC NULLS FIRST, c_last_name#0 ASC NULLS FIRST, c_preferred_cust_flag#0 ASC NULLS FIRST, c_birth_day#0 ASC NULLS FIRST, c_birth_month#0 ASC NULLS FIRST, c_birth_year#0 ASC NULLS FIRST, c_birth_country#0 ASC NULLS FIRST, c_login#0 ASC NULLS FIRST, c_email_address#0 ASC NULLS FIRST, c_last_review_date#0 ASC NULLS FIRST, ctr_total_return#0 ASC NULLS FIRST], true
      +- 'Project [c_customer_id#0, c_salutation#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_day#0, c_birth_month#0, c_birth_year#0, c_birth_country#0, c_login#0, c_email_address#0, c_last_review_date#0, ctr_total_return#0]
         +- 'Join Inner, (ca_address_sk#0 = c_current_addr_sk#0)
            :- 'Project [ctr_total_return#0, c_customer_id#0, c_current_addr_sk#0, c_salutation#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_day#0, c_birth_month#0, c_birth_year#0, c_birth_country#0, c_login#0, c_email_address#0, c_last_review_date#0]
            :  +- 'Join Inner, (ctr_customer_sk#0L = cast(c_customer_sk#0 as bigint))
            :     :- 'Project [ctr_customer_sk#0L, ctr_total_return#0]
            :     :  +- 'Join Inner, ((cast(ctr_total_return#0 as decimal(24,7)) > (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#0) && (ctr_state#0 = ctr_state#1873#0))
            :     :     :- 'Filter isnotnull(ctr_total_return#0)
            :     :     :  +- 'Aggregate [wr_returning_customer_sk#0L, ca_state#0], [wr_returning_customer_sk#0L AS ctr_customer_sk#0L, ca_state#0 AS ctr_state#0, MakeDecimal(sum(UnscaledValue(wr_return_amt#0)),17,2) AS ctr_total_return#0]
            :     :     :     +- 'Project [wr_returning_customer_sk#0L, wr_return_amt#0, ca_state#0]
            :     :     :        +- 'Join Inner, (wr_returning_addr_sk#0L = cast(ca_address_sk#0 as bigint))
            :     :     :           :- 'Project [wr_returning_customer_sk#0L, wr_returning_addr_sk#0L, wr_return_amt#0]
            :     :     :           :  +- 'Join Inner, (wr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
            :     :     :           :     :- Project [wr_returned_date_sk#0L, wr_returning_customer_sk#0L, wr_returning_addr_sk#0L, wr_return_amt#0]
            :     :     :           :     :  +- Filter ((isnotnull(wr_returned_date_sk#0L) && isnotnull(wr_returning_addr_sk#0L)) && isnotnull(wr_returning_customer_sk#0L))
            :     :     :           :     :     +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
            :     :     :           :     +- Project [d_date_sk#0]
            :     :     :           :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :     :     :           :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :           +- Project [ca_address_sk#0, ca_state#0]
            :     :     :              +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_state#0))
            :     :     :                 +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
            :     :     +- 'Filter isnotnull((CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#0)
            :     :        +- 'Aggregate [ctr_state#0], [CheckOverflow((promote_precision(avg(ctr_total_return#0)) * 1.200000), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#0, ctr_state#0 AS ctr_state#1873#0]
            :     :           +- 'Aggregate [wr_returning_customer_sk#0L, ca_state#0], [ca_state#0 AS ctr_state#0, MakeDecimal(sum(UnscaledValue(wr_return_amt#0)),17,2) AS ctr_total_return#0]
            :     :              +- 'Project [wr_returning_customer_sk#0L, wr_return_amt#0, ca_state#0]
            :     :                 +- 'Join Inner, (wr_returning_addr_sk#0L = cast(ca_address_sk#0 as bigint))
            :     :                    :- 'Project [wr_returning_customer_sk#0L, wr_returning_addr_sk#0L, wr_return_amt#0]
            :     :                    :  +- 'Join Inner, (wr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
            :     :                    :     :- Project [wr_returned_date_sk#0L, wr_returning_customer_sk#0L, wr_returning_addr_sk#0L, wr_return_amt#0]
            :     :                    :     :  +- Filter (isnotnull(wr_returned_date_sk#0L) && isnotnull(wr_returning_addr_sk#0L))
            :     :                    :     :     +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
            :     :                    :     +- Project [d_date_sk#0]
            :     :                    :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :     :                    :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                    +- Project [ca_address_sk#0, ca_state#0]
            :     :                       +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_state#0))
            :     :                          +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
            :     +- Project [c_customer_sk#0, c_customer_id#0, c_current_addr_sk#0, c_salutation#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_day#0, c_birth_month#0, c_birth_year#0, c_birth_country#0, c_login#0, c_email_address#0, c_last_review_date#0]
            :        +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_current_addr_sk#0))
            :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            +- Project [ca_address_sk#0]
               +- Filter ((isnotnull(ca_state#0) && (ca_state#0 = GA)) && isnotnull(ca_address_sk#0))
                  +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet


================================================================================================
q31
================================================================================================

'Sort [ca_county#0 ASC NULLS FIRST], true
+- 'Project [ca_county#0, d_year#0, CheckOverflow((promote_precision(web_sales#0) / promote_precision(web_sales#0)), DecimalType(37,20)) AS web_q1_q2_increase#0, CheckOverflow((promote_precision(store_sales#0) / promote_precision(store_sales#0)), DecimalType(37,20)) AS store_q1_q2_increase#0, CheckOverflow((promote_precision(web_sales#0) / promote_precision(web_sales#0)), DecimalType(37,20)) AS web_q2_q3_increase#0, CheckOverflow((promote_precision(store_sales#0) / promote_precision(store_sales#0)), DecimalType(37,20)) AS store_q2_q3_increase#0]
   +- 'Join Inner, ((ca_county#0 = ca_county#0) && (CASE WHEN (web_sales#0 > 0.00) THEN CheckOverflow((promote_precision(web_sales#0) / promote_precision(web_sales#0)), DecimalType(37,20)) ELSE null END > CASE WHEN (store_sales#0 > 0.00) THEN CheckOverflow((promote_precision(store_sales#0) / promote_precision(store_sales#0)), DecimalType(37,20)) ELSE null END))
      :- 'Project [ca_county#0, d_year#0, store_sales#0, store_sales#0, store_sales#0, ca_county#0, web_sales#0, web_sales#0]
      :  +- 'Join Inner, ((ca_county#0 = ca_county#0) && (CASE WHEN (web_sales#0 > 0.00) THEN CheckOverflow((promote_precision(web_sales#0) / promote_precision(web_sales#0)), DecimalType(37,20)) ELSE null END > CASE WHEN (store_sales#0 > 0.00) THEN CheckOverflow((promote_precision(store_sales#0) / promote_precision(store_sales#0)), DecimalType(37,20)) ELSE null END))
      :     :- 'Join Inner, (ca_county#0 = ca_county#0)
      :     :  :- 'Project [ca_county#0, d_year#0, store_sales#0, store_sales#0, store_sales#0]
      :     :  :  +- 'Join Inner, (ca_county#0 = ca_county#0)
      :     :  :     :- 'Join Inner, (ca_county#0 = ca_county#0)
      :     :  :     :  :- 'Aggregate [ca_county#0, d_qoy#0, d_year#0], [ca_county#0, d_year#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS store_sales#0]
      :     :  :     :  :  +- 'Project [ss_ext_sales_price#0, d_year#0, d_qoy#0, ca_county#0]
      :     :  :     :  :     +- 'Join Inner, (ss_addr_sk#0 = ca_address_sk#0)
      :     :  :     :  :        :- 'Project [ss_addr_sk#0, ss_ext_sales_price#0, d_year#0, d_qoy#0]
      :     :  :     :  :        :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
      :     :  :     :  :        :     :- Project [ss_sold_date_sk#0, ss_addr_sk#0, ss_ext_sales_price#0]
      :     :  :     :  :        :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_addr_sk#0))
      :     :  :     :  :        :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :     :  :     :  :        :     +- Project [d_date_sk#0, d_year#0, d_qoy#0]
      :     :  :     :  :        :        +- Filter ((((isnotnull(d_qoy#0) && isnotnull(d_year#0)) && (d_qoy#0 = 1)) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
      :     :  :     :  :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :     :  :     :  :        +- Project [ca_address_sk#0, ca_county#0]
      :     :  :     :  :           +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_county#0))
      :     :  :     :  :              +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
      :     :  :     :  +- 'Aggregate [ca_county#0, d_qoy#0, d_year#0], [ca_county#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS store_sales#0]
      :     :  :     :     +- 'Project [ss_ext_sales_price#0, d_year#0, d_qoy#0, ca_county#0]
      :     :  :     :        +- 'Join Inner, (ss_addr_sk#0 = ca_address_sk#0)
      :     :  :     :           :- 'Project [ss_addr_sk#0, ss_ext_sales_price#0, d_year#0, d_qoy#0]
      :     :  :     :           :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
      :     :  :     :           :     :- Project [ss_sold_date_sk#0, ss_addr_sk#0, ss_ext_sales_price#0]
      :     :  :     :           :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_addr_sk#0))
      :     :  :     :           :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :     :  :     :           :     +- Project [d_date_sk#0, d_year#0, d_qoy#0]
      :     :  :     :           :        +- Filter ((((isnotnull(d_qoy#0) && isnotnull(d_year#0)) && (d_qoy#0 = 2)) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
      :     :  :     :           :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :     :  :     :           +- Project [ca_address_sk#0, ca_county#0]
      :     :  :     :              +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_county#0))
      :     :  :     :                 +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
      :     :  :     +- 'Aggregate [ca_county#0, d_qoy#0, d_year#0], [ca_county#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS store_sales#0]
      :     :  :        +- 'Project [ss_ext_sales_price#0, d_year#0, d_qoy#0, ca_county#0]
      :     :  :           +- 'Join Inner, (ss_addr_sk#0 = ca_address_sk#0)
      :     :  :              :- 'Project [ss_addr_sk#0, ss_ext_sales_price#0, d_year#0, d_qoy#0]
      :     :  :              :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
      :     :  :              :     :- Project [ss_sold_date_sk#0, ss_addr_sk#0, ss_ext_sales_price#0]
      :     :  :              :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_addr_sk#0))
      :     :  :              :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :     :  :              :     +- Project [d_date_sk#0, d_year#0, d_qoy#0]
      :     :  :              :        +- Filter ((((isnotnull(d_qoy#0) && isnotnull(d_year#0)) && (d_qoy#0 = 3)) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
      :     :  :              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :     :  :              +- Project [ca_address_sk#0, ca_county#0]
      :     :  :                 +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_county#0))
      :     :  :                    +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
      :     :  +- 'Aggregate [ca_county#0, d_qoy#0, d_year#0], [ca_county#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS web_sales#0]
      :     :     +- 'Project [ws_ext_sales_price#0, d_year#0, d_qoy#0, ca_county#0]
      :     :        +- 'Join Inner, (ws_bill_addr_sk#0 = ca_address_sk#0)
      :     :           :- 'Project [ws_bill_addr_sk#0, ws_ext_sales_price#0, d_year#0, d_qoy#0]
      :     :           :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
      :     :           :     :- Project [ws_sold_date_sk#0, ws_bill_addr_sk#0, ws_ext_sales_price#0]
      :     :           :     :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_bill_addr_sk#0))
      :     :           :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
      :     :           :     +- Project [d_date_sk#0, d_year#0, d_qoy#0]
      :     :           :        +- Filter ((((isnotnull(d_qoy#0) && isnotnull(d_year#0)) && (d_qoy#0 = 1)) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
      :     :           :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :     :           +- Project [ca_address_sk#0, ca_county#0]
      :     :              +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_county#0))
      :     :                 +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
      :     +- 'Aggregate [ca_county#0, d_qoy#0, d_year#0], [ca_county#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS web_sales#0]
      :        +- 'Project [ws_ext_sales_price#0, d_year#0, d_qoy#0, ca_county#0]
      :           +- 'Join Inner, (ws_bill_addr_sk#0 = ca_address_sk#0)
      :              :- 'Project [ws_bill_addr_sk#0, ws_ext_sales_price#0, d_year#0, d_qoy#0]
      :              :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
      :              :     :- Project [ws_sold_date_sk#0, ws_bill_addr_sk#0, ws_ext_sales_price#0]
      :              :     :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_bill_addr_sk#0))
      :              :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
      :              :     +- Project [d_date_sk#0, d_year#0, d_qoy#0]
      :              :        +- Filter ((((isnotnull(d_qoy#0) && isnotnull(d_year#0)) && (d_qoy#0 = 2)) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
      :              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :              +- Project [ca_address_sk#0, ca_county#0]
      :                 +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_county#0))
      :                    +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
      +- 'Aggregate [ca_county#0, d_qoy#0, d_year#0], [ca_county#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS web_sales#0]
         +- 'Project [ws_ext_sales_price#0, d_year#0, d_qoy#0, ca_county#0]
            +- 'Join Inner, (ws_bill_addr_sk#0 = ca_address_sk#0)
               :- 'Project [ws_bill_addr_sk#0, ws_ext_sales_price#0, d_year#0, d_qoy#0]
               :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :     :- Project [ws_sold_date_sk#0, ws_bill_addr_sk#0, ws_ext_sales_price#0]
               :     :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_bill_addr_sk#0))
               :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     +- Project [d_date_sk#0, d_year#0, d_qoy#0]
               :        +- Filter ((((isnotnull(d_qoy#0) && isnotnull(d_year#0)) && (d_qoy#0 = 3)) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
               :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               +- Project [ca_address_sk#0, ca_county#0]
                  +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_county#0))
                     +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet


================================================================================================
q32
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Project [1 AS excess discount amount #0]
      +- 'Join Inner, (d_date_sk#0 = cs_sold_date_sk#0)
         :- 'Project [cs_sold_date_sk#0]
         :  +- 'Join Inner, ((cast(cs_ext_discount_amt#0 as decimal(14,7)) > (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(cs_ext_discount_amt) AS DECIMAL(11,6)))#0) && (cs_item_sk#180#0 = i_item_sk#0))
         :     :- 'Project [cs_sold_date_sk#0, cs_ext_discount_amt#0, i_item_sk#0]
         :     :  +- 'Join Inner, (i_item_sk#0 = cs_item_sk#0)
         :     :     :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_ext_discount_amt#0]
         :     :     :  +- Filter ((isnotnull(cs_item_sk#0) && isnotnull(cs_ext_discount_amt#0)) && isnotnull(cs_sold_date_sk#0))
         :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
         :     :     +- Project [i_item_sk#0]
         :     :        +- Filter ((isnotnull(i_manufact_id#0) && (i_manufact_id#0 = 977)) && isnotnull(i_item_sk#0))
         :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :     +- 'Filter isnotnull((CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(cs_ext_discount_amt) AS DECIMAL(11,6)))#0)
         :        +- 'Aggregate [cs_item_sk#0], [CheckOverflow((1.300000 * promote_precision(cast((avg(UnscaledValue(cs_ext_discount_amt#0)) / 100.0) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(cs_ext_discount_amt) AS DECIMAL(11,6)))#0, cs_item_sk#0 AS cs_item_sk#180#0]
         :           +- 'Project [cs_item_sk#0, cs_ext_discount_amt#0]
         :              +- 'Join Inner, (d_date_sk#0 = cs_sold_date_sk#0)
         :                 :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_ext_discount_amt#0]
         :                 :  +- Filter (isnotnull(cs_sold_date_sk#0) && isnotnull(cs_item_sk#0))
         :                 :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
         :                 +- Project [d_date_sk#0]
         :                    +- Filter (((isnotnull(d_date#0) && (cast(d_date#0 as string) >= 2000-01-27])) && (d_date#0 <= 11073)) && isnotnull(d_date_sk#0))
         :                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         +- Project [d_date_sk#0]
            +- Filter (((isnotnull(d_date#0) && (cast(d_date#0 as string) >= 2000-01-27)) && (d_date#0 <= 11073)) && isnotnull(d_date_sk#0))
               +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q33
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [total_sales#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_manufact_id#0], [i_manufact_id#0, sum(total_sales#0) AS total_sales#0]
         +- 'Union
            :- 'Aggregate [i_manufact_id#0], [i_manufact_id#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS total_sales#0]
            :  +- 'Project [ss_ext_sales_price#0, i_manufact_id#0]
            :     +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :        :- 'Project [ss_item_sk#0, ss_ext_sales_price#0]
            :        :  +- 'Join Inner, (ss_addr_sk#0 = ca_address_sk#0)
            :        :     :- 'Project [ss_item_sk#0, ss_addr_sk#0, ss_ext_sales_price#0]
            :        :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :        :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_addr_sk#0, ss_ext_sales_price#0]
            :        :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_addr_sk#0)) && isnotnull(ss_item_sk#0))
            :        :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :        :     :     +- Project [d_date_sk#0]
            :        :     :        +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 1998)) && (d_moy#0 = 5)) && isnotnull(d_date_sk#0))
            :        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :        :     +- Project [ca_address_sk#0]
            :        :        +- Filter ((isnotnull(ca_gmt_offset#0) && (ca_gmt_offset#0 = -5.00)) && isnotnull(ca_address_sk#0))
            :        :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
            :        +- 'Join LeftSemi, (i_manufact_id#0 = i_manufact_id#316#0)
            :           :- Project [i_item_sk#0, i_manufact_id#0]
            :           :  +- Filter isnotnull(i_manufact_id#0)
            :           :     +- Filter isnotnull(i_item_sk#0)
            :           :        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :           +- Project [i_manufact_id#0 AS i_manufact_id#316#0]
            :              +- Filter isnotnull(i_manufact_id#0)
            :                 +- Filter (isnotnull(i_category#0) && (i_category#0 = Electronics))
            :                    +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :- 'Aggregate [i_manufact_id#0], [i_manufact_id#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS total_sales#0]
            :  +- 'Project [cs_ext_sales_price#0, i_manufact_id#0]
            :     +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :        :- 'Project [cs_item_sk#0, cs_ext_sales_price#0]
            :        :  +- 'Join Inner, (cs_bill_addr_sk#0 = ca_address_sk#0)
            :        :     :- 'Project [cs_bill_addr_sk#0, cs_item_sk#0, cs_ext_sales_price#0]
            :        :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :        :     :     :- Project [cs_sold_date_sk#0, cs_bill_addr_sk#0, cs_item_sk#0, cs_ext_sales_price#0]
            :        :     :     :  +- Filter ((isnotnull(cs_sold_date_sk#0) && isnotnull(cs_bill_addr_sk#0)) && isnotnull(cs_item_sk#0))
            :        :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :        :     :     +- Project [d_date_sk#0]
            :        :     :        +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 1998)) && (d_moy#0 = 5)) && isnotnull(d_date_sk#0))
            :        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :        :     +- Project [ca_address_sk#0]
            :        :        +- Filter ((isnotnull(ca_gmt_offset#0) && (ca_gmt_offset#0 = -5.00)) && isnotnull(ca_address_sk#0))
            :        :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
            :        +- 'Join LeftSemi, (i_manufact_id#0 = i_manufact_id#316#0)
            :           :- Project [i_item_sk#0, i_manufact_id#0]
            :           :  +- Filter isnotnull(i_manufact_id#0)
            :           :     +- Filter isnotnull(i_item_sk#0)
            :           :        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :           +- Project [i_manufact_id#0 AS i_manufact_id#316#0]
            :              +- Filter isnotnull(i_manufact_id#0)
            :                 +- Filter (isnotnull(i_category#0) && (i_category#0 = Electronics))
            :                    +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            +- 'Aggregate [i_manufact_id#0], [i_manufact_id#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS total_sales#0]
               +- 'Project [ws_ext_sales_price#0, i_manufact_id#0]
                  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                     :- 'Project [ws_item_sk#0, ws_ext_sales_price#0]
                     :  +- 'Join Inner, (ws_bill_addr_sk#0 = ca_address_sk#0)
                     :     :- 'Project [ws_item_sk#0, ws_bill_addr_sk#0, ws_ext_sales_price#0]
                     :     :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                     :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_bill_addr_sk#0, ws_ext_sales_price#0]
                     :     :     :  +- Filter ((isnotnull(ws_sold_date_sk#0) && isnotnull(ws_bill_addr_sk#0)) && isnotnull(ws_item_sk#0))
                     :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                     :     :     +- Project [d_date_sk#0]
                     :     :        +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 1998)) && (d_moy#0 = 5)) && isnotnull(d_date_sk#0))
                     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :     +- Project [ca_address_sk#0]
                     :        +- Filter ((isnotnull(ca_gmt_offset#0) && (ca_gmt_offset#0 = -5.00)) && isnotnull(ca_address_sk#0))
                     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                     +- 'Join LeftSemi, (i_manufact_id#0 = i_manufact_id#316#0)
                        :- Project [i_item_sk#0, i_manufact_id#0]
                        :  +- Filter isnotnull(i_manufact_id#0)
                        :     +- Filter isnotnull(i_item_sk#0)
                        :        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        +- Project [i_manufact_id#0 AS i_manufact_id#316#0]
                           +- Filter isnotnull(i_manufact_id#0)
                              +- Filter (isnotnull(i_category#0) && (i_category#0 = Electronics))
                                 +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q34
================================================================================================

'Sort [c_last_name#0 ASC NULLS FIRST, c_first_name#0 ASC NULLS FIRST, c_salutation#0 ASC NULLS FIRST, c_preferred_cust_flag#0 DESC NULLS LAST], true
+- 'Project [c_last_name#0, c_first_name#0, c_salutation#0, c_preferred_cust_flag#0, ss_ticket_number#0, cnt#0L]
   +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
      :- 'Filter ((cnt#0L >= 15) && (cnt#0L <= 20))
      :  +- 'Aggregate [ss_ticket_number#0, ss_customer_sk#0], [ss_ticket_number#0, ss_customer_sk#0, count(1) AS cnt#0L]
      :     +- 'Project [ss_customer_sk#0, ss_ticket_number#0]
      :        +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
      :           :- 'Project [ss_customer_sk#0, ss_hdemo_sk#0, ss_ticket_number#0]
      :           :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
      :           :     :- 'Project [ss_customer_sk#0, ss_hdemo_sk#0, ss_store_sk#0, ss_ticket_number#0]
      :           :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
      :           :     :     :- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_hdemo_sk#0, ss_store_sk#0, ss_ticket_number#0]
      :           :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_hdemo_sk#0)) && isnotnull(ss_customer_sk#0))
      :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :           :     :     +- Project [d_date_sk#0]
      :           :     :        +- Filter (((((d_dom#0 >= 1) && (d_dom#0 <= 3)) || ((d_dom#0 >= 25) && (d_dom#0 <= 28))) && d_year#0 IN (1999,2000,2001)) && isnotnull(d_date_sk#0))
      :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :           :     +- Project [s_store_sk#0]
      :           :        +- Filter ((isnotnull(s_county#0) && (s_county#0 = Williamson County)) && isnotnull(s_store_sk#0))
      :           :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
      :           +- Project [hd_demo_sk#0]
      :              +- Filter ((((isnotnull(hd_vehicle_count#0) && ((hd_buy_potential#0 = >10000) || (hd_buy_potential#0 = unknown))) && (hd_vehicle_count#0 > 0)) && (CASE WHEN (hd_vehicle_count#0 > 0) THEN (cast(hd_dep_count#0 as double) / cast(hd_vehicle_count#0 as double)) ELSE null END > 1.2)) && isnotnull(hd_demo_sk#0))
      :                 +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
      +- Project [c_customer_sk#0, c_salutation#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0]
         +- Filter isnotnull(c_customer_sk#0)
            +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet


================================================================================================
q35
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Project [ca_state#0, cd_gender#0, cd_marital_status#0, cnt1#0L, min(cd_dep_count)#0, max(cd_dep_count)#0, avg(cd_dep_count)#0, cd_dep_employed_count#0, cnt2#0L, min(cd_dep_employed_count)#0, max(cd_dep_employed_count)#0, avg(cd_dep_employed_count)#0, cd_dep_college_count#0, cnt3#0L, min(cd_dep_college_count)#0, max(cd_dep_college_count)#0, avg(cd_dep_college_count)#0]
      +- 'Sort [ca_state#0 ASC NULLS FIRST, cd_gender#0 ASC NULLS FIRST, cd_marital_status#0 ASC NULLS FIRST, aggOrder#0 ASC NULLS FIRST, cd_dep_employed_count#0 ASC NULLS FIRST, cd_dep_college_count#0 ASC NULLS FIRST], true
         +- 'Aggregate [ca_state#0, cd_gender#0, cd_marital_status#0, cd_dep_count#0, cd_dep_employed_count#0, cd_dep_college_count#0], [ca_state#0, cd_gender#0, cd_marital_status#0, count(1) AS cnt1#0L, min(cd_dep_count#0) AS min(cd_dep_count)#0, max(cd_dep_count#0) AS max(cd_dep_count)#0, avg(cast(cd_dep_count#0 as bigint)) AS avg(cd_dep_count)#0, cd_dep_employed_count#0, count(1) AS cnt2#0L, min(cd_dep_employed_count#0) AS min(cd_dep_employed_count)#0, max(cd_dep_employed_count#0) AS max(cd_dep_employed_count)#0, avg(cast(cd_dep_employed_count#0 as bigint)) AS avg(cd_dep_employed_count)#0, cd_dep_college_count#0, count(1) AS cnt3#0L, min(cd_dep_college_count#0) AS min(cd_dep_college_count)#0, max(cd_dep_college_count#0) AS max(cd_dep_college_count)#0, avg(cast(cd_dep_college_count#0 as bigint)) AS avg(cd_dep_college_count)#0, cd_dep_count#0 AS aggOrder#0]
            +- 'Project [ca_state#0, cd_gender#0, cd_marital_status#0, cd_dep_count#0, cd_dep_employed_count#0, cd_dep_college_count#0]
               +- 'Join Inner, (cd_demo_sk#0 = c_current_cdemo_sk#0)
                  :- 'Project [c_current_cdemo_sk#0, ca_state#0]
                  :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
                  :     :- 'Project [c_current_cdemo_sk#0, c_current_addr_sk#0]
                  :     :  +- 'Filter (exists#0 || exists#0)
                  :     :     +- 'Join ExistenceJoin(exists#2426), (c_customer_sk#0 = cs_ship_customer_sk#0)
                  :     :        :- 'Join ExistenceJoin(exists#2425), (c_customer_sk#0 = ws_bill_customer_sk#0)
                  :     :        :  :- 'Join LeftSemi, (c_customer_sk#0 = ss_customer_sk#0)
                  :     :        :  :  :- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_addr_sk#0]
                  :     :        :  :  :  +- Filter isnotnull(c_customer_sk#0)
                  :     :        :  :  :     +- Filter (isnotnull(c_current_addr_sk#0) && isnotnull(c_current_cdemo_sk#0))
                  :     :        :  :  :        +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                  :     :        :  :  +- 'Project [ss_customer_sk#0]
                  :     :        :  :     +- 'Filter isnotnull(ss_customer_sk#0)
                  :     :        :  :        +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                  :     :        :  :           :- Project [ss_sold_date_sk#0, ss_customer_sk#0]
                  :     :        :  :           :  +- Filter isnotnull(ss_sold_date_sk#0)
                  :     :        :  :           :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :     :        :  :           +- Project [d_date_sk#0]
                  :     :        :  :              +- Filter ((((isnotnull(d_year#0) && isnotnull(d_qoy#0)) && (d_year#0 = 2002)) && (d_qoy#0 < 4)) && isnotnull(d_date_sk#0))
                  :     :        :  :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     :        :  +- 'Project [ws_bill_customer_sk#0]
                  :     :        :     +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                  :     :        :        :- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0]
                  :     :        :        :  +- Filter isnotnull(ws_sold_date_sk#0)
                  :     :        :        :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                  :     :        :        +- Project [d_date_sk#0]
                  :     :        :           +- Filter ((((isnotnull(d_year#0) && isnotnull(d_qoy#0)) && (d_year#0 = 2002)) && (d_qoy#0 < 4)) && isnotnull(d_date_sk#0))
                  :     :        :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     :        +- 'Project [cs_ship_customer_sk#0]
                  :     :           +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                  :     :              :- Project [cs_sold_date_sk#0, cs_ship_customer_sk#0]
                  :     :              :  +- Filter isnotnull(cs_sold_date_sk#0)
                  :     :              :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                  :     :              +- Project [d_date_sk#0]
                  :     :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_qoy#0)) && (d_year#0 = 2002)) && (d_qoy#0 < 4)) && isnotnull(d_date_sk#0))
                  :     :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     +- Project [ca_address_sk#0, ca_state#0]
                  :        +- Filter isnotnull(ca_address_sk#0)
                  :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                  +- Project [cd_demo_sk#0, cd_gender#0, cd_marital_status#0, cd_dep_count#0, cd_dep_employed_count#0, cd_dep_college_count#0]
                     +- Filter isnotnull(cd_demo_sk#0)
                        +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet


================================================================================================
q36
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [lochierarchy#0 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#0 as int) = 0) THEN i_category#0 END ASC NULLS FIRST, rank_within_parent#0 ASC NULLS FIRST], true
      +- 'Project [gross_margin#0, i_category#0, i_class#0, lochierarchy#0, rank_within_parent#0]
         +- 'Window [rank(_w3#0) windowspecdefinition(_w1#0, _w2#0, _w3#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#0], [_w1#0, _w2#0], [_w3#0 ASC NULLS FIRST]
            +- 'Aggregate [i_category#0, i_class#0, spark_grouping_id#0], [CheckOverflow((promote_precision(MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2)) / promote_precision(MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2))), DecimalType(37,20)) AS gross_margin#0, i_category#0, i_class#0, (cast((shiftright(spark_grouping_id#0, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#0, 0) & 1) as tinyint)) AS lochierarchy#0, (cast((shiftright(spark_grouping_id#0, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#0, 0) & 1) as tinyint)) AS _w1#0, CASE WHEN (cast(cast((shiftright(spark_grouping_id#0, 0) & 1) as tinyint) as int) = 0) THEN i_category#0 END AS _w2#0, CheckOverflow((promote_precision(MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2)) / promote_precision(MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2))), DecimalType(37,20)) AS _w3#0]
               +- 'Expand [List(ss_ext_sales_price#0, ss_net_profit#0, i_category#0, i_class#0, 0), List(ss_ext_sales_price#0, ss_net_profit#0, i_category#0, null, 1), List(ss_ext_sales_price#0, ss_net_profit#0, null, null, 3)], [ss_ext_sales_price#0, ss_net_profit#0, i_category#0, i_class#0, spark_grouping_id#0]
                  +- 'Project [ss_ext_sales_price#0, ss_net_profit#0, i_category#0, i_class#0]
                     +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
                        :- 'Project [ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0, i_class#0, i_category#0]
                        :  +- 'Join Inner, (i_item_sk#0 = ss_item_sk#0)
                        :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
                        :     :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                        :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
                        :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0)) && isnotnull(ss_store_sk#0))
                        :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        :     :     +- Project [d_date_sk#0]
                        :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        :     +- Project [i_item_sk#0, i_class#0, i_category#0]
                        :        +- Filter isnotnull(i_item_sk#0)
                        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        +- Project [s_store_sk#0]
                           +- Filter ((isnotnull(s_state#0) && (s_state#0 = TN)) && isnotnull(s_store_sk#0))
                              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet


================================================================================================
q37
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_item_id#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_item_id#0, i_item_desc#0, i_current_price#0], [i_item_id#0, i_item_desc#0, i_current_price#0]
         +- 'Project [i_item_id#0, i_item_desc#0, i_current_price#0]
            +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
               :- 'Project [i_item_sk#0, i_item_id#0, i_item_desc#0, i_current_price#0]
               :  +- 'Join Inner, (d_date_sk#0 = inv_date_sk#0)
               :     :- 'Project [i_item_sk#0, i_item_id#0, i_item_desc#0, i_current_price#0, inv_date_sk#0]
               :     :  +- 'Join Inner, (inv_item_sk#0 = i_item_sk#0)
               :     :     :- Project [i_item_sk#0, i_item_id#0, i_item_desc#0, i_current_price#0]
               :     :     :  +- Filter ((((isnotnull(i_current_price#0) && (i_current_price#0 >= 68.00)) && (cast(i_current_price#0 as decimal(12,2)) <= 98.00)) && i_manufact_id#0 IN (677,940,694,808)) && isnotnull(i_item_sk#0))
               :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :     :     +- Project [inv_date_sk#0, inv_item_sk#0]
               :     :        +- Filter ((((isnotnull(inv_quantity_on_hand#0) && (inv_quantity_on_hand#0 >= 100)) && (inv_quantity_on_hand#0 <= 500)) && isnotnull(inv_item_sk#0)) && isnotnull(inv_date_sk#0))
               :     :           +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
               :     +- Project [d_date_sk#0]
               :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10988)) && (d_date#0 <= 11048)) && isnotnull(d_date_sk#0))
               :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               +- Project [cs_item_sk#0]
                  +- Filter isnotnull(cs_item_sk#0)
                     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet


================================================================================================
q38
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Aggregate [count(1) AS count(1)#0L]
      +- 'Aggregate [c_last_name#0, c_first_name#0, d_date#0]
         +- 'Join LeftSemi, (((c_last_name#0 <=> c_last_name#0) && (c_first_name#0 <=> c_first_name#0)) && (d_date#0 <=> d_date#0))
            :- 'Aggregate [c_last_name#0, c_first_name#0, d_date#0], [c_last_name#0, c_first_name#0, d_date#0]
            :  +- 'Join LeftSemi, (((c_last_name#0 <=> c_last_name#0) && (c_first_name#0 <=> c_first_name#0)) && (d_date#0 <=> d_date#0))
            :     :- 'Aggregate [c_last_name#0, c_first_name#0, d_date#0], [c_last_name#0, c_first_name#0, d_date#0]
            :     :  +- 'Project [c_last_name#0, c_first_name#0, d_date#0]
            :     :     +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
            :     :        :- 'Project [ss_customer_sk#0, d_date#0]
            :     :        :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :        :     :- Project [ss_sold_date_sk#0, ss_customer_sk#0]
            :     :        :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_customer_sk#0))
            :     :        :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :        :     +- Project [d_date_sk#0, d_date#0]
            :     :        :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
            :     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :        +- Project [c_customer_sk#0, c_first_name#0, c_last_name#0]
            :     :           +- Filter isnotnull(c_customer_sk#0)
            :     :              +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :     +- 'Aggregate [c_last_name#0, c_first_name#0, d_date#0], [c_last_name#0, c_first_name#0, d_date#0]
            :        +- 'Project [c_last_name#0, c_first_name#0, d_date#0]
            :           +- 'Join Inner, (cs_bill_customer_sk#0 = c_customer_sk#0)
            :              :- 'Project [cs_bill_customer_sk#0, d_date#0]
            :              :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :              :     :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0]
            :              :     :  +- Filter (isnotnull(cs_sold_date_sk#0) && isnotnull(cs_bill_customer_sk#0))
            :              :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :              :     +- Project [d_date_sk#0, d_date#0]
            :              :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
            :              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              +- Project [c_customer_sk#0, c_first_name#0, c_last_name#0]
            :                 +- Filter isnotnull(c_customer_sk#0)
            :                    +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            +- 'Aggregate [c_last_name#0, c_first_name#0, d_date#0], [c_last_name#0, c_first_name#0, d_date#0]
               +- 'Project [c_last_name#0, c_first_name#0, d_date#0]
                  +- 'Join Inner, (ws_bill_customer_sk#0 = c_customer_sk#0)
                     :- 'Project [ws_bill_customer_sk#0, d_date#0]
                     :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                     :     :- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0]
                     :     :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_bill_customer_sk#0))
                     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                     :     +- Project [d_date_sk#0, d_date#0]
                     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
                     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     +- Project [c_customer_sk#0, c_first_name#0, c_last_name#0]
                        +- Filter isnotnull(c_customer_sk#0)
                           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet


================================================================================================
q39a
================================================================================================

'Sort [w_warehouse_sk#0 ASC NULLS FIRST, i_item_sk#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, mean#0 ASC NULLS FIRST, cov#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, mean#0 ASC NULLS FIRST, cov#0 ASC NULLS FIRST], true
+- 'Join Inner, ((i_item_sk#0 = i_item_sk#0) && (w_warehouse_sk#0 = w_warehouse_sk#0))
   :- 'Project [w_warehouse_sk#0, i_item_sk#0, d_moy#0, mean#0, CASE WHEN (mean#0 = 0.0) THEN null ELSE (stdev#0 / mean#0) END AS cov#0]
   :  +- 'Filter (CASE WHEN (mean#0 = 0.0) THEN 0.0 ELSE (stdev#0 / mean#0) END > 1.0)
   :     +- 'Aggregate [w_warehouse_name#0, w_warehouse_sk#0, i_item_sk#0, d_moy#0], [w_warehouse_sk#0, i_item_sk#0, d_moy#0, stddev_samp(cast(inv_quantity_on_hand#0 as double)) AS stdev#0, avg(cast(inv_quantity_on_hand#0 as bigint)) AS mean#0]
   :        +- 'Project [inv_quantity_on_hand#0, i_item_sk#0, w_warehouse_sk#0, w_warehouse_name#0, d_moy#0]
   :           +- 'Join Inner, (inv_date_sk#0 = d_date_sk#0)
   :              :- 'Project [inv_date_sk#0, inv_quantity_on_hand#0, i_item_sk#0, w_warehouse_sk#0, w_warehouse_name#0]
   :              :  +- 'Join Inner, (inv_warehouse_sk#0 = w_warehouse_sk#0)
   :              :     :- 'Project [inv_date_sk#0, inv_warehouse_sk#0, inv_quantity_on_hand#0, i_item_sk#0]
   :              :     :  +- 'Join Inner, (inv_item_sk#0 = i_item_sk#0)
   :              :     :     :- Filter ((isnotnull(inv_item_sk#0) && isnotnull(inv_warehouse_sk#0)) && isnotnull(inv_date_sk#0))
   :              :     :     :  +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
   :              :     :     +- Project [i_item_sk#0]
   :              :     :        +- Filter isnotnull(i_item_sk#0)
   :              :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
   :              :     +- Project [w_warehouse_sk#0, w_warehouse_name#0]
   :              :        +- Filter isnotnull(w_warehouse_sk#0)
   :              :           +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
   :              +- Project [d_date_sk#0, d_moy#0]
   :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 1)) && isnotnull(d_date_sk#0))
   :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
   +- 'Project [w_warehouse_sk#0, i_item_sk#0, d_moy#0, mean#0, CASE WHEN (mean#0 = 0.0) THEN null ELSE (stdev#0 / mean#0) END AS cov#0]
      +- 'Filter (CASE WHEN (mean#0 = 0.0) THEN 0.0 ELSE (stdev#0 / mean#0) END > 1.0)
         +- 'Aggregate [w_warehouse_name#0, w_warehouse_sk#0, i_item_sk#0, d_moy#0], [w_warehouse_sk#0, i_item_sk#0, d_moy#0, stddev_samp(cast(inv_quantity_on_hand#0 as double)) AS stdev#0, avg(cast(inv_quantity_on_hand#0 as bigint)) AS mean#0]
            +- 'Project [inv_quantity_on_hand#0, i_item_sk#0, w_warehouse_sk#0, w_warehouse_name#0, d_moy#0]
               +- 'Join Inner, (inv_date_sk#0 = d_date_sk#0)
                  :- 'Project [inv_date_sk#0, inv_quantity_on_hand#0, i_item_sk#0, w_warehouse_sk#0, w_warehouse_name#0]
                  :  +- 'Join Inner, (inv_warehouse_sk#0 = w_warehouse_sk#0)
                  :     :- 'Project [inv_date_sk#0, inv_warehouse_sk#0, inv_quantity_on_hand#0, i_item_sk#0]
                  :     :  +- 'Join Inner, (inv_item_sk#0 = i_item_sk#0)
                  :     :     :- Filter ((isnotnull(inv_item_sk#0) && isnotnull(inv_warehouse_sk#0)) && isnotnull(inv_date_sk#0))
                  :     :     :  +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
                  :     :     +- Project [i_item_sk#0]
                  :     :        +- Filter isnotnull(i_item_sk#0)
                  :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  :     +- Project [w_warehouse_sk#0, w_warehouse_name#0]
                  :        +- Filter isnotnull(w_warehouse_sk#0)
                  :           +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
                  +- Project [d_date_sk#0, d_moy#0]
                     +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 2)) && isnotnull(d_date_sk#0))
                        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q39b
================================================================================================

'Sort [w_warehouse_sk#0 ASC NULLS FIRST, i_item_sk#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, mean#0 ASC NULLS FIRST, cov#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, mean#0 ASC NULLS FIRST, cov#0 ASC NULLS FIRST], true
+- 'Join Inner, ((i_item_sk#0 = i_item_sk#0) && (w_warehouse_sk#0 = w_warehouse_sk#0))
   :- 'Project [w_warehouse_sk#0, i_item_sk#0, d_moy#0, mean#0, CASE WHEN (mean#0 = 0.0) THEN null ELSE (stdev#0 / mean#0) END AS cov#0]
   :  +- 'Filter ((CASE WHEN (mean#0 = 0.0) THEN 0.0 ELSE (stdev#0 / mean#0) END > 1.0) && (CASE WHEN (mean#0 = 0.0) THEN null ELSE (stdev#0 / mean#0) END > 1.5))
   :     +- 'Aggregate [w_warehouse_name#0, w_warehouse_sk#0, i_item_sk#0, d_moy#0], [w_warehouse_sk#0, i_item_sk#0, d_moy#0, stddev_samp(cast(inv_quantity_on_hand#0 as double)) AS stdev#0, avg(cast(inv_quantity_on_hand#0 as bigint)) AS mean#0]
   :        +- 'Project [inv_quantity_on_hand#0, i_item_sk#0, w_warehouse_sk#0, w_warehouse_name#0, d_moy#0]
   :           +- 'Join Inner, (inv_date_sk#0 = d_date_sk#0)
   :              :- 'Project [inv_date_sk#0, inv_quantity_on_hand#0, i_item_sk#0, w_warehouse_sk#0, w_warehouse_name#0]
   :              :  +- 'Join Inner, (inv_warehouse_sk#0 = w_warehouse_sk#0)
   :              :     :- 'Project [inv_date_sk#0, inv_warehouse_sk#0, inv_quantity_on_hand#0, i_item_sk#0]
   :              :     :  +- 'Join Inner, (inv_item_sk#0 = i_item_sk#0)
   :              :     :     :- Filter ((isnotnull(inv_item_sk#0) && isnotnull(inv_warehouse_sk#0)) && isnotnull(inv_date_sk#0))
   :              :     :     :  +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
   :              :     :     +- Project [i_item_sk#0]
   :              :     :        +- Filter isnotnull(i_item_sk#0)
   :              :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
   :              :     +- Project [w_warehouse_sk#0, w_warehouse_name#0]
   :              :        +- Filter isnotnull(w_warehouse_sk#0)
   :              :           +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
   :              +- Project [d_date_sk#0, d_moy#0]
   :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 1)) && isnotnull(d_date_sk#0))
   :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
   +- 'Project [w_warehouse_sk#0, i_item_sk#0, d_moy#0, mean#0, CASE WHEN (mean#0 = 0.0) THEN null ELSE (stdev#0 / mean#0) END AS cov#0]
      +- 'Filter (CASE WHEN (mean#0 = 0.0) THEN 0.0 ELSE (stdev#0 / mean#0) END > 1.0)
         +- 'Aggregate [w_warehouse_name#0, w_warehouse_sk#0, i_item_sk#0, d_moy#0], [w_warehouse_sk#0, i_item_sk#0, d_moy#0, stddev_samp(cast(inv_quantity_on_hand#0 as double)) AS stdev#0, avg(cast(inv_quantity_on_hand#0 as bigint)) AS mean#0]
            +- 'Project [inv_quantity_on_hand#0, i_item_sk#0, w_warehouse_sk#0, w_warehouse_name#0, d_moy#0]
               +- 'Join Inner, (inv_date_sk#0 = d_date_sk#0)
                  :- 'Project [inv_date_sk#0, inv_quantity_on_hand#0, i_item_sk#0, w_warehouse_sk#0, w_warehouse_name#0]
                  :  +- 'Join Inner, (inv_warehouse_sk#0 = w_warehouse_sk#0)
                  :     :- 'Project [inv_date_sk#0, inv_warehouse_sk#0, inv_quantity_on_hand#0, i_item_sk#0]
                  :     :  +- 'Join Inner, (inv_item_sk#0 = i_item_sk#0)
                  :     :     :- Filter ((isnotnull(inv_item_sk#0) && isnotnull(inv_warehouse_sk#0)) && isnotnull(inv_date_sk#0))
                  :     :     :  +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
                  :     :     +- Project [i_item_sk#0]
                  :     :        +- Filter isnotnull(i_item_sk#0)
                  :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  :     +- Project [w_warehouse_sk#0, w_warehouse_name#0]
                  :        +- Filter isnotnull(w_warehouse_sk#0)
                  :           +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
                  +- Project [d_date_sk#0, d_moy#0]
                     +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 2)) && isnotnull(d_date_sk#0))
                        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q40
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [w_state#0 ASC NULLS FIRST, i_item_id#0 ASC NULLS FIRST], true
      +- 'Aggregate [w_state#0, i_item_id#0], [w_state#0, i_item_id#0, sum(CASE WHEN (d_date#0 < 11027) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2)) ELSE 0.00 END) AS sales_before#0, sum(CASE WHEN (d_date#0 >= 11027) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2)) ELSE 0.00 END) AS sales_after#0]
         +- 'Project [cs_sales_price#0, cr_refunded_cash#0, w_state#0, i_item_id#0, d_date#0]
            +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :- 'Project [cs_sold_date_sk#0, cs_sales_price#0, cr_refunded_cash#0, w_state#0, i_item_id#0]
               :  +- 'Join Inner, (i_item_sk#0 = cs_item_sk#0)
               :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_sales_price#0, cr_refunded_cash#0, w_state#0]
               :     :  +- 'Join Inner, (cs_warehouse_sk#0 = w_warehouse_sk#0)
               :     :     :- 'Project [cs_sold_date_sk#0, cs_warehouse_sk#0, cs_item_sk#0, cs_sales_price#0, cr_refunded_cash#0]
               :     :     :  +- 'Join LeftOuter, ((cs_order_number#0 = cr_order_number#0) && (cs_item_sk#0 = cr_item_sk#0))
               :     :     :     :- Project [cs_sold_date_sk#0, cs_warehouse_sk#0, cs_item_sk#0, cs_order_number#0, cs_sales_price#0]
               :     :     :     :  +- Filter ((isnotnull(cs_warehouse_sk#0) && isnotnull(cs_item_sk#0)) && isnotnull(cs_sold_date_sk#0))
               :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :     :     +- Project [cr_item_sk#0, cr_order_number#0, cr_refunded_cash#0]
               :     :     :        +- Filter (isnotnull(cr_order_number#0) && isnotnull(cr_item_sk#0))
               :     :     :           +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
               :     :     +- Project [w_warehouse_sk#0, w_state#0]
               :     :        +- Filter isnotnull(w_warehouse_sk#0)
               :     :           +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
               :     +- Project [i_item_sk#0, i_item_id#0]
               :        +- Filter (((isnotnull(i_current_price#0) && (i_current_price#0 >= 0.99)) && (i_current_price#0 <= 1.49)) && isnotnull(i_item_sk#0))
               :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               +- Project [d_date_sk#0, d_date#0]
                  +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10997)) && (d_date#0 <= 11057)) && isnotnull(d_date_sk#0))
                     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q41
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_product_name#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_product_name#0], [i_product_name#0]
         +- 'Project [i_product_name#0]
            +- 'Join Inner, (i_manufact#317#0 = i_manufact#0)
               :- Project [i_manufact#0, i_product_name#0]
               :  +- Filter (((isnotnull(i_manufact_id#0) && (i_manufact_id#0 >= 738)) && (i_manufact_id#0 <= 778)) && isnotnull(i_manufact#0))
               :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               +- Project [i_manufact#317#0]
                  +- Filter (if (isnull(alwaysTrue#0)) 0 else item_cnt#0L > 0)
                     +- Aggregate [i_manufact#0], [count(1) AS item_cnt#0L, i_manufact#0 AS i_manufact#317#0, true AS alwaysTrue#0]
                        +- Project [i_manufact#0]
                           +- Filter (((((i_category#0 = Women) && (((((i_color#0 = powder) || (i_color#0 = khaki)) && ((i_units#0 = Ounce) || (i_units#0 = Oz))) && ((i_size#0 = medium) || (i_size#0 = extra large))) || ((((i_color#0 = brown) || (i_color#0 = honeydew)) && ((i_units#0 = Bunch) || (i_units#0 = Ton))) && ((i_size#0 = N/A) || (i_size#0 = small))))) || ((i_category#0 = Men) && (((((i_color#0 = floral) || (i_color#0 = deep)) && ((i_units#0 = N/A) || (i_units#0 = Dozen))) && ((i_size#0 = petite) || (i_size#0 = large))) || ((((i_color#0 = light) || (i_color#0 = cornflower)) && ((i_units#0 = Box) || (i_units#0 = Pound))) && ((i_size#0 = medium) || (i_size#0 = extra large)))))) || (((i_category#0 = Women) && (((((i_color#0 = midnight) || (i_color#0 = snow)) && ((i_units#0 = Pallet) || (i_units#0 = Gross))) && ((i_size#0 = medium) || (i_size#0 = extra large))) || ((((i_color#0 = cyan) || (i_color#0 = papaya)) && ((i_units#0 = Cup) || (i_units#0 = Dram))) && ((i_size#0 = N/A) || (i_size#0 = small))))) || ((i_category#0 = Men) && (((((i_color#0 = orange) || (i_color#0 = frosted)) && ((i_units#0 = Each) || (i_units#0 = Tbl))) && ((i_size#0 = petite) || (i_size#0 = large))) || ((((i_color#0 = forest) || (i_color#0 = ghost)) && ((i_units#0 = Lb) || (i_units#0 = Bundle))) && ((i_size#0 = medium) || (i_size#0 = extra large))))))) && isnotnull(i_manufact#0))
                              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q42
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [sum(ss_ext_sales_price)#0 DESC NULLS LAST, d_year#0 ASC NULLS FIRST, i_category_id#0 ASC NULLS FIRST, i_category#0 ASC NULLS FIRST], true
      +- 'Aggregate [d_year#0, i_category_id#0, i_category#0], [d_year#0, i_category_id#0, i_category#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS sum(ss_ext_sales_price)#0]
         +- 'Project [d_year#0, ss_ext_sales_price#0, i_category_id#0, i_category#0]
            +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :- 'Project [d_year#0, ss_item_sk#0, ss_ext_sales_price#0]
               :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
               :     :- Project [d_date_sk#0, d_year#0]
               :     :  +- Filter ((((isnotnull(d_moy#0) && isnotnull(d_year#0)) && (d_moy#0 = 11)) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
               :     :     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ext_sales_price#0]
               :        +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0))
               :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               +- Project [i_item_sk#0, i_category_id#0, i_category#0]
                  +- Filter ((isnotnull(i_manager_id#0) && (i_manager_id#0 = 1)) && isnotnull(i_item_sk#0))
                     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q43
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [s_store_name#0 ASC NULLS FIRST, s_store_id#0 ASC NULLS FIRST, sun_sales#0 ASC NULLS FIRST, mon_sales#0 ASC NULLS FIRST, tue_sales#0 ASC NULLS FIRST, wed_sales#0 ASC NULLS FIRST, thu_sales#0 ASC NULLS FIRST, fri_sales#0 ASC NULLS FIRST, sat_sales#0 ASC NULLS FIRST], true
      +- 'Aggregate [s_store_name#0, s_store_id#0], [s_store_name#0, s_store_id#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Sunday) THEN ss_sales_price#0 ELSE null END)),17,2) AS sun_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Monday) THEN ss_sales_price#0 ELSE null END)),17,2) AS mon_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Tuesday) THEN ss_sales_price#0 ELSE null END)),17,2) AS tue_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Wednesday) THEN ss_sales_price#0 ELSE null END)),17,2) AS wed_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Thursday) THEN ss_sales_price#0 ELSE null END)),17,2) AS thu_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Friday) THEN ss_sales_price#0 ELSE null END)),17,2) AS fri_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Saturday) THEN ss_sales_price#0 ELSE null END)),17,2) AS sat_sales#0]
         +- 'Project [d_day_name#0, ss_sales_price#0, s_store_id#0, s_store_name#0]
            +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
               :- 'Project [d_day_name#0, ss_store_sk#0, ss_sales_price#0]
               :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
               :     :- Project [d_date_sk#0, d_day_name#0]
               :     :  +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
               :     :     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_sales_price#0]
               :        +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0))
               :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               +- Project [s_store_sk#0, s_store_id#0, s_store_name#0]
                  +- Filter ((isnotnull(s_gmt_offset#0) && (s_gmt_offset#0 = -5.00)) && isnotnull(s_store_sk#0))
                     +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet


================================================================================================
q44
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [rnk#0 ASC NULLS FIRST], true
      +- 'Project [rnk#0, i_product_name#0 AS best_performing#0, i_product_name#0 AS worst_performing#0]
         +- 'Join Inner, (i_item_sk#0 = item_sk#0)
            :- 'Project [rnk#0, item_sk#0, i_product_name#0]
            :  +- 'Join Inner, (i_item_sk#0 = item_sk#0)
            :     :- 'Project [item_sk#0, rnk#0, item_sk#0]
            :     :  +- 'Join Inner, (rnk#0 = rnk#0)
            :     :     :- Project [item_sk#0, rnk#0]
            :     :     :  +- Filter ((isnotnull(rnk#0) && (rnk#0 < 11)) && isnotnull(item_sk#0))
            :     :     :     +- Window [rank(rank_col#0) windowspecdefinition(rank_col#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#0], [rank_col#0 ASC NULLS FIRST]
            :     :     :        +- Project [item_sk#0, rank_col#0]
            :     :     :           +- Filter (isnotnull(avg(ss_net_profit#302)#0) && (cast(avg(ss_net_profit#302)#0 as decimal(13,7)) > CheckOverflow((0.900000 * promote_precision(scalar-subquery#0 [])), DecimalType(13,7))))
            :     :     :              :  +- Aggregate [ss_store_sk#287], [cast((avg(UnscaledValue(ss_net_profit#302)) / 100.0) as decimal(11,6)) AS rank_col#3312]
            :     :     :              :     +- Project [ss_store_sk#287, ss_net_profit#302]
            :     :     :              :        +- Filter ((isnotnull(ss_store_sk#287) && (ss_store_sk#287 = 4)) && isnull(ss_addr_sk#286))
            :     :     :              :           +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :     :     :              +- Aggregate [ss_item_sk#0], [ss_item_sk#0 AS item_sk#0, cast((avg(UnscaledValue(ss_net_profit#0)) / 100.0) as decimal(11,6)) AS rank_col#0, cast((avg(UnscaledValue(ss_net_profit#0)) / 100.0) as decimal(11,6)) AS avg(ss_net_profit#302)#0]
            :     :     :                 +- Project [ss_item_sk#0, ss_net_profit#0]
            :     :     :                    +- Filter (isnotnull(ss_store_sk#0) && (ss_store_sk#0 = 4))
            :     :     :                       +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     +- Project [item_sk#0, rnk#0]
            :     :        +- Filter ((isnotnull(rnk#0) && (rnk#0 < 11)) && isnotnull(item_sk#0))
            :     :           +- Window [rank(rank_col#0) windowspecdefinition(rank_col#0 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#0], [rank_col#0 DESC NULLS LAST]
            :     :              +- Project [item_sk#0, rank_col#0]
            :     :                 +- Filter (isnotnull(avg(ss_net_profit#302)#0) && (cast(avg(ss_net_profit#302)#0 as decimal(13,7)) > CheckOverflow((0.900000 * promote_precision(scalar-subquery#0 [])), DecimalType(13,7))))
            :     :                    :  +- Aggregate [ss_store_sk#287], [cast((avg(UnscaledValue(ss_net_profit#302)) / 100.0) as decimal(11,6)) AS rank_col#3317]
            :     :                    :     +- Project [ss_store_sk#287, ss_net_profit#302]
            :     :                    :        +- Filter ((isnotnull(ss_store_sk#287) && (ss_store_sk#287 = 4)) && isnull(ss_addr_sk#286))
            :     :                    :           +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :     :                    +- Aggregate [ss_item_sk#0], [ss_item_sk#0 AS item_sk#0, cast((avg(UnscaledValue(ss_net_profit#0)) / 100.0) as decimal(11,6)) AS rank_col#0, cast((avg(UnscaledValue(ss_net_profit#0)) / 100.0) as decimal(11,6)) AS avg(ss_net_profit#302)#0]
            :     :                       +- Project [ss_item_sk#0, ss_net_profit#0]
            :     :                          +- Filter (isnotnull(ss_store_sk#0) && (ss_store_sk#0 = 4))
            :     :                             +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     +- Project [i_item_sk#0, i_product_name#0]
            :        +- Filter isnotnull(i_item_sk#0)
            :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            +- Project [i_item_sk#0, i_product_name#0]
               +- Filter isnotnull(i_item_sk#0)
                  +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q45
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [ca_zip#0 ASC NULLS FIRST, ca_city#0 ASC NULLS FIRST], true
      +- 'Aggregate [ca_zip#0, ca_city#0], [ca_zip#0, ca_city#0, MakeDecimal(sum(UnscaledValue(ws_sales_price#0)),17,2) AS sum(ws_sales_price)#0]
         +- 'Project [ws_sales_price#0, ca_city#0, ca_zip#0]
            +- 'Filter (substring(ca_zip#0, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || exists#0)
               +- 'Join ExistenceJoin(exists#3400), (i_item_id#0 = i_item_id#304#0)
                  :- 'Project [ws_sales_price#0, ca_city#0, ca_zip#0, i_item_id#0]
                  :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                  :     :- 'Project [ws_item_sk#0, ws_sales_price#0, ca_city#0, ca_zip#0]
                  :     :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                  :     :     :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_sales_price#0, ca_city#0, ca_zip#0]
                  :     :     :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
                  :     :     :     :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_sales_price#0, c_current_addr_sk#0]
                  :     :     :     :  +- 'Join Inner, (ws_bill_customer_sk#0 = c_customer_sk#0)
                  :     :     :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_bill_customer_sk#0, ws_sales_price#0]
                  :     :     :     :     :  +- Filter ((isnotnull(ws_bill_customer_sk#0) && isnotnull(ws_sold_date_sk#0)) && isnotnull(ws_item_sk#0))
                  :     :     :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                  :     :     :     :     +- Project [c_customer_sk#0, c_current_addr_sk#0]
                  :     :     :     :        +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_current_addr_sk#0))
                  :     :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                  :     :     :     +- Project [ca_address_sk#0, ca_city#0, ca_zip#0]
                  :     :     :        +- Filter isnotnull(ca_address_sk#0)
                  :     :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                  :     :     +- Project [d_date_sk#0]
                  :     :        +- Filter ((((isnotnull(d_qoy#0) && isnotnull(d_year#0)) && (d_qoy#0 = 2)) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                  :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     +- Project [i_item_sk#0, i_item_id#0]
                  :        +- Filter isnotnull(i_item_sk#0)
                  :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  +- Project [i_item_id#0 AS i_item_id#304#0]
                     +- Filter i_item_sk#0 IN (2,3,5,7,11,13,17,19,23,29)
                        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q46
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [c_last_name#0 ASC NULLS FIRST, c_first_name#0 ASC NULLS FIRST, ca_city#0 ASC NULLS FIRST, bought_city#0 ASC NULLS FIRST, ss_ticket_number#0 ASC NULLS FIRST], true
      +- 'Project [c_last_name#0, c_first_name#0, ca_city#0, bought_city#0, ss_ticket_number#0, amt#0, profit#0]
         +- 'Join Inner, ((c_current_addr_sk#0 = ca_address_sk#0) && NOT (ca_city#0 = bought_city#0))
            :- 'Project [ss_ticket_number#0, bought_city#0, amt#0, profit#0, c_current_addr_sk#0, c_first_name#0, c_last_name#0]
            :  +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
            :     :- 'Aggregate [ss_ticket_number#0, ss_customer_sk#0, ss_addr_sk#0, ca_city#0], [ss_ticket_number#0, ss_customer_sk#0, ca_city#0 AS bought_city#0, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#0)),17,2) AS amt#0, MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS profit#0]
            :     :  +- 'Project [ss_customer_sk#0, ss_addr_sk#0, ss_ticket_number#0, ss_coupon_amt#0, ss_net_profit#0, ca_city#0]
            :     :     +- 'Join Inner, (ss_addr_sk#0 = ca_address_sk#0)
            :     :        :- 'Project [ss_customer_sk#0, ss_addr_sk#0, ss_ticket_number#0, ss_coupon_amt#0, ss_net_profit#0]
            :     :        :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
            :     :        :     :- 'Project [ss_customer_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_ticket_number#0, ss_coupon_amt#0, ss_net_profit#0]
            :     :        :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
            :     :        :     :     :- 'Project [ss_customer_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_ticket_number#0, ss_coupon_amt#0, ss_net_profit#0]
            :     :        :     :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :        :     :     :     :- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_ticket_number#0, ss_coupon_amt#0, ss_net_profit#0]
            :     :        :     :     :     :  +- Filter ((((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_hdemo_sk#0)) && isnotnull(ss_addr_sk#0)) && isnotnull(ss_customer_sk#0))
            :     :        :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :        :     :     :     +- Project [d_date_sk#0]
            :     :        :     :     :        +- Filter ((d_dow#0 IN (6,0) && d_year#0 IN (1999,2000,2001)) && isnotnull(d_date_sk#0))
            :     :        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :        :     :     +- Project [s_store_sk#0]
            :     :        :     :        +- Filter (s_city#0 IN (Fairview,Midway) && isnotnull(s_store_sk#0))
            :     :        :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :     :        :     +- Project [hd_demo_sk#0]
            :     :        :        +- Filter (((hd_dep_count#0 = 4) || (hd_vehicle_count#0 = 3)) && isnotnull(hd_demo_sk#0))
            :     :        :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
            :     :        +- Project [ca_address_sk#0, ca_city#0]
            :     :           +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_city#0))
            :     :              +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
            :     +- Project [c_customer_sk#0, c_current_addr_sk#0, c_first_name#0, c_last_name#0]
            :        +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_current_addr_sk#0))
            :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            +- Project [ca_address_sk#0, ca_city#0]
               +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_city#0))
                  +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet


================================================================================================
q47
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [CheckOverflow((promote_precision(cast(sum_sales#0 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#0 ASC NULLS FIRST], true
      +- 'Project [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0, avg_monthly_sales#0, sum_sales#0, sum_sales#0 AS psum#0, sum_sales#0 AS nsum#0]
         +- 'Join Inner, (((((i_category#0 = i_category#0) && (i_brand#0 = i_brand#0)) && (s_store_name#0 = s_store_name#0)) && (s_company_name#0 = s_company_name#0)) && (rn#0 = (rn#0 - 1)))
            :- 'Project [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0, sum_sales#0, avg_monthly_sales#0, rn#0, sum_sales#0]
            :  +- 'Join Inner, (((((i_category#0 = i_category#0) && (i_brand#0 = i_brand#0)) && (s_store_name#0 = s_store_name#0)) && (s_company_name#0 = s_company_name#0)) && (rn#0 = (rn#0 + 1)))
            :     :- 'Project [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0, sum_sales#0, avg_monthly_sales#0, rn#0]
            :     :  +- 'Filter (((isnotnull(avg_monthly_sales#0) && (avg_monthly_sales#0 > 0.000000)) && (CASE WHEN (avg_monthly_sales#0 > 0.000000) THEN CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#0 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(22,6)))) / promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(38,16)) ELSE null END > 0.1000000000000000)) && isnotnull(rn#0))
            :     :     +- 'Window [avg(_w0#0) windowspecdefinition(i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0]
            :     :        +- 'Filter (isnotnull(d_year#0) && (d_year#0 = 1999))
            :     :           +- 'Window [rank(d_year#0, d_moy#0) windowspecdefinition(i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0], [d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST]
            :     :              +- 'Aggregate [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS sum_sales#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS _w0#0]
            :     :                 +- 'Project [i_brand#0, i_category#0, ss_sales_price#0, d_year#0, d_moy#0, s_store_name#0, s_company_name#0]
            :     :                    +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
            :     :                       :- 'Project [i_brand#0, i_category#0, ss_store_sk#0, ss_sales_price#0, d_year#0, d_moy#0]
            :     :                       :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :                       :     :- 'Project [i_brand#0, i_category#0, ss_sold_date_sk#0, ss_store_sk#0, ss_sales_price#0]
            :     :                       :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :                       :     :     :- Project [i_item_sk#0, i_brand#0, i_category#0]
            :     :                       :     :     :  +- Filter ((isnotnull(i_item_sk#0) && isnotnull(i_category#0)) && isnotnull(i_brand#0))
            :     :                       :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :                       :     :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_sales_price#0]
            :     :                       :     :        +- Filter ((isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0))
            :     :                       :     :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :                       :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
            :     :                       :        +- Filter ((((d_year#0 = 1999) || ((d_year#0 = 1998) && (d_moy#0 = 12))) || ((d_year#0 = 2000) && (d_moy#0 = 1))) && isnotnull(d_date_sk#0))
            :     :                       :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                       +- Project [s_store_sk#0, s_store_name#0, s_company_name#0]
            :     :                          +- Filter ((isnotnull(s_store_sk#0) && isnotnull(s_company_name#0)) && isnotnull(s_store_name#0))
            :     :                             +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :     +- 'Project [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, sum_sales#0, rn#0]
            :        +- 'Filter isnotnull(rn#0)
            :           +- 'Window [rank(d_year#0, d_moy#0) windowspecdefinition(i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0], [d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST]
            :              +- 'Aggregate [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS sum_sales#0]
            :                 +- 'Project [i_brand#0, i_category#0, ss_sales_price#0, d_year#0, d_moy#0, s_store_name#0, s_company_name#0]
            :                    +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
            :                       :- 'Project [i_brand#0, i_category#0, ss_store_sk#0, ss_sales_price#0, d_year#0, d_moy#0]
            :                       :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :                       :     :- 'Project [i_brand#0, i_category#0, ss_sold_date_sk#0, ss_store_sk#0, ss_sales_price#0]
            :                       :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :                       :     :     :- Project [i_item_sk#0, i_brand#0, i_category#0]
            :                       :     :     :  +- Filter ((isnotnull(i_item_sk#0) && isnotnull(i_brand#0)) && isnotnull(i_category#0))
            :                       :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                       :     :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_sales_price#0]
            :                       :     :        +- Filter ((isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0))
            :                       :     :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :                       :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
            :                       :        +- Filter ((((d_year#0 = 1999) || ((d_year#0 = 1998) && (d_moy#0 = 12))) || ((d_year#0 = 2000) && (d_moy#0 = 1))) && isnotnull(d_date_sk#0))
            :                       :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                       +- Project [s_store_sk#0, s_store_name#0, s_company_name#0]
            :                          +- Filter ((isnotnull(s_store_sk#0) && isnotnull(s_company_name#0)) && isnotnull(s_store_name#0))
            :                             +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            +- 'Project [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, sum_sales#0, rn#0]
               +- 'Filter isnotnull(rn#0)
                  +- 'Window [rank(d_year#0, d_moy#0) windowspecdefinition(i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0], [d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST]
                     +- 'Aggregate [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS sum_sales#0]
                        +- 'Project [i_brand#0, i_category#0, ss_sales_price#0, d_year#0, d_moy#0, s_store_name#0, s_company_name#0]
                           +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                              :- 'Project [i_brand#0, i_category#0, ss_store_sk#0, ss_sales_price#0, d_year#0, d_moy#0]
                              :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                              :     :- 'Project [i_brand#0, i_category#0, ss_sold_date_sk#0, ss_store_sk#0, ss_sales_price#0]
                              :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                              :     :     :- Project [i_item_sk#0, i_brand#0, i_category#0]
                              :     :     :  +- Filter ((isnotnull(i_item_sk#0) && isnotnull(i_category#0)) && isnotnull(i_brand#0))
                              :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              :     :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_sales_price#0]
                              :     :        +- Filter ((isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0))
                              :     :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                              :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
                              :        +- Filter ((((d_year#0 = 1999) || ((d_year#0 = 1998) && (d_moy#0 = 12))) || ((d_year#0 = 2000) && (d_moy#0 = 1))) && isnotnull(d_date_sk#0))
                              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              +- Project [s_store_sk#0, s_store_name#0, s_company_name#0]
                                 +- Filter ((isnotnull(s_store_sk#0) && isnotnull(s_company_name#0)) && isnotnull(s_store_name#0))
                                    +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet


================================================================================================
q48
================================================================================================

'Aggregate [sum(cast(ss_quantity#0 as bigint)) AS sum(ss_quantity)#0L]
+- 'Project [ss_quantity#0]
   +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
      :- 'Project [ss_sold_date_sk#0, ss_quantity#0]
      :  +- 'Join Inner, ((ss_addr_sk#0 = ca_address_sk#0) && ((((ca_state#0 IN (CO,OH,TX) && (ss_net_profit#0 >= 0.00)) && (ss_net_profit#0 <= 2000.00)) || ((ca_state#0 IN (OR,MN,KY) && (ss_net_profit#0 >= 150.00)) && (ss_net_profit#0 <= 3000.00))) || ((ca_state#0 IN (VA,CA,MS) && (ss_net_profit#0 >= 50.00)) && (ss_net_profit#0 <= 25000.00))))
      :     :- 'Project [ss_sold_date_sk#0, ss_addr_sk#0, ss_quantity#0, ss_net_profit#0]
      :     :  +- 'Join Inner, ((cd_demo_sk#0 = ss_cdemo_sk#0) && ((((((cd_marital_status#0 = M) && (cd_education_status#0 = 4 yr Degree)) && (ss_sales_price#0 >= 100.00)) && (ss_sales_price#0 <= 150.00)) || ((((cd_marital_status#0 = D) && (cd_education_status#0 = 2 yr Degree)) && (ss_sales_price#0 >= 50.00)) && (ss_sales_price#0 <= 100.00))) || ((((cd_marital_status#0 = S) && (cd_education_status#0 = College)) && (ss_sales_price#0 >= 150.00)) && (ss_sales_price#0 <= 200.00))))
      :     :     :- 'Project [ss_sold_date_sk#0, ss_cdemo_sk#0, ss_addr_sk#0, ss_quantity#0, ss_sales_price#0, ss_net_profit#0]
      :     :     :  +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
      :     :     :     :- Project [ss_sold_date_sk#0, ss_cdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0, ss_net_profit#0]
      :     :     :     :  +- Filter (((isnotnull(ss_store_sk#0) && isnotnull(ss_cdemo_sk#0)) && isnotnull(ss_addr_sk#0)) && isnotnull(ss_sold_date_sk#0))
      :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :     :     :     +- Project [s_store_sk#0]
      :     :     :        +- Filter isnotnull(s_store_sk#0)
      :     :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
      :     :     +- Project [cd_demo_sk#0, cd_marital_status#0, cd_education_status#0]
      :     :        +- Filter isnotnull(cd_demo_sk#0)
      :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
      :     +- Project [ca_address_sk#0, ca_state#0]
      :        +- Filter ((isnotnull(ca_country#0) && (ca_country#0 = United States)) && isnotnull(ca_address_sk#0))
      :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
      +- Project [d_date_sk#0]
         +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
            +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q49
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [channel#0 ASC NULLS FIRST, return_rank#0 ASC NULLS FIRST, currency_rank#0 ASC NULLS FIRST], true
      +- 'Aggregate [channel#0, item#0, return_ratio#0, return_rank#0, currency_rank#0], [channel#0, item#0, return_ratio#0, return_rank#0, currency_rank#0]
         +- 'Union
            :- 'Project [web AS channel#0, item#0, return_ratio#0, return_rank#0, currency_rank#0]
            :  +- 'Filter ((return_rank#0 <= 10) || (currency_rank#0 <= 10))
            :     +- 'Window [rank(currency_ratio#0) windowspecdefinition(currency_ratio#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#0], [currency_ratio#0 ASC NULLS FIRST]
            :        +- 'Window [rank(return_ratio#0) windowspecdefinition(return_ratio#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#0], [return_ratio#0 ASC NULLS FIRST]
            :           +- 'Aggregate [ws_item_sk#0], [ws_item_sk#0 AS item#0, CheckOverflow((promote_precision(cast(sum(cast(coalesce(wr_return_quantity#0, 0) as bigint)) as decimal(15,4))) / promote_precision(cast(sum(cast(coalesce(ws_quantity#0, 0) as bigint)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#0, CheckOverflow((promote_precision(cast(sum(coalesce(cast(wr_return_amt#0 as decimal(12,2)), 0.00)) as decimal(15,4))) / promote_precision(cast(sum(coalesce(cast(ws_net_paid#0 as decimal(12,2)), 0.00)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#0]
            :              +- 'Project [ws_item_sk#0, ws_quantity#0, ws_net_paid#0, wr_return_quantity#0, wr_return_amt#0]
            :                 +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :                    :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_quantity#0, ws_net_paid#0, wr_return_quantity#0, wr_return_amt#0]
            :                    :  +- 'Join Inner, ((cast(ws_order_number#0 as bigint) = wr_order_number#0L) && (cast(ws_item_sk#0 as bigint) = wr_item_sk#0L))
            :                    :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_net_paid#0]
            :                    :     :  +- Filter ((((((((isnotnull(ws_net_paid#0) && isnotnull(ws_net_profit#0)) && isnotnull(ws_quantity#0)) && (ws_net_profit#0 > 1.00)) && (ws_net_paid#0 > 0.00)) && (ws_quantity#0 > 0)) && isnotnull(ws_item_sk#0)) && isnotnull(ws_order_number#0)) && isnotnull(ws_sold_date_sk#0))
            :                    :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                    :     +- Project [wr_item_sk#0L, wr_order_number#0L, wr_return_quantity#0, wr_return_amt#0]
            :                    :        +- Filter (((isnotnull(wr_return_amt#0) && (wr_return_amt#0 > 10000.00)) && isnotnull(wr_order_number#0L)) && isnotnull(wr_item_sk#0L))
            :                    :           +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
            :                    +- Project [d_date_sk#0]
            :                       +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 12)) && isnotnull(d_date_sk#0))
            :                          +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :- 'Project [catalog AS channel#0, item#0, return_ratio#0, return_rank#0, currency_rank#0]
            :  +- 'Filter ((return_rank#0 <= 10) || (currency_rank#0 <= 10))
            :     +- 'Window [rank(currency_ratio#0) windowspecdefinition(currency_ratio#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#0], [currency_ratio#0 ASC NULLS FIRST]
            :        +- 'Window [rank(return_ratio#0) windowspecdefinition(return_ratio#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#0], [return_ratio#0 ASC NULLS FIRST]
            :           +- 'Aggregate [cs_item_sk#0], [cs_item_sk#0 AS item#0, CheckOverflow((promote_precision(cast(sum(cast(coalesce(cr_return_quantity#0, 0) as bigint)) as decimal(15,4))) / promote_precision(cast(sum(cast(coalesce(cs_quantity#0, 0) as bigint)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#0, CheckOverflow((promote_precision(cast(sum(coalesce(cast(cr_return_amount#0 as decimal(12,2)), 0.00)) as decimal(15,4))) / promote_precision(cast(sum(coalesce(cast(cs_net_paid#0 as decimal(12,2)), 0.00)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#0]
            :              +- 'Project [cs_item_sk#0, cs_quantity#0, cs_net_paid#0, cr_return_quantity#0, cr_return_amount#0]
            :                 +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :                    :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_net_paid#0, cr_return_quantity#0, cr_return_amount#0]
            :                    :  +- 'Join Inner, ((cs_order_number#0 = cr_order_number#0) && (cs_item_sk#0 = cr_item_sk#0))
            :                    :     :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_net_paid#0]
            :                    :     :  +- Filter ((((((((isnotnull(cs_quantity#0) && isnotnull(cs_net_profit#0)) && isnotnull(cs_net_paid#0)) && (cs_net_profit#0 > 1.00)) && (cs_net_paid#0 > 0.00)) && (cs_quantity#0 > 0)) && isnotnull(cs_order_number#0)) && isnotnull(cs_item_sk#0)) && isnotnull(cs_sold_date_sk#0))
            :                    :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :                    :     +- Project [cr_item_sk#0, cr_order_number#0, cr_return_quantity#0, cr_return_amount#0]
            :                    :        +- Filter (((isnotnull(cr_return_amount#0) && (cr_return_amount#0 > 10000.00)) && isnotnull(cr_order_number#0)) && isnotnull(cr_item_sk#0))
            :                    :           +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
            :                    +- Project [d_date_sk#0]
            :                       +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 12)) && isnotnull(d_date_sk#0))
            :                          +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- 'Project [store AS channel#0, item#0, return_ratio#0, return_rank#0, currency_rank#0]
               +- 'Filter ((return_rank#0 <= 10) || (currency_rank#0 <= 10))
                  +- 'Window [rank(currency_ratio#0) windowspecdefinition(currency_ratio#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#0], [currency_ratio#0 ASC NULLS FIRST]
                     +- 'Window [rank(return_ratio#0) windowspecdefinition(return_ratio#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#0], [return_ratio#0 ASC NULLS FIRST]
                        +- 'Aggregate [ss_item_sk#0], [ss_item_sk#0 AS item#0, CheckOverflow((promote_precision(cast(sum(cast(coalesce(sr_return_quantity#0, 0) as bigint)) as decimal(15,4))) / promote_precision(cast(sum(cast(coalesce(ss_quantity#0, 0) as bigint)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#0, CheckOverflow((promote_precision(cast(sum(coalesce(cast(sr_return_amt#0 as decimal(12,2)), 0.00)) as decimal(15,4))) / promote_precision(cast(sum(coalesce(cast(ss_net_paid#0 as decimal(12,2)), 0.00)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#0]
                           +- 'Project [ss_item_sk#0, ss_quantity#0, ss_net_paid#0, sr_return_quantity#0, sr_return_amt#0]
                              +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                                 :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_quantity#0, ss_net_paid#0, sr_return_quantity#0, sr_return_amt#0]
                                 :  +- 'Join Inner, ((cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L))
                                 :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_net_paid#0]
                                 :     :  +- Filter ((((((((isnotnull(ss_quantity#0) && isnotnull(ss_net_profit#0)) && isnotnull(ss_net_paid#0)) && (ss_net_profit#0 > 1.00)) && (ss_net_paid#0 > 0.00)) && (ss_quantity#0 > 0)) && isnotnull(ss_item_sk#0)) && isnotnull(ss_ticket_number#0)) && isnotnull(ss_sold_date_sk#0))
                                 :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                                 :     +- Project [sr_item_sk#0L, sr_ticket_number#0L, sr_return_quantity#0, sr_return_amt#0]
                                 :        +- Filter (((isnotnull(sr_return_amt#0) && (sr_return_amt#0 > 10000.00)) && isnotnull(sr_ticket_number#0L)) && isnotnull(sr_item_sk#0L))
                                 :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
                                 +- Project [d_date_sk#0]
                                    +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 12)) && isnotnull(d_date_sk#0))
                                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q50
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [s_store_name#0 ASC NULLS FIRST, s_company_id#0 ASC NULLS FIRST, s_street_number#0 ASC NULLS FIRST, s_street_name#0 ASC NULLS FIRST, s_street_type#0 ASC NULLS FIRST, s_suite_number#0 ASC NULLS FIRST, s_city#0 ASC NULLS FIRST, s_county#0 ASC NULLS FIRST, s_state#0 ASC NULLS FIRST, s_zip#0 ASC NULLS FIRST], true
      +- 'Aggregate [s_store_name#0, s_company_id#0, s_street_number#0, s_street_name#0, s_street_type#0, s_suite_number#0, s_city#0, s_county#0, s_state#0, s_zip#0], [s_store_name#0, s_company_id#0, s_street_number#0, s_street_name#0, s_street_type#0, s_suite_number#0, s_city#0, s_county#0, s_state#0, s_zip#0, sum(cast(CASE WHEN ((sr_returned_date_sk#0L - cast(ss_sold_date_sk#0 as bigint)) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days #0L, sum(cast(CASE WHEN (((sr_returned_date_sk#0L - cast(ss_sold_date_sk#0 as bigint)) > 30) && ((sr_returned_date_sk#0L - cast(ss_sold_date_sk#0 as bigint)) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31 - 60 days #0L, sum(cast(CASE WHEN (((sr_returned_date_sk#0L - cast(ss_sold_date_sk#0 as bigint)) > 60) && ((sr_returned_date_sk#0L - cast(ss_sold_date_sk#0 as bigint)) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61 - 90 days #0L, sum(cast(CASE WHEN (((sr_returned_date_sk#0L - cast(ss_sold_date_sk#0 as bigint)) > 90) && ((sr_returned_date_sk#0L - cast(ss_sold_date_sk#0 as bigint)) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91 - 120 days #0L, sum(cast(CASE WHEN ((sr_returned_date_sk#0L - cast(ss_sold_date_sk#0 as bigint)) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days #0L]
         +- 'Project [ss_sold_date_sk#0, sr_returned_date_sk#0L, s_store_name#0, s_company_id#0, s_street_number#0, s_street_name#0, s_street_type#0, s_suite_number#0, s_city#0, s_county#0, s_state#0, s_zip#0]
            +- 'Join Inner, (sr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
               :- 'Project [ss_sold_date_sk#0, sr_returned_date_sk#0L, s_store_name#0, s_company_id#0, s_street_number#0, s_street_name#0, s_street_type#0, s_suite_number#0, s_city#0, s_county#0, s_state#0, s_zip#0]
               :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :- 'Project [ss_sold_date_sk#0, sr_returned_date_sk#0L, s_store_name#0, s_company_id#0, s_street_number#0, s_street_name#0, s_street_type#0, s_suite_number#0, s_city#0, s_county#0, s_state#0, s_zip#0]
               :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :     :     :- 'Project [ss_sold_date_sk#0, ss_store_sk#0, sr_returned_date_sk#0L]
               :     :     :  +- 'Join Inner, (((cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L)) && (cast(ss_customer_sk#0 as bigint) = sr_customer_sk#0L))
               :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_ticket_number#0]
               :     :     :     :  +- Filter ((((isnotnull(ss_customer_sk#0) && isnotnull(ss_ticket_number#0)) && isnotnull(ss_item_sk#0)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_sold_date_sk#0))
               :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     :     +- Project [sr_returned_date_sk#0L, sr_item_sk#0L, sr_customer_sk#0L, sr_ticket_number#0L]
               :     :     :        +- Filter (((isnotnull(sr_ticket_number#0L) && isnotnull(sr_customer_sk#0L)) && isnotnull(sr_item_sk#0L)) && isnotnull(sr_returned_date_sk#0L))
               :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               :     :     +- Project [s_store_sk#0, s_store_name#0, s_company_id#0, s_street_number#0, s_street_name#0, s_street_type#0, s_suite_number#0, s_city#0, s_county#0, s_state#0, s_zip#0]
               :     :        +- Filter isnotnull(s_store_sk#0)
               :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :     +- Project [d_date_sk#0]
               :        +- Filter isnotnull(d_date_sk#0)
               :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               +- Project [d_date_sk#0]
                  +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 8)) && isnotnull(d_date_sk#0))
                     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q51
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [item_sk#0 ASC NULLS FIRST, d_date#0 ASC NULLS FIRST], true
      +- 'Filter ((isnotnull(web_cumulative#0) && isnotnull(store_cumulative#0)) && (web_cumulative#0 > store_cumulative#0))
         +- 'Window [max(web_sales#0) windowspecdefinition(item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS web_cumulative#0, max(store_sales#0) windowspecdefinition(item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS store_cumulative#0], [item_sk#0], [d_date#0 ASC NULLS FIRST]
            +- 'Project [CASE WHEN isnotnull(item_sk#0) THEN item_sk#0 ELSE item_sk#0 END AS item_sk#0, CASE WHEN isnotnull(d_date#0) THEN d_date#0 ELSE d_date#0 END AS d_date#0, cume_sales#0 AS web_sales#0, cume_sales#0 AS store_sales#0]
               +- 'Join FullOuter, ((item_sk#0 = item_sk#0) && (d_date#0 = d_date#0))
                  :- 'Project [item_sk#0, d_date#0, cume_sales#0]
                  :  +- 'Window [sum(_w0#0) windowspecdefinition(ws_item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#0], [ws_item_sk#0], [d_date#0 ASC NULLS FIRST]
                  :     +- 'Aggregate [ws_item_sk#0, d_date#0], [ws_item_sk#0 AS item_sk#0, d_date#0, MakeDecimal(sum(UnscaledValue(ws_sales_price#0)),17,2) AS _w0#0, ws_item_sk#0]
                  :        +- 'Project [ws_item_sk#0, ws_sales_price#0, d_date#0]
                  :           +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                  :              :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_sales_price#0]
                  :              :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                  :              :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                  :              +- Project [d_date_sk#0, d_date#0]
                  :                 +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
                  :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  +- 'Project [item_sk#0, d_date#0, cume_sales#0]
                     +- 'Window [sum(_w0#0) windowspecdefinition(ss_item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#0], [ss_item_sk#0], [d_date#0 ASC NULLS FIRST]
                        +- 'Aggregate [ss_item_sk#0, d_date#0], [ss_item_sk#0 AS item_sk#0, d_date#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS _w0#0, ss_item_sk#0]
                           +- 'Project [ss_item_sk#0, ss_sales_price#0, d_date#0]
                              +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                                 :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_sales_price#0]
                                 :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                                 :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                                 +- Project [d_date_sk#0, d_date#0]
                                    +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
                                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q52
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [d_year#0 ASC NULLS FIRST, ext_price#0 DESC NULLS LAST, brand_id#0 ASC NULLS FIRST], true
      +- 'Aggregate [d_year#0, i_brand#0, i_brand_id#0], [d_year#0, i_brand_id#0 AS brand_id#0, i_brand#0 AS brand#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS ext_price#0]
         +- 'Project [d_year#0, ss_ext_sales_price#0, i_brand_id#0, i_brand#0]
            +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :- 'Project [d_year#0, ss_item_sk#0, ss_ext_sales_price#0]
               :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
               :     :- Project [d_date_sk#0, d_year#0]
               :     :  +- Filter ((((isnotnull(d_moy#0) && isnotnull(d_year#0)) && (d_moy#0 = 11)) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
               :     :     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ext_sales_price#0]
               :        +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0))
               :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               +- Project [i_item_sk#0, i_brand_id#0, i_brand#0]
                  +- Filter ((isnotnull(i_manager_id#0) && (i_manager_id#0 = 1)) && isnotnull(i_item_sk#0))
                     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q53
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [avg_quarterly_sales#0 ASC NULLS FIRST, sum_sales#0 ASC NULLS FIRST, i_manufact_id#0 ASC NULLS FIRST], true
      +- 'Project [i_manufact_id#0, sum_sales#0, avg_quarterly_sales#0]
         +- 'Filter (CASE WHEN (avg_quarterly_sales#0 > 0.000000) THEN CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#0 as decimal(22,6))) - promote_precision(cast(avg_quarterly_sales#0 as decimal(22,6)))), DecimalType(22,6)))) / promote_precision(cast(avg_quarterly_sales#0 as decimal(22,6)))), DecimalType(38,16)) ELSE null END > 0.1000000000000000)
            +- 'Window [avg(_w0#0) windowspecdefinition(i_manufact_id#0, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_quarterly_sales#0], [i_manufact_id#0]
               +- 'Aggregate [i_manufact_id#0, d_qoy#0], [i_manufact_id#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS sum_sales#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS _w0#0]
                  +- 'Project [i_manufact_id#0, ss_sales_price#0, d_qoy#0]
                     +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                        :- 'Project [i_manufact_id#0, ss_store_sk#0, ss_sales_price#0, d_qoy#0]
                        :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                        :     :- 'Project [i_manufact_id#0, ss_sold_date_sk#0, ss_store_sk#0, ss_sales_price#0]
                        :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                        :     :     :- Project [i_item_sk#0, i_manufact_id#0]
                        :     :     :  +- Filter ((((i_category#0 IN (Books,Children,Electronics) && i_class#0 IN (personal,portable,reference,self-help)) && i_brand#0 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#0 IN (Women,Music,Men) && i_class#0 IN (accessories,classical,fragrances,pants)) && i_brand#0 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1))) && isnotnull(i_item_sk#0))
                        :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :     :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_sales_price#0]
                        :     :        +- Filter ((isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0))
                        :     :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        :     +- Project [d_date_sk#0, d_qoy#0]
                        :        +- Filter (d_month_seq#0 INSET (1200,1211,1205,1201,1206,1210,1207,1202,1209,1203,1208,1204) && isnotnull(d_date_sk#0))
                        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        +- Project [s_store_sk#0]
                           +- Filter isnotnull(s_store_sk#0)
                              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet


================================================================================================
q54
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [segment#0 ASC NULLS FIRST, num_customers#0L ASC NULLS FIRST], true
      +- 'Aggregate [segment#0], [segment#0, count(1) AS num_customers#0L, (segment#0 * 50) AS segment_base#0]
         +- 'Aggregate [c_customer_sk#0], [cast(CheckOverflow((promote_precision(MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2)) / 50.00), DecimalType(21,6)) as int) AS segment#0]
            +- 'Project [c_customer_sk#0, ss_ext_sales_price#0]
               +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                  :- 'Project [c_customer_sk#0, ss_sold_date_sk#0, ss_ext_sales_price#0]
                  :  +- 'Join Inner, ((ca_county#0 = s_county#0) && (ca_state#0 = s_state#0))
                  :     :- 'Project [c_customer_sk#0, ss_sold_date_sk#0, ss_ext_sales_price#0, ca_county#0, ca_state#0]
                  :     :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
                  :     :     :- 'Project [c_customer_sk#0, c_current_addr_sk#0, ss_sold_date_sk#0, ss_ext_sales_price#0]
                  :     :     :  +- 'Join Inner, (c_customer_sk#0 = ss_customer_sk#0)
                  :     :     :     :- 'Aggregate [c_customer_sk#0, c_current_addr_sk#0], [c_customer_sk#0, c_current_addr_sk#0]
                  :     :     :     :  +- 'Project [c_customer_sk#0, c_current_addr_sk#0]
                  :     :     :     :     +- 'Join Inner, (c_customer_sk#0 = customer_sk#0)
                  :     :     :     :        :- 'Project [customer_sk#0]
                  :     :     :     :        :  +- 'Join Inner, (sold_date_sk#0 = d_date_sk#0)
                  :     :     :     :        :     :- 'Project [sold_date_sk#0, customer_sk#0]
                  :     :     :     :        :     :  +- 'Join Inner, (item_sk#0 = i_item_sk#0)
                  :     :     :     :        :     :     :- Union
                  :     :     :     :        :     :     :  :- Project [cs_sold_date_sk#0 AS sold_date_sk#0, cs_bill_customer_sk#0 AS customer_sk#0, cs_item_sk#0 AS item_sk#0]
                  :     :     :     :        :     :     :  :  +- Filter ((isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_bill_customer_sk#0))
                  :     :     :     :        :     :     :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                  :     :     :     :        :     :     :  +- Project [ws_sold_date_sk#0 AS sold_date_sk#0, ws_bill_customer_sk#0 AS customer_sk#0, ws_item_sk#0 AS item_sk#0]
                  :     :     :     :        :     :     :     +- Filter ((isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0)) && isnotnull(ws_bill_customer_sk#0))
                  :     :     :     :        :     :     :        +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                  :     :     :     :        :     :     +- Project [i_item_sk#0]
                  :     :     :     :        :     :        +- Filter ((((isnotnull(i_category#0) && isnotnull(i_class#0)) && (i_category#0 = Women)) && (i_class#0 = maternity)) && isnotnull(i_item_sk#0))
                  :     :     :     :        :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  :     :     :     :        :     +- Project [d_date_sk#0]
                  :     :     :     :        :        +- Filter ((((isnotnull(d_moy#0) && isnotnull(d_year#0)) && (d_moy#0 = 12)) && (d_year#0 = 1998)) && isnotnull(d_date_sk#0))
                  :     :     :     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     :     :     :        +- Project [c_customer_sk#0, c_current_addr_sk#0]
                  :     :     :     :           +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_current_addr_sk#0))
                  :     :     :     :              +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                  :     :     :     +- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_ext_sales_price#0]
                  :     :     :        +- Filter (isnotnull(ss_customer_sk#0) && isnotnull(ss_sold_date_sk#0))
                  :     :     :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :     :     +- Project [ca_address_sk#0, ca_county#0, ca_state#0]
                  :     :        +- Filter ((isnotnull(ca_address_sk#0) && isnotnull(ca_state#0)) && isnotnull(ca_county#0))
                  :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                  :     +- Project [s_county#0, s_state#0]
                  :        +- Filter (isnotnull(s_county#0) && isnotnull(s_state#0))
                  :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                  +- Project [d_date_sk#0]
                     +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= scalar-subquery#0 [])) && (d_month_seq#0 <= scalar-subquery#0 [])) && isnotnull(d_date_sk#0))
                        :  :- Aggregate [(d_month_seq + 1)#4779], [(d_month_seq + 1)#4779]
                        :  :  +- Project [(d_month_seq#27 + 1) AS (d_month_seq + 1)#4779]
                        :  :     +- Filter (((isnotnull(d_year#30) && isnotnull(d_moy#32)) && (d_year#30 = 1998)) && (d_moy#32 = 12))
                        :  :        +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                        :  +- Aggregate [(d_month_seq + 3)#4780], [(d_month_seq + 3)#4780]
                        :     +- Project [(d_month_seq#27 + 3) AS (d_month_seq + 3)#4780]
                        :        +- Filter (((isnotnull(d_year#30) && isnotnull(d_moy#32)) && (d_year#30 = 1998)) && (d_moy#32 = 12))
                        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q55
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [ext_price#0 DESC NULLS LAST, brand_id#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_brand#0, i_brand_id#0], [i_brand_id#0 AS brand_id#0, i_brand#0 AS brand#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS ext_price#0]
         +- 'Project [ss_ext_sales_price#0, i_brand_id#0, i_brand#0]
            +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :- 'Project [ss_item_sk#0, ss_ext_sales_price#0]
               :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
               :     :- Project [d_date_sk#0]
               :     :  +- Filter ((((isnotnull(d_moy#0) && isnotnull(d_year#0)) && (d_moy#0 = 11)) && (d_year#0 = 1999)) && isnotnull(d_date_sk#0))
               :     :     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ext_sales_price#0]
               :        +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0))
               :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               +- Project [i_item_sk#0, i_brand_id#0, i_brand#0]
                  +- Filter ((isnotnull(i_manager_id#0) && (i_manager_id#0 = 28)) && isnotnull(i_item_sk#0))
                     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q56
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [total_sales#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_item_id#0], [i_item_id#0, sum(total_sales#0) AS total_sales#0]
         +- 'Union
            :- 'Aggregate [i_item_id#0], [i_item_id#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS total_sales#0]
            :  +- 'Project [ss_ext_sales_price#0, i_item_id#0]
            :     +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :        :- 'Project [ss_item_sk#0, ss_ext_sales_price#0]
            :        :  +- 'Join Inner, (ss_addr_sk#0 = ca_address_sk#0)
            :        :     :- 'Project [ss_item_sk#0, ss_addr_sk#0, ss_ext_sales_price#0]
            :        :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :        :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_addr_sk#0, ss_ext_sales_price#0]
            :        :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_addr_sk#0)) && isnotnull(ss_item_sk#0))
            :        :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :        :     :     +- Project [d_date_sk#0]
            :        :     :        +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 2)) && isnotnull(d_date_sk#0))
            :        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :        :     +- Project [ca_address_sk#0]
            :        :        +- Filter ((isnotnull(ca_gmt_offset#0) && (ca_gmt_offset#0 = -5.00)) && isnotnull(ca_address_sk#0))
            :        :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
            :        +- 'Join LeftSemi, (i_item_id#0 = i_item_id#304#0)
            :           :- Project [i_item_sk#0, i_item_id#0]
            :           :  +- Filter isnotnull(i_item_id#0)
            :           :     +- Filter isnotnull(i_item_sk#0)
            :           :        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :           +- Project [i_item_id#0 AS i_item_id#304#0]
            :              +- Filter isnotnull(i_item_id#0)
            :                 +- Filter i_color#0 IN (slate,blanched,burnished)
            :                    +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :- 'Aggregate [i_item_id#0], [i_item_id#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS total_sales#0]
            :  +- 'Project [cs_ext_sales_price#0, i_item_id#0]
            :     +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :        :- 'Project [cs_item_sk#0, cs_ext_sales_price#0]
            :        :  +- 'Join Inner, (cs_bill_addr_sk#0 = ca_address_sk#0)
            :        :     :- 'Project [cs_bill_addr_sk#0, cs_item_sk#0, cs_ext_sales_price#0]
            :        :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :        :     :     :- Project [cs_sold_date_sk#0, cs_bill_addr_sk#0, cs_item_sk#0, cs_ext_sales_price#0]
            :        :     :     :  +- Filter ((isnotnull(cs_sold_date_sk#0) && isnotnull(cs_bill_addr_sk#0)) && isnotnull(cs_item_sk#0))
            :        :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :        :     :     +- Project [d_date_sk#0]
            :        :     :        +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 2)) && isnotnull(d_date_sk#0))
            :        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :        :     +- Project [ca_address_sk#0]
            :        :        +- Filter ((isnotnull(ca_gmt_offset#0) && (ca_gmt_offset#0 = -5.00)) && isnotnull(ca_address_sk#0))
            :        :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
            :        +- 'Join LeftSemi, (i_item_id#0 = i_item_id#304#0)
            :           :- Project [i_item_sk#0, i_item_id#0]
            :           :  +- Filter isnotnull(i_item_id#0)
            :           :     +- Filter isnotnull(i_item_sk#0)
            :           :        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :           +- Project [i_item_id#0 AS i_item_id#304#0]
            :              +- Filter isnotnull(i_item_id#0)
            :                 +- Filter i_color#0 IN (slate,blanched,burnished)
            :                    +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            +- 'Aggregate [i_item_id#0], [i_item_id#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS total_sales#0]
               +- 'Project [ws_ext_sales_price#0, i_item_id#0]
                  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                     :- 'Project [ws_item_sk#0, ws_ext_sales_price#0]
                     :  +- 'Join Inner, (ws_bill_addr_sk#0 = ca_address_sk#0)
                     :     :- 'Project [ws_item_sk#0, ws_bill_addr_sk#0, ws_ext_sales_price#0]
                     :     :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                     :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_bill_addr_sk#0, ws_ext_sales_price#0]
                     :     :     :  +- Filter ((isnotnull(ws_sold_date_sk#0) && isnotnull(ws_bill_addr_sk#0)) && isnotnull(ws_item_sk#0))
                     :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                     :     :     +- Project [d_date_sk#0]
                     :     :        +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 2)) && isnotnull(d_date_sk#0))
                     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :     +- Project [ca_address_sk#0]
                     :        +- Filter ((isnotnull(ca_gmt_offset#0) && (ca_gmt_offset#0 = -5.00)) && isnotnull(ca_address_sk#0))
                     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                     +- 'Join LeftSemi, (i_item_id#0 = i_item_id#304#0)
                        :- Project [i_item_sk#0, i_item_id#0]
                        :  +- Filter isnotnull(i_item_id#0)
                        :     +- Filter isnotnull(i_item_sk#0)
                        :        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        +- Project [i_item_id#0 AS i_item_id#304#0]
                           +- Filter isnotnull(i_item_id#0)
                              +- Filter i_color#0 IN (slate,blanched,burnished)
                                 +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q57
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [CheckOverflow((promote_precision(cast(sum_sales#0 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, cc_name#0 ASC NULLS FIRST], true
      +- 'Project [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0, avg_monthly_sales#0, sum_sales#0, sum_sales#0 AS psum#0, sum_sales#0 AS nsum#0]
         +- 'Join Inner, ((((i_category#0 = i_category#0) && (i_brand#0 = i_brand#0)) && (cc_name#0 = cc_name#0)) && (rn#0 = (rn#0 - 1)))
            :- 'Project [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0, sum_sales#0, avg_monthly_sales#0, rn#0, sum_sales#0]
            :  +- 'Join Inner, ((((i_category#0 = i_category#0) && (i_brand#0 = i_brand#0)) && (cc_name#0 = cc_name#0)) && (rn#0 = (rn#0 + 1)))
            :     :- 'Project [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0, sum_sales#0, avg_monthly_sales#0, rn#0]
            :     :  +- 'Filter (((isnotnull(avg_monthly_sales#0) && (avg_monthly_sales#0 > 0.000000)) && (CASE WHEN (avg_monthly_sales#0 > 0.000000) THEN CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#0 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(22,6)))) / promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(38,16)) ELSE null END > 0.1000000000000000)) && isnotnull(rn#0))
            :     :     +- 'Window [avg(_w0#0) windowspecdefinition(i_category#0, i_brand#0, cc_name#0, d_year#0, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#0], [i_category#0, i_brand#0, cc_name#0, d_year#0]
            :     :        +- 'Filter (isnotnull(d_year#0) && (d_year#0 = 1999))
            :     :           +- 'Window [rank(d_year#0, d_moy#0) windowspecdefinition(i_category#0, i_brand#0, cc_name#0, d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#0], [i_category#0, i_brand#0, cc_name#0], [d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST]
            :     :              +- 'Aggregate [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0], [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0, MakeDecimal(sum(UnscaledValue(cs_sales_price#0)),17,2) AS sum_sales#0, MakeDecimal(sum(UnscaledValue(cs_sales_price#0)),17,2) AS _w0#0]
            :     :                 +- 'Project [i_brand#0, i_category#0, cs_sales_price#0, d_year#0, d_moy#0, cc_name#0]
            :     :                    +- 'Join Inner, (cc_call_center_sk#0 = cs_call_center_sk#0)
            :     :                       :- 'Project [i_brand#0, i_category#0, cs_call_center_sk#0, cs_sales_price#0, d_year#0, d_moy#0]
            :     :                       :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :                       :     :- 'Project [i_brand#0, i_category#0, cs_sold_date_sk#0, cs_call_center_sk#0, cs_sales_price#0]
            :     :                       :     :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :                       :     :     :- Project [i_item_sk#0, i_brand#0, i_category#0]
            :     :                       :     :     :  +- Filter ((isnotnull(i_item_sk#0) && isnotnull(i_category#0)) && isnotnull(i_brand#0))
            :     :                       :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :                       :     :     +- Project [cs_sold_date_sk#0, cs_call_center_sk#0, cs_item_sk#0, cs_sales_price#0]
            :     :                       :     :        +- Filter ((isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_call_center_sk#0))
            :     :                       :     :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :                       :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
            :     :                       :        +- Filter ((((d_year#0 = 1999) || ((d_year#0 = 1998) && (d_moy#0 = 12))) || ((d_year#0 = 2000) && (d_moy#0 = 1))) && isnotnull(d_date_sk#0))
            :     :                       :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                       +- Project [cc_call_center_sk#0, cc_name#0]
            :     :                          +- Filter (isnotnull(cc_call_center_sk#0) && isnotnull(cc_name#0))
            :     :                             +- Relation[cc_call_center_sk#0,cc_call_center_id#0,cc_rec_start_date#0,cc_rec_end_date#0,cc_closed_date_sk#0,cc_open_date_sk#0,cc_name#0,cc_class#0,cc_employees#0,cc_sq_ft#0,cc_hours#0,cc_manager#0,cc_mkt_id#0,cc_mkt_class#0,cc_mkt_desc#0,cc_market_manager#0,cc_division#0,cc_division_name#0,cc_company#0,cc_company_name#0,cc_street_number#0,cc_street_name#0,cc_street_type#0,cc_suite_number#0,... 7 more fields] parquet
            :     +- 'Project [i_category#0, i_brand#0, cc_name#0, sum_sales#0, rn#0]
            :        +- 'Filter isnotnull(rn#0)
            :           +- 'Window [rank(d_year#0, d_moy#0) windowspecdefinition(i_category#0, i_brand#0, cc_name#0, d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#0], [i_category#0, i_brand#0, cc_name#0], [d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST]
            :              +- 'Aggregate [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0], [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0, MakeDecimal(sum(UnscaledValue(cs_sales_price#0)),17,2) AS sum_sales#0]
            :                 +- 'Project [i_brand#0, i_category#0, cs_sales_price#0, d_year#0, d_moy#0, cc_name#0]
            :                    +- 'Join Inner, (cc_call_center_sk#0 = cs_call_center_sk#0)
            :                       :- 'Project [i_brand#0, i_category#0, cs_call_center_sk#0, cs_sales_price#0, d_year#0, d_moy#0]
            :                       :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :                       :     :- 'Project [i_brand#0, i_category#0, cs_sold_date_sk#0, cs_call_center_sk#0, cs_sales_price#0]
            :                       :     :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :                       :     :     :- Project [i_item_sk#0, i_brand#0, i_category#0]
            :                       :     :     :  +- Filter ((isnotnull(i_item_sk#0) && isnotnull(i_brand#0)) && isnotnull(i_category#0))
            :                       :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                       :     :     +- Project [cs_sold_date_sk#0, cs_call_center_sk#0, cs_item_sk#0, cs_sales_price#0]
            :                       :     :        +- Filter ((isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_call_center_sk#0))
            :                       :     :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :                       :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
            :                       :        +- Filter ((((d_year#0 = 1999) || ((d_year#0 = 1998) && (d_moy#0 = 12))) || ((d_year#0 = 2000) && (d_moy#0 = 1))) && isnotnull(d_date_sk#0))
            :                       :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                       +- Project [cc_call_center_sk#0, cc_name#0]
            :                          +- Filter (isnotnull(cc_call_center_sk#0) && isnotnull(cc_name#0))
            :                             +- Relation[cc_call_center_sk#0,cc_call_center_id#0,cc_rec_start_date#0,cc_rec_end_date#0,cc_closed_date_sk#0,cc_open_date_sk#0,cc_name#0,cc_class#0,cc_employees#0,cc_sq_ft#0,cc_hours#0,cc_manager#0,cc_mkt_id#0,cc_mkt_class#0,cc_mkt_desc#0,cc_market_manager#0,cc_division#0,cc_division_name#0,cc_company#0,cc_company_name#0,cc_street_number#0,cc_street_name#0,cc_street_type#0,cc_suite_number#0,... 7 more fields] parquet
            +- 'Project [i_category#0, i_brand#0, cc_name#0, sum_sales#0, rn#0]
               +- 'Filter isnotnull(rn#0)
                  +- 'Window [rank(d_year#0, d_moy#0) windowspecdefinition(i_category#0, i_brand#0, cc_name#0, d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#0], [i_category#0, i_brand#0, cc_name#0], [d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST]
                     +- 'Aggregate [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0], [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0, MakeDecimal(sum(UnscaledValue(cs_sales_price#0)),17,2) AS sum_sales#0]
                        +- 'Project [i_brand#0, i_category#0, cs_sales_price#0, d_year#0, d_moy#0, cc_name#0]
                           +- 'Join Inner, (cc_call_center_sk#0 = cs_call_center_sk#0)
                              :- 'Project [i_brand#0, i_category#0, cs_call_center_sk#0, cs_sales_price#0, d_year#0, d_moy#0]
                              :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                              :     :- 'Project [i_brand#0, i_category#0, cs_sold_date_sk#0, cs_call_center_sk#0, cs_sales_price#0]
                              :     :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                              :     :     :- Project [i_item_sk#0, i_brand#0, i_category#0]
                              :     :     :  +- Filter ((isnotnull(i_item_sk#0) && isnotnull(i_brand#0)) && isnotnull(i_category#0))
                              :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              :     :     +- Project [cs_sold_date_sk#0, cs_call_center_sk#0, cs_item_sk#0, cs_sales_price#0]
                              :     :        +- Filter ((isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_call_center_sk#0))
                              :     :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                              :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
                              :        +- Filter ((((d_year#0 = 1999) || ((d_year#0 = 1998) && (d_moy#0 = 12))) || ((d_year#0 = 2000) && (d_moy#0 = 1))) && isnotnull(d_date_sk#0))
                              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              +- Project [cc_call_center_sk#0, cc_name#0]
                                 +- Filter (isnotnull(cc_call_center_sk#0) && isnotnull(cc_name#0))
                                    +- Relation[cc_call_center_sk#0,cc_call_center_id#0,cc_rec_start_date#0,cc_rec_end_date#0,cc_closed_date_sk#0,cc_open_date_sk#0,cc_name#0,cc_class#0,cc_employees#0,cc_sq_ft#0,cc_hours#0,cc_manager#0,cc_mkt_id#0,cc_mkt_class#0,cc_mkt_desc#0,cc_market_manager#0,cc_division#0,cc_division_name#0,cc_company#0,cc_company_name#0,cc_street_number#0,cc_street_name#0,cc_street_type#0,cc_suite_number#0,... 7 more fields] parquet


================================================================================================
q58
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [item_id#0 ASC NULLS FIRST, ss_item_rev#0 ASC NULLS FIRST], true
      +- 'Project [item_id#0, ss_item_rev#0, CheckOverflow((promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(ss_item_rev#0 as decimal(19,2))) / promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#0 as decimal(18,2))) + promote_precision(cast(cs_item_rev#0 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#0 as decimal(19,2)))), DecimalType(19,2)))), DecimalType(38,21))) / 3.000000000000000000000), DecimalType(38,21))) * 100.000000000000000000000), DecimalType(38,17)) AS ss_dev#0, cs_item_rev#0, CheckOverflow((promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(cs_item_rev#0 as decimal(19,2))) / promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#0 as decimal(18,2))) + promote_precision(cast(cs_item_rev#0 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#0 as decimal(19,2)))), DecimalType(19,2)))), DecimalType(38,21))) / 3.000000000000000000000), DecimalType(38,21))) * 100.000000000000000000000), DecimalType(38,17)) AS cs_dev#0, ws_item_rev#0, CheckOverflow((promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(ws_item_rev#0 as decimal(19,2))) / promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#0 as decimal(18,2))) + promote_precision(cast(cs_item_rev#0 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#0 as decimal(19,2)))), DecimalType(19,2)))), DecimalType(38,21))) / 3.000000000000000000000), DecimalType(38,21))) * 100.000000000000000000000), DecimalType(38,17)) AS ws_dev#0, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#0 as decimal(18,2))) + promote_precision(cast(cs_item_rev#0 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#0 as decimal(19,2)))), DecimalType(19,2))) / 3.00), DecimalType(23,6)) AS average#0]
         +- 'Join Inner, (((((((((item_id#0 = item_id#0) && (cast(ss_item_rev#0 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ws_item_rev#0)), DecimalType(19,3)))) && (cast(ss_item_rev#0 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ws_item_rev#0)), DecimalType(20,3)))) && (cast(cs_item_rev#0 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ws_item_rev#0)), DecimalType(19,3)))) && (cast(cs_item_rev#0 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ws_item_rev#0)), DecimalType(20,3)))) && (cast(ws_item_rev#0 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ss_item_rev#0)), DecimalType(19,3)))) && (cast(ws_item_rev#0 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ss_item_rev#0)), DecimalType(20,3)))) && (cast(ws_item_rev#0 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(cs_item_rev#0)), DecimalType(19,3)))) && (cast(ws_item_rev#0 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(cs_item_rev#0)), DecimalType(20,3))))
            :- 'Project [item_id#0, ss_item_rev#0, cs_item_rev#0]
            :  +- 'Join Inner, (((((item_id#0 = item_id#0) && (cast(ss_item_rev#0 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(cs_item_rev#0)), DecimalType(19,3)))) && (cast(ss_item_rev#0 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(cs_item_rev#0)), DecimalType(20,3)))) && (cast(cs_item_rev#0 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ss_item_rev#0)), DecimalType(19,3)))) && (cast(cs_item_rev#0 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ss_item_rev#0)), DecimalType(20,3))))
            :     :- 'Filter isnotnull(ss_item_rev#0)
            :     :  +- 'Aggregate [i_item_id#0], [i_item_id#0 AS item_id#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS ss_item_rev#0]
            :     :     +- 'Project [ss_ext_sales_price#0, i_item_id#0]
            :     :        +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :           :- 'Project [ss_sold_date_sk#0, ss_ext_sales_price#0, i_item_id#0]
            :     :           :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :           :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ext_sales_price#0]
            :     :           :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :           :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :           :     +- Project [i_item_sk#0, i_item_id#0]
            :     :           :        +- Filter (isnotnull(i_item_sk#0) && isnotnull(i_item_id#0))
            :     :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :           +- 'Project [d_date_sk#0]
            :     :              +- 'Join LeftSemi, (d_date#0 = d_date#26#0)
            :     :                 :- Project [d_date_sk#0, d_date#0]
            :     :                 :  +- Filter isnotnull(d_date#0)
            :     :                 :     +- Filter isnotnull(d_date_sk#0)
            :     :                 :        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                 +- Project [d_date#0 AS d_date#26#0]
            :     :                    +- Filter isnotnull(d_date#0)
            :     :                       +- Filter (isnotnull(d_week_seq#0) && (d_week_seq#0 = scalar-subquery#0 []))
            :     :                          :  +- Project [d_week_seq#28]
            :     :                          :     +- Filter (isnotnull(d_date#26) && (cast(d_date#26 as string) = 2000-01-03))
            :     :                          :        +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :                          +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     +- 'Filter isnotnull(cs_item_rev#0)
            :        +- 'Aggregate [i_item_id#0], [i_item_id#0 AS item_id#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS cs_item_rev#0]
            :           +- 'Project [cs_ext_sales_price#0, i_item_id#0]
            :              +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :                 :- 'Project [cs_sold_date_sk#0, cs_ext_sales_price#0, i_item_id#0]
            :                 :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :                 :     :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_ext_sales_price#0]
            :                 :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :                 :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :                 :     +- Project [i_item_sk#0, i_item_id#0]
            :                 :        +- Filter (isnotnull(i_item_sk#0) && isnotnull(i_item_id#0))
            :                 :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                 +- 'Project [d_date_sk#0]
            :                    +- 'Join LeftSemi, (d_date#0 = d_date#26#0)
            :                       :- Project [d_date_sk#0, d_date#0]
            :                       :  +- Filter isnotnull(d_date#0)
            :                       :     +- Filter isnotnull(d_date_sk#0)
            :                       :        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                       +- Project [d_date#0 AS d_date#26#0]
            :                          +- Filter isnotnull(d_date#0)
            :                             +- Filter (isnotnull(d_week_seq#0) && (d_week_seq#0 = scalar-subquery#0 []))
            :                                :  +- Project [d_week_seq#28]
            :                                :     +- Filter (isnotnull(d_date#26) && (cast(d_date#26 as string) = 2000-01-03))
            :                                :        +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :                                +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- 'Filter isnotnull(ws_item_rev#0)
               +- 'Aggregate [i_item_id#0], [i_item_id#0 AS item_id#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS ws_item_rev#0]
                  +- 'Project [ws_ext_sales_price#0, i_item_id#0]
                     +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                        :- 'Project [ws_sold_date_sk#0, ws_ext_sales_price#0, i_item_id#0]
                        :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                        :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_ext_sales_price#0]
                        :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                        :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                        :     +- Project [i_item_sk#0, i_item_id#0]
                        :        +- Filter (isnotnull(i_item_sk#0) && isnotnull(i_item_id#0))
                        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        +- 'Project [d_date_sk#0]
                           +- 'Join LeftSemi, (d_date#0 = d_date#26#0)
                              :- Project [d_date_sk#0, d_date#0]
                              :  +- Filter isnotnull(d_date#0)
                              :     +- Filter isnotnull(d_date_sk#0)
                              :        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              +- Project [d_date#0 AS d_date#26#0]
                                 +- Filter isnotnull(d_date#0)
                                    +- Filter (isnotnull(d_week_seq#0) && (d_week_seq#0 = scalar-subquery#0 []))
                                       :  +- Project [d_week_seq#28]
                                       :     +- Filter (isnotnull(d_date#26) && (cast(d_date#26 as string) = 2000-01-03))
                                       :        +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q59
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [s_store_name1#0 ASC NULLS FIRST, s_store_id1#0 ASC NULLS FIRST, d_week_seq1#0 ASC NULLS FIRST], true
      +- 'Project [s_store_name1#0, s_store_id1#0, d_week_seq1#0, CheckOverflow((promote_precision(sun_sales1#0) / promote_precision(sun_sales2#0)), DecimalType(37,20)) AS (sun_sales1 / sun_sales2)#0, CheckOverflow((promote_precision(mon_sales1#0) / promote_precision(mon_sales2#0)), DecimalType(37,20)) AS (mon_sales1 / mon_sales2)#0, CheckOverflow((promote_precision(tue_sales1#0) / promote_precision(tue_sales2#0)), DecimalType(37,20)) AS (tue_sales1 / tue_sales2)#0, CheckOverflow((promote_precision(wed_sales1#0) / promote_precision(wed_sales2#0)), DecimalType(37,20)) AS (wed_sales1 / wed_sales2)#0, CheckOverflow((promote_precision(thu_sales1#0) / promote_precision(thu_sales2#0)), DecimalType(37,20)) AS (thu_sales1 / thu_sales2)#0, CheckOverflow((promote_precision(fri_sales1#0) / promote_precision(fri_sales2#0)), DecimalType(37,20)) AS (fri_sales1 / fri_sales2)#0, CheckOverflow((promote_precision(sat_sales1#0) / promote_precision(sat_sales2#0)), DecimalType(37,20)) AS (sat_sales1 / sat_sales2)#0]
         +- 'Join Inner, ((s_store_id1#0 = s_store_id2#0) && (d_week_seq1#0 = (d_week_seq2#0 - 52)))
            :- 'Project [s_store_name#0 AS s_store_name1#0, d_week_seq#0 AS d_week_seq1#0, s_store_id#0 AS s_store_id1#0, sun_sales#0 AS sun_sales1#0, mon_sales#0 AS mon_sales1#0, tue_sales#0 AS tue_sales1#0, wed_sales#0 AS wed_sales1#0, thu_sales#0 AS thu_sales1#0, fri_sales#0 AS fri_sales1#0, sat_sales#0 AS sat_sales1#0]
            :  +- 'Join Inner, (d_week_seq#0 = d_week_seq#0)
            :     :- 'Project [d_week_seq#0, sun_sales#0, mon_sales#0, tue_sales#0, wed_sales#0, thu_sales#0, fri_sales#0, sat_sales#0, s_store_id#0, s_store_name#0]
            :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
            :     :     :- 'Aggregate [d_week_seq#0, ss_store_sk#0], [d_week_seq#0, ss_store_sk#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Sunday) THEN ss_sales_price#0 ELSE null END)),17,2) AS sun_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Monday) THEN ss_sales_price#0 ELSE null END)),17,2) AS mon_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Tuesday) THEN ss_sales_price#0 ELSE null END)),17,2) AS tue_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Wednesday) THEN ss_sales_price#0 ELSE null END)),17,2) AS wed_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Thursday) THEN ss_sales_price#0 ELSE null END)),17,2) AS thu_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Friday) THEN ss_sales_price#0 ELSE null END)),17,2) AS fri_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Saturday) THEN ss_sales_price#0 ELSE null END)),17,2) AS sat_sales#0]
            :     :     :  +- 'Project [ss_store_sk#0, ss_sales_price#0, d_week_seq#0, d_day_name#0]
            :     :     :     +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
            :     :     :        :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_sales_price#0]
            :     :     :        :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0))
            :     :     :        :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :        +- Project [d_date_sk#0, d_week_seq#0, d_day_name#0]
            :     :     :           +- Filter (isnotnull(d_date_sk#0) && isnotnull(d_week_seq#0))
            :     :     :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     +- Project [s_store_sk#0, s_store_id#0, s_store_name#0]
            :     :        +- Filter (isnotnull(s_store_sk#0) && isnotnull(s_store_id#0))
            :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :     +- Project [d_week_seq#0]
            :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_week_seq#0))
            :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- 'Project [d_week_seq#0 AS d_week_seq2#0, s_store_id#0 AS s_store_id2#0, sun_sales#0 AS sun_sales2#0, mon_sales#0 AS mon_sales2#0, tue_sales#0 AS tue_sales2#0, wed_sales#0 AS wed_sales2#0, thu_sales#0 AS thu_sales2#0, fri_sales#0 AS fri_sales2#0, sat_sales#0 AS sat_sales2#0]
               +- 'Join Inner, (d_week_seq#0 = d_week_seq#0)
                  :- 'Project [d_week_seq#0, sun_sales#0, mon_sales#0, tue_sales#0, wed_sales#0, thu_sales#0, fri_sales#0, sat_sales#0, s_store_id#0]
                  :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                  :     :- 'Aggregate [d_week_seq#0, ss_store_sk#0], [d_week_seq#0, ss_store_sk#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Sunday) THEN ss_sales_price#0 ELSE null END)),17,2) AS sun_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Monday) THEN ss_sales_price#0 ELSE null END)),17,2) AS mon_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Tuesday) THEN ss_sales_price#0 ELSE null END)),17,2) AS tue_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Wednesday) THEN ss_sales_price#0 ELSE null END)),17,2) AS wed_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Thursday) THEN ss_sales_price#0 ELSE null END)),17,2) AS thu_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Friday) THEN ss_sales_price#0 ELSE null END)),17,2) AS fri_sales#0, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#0 = Saturday) THEN ss_sales_price#0 ELSE null END)),17,2) AS sat_sales#0]
                  :     :  +- 'Project [ss_store_sk#0, ss_sales_price#0, d_week_seq#0, d_day_name#0]
                  :     :     +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                  :     :        :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_sales_price#0]
                  :     :        :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0))
                  :     :        :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :     :        +- Project [d_date_sk#0, d_week_seq#0, d_day_name#0]
                  :     :           +- Filter (isnotnull(d_date_sk#0) && isnotnull(d_week_seq#0))
                  :     :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     +- Project [s_store_sk#0, s_store_id#0]
                  :        +- Filter (isnotnull(s_store_sk#0) && isnotnull(s_store_id#0))
                  :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                  +- Project [d_week_seq#0]
                     +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1224)) && (d_month_seq#0 <= 1235)) && isnotnull(d_week_seq#0))
                        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q60
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_item_id#0 ASC NULLS FIRST, total_sales#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_item_id#0], [i_item_id#0, sum(total_sales#0) AS total_sales#0]
         +- 'Union
            :- 'Aggregate [i_item_id#0], [i_item_id#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS total_sales#0]
            :  +- 'Project [ss_ext_sales_price#0, i_item_id#0]
            :     +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :        :- 'Project [ss_item_sk#0, ss_ext_sales_price#0]
            :        :  +- 'Join Inner, (ss_addr_sk#0 = ca_address_sk#0)
            :        :     :- 'Project [ss_item_sk#0, ss_addr_sk#0, ss_ext_sales_price#0]
            :        :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :        :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_addr_sk#0, ss_ext_sales_price#0]
            :        :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_addr_sk#0)) && isnotnull(ss_item_sk#0))
            :        :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :        :     :     +- Project [d_date_sk#0]
            :        :     :        +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 1998)) && (d_moy#0 = 9)) && isnotnull(d_date_sk#0))
            :        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :        :     +- Project [ca_address_sk#0]
            :        :        +- Filter ((isnotnull(ca_gmt_offset#0) && (ca_gmt_offset#0 = -5.00)) && isnotnull(ca_address_sk#0))
            :        :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
            :        +- 'Join LeftSemi, (i_item_id#0 = i_item_id#304#0)
            :           :- Project [i_item_sk#0, i_item_id#0]
            :           :  +- Filter isnotnull(i_item_id#0)
            :           :     +- Filter isnotnull(i_item_sk#0)
            :           :        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :           +- Project [i_item_id#0 AS i_item_id#304#0]
            :              +- Filter isnotnull(i_item_id#0)
            :                 +- Filter (isnotnull(i_category#0) && (i_category#0 = Music))
            :                    +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :- 'Aggregate [i_item_id#0], [i_item_id#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS total_sales#0]
            :  +- 'Project [cs_ext_sales_price#0, i_item_id#0]
            :     +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :        :- 'Project [cs_item_sk#0, cs_ext_sales_price#0]
            :        :  +- 'Join Inner, (cs_bill_addr_sk#0 = ca_address_sk#0)
            :        :     :- 'Project [cs_bill_addr_sk#0, cs_item_sk#0, cs_ext_sales_price#0]
            :        :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :        :     :     :- Project [cs_sold_date_sk#0, cs_bill_addr_sk#0, cs_item_sk#0, cs_ext_sales_price#0]
            :        :     :     :  +- Filter ((isnotnull(cs_sold_date_sk#0) && isnotnull(cs_bill_addr_sk#0)) && isnotnull(cs_item_sk#0))
            :        :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :        :     :     +- Project [d_date_sk#0]
            :        :     :        +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 1998)) && (d_moy#0 = 9)) && isnotnull(d_date_sk#0))
            :        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :        :     +- Project [ca_address_sk#0]
            :        :        +- Filter ((isnotnull(ca_gmt_offset#0) && (ca_gmt_offset#0 = -5.00)) && isnotnull(ca_address_sk#0))
            :        :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
            :        +- 'Join LeftSemi, (i_item_id#0 = i_item_id#304#0)
            :           :- Project [i_item_sk#0, i_item_id#0]
            :           :  +- Filter isnotnull(i_item_id#0)
            :           :     +- Filter isnotnull(i_item_sk#0)
            :           :        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :           +- Project [i_item_id#0 AS i_item_id#304#0]
            :              +- Filter isnotnull(i_item_id#0)
            :                 +- Filter (isnotnull(i_category#0) && (i_category#0 = Music))
            :                    +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            +- 'Aggregate [i_item_id#0], [i_item_id#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS total_sales#0]
               +- 'Project [ws_ext_sales_price#0, i_item_id#0]
                  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                     :- 'Project [ws_item_sk#0, ws_ext_sales_price#0]
                     :  +- 'Join Inner, (ws_bill_addr_sk#0 = ca_address_sk#0)
                     :     :- 'Project [ws_item_sk#0, ws_bill_addr_sk#0, ws_ext_sales_price#0]
                     :     :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                     :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_bill_addr_sk#0, ws_ext_sales_price#0]
                     :     :     :  +- Filter ((isnotnull(ws_sold_date_sk#0) && isnotnull(ws_bill_addr_sk#0)) && isnotnull(ws_item_sk#0))
                     :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                     :     :     +- Project [d_date_sk#0]
                     :     :        +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 1998)) && (d_moy#0 = 9)) && isnotnull(d_date_sk#0))
                     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :     +- Project [ca_address_sk#0]
                     :        +- Filter ((isnotnull(ca_gmt_offset#0) && (ca_gmt_offset#0 = -5.00)) && isnotnull(ca_address_sk#0))
                     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                     +- 'Join LeftSemi, (i_item_id#0 = i_item_id#304#0)
                        :- Project [i_item_sk#0, i_item_id#0]
                        :  +- Filter isnotnull(i_item_id#0)
                        :     +- Filter isnotnull(i_item_sk#0)
                        :        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        +- Project [i_item_id#0 AS i_item_id#304#0]
                           +- Filter isnotnull(i_item_id#0)
                              +- Filter (isnotnull(i_category#0) && (i_category#0 = Music))
                                 +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q61
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [promotions#0 ASC NULLS FIRST, total#0 ASC NULLS FIRST], true
      +- 'Project [promotions#0, total#0, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(promotions#0 as decimal(15,4))) / promote_precision(cast(total#0 as decimal(15,4)))), DecimalType(35,20))) * 100.00000000000000000000), DecimalType(38,19)) AS (CAST((CAST(CAST(promotions AS DECIMAL(15,4)) AS DECIMAL(15,4)) / CAST(CAST(total AS DECIMAL(15,4)) AS DECIMAL(15,4))) AS DECIMAL(35,20)) * CAST(CAST(100 AS DECIMAL(3,0)) AS DECIMAL(35,20)))#0]
         +- 'Join Inner
            :- 'Aggregate [MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS promotions#0]
            :  +- 'Project [ss_ext_sales_price#0]
            :     +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :        :- 'Project [ss_item_sk#0, ss_ext_sales_price#0]
            :        :  +- 'Join Inner, (ca_address_sk#0 = c_current_addr_sk#0)
            :        :     :- 'Project [ss_item_sk#0, ss_ext_sales_price#0, c_current_addr_sk#0]
            :        :     :  +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
            :        :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_ext_sales_price#0]
            :        :     :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :        :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_ext_sales_price#0]
            :        :     :     :     :  +- 'Join Inner, (ss_promo_sk#0 = p_promo_sk#0)
            :        :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_promo_sk#0, ss_ext_sales_price#0]
            :        :     :     :     :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
            :        :     :     :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ext_sales_price#0]
            :        :     :     :     :     :     :  +- Filter ((((isnotnull(ss_store_sk#0) && isnotnull(ss_promo_sk#0)) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_customer_sk#0)) && isnotnull(ss_item_sk#0))
            :        :     :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :        :     :     :     :     :     +- Project [s_store_sk#0]
            :        :     :     :     :     :        +- Filter ((isnotnull(s_gmt_offset#0) && (s_gmt_offset#0 = -5.00)) && isnotnull(s_store_sk#0))
            :        :     :     :     :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :        :     :     :     :     +- Project [p_promo_sk#0]
            :        :     :     :     :        +- Filter ((((p_channel_dmail#0 = Y) || (p_channel_email#0 = Y)) || (p_channel_tv#0 = Y)) && isnotnull(p_promo_sk#0))
            :        :     :     :     :           +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
            :        :     :     :     +- Project [d_date_sk#0]
            :        :     :     :        +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 1998)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
            :        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :        :     :     +- Project [c_customer_sk#0, c_current_addr_sk#0]
            :        :     :        +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_current_addr_sk#0))
            :        :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :        :     +- Project [ca_address_sk#0]
            :        :        +- Filter ((isnotnull(ca_gmt_offset#0) && (ca_gmt_offset#0 = -5.00)) && isnotnull(ca_address_sk#0))
            :        :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
            :        +- Project [i_item_sk#0]
            :           +- Filter ((isnotnull(i_category#0) && (i_category#0 = Jewelry)) && isnotnull(i_item_sk#0))
            :              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            +- 'Aggregate [MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS total#0]
               +- 'Project [ss_ext_sales_price#0]
                  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                     :- 'Project [ss_item_sk#0, ss_ext_sales_price#0]
                     :  +- 'Join Inner, (ca_address_sk#0 = c_current_addr_sk#0)
                     :     :- 'Project [ss_item_sk#0, ss_ext_sales_price#0, c_current_addr_sk#0]
                     :     :  +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
                     :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_ext_sales_price#0]
                     :     :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_ext_sales_price#0]
                     :     :     :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                     :     :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_ext_sales_price#0]
                     :     :     :     :     :  +- Filter (((isnotnull(ss_store_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_customer_sk#0)) && isnotnull(ss_item_sk#0))
                     :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                     :     :     :     :     +- Project [s_store_sk#0]
                     :     :     :     :        +- Filter ((isnotnull(s_gmt_offset#0) && (s_gmt_offset#0 = -5.00)) && isnotnull(s_store_sk#0))
                     :     :     :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                     :     :     :     +- Project [d_date_sk#0]
                     :     :     :        +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 1998)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
                     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :     :     +- Project [c_customer_sk#0, c_current_addr_sk#0]
                     :     :        +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_current_addr_sk#0))
                     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                     :     +- Project [ca_address_sk#0]
                     :        +- Filter ((isnotnull(ca_gmt_offset#0) && (ca_gmt_offset#0 = -5.00)) && isnotnull(ca_address_sk#0))
                     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                     +- Project [i_item_sk#0]
                        +- Filter ((isnotnull(i_category#0) && (i_category#0 = Jewelry)) && isnotnull(i_item_sk#0))
                           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q62
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [substring(w_warehouse_name, 1, 20)#0 ASC NULLS FIRST, sm_type#0 ASC NULLS FIRST, web_name#0 ASC NULLS FIRST], true
      +- 'Aggregate [substring(w_warehouse_name#0, 1, 20), sm_type#0, web_name#0], [substring(w_warehouse_name#0, 1, 20) AS substring(w_warehouse_name, 1, 20)#0, sm_type#0, web_name#0, sum(cast(CASE WHEN ((ws_ship_date_sk#0 - ws_sold_date_sk#0) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days #0L, sum(cast(CASE WHEN (((ws_ship_date_sk#0 - ws_sold_date_sk#0) > 30) && ((ws_ship_date_sk#0 - ws_sold_date_sk#0) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31 - 60 days #0L, sum(cast(CASE WHEN (((ws_ship_date_sk#0 - ws_sold_date_sk#0) > 60) && ((ws_ship_date_sk#0 - ws_sold_date_sk#0) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61 - 90 days #0L, sum(cast(CASE WHEN (((ws_ship_date_sk#0 - ws_sold_date_sk#0) > 90) && ((ws_ship_date_sk#0 - ws_sold_date_sk#0) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91 - 120 days #0L, sum(cast(CASE WHEN ((ws_ship_date_sk#0 - ws_sold_date_sk#0) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days #0L]
         +- 'Project [ws_sold_date_sk#0, ws_ship_date_sk#0, w_warehouse_name#0, sm_type#0, web_name#0]
            +- 'Join Inner, (ws_ship_date_sk#0 = d_date_sk#0)
               :- 'Project [ws_sold_date_sk#0, ws_ship_date_sk#0, w_warehouse_name#0, sm_type#0, web_name#0]
               :  +- 'Join Inner, (ws_web_site_sk#0 = web_site_sk#0)
               :     :- 'Project [ws_sold_date_sk#0, ws_ship_date_sk#0, ws_web_site_sk#0, w_warehouse_name#0, sm_type#0]
               :     :  +- 'Join Inner, (ws_ship_mode_sk#0 = sm_ship_mode_sk#0)
               :     :     :- 'Project [ws_sold_date_sk#0, ws_ship_date_sk#0, ws_web_site_sk#0, ws_ship_mode_sk#0, w_warehouse_name#0]
               :     :     :  +- 'Join Inner, (ws_warehouse_sk#0 = w_warehouse_sk#0)
               :     :     :     :- Project [ws_sold_date_sk#0, ws_ship_date_sk#0, ws_web_site_sk#0, ws_ship_mode_sk#0, ws_warehouse_sk#0]
               :     :     :     :  +- Filter (((isnotnull(ws_warehouse_sk#0) && isnotnull(ws_ship_mode_sk#0)) && isnotnull(ws_web_site_sk#0)) && isnotnull(ws_ship_date_sk#0))
               :     :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :     :     +- Project [w_warehouse_sk#0, w_warehouse_name#0]
               :     :     :        +- Filter isnotnull(w_warehouse_sk#0)
               :     :     :           +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
               :     :     +- Project [sm_ship_mode_sk#0, sm_type#0]
               :     :        +- Filter isnotnull(sm_ship_mode_sk#0)
               :     :           +- Relation[sm_ship_mode_sk#0,sm_ship_mode_id#0,sm_type#0,sm_code#0,sm_carrier#0,sm_contract#0] parquet
               :     +- Project [web_site_sk#0, web_name#0]
               :        +- Filter isnotnull(web_site_sk#0)
               :           +- Relation[web_site_sk#0,web_site_id#0,web_rec_start_date#0,web_rec_end_date#0,web_name#0,web_open_date_sk#0,web_close_date_sk#0,web_class#0,web_manager#0,web_mkt_id#0,web_mkt_class#0,web_mkt_desc#0,web_market_manager#0,web_company_id#0,web_company_name#0,web_street_number#0,web_street_name#0,web_street_type#0,web_suite_number#0,web_city#0,web_county#0,web_state#0,web_zip#0,web_country#0,... 2 more fields] parquet
               +- Project [d_date_sk#0]
                  +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
                     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q63
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_manager_id#0 ASC NULLS FIRST, avg_monthly_sales#0 ASC NULLS FIRST, sum_sales#0 ASC NULLS FIRST], true
      +- 'Project [i_manager_id#0, sum_sales#0, avg_monthly_sales#0]
         +- 'Filter (CASE WHEN (avg_monthly_sales#0 > 0.000000) THEN CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#0 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(22,6)))) / promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(38,16)) ELSE null END > 0.1000000000000000)
            +- 'Window [avg(_w0#0) windowspecdefinition(i_manager_id#0, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#0], [i_manager_id#0]
               +- 'Aggregate [i_manager_id#0, d_moy#0], [i_manager_id#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS sum_sales#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS _w0#0]
                  +- 'Project [i_manager_id#0, ss_sales_price#0, d_moy#0]
                     +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                        :- 'Project [i_manager_id#0, ss_store_sk#0, ss_sales_price#0, d_moy#0]
                        :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                        :     :- 'Project [i_manager_id#0, ss_sold_date_sk#0, ss_store_sk#0, ss_sales_price#0]
                        :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                        :     :     :- Project [i_item_sk#0, i_manager_id#0]
                        :     :     :  +- Filter ((((i_category#0 IN (Books,Children,Electronics) && i_class#0 IN (personal,portable,refernece,self-help)) && i_brand#0 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#0 IN (Women,Music,Men) && i_class#0 IN (accessories,classical,fragrances,pants)) && i_brand#0 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1))) && isnotnull(i_item_sk#0))
                        :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :     :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_sales_price#0]
                        :     :        +- Filter ((isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0))
                        :     :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        :     +- Project [d_date_sk#0, d_moy#0]
                        :        +- Filter (d_month_seq#0 INSET (1200,1211,1205,1201,1206,1210,1207,1202,1209,1203,1208,1204) && isnotnull(d_date_sk#0))
                        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        +- Project [s_store_sk#0]
                           +- Filter isnotnull(s_store_sk#0)
                              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet


================================================================================================
q64
================================================================================================

'Sort [product_name#0 ASC NULLS FIRST, store_name#0 ASC NULLS FIRST, cnt#0L ASC NULLS FIRST], true
+- 'Project [product_name#0, store_name#0, store_zip#0, b_street_number#0, b_streen_name#0, b_city#0, b_zip#0, c_street_number#0, c_street_name#0, c_city#0, c_zip#0, syear#0, cnt#0L, s1#0, s2#0, s3#0, s1#0, s2#0, s3#0, syear#0, cnt#0L]
   +- 'Join Inner, ((((item_sk#0 = item_sk#0) && (cnt#0L <= cnt#0L)) && (store_name#0 = store_name#0)) && (store_zip#0 = store_zip#0))
      :- 'Aggregate [i_product_name#0, i_item_sk#0, s_store_name#0, s_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, d_year#0, d_year#0, d_year#0], [i_product_name#0 AS product_name#0, i_item_sk#0 AS item_sk#0, s_store_name#0 AS store_name#0, s_zip#0 AS store_zip#0, ca_street_number#0 AS b_street_number#0, ca_street_name#0 AS b_streen_name#0, ca_city#0 AS b_city#0, ca_zip#0 AS b_zip#0, ca_street_number#0 AS c_street_number#0, ca_street_name#0 AS c_street_name#0, ca_city#0 AS c_city#0, ca_zip#0 AS c_zip#0, d_year#0 AS syear#0, count(1) AS cnt#0L, MakeDecimal(sum(UnscaledValue(ss_wholesale_cost#0)),17,2) AS s1#0, MakeDecimal(sum(UnscaledValue(ss_list_price#0)),17,2) AS s2#0, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#0)),17,2) AS s3#0]
      :  +- 'Project [ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, i_item_sk#0, i_product_name#0]
      :     +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
      :        :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
      :        :  +- 'Join Inner, (hd_income_band_sk#0 = ib_income_band_sk#0)
      :        :     :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, hd_income_band_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
      :        :     :  +- 'Join Inner, (hd_income_band_sk#0 = ib_income_band_sk#0)
      :        :     :     :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, hd_income_band_sk#0, hd_income_band_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
      :        :     :     :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
      :        :     :     :     :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_addr_sk#0, d_year#0, d_year#0, hd_income_band_sk#0, hd_income_band_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
      :        :     :     :     :  +- 'Join Inner, (ss_addr_sk#0 = ca_address_sk#0)
      :        :     :     :     :     :- 'Project [ss_item_sk#0, ss_addr_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_addr_sk#0, d_year#0, d_year#0, hd_income_band_sk#0, hd_income_band_sk#0]
      :        :     :     :     :     :  +- 'Join Inner, (c_current_hdemo_sk#0 = hd_demo_sk#0)
      :        :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_addr_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0, hd_income_band_sk#0]
      :        :     :     :     :     :     :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
      :        :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0]
      :        :     :     :     :     :     :     :  +- 'Join Inner, (ss_promo_sk#0 = p_promo_sk#0)
      :        :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0]
      :        :     :     :     :     :     :     :     :  +- 'Join Inner, ((c_current_cdemo_sk#0 = cd_demo_sk#0) && NOT (cd_marital_status#0 = cd_marital_status#0))
      :        :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0, cd_marital_status#0]
      :        :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_cdemo_sk#0 = cd_demo_sk#0)
      :        :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0]
      :        :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (c_first_shipto_date_sk#0 = d_date_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, c_first_shipto_date_sk#0, d_year#0]
      :        :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (c_first_sales_date_sk#0 = d_date_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, c_first_shipto_date_sk#0, c_first_sales_date_sk#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_item_sk#0 = cs_item_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, ((cast(ss_item_sk#0 as bigint) = sr_item_sk#0L) && (cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ticket_number#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter ((((((((isnotnull(ss_item_sk#0) && isnotnull(ss_ticket_number#0)) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_customer_sk#0)) && isnotnull(ss_cdemo_sk#0)) && isnotnull(ss_promo_sk#0)) && isnotnull(ss_hdemo_sk#0)) && isnotnull(ss_addr_sk#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#0L, sr_ticket_number#0L]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#0L) && isnotnull(sr_ticket_number#0L))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- 'Project [cs_item_sk#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- 'Filter (isnotnull(sum(cs_ext_list_price#190)#0) && (cast(sum(cs_ext_list_price#190)#0 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#512 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#513 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#514 as decimal(9,2)))), DecimalType(9,2)))#0)), DecimalType(21,2))))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- 'Aggregate [cs_item_sk#0], [cs_item_sk#0, MakeDecimal(sum(UnscaledValue(cs_ext_list_price#0)),17,2) AS sum(cs_ext_list_price#190)#0, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#0 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#0 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#0 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#512 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#513 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#514 as decimal(9,2)))), DecimalType(9,2)))#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- 'Project [cs_item_sk#0, cs_ext_list_price#0, cr_refunded_cash#0, cr_reversed_charge#0, cr_store_credit#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- 'Join Inner, ((cs_item_sk#0 = cr_item_sk#0) && (cs_order_number#0 = cr_order_number#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#0, cs_order_number#0, cs_ext_list_price#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_order_number#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#0, cr_order_number#0, cr_refunded_cash#0, cr_reversed_charge#0, cr_store_credit#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#0, d_year#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 1999)) && isnotnull(d_date_sk#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#0, s_store_name#0, s_zip#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#0) && isnotnull(s_zip#0)) && isnotnull(s_store_name#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, c_first_shipto_date_sk#0, c_first_sales_date_sk#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#0) && isnotnull(c_first_sales_date_sk#0)) && isnotnull(c_first_shipto_date_sk#0)) && isnotnull(c_current_cdemo_sk#0)) && isnotnull(c_current_hdemo_sk#0)) && isnotnull(c_current_addr_sk#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#0, d_year#0]
      :        :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#0, d_year#0]
      :        :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#0)
      :        :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#0, cd_marital_status#0]
      :        :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#0) && isnotnull(cd_marital_status#0))
      :        :     :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
      :        :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#0, cd_marital_status#0]
      :        :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_marital_status#0) && isnotnull(cd_demo_sk#0))
      :        :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
      :        :     :     :     :     :     :     :     +- Project [p_promo_sk#0]
      :        :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#0)
      :        :     :     :     :     :     :     :           +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
      :        :     :     :     :     :     :     +- Project [hd_demo_sk#0, hd_income_band_sk#0]
      :        :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#0) && isnotnull(hd_income_band_sk#0))
      :        :     :     :     :     :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
      :        :     :     :     :     :     +- Project [hd_demo_sk#0, hd_income_band_sk#0]
      :        :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#0) && isnotnull(hd_income_band_sk#0))
      :        :     :     :     :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
      :        :     :     :     :     +- Project [ca_address_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
      :        :     :     :     :        +- Filter isnotnull(ca_address_sk#0)
      :        :     :     :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
      :        :     :     :     +- Project [ca_address_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
      :        :     :     :        +- Filter isnotnull(ca_address_sk#0)
      :        :     :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
      :        :     :     +- Project [ib_income_band_sk#0]
      :        :     :        +- Filter isnotnull(ib_income_band_sk#0)
      :        :     :           +- Relation[ib_income_band_sk#0,ib_lower_bound#0,ib_upper_bound#0] parquet
      :        :     +- Project [ib_income_band_sk#0]
      :        :        +- Filter isnotnull(ib_income_band_sk#0)
      :        :           +- Relation[ib_income_band_sk#0,ib_lower_bound#0,ib_upper_bound#0] parquet
      :        +- Project [i_item_sk#0, i_product_name#0]
      :           +- Filter ((((((isnotnull(i_current_price#0) && i_color#0 IN (purple,burlywood,indian,spring,floral,medium)) && (i_current_price#0 >= 64.00)) && (cast(i_current_price#0 as decimal(12,2)) <= 74.00)) && (cast(i_current_price#0 as decimal(12,2)) >= 65.00)) && (cast(i_current_price#0 as decimal(12,2)) <= 79.00)) && isnotnull(i_item_sk#0))
      :              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
      +- 'Aggregate [i_product_name#0, i_item_sk#0, s_store_name#0, s_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, d_year#0, d_year#0, d_year#0], [i_item_sk#0 AS item_sk#0, s_store_name#0 AS store_name#0, s_zip#0 AS store_zip#0, d_year#0 AS syear#0, count(1) AS cnt#0L, MakeDecimal(sum(UnscaledValue(ss_wholesale_cost#0)),17,2) AS s1#0, MakeDecimal(sum(UnscaledValue(ss_list_price#0)),17,2) AS s2#0, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#0)),17,2) AS s3#0]
         +- 'Project [ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, i_item_sk#0, i_product_name#0]
            +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
               :  +- 'Join Inner, (hd_income_band_sk#0 = ib_income_band_sk#0)
               :     :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, hd_income_band_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
               :     :  +- 'Join Inner, (hd_income_band_sk#0 = ib_income_band_sk#0)
               :     :     :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, hd_income_band_sk#0, hd_income_band_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
               :     :     :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
               :     :     :     :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_addr_sk#0, d_year#0, d_year#0, hd_income_band_sk#0, hd_income_band_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
               :     :     :     :  +- 'Join Inner, (ss_addr_sk#0 = ca_address_sk#0)
               :     :     :     :     :- 'Project [ss_item_sk#0, ss_addr_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_addr_sk#0, d_year#0, d_year#0, hd_income_band_sk#0, hd_income_band_sk#0]
               :     :     :     :     :  +- 'Join Inner, (c_current_hdemo_sk#0 = hd_demo_sk#0)
               :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_addr_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0, hd_income_band_sk#0]
               :     :     :     :     :     :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
               :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0]
               :     :     :     :     :     :     :  +- 'Join Inner, (ss_promo_sk#0 = p_promo_sk#0)
               :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0]
               :     :     :     :     :     :     :     :  +- 'Join Inner, ((c_current_cdemo_sk#0 = cd_demo_sk#0) && NOT (cd_marital_status#0 = cd_marital_status#0))
               :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0, cd_marital_status#0]
               :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_cdemo_sk#0 = cd_demo_sk#0)
               :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0]
               :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (c_first_shipto_date_sk#0 = d_date_sk#0)
               :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, c_first_shipto_date_sk#0, d_year#0]
               :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (c_first_sales_date_sk#0 = d_date_sk#0)
               :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, c_first_shipto_date_sk#0, c_first_sales_date_sk#0]
               :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
               :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_item_sk#0 = cs_item_sk#0)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, ((cast(ss_item_sk#0 as bigint) = sr_item_sk#0L) && (cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ticket_number#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter ((((((((isnotnull(ss_item_sk#0) && isnotnull(ss_ticket_number#0)) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_customer_sk#0)) && isnotnull(ss_cdemo_sk#0)) && isnotnull(ss_promo_sk#0)) && isnotnull(ss_hdemo_sk#0)) && isnotnull(ss_addr_sk#0))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#0L, sr_ticket_number#0L]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#0L) && isnotnull(sr_ticket_number#0L))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- 'Project [cs_item_sk#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- 'Filter (isnotnull(sum(cs_ext_list_price#190)#0) && (cast(sum(cs_ext_list_price#190)#0 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#512 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#513 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#514 as decimal(9,2)))), DecimalType(9,2)))#0)), DecimalType(21,2))))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- 'Aggregate [cs_item_sk#0], [cs_item_sk#0, MakeDecimal(sum(UnscaledValue(cs_ext_list_price#0)),17,2) AS sum(cs_ext_list_price#190)#0, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#0 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#0 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#0 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#512 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#513 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#514 as decimal(9,2)))), DecimalType(9,2)))#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- 'Project [cs_item_sk#0, cs_ext_list_price#0, cr_refunded_cash#0, cr_reversed_charge#0, cr_store_credit#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- 'Join Inner, ((cs_item_sk#0 = cr_item_sk#0) && (cs_order_number#0 = cr_order_number#0))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#0, cs_order_number#0, cs_ext_list_price#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_order_number#0))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#0, cr_order_number#0, cr_refunded_cash#0, cr_reversed_charge#0, cr_store_credit#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#0, d_year#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#0, s_store_name#0, s_zip#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#0) && isnotnull(s_zip#0)) && isnotnull(s_store_name#0))
               :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, c_first_shipto_date_sk#0, c_first_sales_date_sk#0]
               :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#0) && isnotnull(c_first_sales_date_sk#0)) && isnotnull(c_first_shipto_date_sk#0)) && isnotnull(c_current_cdemo_sk#0)) && isnotnull(c_current_hdemo_sk#0)) && isnotnull(c_current_addr_sk#0))
               :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
               :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#0, d_year#0]
               :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#0)
               :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#0, d_year#0]
               :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#0)
               :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#0, cd_marital_status#0]
               :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#0) && isnotnull(cd_marital_status#0))
               :     :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
               :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#0, cd_marital_status#0]
               :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_marital_status#0) && isnotnull(cd_demo_sk#0))
               :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
               :     :     :     :     :     :     :     +- Project [p_promo_sk#0]
               :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#0)
               :     :     :     :     :     :     :           +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
               :     :     :     :     :     :     +- Project [hd_demo_sk#0, hd_income_band_sk#0]
               :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#0) && isnotnull(hd_income_band_sk#0))
               :     :     :     :     :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
               :     :     :     :     :     +- Project [hd_demo_sk#0, hd_income_band_sk#0]
               :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#0) && isnotnull(hd_income_band_sk#0))
               :     :     :     :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
               :     :     :     :     +- Project [ca_address_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
               :     :     :     :        +- Filter isnotnull(ca_address_sk#0)
               :     :     :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               :     :     :     +- Project [ca_address_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
               :     :     :        +- Filter isnotnull(ca_address_sk#0)
               :     :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               :     :     +- Project [ib_income_band_sk#0]
               :     :        +- Filter isnotnull(ib_income_band_sk#0)
               :     :           +- Relation[ib_income_band_sk#0,ib_lower_bound#0,ib_upper_bound#0] parquet
               :     +- Project [ib_income_band_sk#0]
               :        +- Filter isnotnull(ib_income_band_sk#0)
               :           +- Relation[ib_income_band_sk#0,ib_lower_bound#0,ib_upper_bound#0] parquet
               +- Project [i_item_sk#0, i_product_name#0]
                  +- Filter ((((((isnotnull(i_current_price#0) && i_color#0 IN (purple,burlywood,indian,spring,floral,medium)) && (i_current_price#0 >= 64.00)) && (cast(i_current_price#0 as decimal(12,2)) <= 74.00)) && (cast(i_current_price#0 as decimal(12,2)) >= 65.00)) && (cast(i_current_price#0 as decimal(12,2)) <= 79.00)) && isnotnull(i_item_sk#0))
                     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q65
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [s_store_name#0 ASC NULLS FIRST, i_item_desc#0 ASC NULLS FIRST], true
      +- 'Project [s_store_name#0, i_item_desc#0, revenue#0, i_current_price#0, i_wholesale_cost#0, i_brand#0]
         +- 'Join Inner, ((ss_store_sk#0 = ss_store_sk#0) && (cast(revenue#0 as decimal(23,7)) <= CheckOverflow((0.100000 * promote_precision(ave#0)), DecimalType(23,7))))
            :- 'Project [s_store_name#0, ss_store_sk#0, revenue#0, i_item_desc#0, i_current_price#0, i_wholesale_cost#0, i_brand#0]
            :  +- 'Join Inner, (i_item_sk#0 = ss_item_sk#0)
            :     :- 'Project [s_store_name#0, ss_store_sk#0, ss_item_sk#0, revenue#0]
            :     :  +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
            :     :     :- Project [s_store_sk#0, s_store_name#0]
            :     :     :  +- Filter isnotnull(s_store_sk#0)
            :     :     :     +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :     :     +- 'Filter isnotnull(revenue#0)
            :     :        +- 'Aggregate [ss_store_sk#0, ss_item_sk#0], [ss_store_sk#0, ss_item_sk#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS revenue#0]
            :     :           +- 'Project [ss_item_sk#0, ss_store_sk#0, ss_sales_price#0]
            :     :              +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :                 :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_sales_price#0]
            :     :                 :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
            :     :                 :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :                 +- Project [d_date_sk#0]
            :     :                    +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1176)) && (d_month_seq#0 <= 1187)) && isnotnull(d_date_sk#0))
            :     :                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     +- Project [i_item_sk#0, i_item_desc#0, i_current_price#0, i_wholesale_cost#0, i_brand#0]
            :        +- Filter isnotnull(i_item_sk#0)
            :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            +- 'Aggregate [ss_store_sk#0], [ss_store_sk#0, avg(revenue#0) AS ave#0]
               +- 'Aggregate [ss_store_sk#0, ss_item_sk#0], [ss_store_sk#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS revenue#0]
                  +- 'Project [ss_item_sk#0, ss_store_sk#0, ss_sales_price#0]
                     +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                        :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_sales_price#0]
                        :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0))
                        :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        +- Project [d_date_sk#0]
                           +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1176)) && (d_month_seq#0 <= 1187)) && isnotnull(d_date_sk#0))
                              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q66
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [w_warehouse_name#0 ASC NULLS FIRST], true
      +- 'Aggregate [w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0, ship_carriers#0, year#0], [w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0, ship_carriers#0, year#0, sum(jan_sales#0) AS jan_sales#0, sum(feb_sales#0) AS feb_sales#0, sum(mar_sales#0) AS mar_sales#0, sum(apr_sales#0) AS apr_sales#0, sum(may_sales#0) AS may_sales#0, sum(jun_sales#0) AS jun_sales#0, sum(jul_sales#0) AS jul_sales#0, sum(aug_sales#0) AS aug_sales#0, sum(sep_sales#0) AS sep_sales#0, sum(oct_sales#0) AS oct_sales#0, sum(nov_sales#0) AS nov_sales#0, sum(dec_sales#0) AS dec_sales#0, sum(CheckOverflow((promote_precision(jan_sales#0) / promote_precision(cast(cast(w_warehouse_sq_ft#0 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS jan_sales_per_sq_foot#0, sum(CheckOverflow((promote_precision(feb_sales#0) / promote_precision(cast(cast(w_warehouse_sq_ft#0 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS feb_sales_per_sq_foot#0, sum(CheckOverflow((promote_precision(mar_sales#0) / promote_precision(cast(cast(w_warehouse_sq_ft#0 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS mar_sales_per_sq_foot#0, sum(CheckOverflow((promote_precision(apr_sales#0) / promote_precision(cast(cast(w_warehouse_sq_ft#0 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS apr_sales_per_sq_foot#0, ... 20 more fields]
         +- 'Union
            :- 'Aggregate [w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0, d_year#0], [w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0, DHL,BARIAN AS ship_carriers#0, d_year#0 AS year#0, sum(CASE WHEN (d_moy#0 = 1) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jan_sales#0, sum(CASE WHEN (d_moy#0 = 2) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS feb_sales#0, sum(CASE WHEN (d_moy#0 = 3) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS mar_sales#0, sum(CASE WHEN (d_moy#0 = 4) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS apr_sales#0, sum(CASE WHEN (d_moy#0 = 5) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS may_sales#0, sum(CASE WHEN (d_moy#0 = 6) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jun_sales#0, sum(CASE WHEN (d_moy#0 = 7) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jul_sales#0, sum(CASE WHEN (d_moy#0 = 8) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS aug_sales#0, sum(CASE WHEN (d_moy#0 = 9) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS sep_sales#0, sum(CASE WHEN (d_moy#0 = 10) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS oct_sales#0, sum(CASE WHEN (d_moy#0 = 11) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS nov_sales#0, sum(CASE WHEN (d_moy#0 = 12) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS dec_sales#0, sum(CASE WHEN (d_moy#0 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jan_net#0, sum(CASE WHEN (d_moy#0 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS feb_net#0, sum(CASE WHEN (d_moy#0 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS mar_net#0, sum(CASE WHEN (d_moy#0 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid#0 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS apr_net#0, ... 8 more fields]
            :  +- 'Project [ws_quantity#0, ws_ext_sales_price#0, ws_net_paid#0, w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0, d_year#0, d_moy#0]
            :     +- 'Join Inner, (ws_ship_mode_sk#0 = sm_ship_mode_sk#0)
            :        :- 'Project [ws_ship_mode_sk#0, ws_quantity#0, ws_ext_sales_price#0, ws_net_paid#0, w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0, d_year#0, d_moy#0]
            :        :  +- 'Join Inner, (ws_sold_time_sk#0 = t_time_sk#0)
            :        :     :- 'Project [ws_sold_time_sk#0, ws_ship_mode_sk#0, ws_quantity#0, ws_ext_sales_price#0, ws_net_paid#0, w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0, d_year#0, d_moy#0]
            :        :     :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :        :     :     :- 'Project [ws_sold_date_sk#0, ws_sold_time_sk#0, ws_ship_mode_sk#0, ws_quantity#0, ws_ext_sales_price#0, ws_net_paid#0, w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0]
            :        :     :     :  +- 'Join Inner, (ws_warehouse_sk#0 = w_warehouse_sk#0)
            :        :     :     :     :- Project [ws_sold_date_sk#0, ws_sold_time_sk#0, ws_ship_mode_sk#0, ws_warehouse_sk#0, ws_quantity#0, ws_ext_sales_price#0, ws_net_paid#0]
            :        :     :     :     :  +- Filter (((isnotnull(ws_warehouse_sk#0) && isnotnull(ws_sold_date_sk#0)) && isnotnull(ws_sold_time_sk#0)) && isnotnull(ws_ship_mode_sk#0))
            :        :     :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :        :     :     :     +- Project [w_warehouse_sk#0, w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0]
            :        :     :     :        +- Filter isnotnull(w_warehouse_sk#0)
            :        :     :     :           +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
            :        :     :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
            :        :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
            :        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :        :     +- Project [t_time_sk#0]
            :        :        +- Filter (((isnotnull(t_time#0) && (t_time#0 >= 30838)) && (t_time#0 <= 59638)) && isnotnull(t_time_sk#0))
            :        :           +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet
            :        +- Project [sm_ship_mode_sk#0]
            :           +- Filter (sm_carrier#0 IN (DHL,BARIAN) && isnotnull(sm_ship_mode_sk#0))
            :              +- Relation[sm_ship_mode_sk#0,sm_ship_mode_id#0,sm_type#0,sm_code#0,sm_carrier#0,sm_contract#0] parquet
            +- 'Aggregate [w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0, d_year#0], [w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0, DHL,BARIAN AS ship_carriers#0, d_year#0 AS year#0, sum(CASE WHEN (d_moy#0 = 1) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jan_sales#0, sum(CASE WHEN (d_moy#0 = 2) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS feb_sales#0, sum(CASE WHEN (d_moy#0 = 3) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS mar_sales#0, sum(CASE WHEN (d_moy#0 = 4) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS apr_sales#0, sum(CASE WHEN (d_moy#0 = 5) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS may_sales#0, sum(CASE WHEN (d_moy#0 = 6) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jun_sales#0, sum(CASE WHEN (d_moy#0 = 7) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jul_sales#0, sum(CASE WHEN (d_moy#0 = 8) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS aug_sales#0, sum(CASE WHEN (d_moy#0 = 9) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS sep_sales#0, sum(CASE WHEN (d_moy#0 = 10) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS oct_sales#0, sum(CASE WHEN (d_moy#0 = 11) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS nov_sales#0, sum(CASE WHEN (d_moy#0 = 12) THEN CheckOverflow((promote_precision(cast(cs_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS dec_sales#0, sum(CASE WHEN (d_moy#0 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jan_net#0, sum(CASE WHEN (d_moy#0 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS feb_net#0, sum(CASE WHEN (d_moy#0 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS mar_net#0, sum(CASE WHEN (d_moy#0 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#0 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS apr_net#0, ... 8 more fields]
               +- 'Project [cs_quantity#0, cs_sales_price#0, cs_net_paid_inc_tax#0, w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0, d_year#0, d_moy#0]
                  +- 'Join Inner, (cs_ship_mode_sk#0 = sm_ship_mode_sk#0)
                     :- 'Project [cs_ship_mode_sk#0, cs_quantity#0, cs_sales_price#0, cs_net_paid_inc_tax#0, w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0, d_year#0, d_moy#0]
                     :  +- 'Join Inner, (cs_sold_time_sk#0 = t_time_sk#0)
                     :     :- 'Project [cs_sold_time_sk#0, cs_ship_mode_sk#0, cs_quantity#0, cs_sales_price#0, cs_net_paid_inc_tax#0, w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0, d_year#0, d_moy#0]
                     :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                     :     :     :- 'Project [cs_sold_date_sk#0, cs_sold_time_sk#0, cs_ship_mode_sk#0, cs_quantity#0, cs_sales_price#0, cs_net_paid_inc_tax#0, w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0]
                     :     :     :  +- 'Join Inner, (cs_warehouse_sk#0 = w_warehouse_sk#0)
                     :     :     :     :- Project [cs_sold_date_sk#0, cs_sold_time_sk#0, cs_ship_mode_sk#0, cs_warehouse_sk#0, cs_quantity#0, cs_sales_price#0, cs_net_paid_inc_tax#0]
                     :     :     :     :  +- Filter (((isnotnull(cs_warehouse_sk#0) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_sold_time_sk#0)) && isnotnull(cs_ship_mode_sk#0))
                     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                     :     :     :     +- Project [w_warehouse_sk#0, w_warehouse_name#0, w_warehouse_sq_ft#0, w_city#0, w_county#0, w_state#0, w_country#0]
                     :     :     :        +- Filter isnotnull(w_warehouse_sk#0)
                     :     :     :           +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
                     :     :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
                     :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :     +- Project [t_time_sk#0]
                     :        +- Filter (((isnotnull(t_time#0) && (t_time#0 >= 30838)) && (t_time#0 <= 59638)) && isnotnull(t_time_sk#0))
                     :           +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet
                     +- Project [sm_ship_mode_sk#0]
                        +- Filter (sm_carrier#0 IN (DHL,BARIAN) && isnotnull(sm_ship_mode_sk#0))
                           +- Relation[sm_ship_mode_sk#0,sm_ship_mode_id#0,sm_type#0,sm_code#0,sm_carrier#0,sm_contract#0] parquet


================================================================================================
q67
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_category#0 ASC NULLS FIRST, i_class#0 ASC NULLS FIRST, i_brand#0 ASC NULLS FIRST, i_product_name#0 ASC NULLS FIRST, d_year#0 ASC NULLS FIRST, d_qoy#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, s_store_id#0 ASC NULLS FIRST, sumsales#0 ASC NULLS FIRST, rk#0 ASC NULLS FIRST], true
      +- 'Filter (isnotnull(rk#0) && (rk#0 <= 100))
         +- 'Window [rank(sumsales#0) windowspecdefinition(i_category#0, sumsales#0 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#0], [i_category#0], [sumsales#0 DESC NULLS LAST]
            +- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0, spark_grouping_id#0], [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), 0.00)) AS sumsales#0]
               +- 'Expand [List(ss_quantity#0, ss_sales_price#0, i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0, 0), List(ss_quantity#0, ss_sales_price#0, i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, null, 1), List(ss_quantity#0, ss_sales_price#0, i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, null, null, 3), List(ss_quantity#0, ss_sales_price#0, i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, null, null, null, 7), List(ss_quantity#0, ss_sales_price#0, i_category#0, i_class#0, i_brand#0, i_product_name#0, null, null, null, null, 15), List(ss_quantity#0, ss_sales_price#0, i_category#0, i_class#0, i_brand#0, null, null, null, null, null, 31), List(ss_quantity#0, ss_sales_price#0, i_category#0, i_class#0, null, null, null, null, null, null, 63), List(ss_quantity#0, ss_sales_price#0, i_category#0, null, null, null, null, null, null, null, 127), List(ss_quantity#0, ss_sales_price#0, null, null, null, null, null, null, null, null, 255)], [ss_quantity#0, ss_sales_price#0, i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0, spark_grouping_id#0]
                  +- 'Project [ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0, i_brand#0, i_class#0, i_category#0, i_product_name#0, i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0]
                     +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                        :- 'Project [ss_item_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0]
                        :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                        :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0]
                        :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                        :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0]
                        :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
                        :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        :     :     +- Project [d_date_sk#0, d_year#0, d_moy#0, d_qoy#0]
                        :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
                        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        :     +- Project [s_store_sk#0, s_store_id#0]
                        :        +- Filter isnotnull(s_store_sk#0)
                        :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                        +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
                           +- Filter isnotnull(i_item_sk#0)
                              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q68
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [c_last_name#0 ASC NULLS FIRST, ss_ticket_number#0 ASC NULLS FIRST], true
      +- 'Project [c_last_name#0, c_first_name#0, ca_city#0, bought_city#0, ss_ticket_number#0, extended_price#0, extended_tax#0, list_price#0]
         +- 'Join Inner, ((c_current_addr_sk#0 = ca_address_sk#0) && NOT (ca_city#0 = bought_city#0))
            :- 'Project [ss_ticket_number#0, bought_city#0, extended_price#0, list_price#0, extended_tax#0, c_current_addr_sk#0, c_first_name#0, c_last_name#0]
            :  +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
            :     :- 'Aggregate [ss_ticket_number#0, ss_customer_sk#0, ss_addr_sk#0, ca_city#0], [ss_ticket_number#0, ss_customer_sk#0, ca_city#0 AS bought_city#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS extended_price#0, MakeDecimal(sum(UnscaledValue(ss_ext_list_price#0)),17,2) AS list_price#0, MakeDecimal(sum(UnscaledValue(ss_ext_tax#0)),17,2) AS extended_tax#0]
            :     :  +- 'Project [ss_customer_sk#0, ss_addr_sk#0, ss_ticket_number#0, ss_ext_sales_price#0, ss_ext_list_price#0, ss_ext_tax#0, ca_city#0]
            :     :     +- 'Join Inner, (ss_addr_sk#0 = ca_address_sk#0)
            :     :        :- 'Project [ss_customer_sk#0, ss_addr_sk#0, ss_ticket_number#0, ss_ext_sales_price#0, ss_ext_list_price#0, ss_ext_tax#0]
            :     :        :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
            :     :        :     :- 'Project [ss_customer_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_ticket_number#0, ss_ext_sales_price#0, ss_ext_list_price#0, ss_ext_tax#0]
            :     :        :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
            :     :        :     :     :- 'Project [ss_customer_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_ticket_number#0, ss_ext_sales_price#0, ss_ext_list_price#0, ss_ext_tax#0]
            :     :        :     :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :        :     :     :     :- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_ticket_number#0, ss_ext_sales_price#0, ss_ext_list_price#0, ss_ext_tax#0]
            :     :        :     :     :     :  +- Filter ((((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_hdemo_sk#0)) && isnotnull(ss_addr_sk#0)) && isnotnull(ss_customer_sk#0))
            :     :        :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :        :     :     :     +- Project [d_date_sk#0]
            :     :        :     :     :        +- Filter ((((isnotnull(d_dom#0) && (d_dom#0 >= 1)) && (d_dom#0 <= 2)) && d_year#0 IN (1999,2000,2001)) && isnotnull(d_date_sk#0))
            :     :        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :        :     :     +- Project [s_store_sk#0]
            :     :        :     :        +- Filter (s_city#0 IN (Midway,Fairview) && isnotnull(s_store_sk#0))
            :     :        :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :     :        :     +- Project [hd_demo_sk#0]
            :     :        :        +- Filter (((hd_dep_count#0 = 4) || (hd_vehicle_count#0 = 3)) && isnotnull(hd_demo_sk#0))
            :     :        :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
            :     :        +- Project [ca_address_sk#0, ca_city#0]
            :     :           +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_city#0))
            :     :              +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
            :     +- Project [c_customer_sk#0, c_current_addr_sk#0, c_first_name#0, c_last_name#0]
            :        +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_current_addr_sk#0))
            :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            +- Project [ca_address_sk#0, ca_city#0]
               +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_city#0))
                  +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet


================================================================================================
q69
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [cd_gender#0 ASC NULLS FIRST, cd_marital_status#0 ASC NULLS FIRST, cd_education_status#0 ASC NULLS FIRST, cd_purchase_estimate#0 ASC NULLS FIRST, cd_credit_rating#0 ASC NULLS FIRST], true
      +- 'Aggregate [cd_gender#0, cd_marital_status#0, cd_education_status#0, cd_purchase_estimate#0, cd_credit_rating#0], [cd_gender#0, cd_marital_status#0, cd_education_status#0, count(1) AS cnt1#0L, cd_purchase_estimate#0, count(1) AS cnt2#0L, cd_credit_rating#0, count(1) AS cnt3#0L]
         +- 'Project [cd_gender#0, cd_marital_status#0, cd_education_status#0, cd_purchase_estimate#0, cd_credit_rating#0]
            +- 'Join Inner, (cd_demo_sk#0 = c_current_cdemo_sk#0)
               :- 'Project [c_current_cdemo_sk#0]
               :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
               :     :- 'Project [c_current_cdemo_sk#0, c_current_addr_sk#0]
               :     :  +- 'Join LeftAnti, (c_customer_sk#0 = cs_ship_customer_sk#0)
               :     :     :- 'Join LeftAnti, (c_customer_sk#0 = ws_bill_customer_sk#0)
               :     :     :  :- 'Join LeftSemi, (c_customer_sk#0 = ss_customer_sk#0)
               :     :     :  :  :- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_addr_sk#0]
               :     :     :  :  :  +- Filter isnotnull(c_customer_sk#0)
               :     :     :  :  :     +- Filter (isnotnull(c_current_addr_sk#0) && isnotnull(c_current_cdemo_sk#0))
               :     :     :  :  :        +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
               :     :     :  :  +- 'Project [ss_customer_sk#0]
               :     :     :  :     +- 'Filter isnotnull(ss_customer_sk#0)
               :     :     :  :        +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :     :  :           :- Project [ss_sold_date_sk#0, ss_customer_sk#0]
               :     :     :  :           :  +- Filter isnotnull(ss_sold_date_sk#0)
               :     :     :  :           :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     :  :           +- Project [d_date_sk#0]
               :     :     :  :              +- Filter (((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 >= 4)) && (d_moy#0 <= 6)) && isnotnull(d_date_sk#0))
               :     :     :  :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     :  +- 'Project [ws_bill_customer_sk#0]
               :     :     :     +- 'Filter isnotnull(ws_bill_customer_sk#0)
               :     :     :        +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :     :     :           :- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0]
               :     :     :           :  +- Filter isnotnull(ws_sold_date_sk#0)
               :     :     :           :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :     :           +- Project [d_date_sk#0]
               :     :     :              +- Filter (((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 >= 4)) && (d_moy#0 <= 6)) && isnotnull(d_date_sk#0))
               :     :     :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     +- 'Project [cs_ship_customer_sk#0]
               :     :        +- 'Filter isnotnull(cs_ship_customer_sk#0)
               :     :           +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :     :              :- Project [cs_sold_date_sk#0, cs_ship_customer_sk#0]
               :     :              :  +- Filter isnotnull(cs_sold_date_sk#0)
               :     :              :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :              +- Project [d_date_sk#0]
               :     :                 +- Filter (((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 >= 4)) && (d_moy#0 <= 6)) && isnotnull(d_date_sk#0))
               :     :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [ca_address_sk#0]
               :        +- Filter (ca_state#0 IN (KY,GA,NM) && isnotnull(ca_address_sk#0))
               :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               +- Project [cd_demo_sk#0, cd_gender#0, cd_marital_status#0, cd_education_status#0, cd_purchase_estimate#0, cd_credit_rating#0]
                  +- Filter isnotnull(cd_demo_sk#0)
                     +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet


================================================================================================
q70
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [lochierarchy#0 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#0 as int) = 0) THEN s_state#0 END ASC NULLS FIRST, rank_within_parent#0 ASC NULLS FIRST], true
      +- 'Project [total_sum#0, s_state#0, s_county#0, lochierarchy#0, rank_within_parent#0]
         +- 'Window [rank(_w3#0) windowspecdefinition(_w1#0, _w2#0, _w3#0 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#0], [_w1#0, _w2#0], [_w3#0 DESC NULLS LAST]
            +- 'Aggregate [s_state#0, s_county#0, spark_grouping_id#0], [MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS total_sum#0, s_state#0, s_county#0, (cast((shiftright(spark_grouping_id#0, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#0, 0) & 1) as tinyint)) AS lochierarchy#0, (cast((shiftright(spark_grouping_id#0, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#0, 0) & 1) as tinyint)) AS _w1#0, CASE WHEN (cast(cast((shiftright(spark_grouping_id#0, 0) & 1) as tinyint) as int) = 0) THEN s_state#0 END AS _w2#0, MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS _w3#0]
               +- 'Expand [List(ss_net_profit#0, s_state#0, s_county#0, 0), List(ss_net_profit#0, s_state#0, null, 1), List(ss_net_profit#0, null, null, 3)], [ss_net_profit#0, s_state#0, s_county#0, spark_grouping_id#0]
                  +- 'Project [ss_net_profit#0, s_state#0, s_county#0]
                     +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
                        :- 'Project [ss_store_sk#0, ss_net_profit#0]
                        :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                        :     :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_net_profit#0]
                        :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0))
                        :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        :     +- Project [d_date_sk#0]
                        :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
                        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        +- 'Join LeftSemi, (s_state#0 = s_state#0)
                           :- Project [s_store_sk#0, s_county#0, s_state#0]
                           :  +- Filter isnotnull(s_state#0)
                           :     +- Filter isnotnull(s_store_sk#0)
                           :        +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                           +- 'Project [s_state#0]
                              +- 'Filter isnotnull(s_state#0)
                                 +- 'Filter (isnotnull(ranking#0) && (ranking#0 <= 5))
                                    +- 'Window [rank(_w2#0) windowspecdefinition(s_state#0, _w2#0 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#0], [s_state#0], [_w2#0 DESC NULLS LAST]
                                       +- 'Aggregate [s_state#0], [s_state#0 AS s_state#0, s_state#0, MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS _w2#0]
                                          +- 'Project [ss_net_profit#0, s_state#0]
                                             +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                                                :- 'Project [ss_sold_date_sk#0, ss_net_profit#0, s_state#0]
                                                :  +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
                                                :     :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_net_profit#0]
                                                :     :  +- Filter (isnotnull(ss_store_sk#0) && isnotnull(ss_sold_date_sk#0))
                                                :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                                                :     +- Project [s_store_sk#0, s_state#0]
                                                :        +- Filter isnotnull(s_store_sk#0)
                                                :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                                                +- Project [d_date_sk#0]
                                                   +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
                                                      +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q71
================================================================================================

'Sort [ext_price#0 DESC NULLS LAST, brand_id#0 ASC NULLS FIRST], true
+- 'Aggregate [i_brand#0, i_brand_id#0, t_hour#0, t_minute#0], [i_brand_id#0 AS brand_id#0, i_brand#0 AS brand#0, t_hour#0, t_minute#0, MakeDecimal(sum(UnscaledValue(ext_price#0)),17,2) AS ext_price#0]
   +- 'Project [i_brand_id#0, i_brand#0, ext_price#0, t_hour#0, t_minute#0]
      +- 'Join Inner, (time_sk#0 = t_time_sk#0)
         :- 'Project [i_brand_id#0, i_brand#0, ext_price#0, time_sk#0]
         :  +- 'Join Inner, (sold_item_sk#0 = i_item_sk#0)
         :     :- Project [i_item_sk#0, i_brand_id#0, i_brand#0]
         :     :  +- Filter ((isnotnull(i_manager_id#0) && (i_manager_id#0 = 1)) && isnotnull(i_item_sk#0))
         :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :     +- 'Union
         :        :- 'Project [ws_ext_sales_price#0 AS ext_price#0, ws_item_sk#0 AS sold_item_sk#0, ws_sold_time_sk#0 AS time_sk#0]
         :        :  +- 'Join Inner, (d_date_sk#0 = ws_sold_date_sk#0)
         :        :     :- Project [ws_sold_date_sk#0, ws_sold_time_sk#0, ws_item_sk#0, ws_ext_sales_price#0]
         :        :     :  +- Filter ((isnotnull(ws_sold_date_sk#0) && isnotnull(ws_item_sk#0)) && isnotnull(ws_sold_time_sk#0))
         :        :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
         :        :     +- Project [d_date_sk#0]
         :        :        +- Filter ((((isnotnull(d_moy#0) && isnotnull(d_year#0)) && (d_moy#0 = 11)) && (d_year#0 = 1999)) && isnotnull(d_date_sk#0))
         :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :        :- 'Project [cs_ext_sales_price#0 AS ext_price#0, cs_item_sk#0 AS sold_item_sk#0, cs_sold_time_sk#0 AS time_sk#0]
         :        :  +- 'Join Inner, (d_date_sk#0 = cs_sold_date_sk#0)
         :        :     :- Project [cs_sold_date_sk#0, cs_sold_time_sk#0, cs_item_sk#0, cs_ext_sales_price#0]
         :        :     :  +- Filter ((isnotnull(cs_sold_date_sk#0) && isnotnull(cs_item_sk#0)) && isnotnull(cs_sold_time_sk#0))
         :        :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
         :        :     +- Project [d_date_sk#0]
         :        :        +- Filter ((((isnotnull(d_moy#0) && isnotnull(d_year#0)) && (d_moy#0 = 11)) && (d_year#0 = 1999)) && isnotnull(d_date_sk#0))
         :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :        +- 'Project [ss_ext_sales_price#0 AS ext_price#0, ss_item_sk#0 AS sold_item_sk#0, ss_sold_time_sk#0 AS time_sk#0]
         :           +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
         :              :- Project [ss_sold_date_sk#0, ss_sold_time_sk#0, ss_item_sk#0, ss_ext_sales_price#0]
         :              :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0)) && isnotnull(ss_sold_time_sk#0))
         :              :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :              +- Project [d_date_sk#0]
         :                 +- Filter ((((isnotnull(d_moy#0) && isnotnull(d_year#0)) && (d_moy#0 = 11)) && (d_year#0 = 1999)) && isnotnull(d_date_sk#0))
         :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         +- Project [t_time_sk#0, t_hour#0, t_minute#0]
            +- Filter (((t_meal_time#0 = breakfast) || (t_meal_time#0 = dinner)) && isnotnull(t_time_sk#0))
               +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet


================================================================================================
q72
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [total_cnt#0L DESC NULLS LAST, i_item_desc#0 ASC NULLS FIRST, w_warehouse_name#0 ASC NULLS FIRST, d_week_seq#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_item_desc#0, w_warehouse_name#0, d_week_seq#0], [i_item_desc#0, w_warehouse_name#0, d_week_seq#0, count(1) AS no_promo#0L, count(1) AS promo#0L, count(1) AS total_cnt#0L]
         +- 'Project [w_warehouse_name#0, i_item_desc#0, d_week_seq#0]
            +- 'Join LeftOuter, ((cr_item_sk#0 = cs_item_sk#0) && (cr_order_number#0 = cs_order_number#0))
               :- 'Project [cs_item_sk#0, cs_order_number#0, w_warehouse_name#0, i_item_desc#0, d_week_seq#0]
               :  +- 'Join LeftOuter, (cs_promo_sk#0 = p_promo_sk#0)
               :     :- 'Project [cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, w_warehouse_name#0, i_item_desc#0, d_week_seq#0]
               :     :  +- 'Join Inner, ((d_date#0 > cast(cast(d_date#0 as timestamp) + interval 5 days as date)) && (cs_ship_date_sk#0 = d_date_sk#0))
               :     :     :- 'Project [cs_ship_date_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, w_warehouse_name#0, i_item_desc#0, d_date#0, d_week_seq#0]
               :     :     :  +- 'Join Inner, ((d_week_seq#0 = d_week_seq#0) && (inv_date_sk#0 = d_date_sk#0))
               :     :     :     :- 'Project [cs_ship_date_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, inv_date_sk#0, w_warehouse_name#0, i_item_desc#0, d_date#0, d_week_seq#0]
               :     :     :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, inv_date_sk#0, w_warehouse_name#0, i_item_desc#0]
               :     :     :     :     :  +- 'Join Inner, (cs_bill_hdemo_sk#0 = hd_demo_sk#0)
               :     :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_bill_hdemo_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, inv_date_sk#0, w_warehouse_name#0, i_item_desc#0]
               :     :     :     :     :     :  +- 'Join Inner, (cs_bill_cdemo_sk#0 = cd_demo_sk#0)
               :     :     :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_bill_cdemo_sk#0, cs_bill_hdemo_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, inv_date_sk#0, w_warehouse_name#0, i_item_desc#0]
               :     :     :     :     :     :     :  +- 'Join Inner, (i_item_sk#0 = cs_item_sk#0)
               :     :     :     :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_bill_cdemo_sk#0, cs_bill_hdemo_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, inv_date_sk#0, w_warehouse_name#0]
               :     :     :     :     :     :     :     :  +- 'Join Inner, (w_warehouse_sk#0 = inv_warehouse_sk#0)
               :     :     :     :     :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_bill_cdemo_sk#0, cs_bill_hdemo_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, inv_date_sk#0, inv_warehouse_sk#0]
               :     :     :     :     :     :     :     :     :  +- 'Join Inner, ((inv_quantity_on_hand#0 < cs_quantity#0) && (cs_item_sk#0 = inv_item_sk#0))
               :     :     :     :     :     :     :     :     :     :- Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_bill_cdemo_sk#0, cs_bill_hdemo_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, cs_quantity#0]
               :     :     :     :     :     :     :     :     :     :  +- Filter (((((isnotnull(cs_quantity#0) && isnotnull(cs_item_sk#0)) && isnotnull(cs_bill_cdemo_sk#0)) && isnotnull(cs_bill_hdemo_sk#0)) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_ship_date_sk#0))
               :     :     :     :     :     :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :     :     :     :     :     :     :     :     +- Filter (((isnotnull(inv_quantity_on_hand#0) && isnotnull(inv_item_sk#0)) && isnotnull(inv_warehouse_sk#0)) && isnotnull(inv_date_sk#0))
               :     :     :     :     :     :     :     :     :        +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
               :     :     :     :     :     :     :     :     +- Project [w_warehouse_sk#0, w_warehouse_name#0]
               :     :     :     :     :     :     :     :        +- Filter isnotnull(w_warehouse_sk#0)
               :     :     :     :     :     :     :     :           +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
               :     :     :     :     :     :     :     +- Project [i_item_sk#0, i_item_desc#0]
               :     :     :     :     :     :     :        +- Filter isnotnull(i_item_sk#0)
               :     :     :     :     :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :     :     :     :     :     :     +- Project [cd_demo_sk#0]
               :     :     :     :     :     :        +- Filter ((isnotnull(cd_marital_status#0) && (cd_marital_status#0 = D)) && isnotnull(cd_demo_sk#0))
               :     :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
               :     :     :     :     :     +- Project [hd_demo_sk#0]
               :     :     :     :     :        +- Filter ((isnotnull(hd_buy_potential#0) && (hd_buy_potential#0 = >10000)) && isnotnull(hd_demo_sk#0))
               :     :     :     :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
               :     :     :     :     +- Project [d_date_sk#0, d_date#0, d_week_seq#0]
               :     :     :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 = 1999)) && isnotnull(d_date_sk#0)) && isnotnull(d_week_seq#0))
               :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     :     +- Project [d_date_sk#0, d_week_seq#0]
               :     :     :        +- Filter (isnotnull(d_week_seq#0) && isnotnull(d_date_sk#0))
               :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     +- Project [d_date_sk#0, d_date#0]
               :     :        +- Filter (isnotnull(d_date#0) && isnotnull(d_date_sk#0))
               :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [p_promo_sk#0]
               :        +- Filter isnotnull(p_promo_sk#0)
               :           +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
               +- Project [cr_item_sk#0, cr_order_number#0]
                  +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
                     +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet


================================================================================================
q73
================================================================================================

'Sort [cnt#0L DESC NULLS LAST], true
+- 'Project [c_last_name#0, c_first_name#0, c_salutation#0, c_preferred_cust_flag#0, ss_ticket_number#0, cnt#0L]
   +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
      :- 'Filter ((cnt#0L >= 1) && (cnt#0L <= 5))
      :  +- 'Aggregate [ss_ticket_number#0, ss_customer_sk#0], [ss_ticket_number#0, ss_customer_sk#0, count(1) AS cnt#0L]
      :     +- 'Project [ss_customer_sk#0, ss_ticket_number#0]
      :        +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
      :           :- 'Project [ss_customer_sk#0, ss_hdemo_sk#0, ss_ticket_number#0]
      :           :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
      :           :     :- 'Project [ss_customer_sk#0, ss_hdemo_sk#0, ss_store_sk#0, ss_ticket_number#0]
      :           :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
      :           :     :     :- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_hdemo_sk#0, ss_store_sk#0, ss_ticket_number#0]
      :           :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_hdemo_sk#0)) && isnotnull(ss_customer_sk#0))
      :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :           :     :     +- Project [d_date_sk#0]
      :           :     :        +- Filter ((((isnotnull(d_dom#0) && (d_dom#0 >= 1)) && (d_dom#0 <= 2)) && d_year#0 IN (1999,2000,2001)) && isnotnull(d_date_sk#0))
      :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :           :     +- Project [s_store_sk#0]
      :           :        +- Filter (s_county#0 IN (Williamson County,Franklin Parish,Bronx County,Orange County) && isnotnull(s_store_sk#0))
      :           :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
      :           +- Project [hd_demo_sk#0]
      :              +- Filter ((((isnotnull(hd_vehicle_count#0) && ((hd_buy_potential#0 = >10000) || (hd_buy_potential#0 = unknown))) && (hd_vehicle_count#0 > 0)) && (CASE WHEN (hd_vehicle_count#0 > 0) THEN (cast(hd_dep_count#0 as double) / cast(hd_vehicle_count#0 as double)) ELSE null END > 1.0)) && isnotnull(hd_demo_sk#0))
      :                 +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
      +- Project [c_customer_sk#0, c_salutation#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0]
         +- Filter isnotnull(c_customer_sk#0)
            +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet


================================================================================================
q74
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [customer_id#0 ASC NULLS FIRST, customer_id#0 ASC NULLS FIRST, customer_id#0 ASC NULLS FIRST], true
      +- 'Project [customer_id#0, customer_first_name#0, customer_last_name#0]
         +- 'Join Inner, ((customer_id#0 = customer_id#0) && (CASE WHEN (year_total#0 > 0.00) THEN CheckOverflow((promote_precision(year_total#0) / promote_precision(year_total#0)), DecimalType(37,20)) ELSE null END > CASE WHEN (year_total#0 > 0.00) THEN CheckOverflow((promote_precision(year_total#0) / promote_precision(year_total#0)), DecimalType(37,20)) ELSE null END))
            :- 'Project [customer_id#0, year_total#0, customer_id#0, customer_first_name#0, customer_last_name#0, year_total#0, year_total#0]
            :  +- 'Join Inner, (customer_id#0 = customer_id#0)
            :     :- 'Join Inner, (customer_id#0 = customer_id#0)
            :     :  :- 'Union
            :     :  :  :- 'Filter isnotnull(customer_id#0)
            :     :  :  :  +- 'Filter (isnotnull(year_total#0) && (year_total#0 > 0.00))
            :     :  :  :     +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, d_year#0], [c_customer_id#0 AS customer_id#0, MakeDecimal(sum(UnscaledValue(ss_net_paid#0)),17,2) AS year_total#0]
            :     :  :  :        +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ss_net_paid#0, d_year#0]
            :     :  :  :           +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :  :  :              :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ss_sold_date_sk#0, ss_net_paid#0]
            :     :  :  :              :  +- 'Join Inner, (c_customer_sk#0 = ss_customer_sk#0)
            :     :  :  :              :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0]
            :     :  :  :              :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :     :  :  :              :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :     :  :  :              :     +- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_net_paid#0]
            :     :  :  :              :        +- Filter (isnotnull(ss_customer_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :  :  :              :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :  :  :              +- Project [d_date_sk#0, d_year#0]
            :     :  :  :                 +- Filter (((isnotnull(d_year#0) && d_year#0 IN (2001,2002)) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
            :     :  :  :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :  :  +- Filter isnotnull(customer_id#0)
            :     :  :     +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :     :  +- 'Union
            :     :     :- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, d_year#0], [c_customer_id#0 AS customer_id#0, c_first_name#0 AS customer_first_name#0, c_last_name#0 AS customer_last_name#0, MakeDecimal(sum(UnscaledValue(ss_net_paid#0)),17,2) AS year_total#0]
            :     :     :  +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ss_net_paid#0, d_year#0]
            :     :     :     +- 'Filter isnotnull(c_customer_id#0)
            :     :     :        +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :           :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ss_sold_date_sk#0, ss_net_paid#0]
            :     :     :           :  +- 'Join Inner, (c_customer_sk#0 = ss_customer_sk#0)
            :     :     :           :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0]
            :     :     :           :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :     :     :           :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :     :     :           :     +- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_net_paid#0]
            :     :     :           :        +- Filter (isnotnull(ss_customer_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :           :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :           +- Project [d_date_sk#0, d_year#0]
            :     :     :              +- Filter (((isnotnull(d_year#0) && d_year#0 IN (2001,2002)) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :     :     :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     +- Filter isnotnull(customer_id#0)
            :     :        +- LocalRelation <empty>, [customer_id#0, customer_first_name#0, customer_last_name#0, year_total#0]
            :     +- 'Union
            :        :- Filter isnotnull(customer_id#0)
            :        :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :        +- 'Filter isnotnull(customer_id#0)
            :           +- 'Filter (isnotnull(year_total#0) && (year_total#0 > 0.00))
            :              +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, d_year#0], [c_customer_id#0 AS customer_id#0, MakeDecimal(sum(UnscaledValue(ws_net_paid#0)),17,2) AS year_total#0]
            :                 +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ws_net_paid#0, d_year#0]
            :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :                       :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ws_sold_date_sk#0, ws_net_paid#0]
            :                       :  +- 'Join Inner, (c_customer_sk#0 = ws_bill_customer_sk#0)
            :                       :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0]
            :                       :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :                       :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :                       :     +- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0, ws_net_paid#0]
            :                       :        +- Filter (isnotnull(ws_bill_customer_sk#0) && isnotnull(ws_sold_date_sk#0))
            :                       :           +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                       +- Project [d_date_sk#0, d_year#0]
            :                          +- Filter (((isnotnull(d_year#0) && d_year#0 IN (2001,2002)) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
            :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- 'Union
               :- Filter isnotnull(customer_id#0)
               :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
               +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, d_year#0], [c_customer_id#0 AS customer_id#0, MakeDecimal(sum(UnscaledValue(ws_net_paid#0)),17,2) AS year_total#0]
                  +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ws_net_paid#0, d_year#0]
                     +- 'Filter isnotnull(c_customer_id#0)
                        +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                           :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ws_sold_date_sk#0, ws_net_paid#0]
                           :  +- 'Join Inner, (c_customer_sk#0 = ws_bill_customer_sk#0)
                           :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0]
                           :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
                           :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                           :     +- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0, ws_net_paid#0]
                           :        +- Filter (isnotnull(ws_bill_customer_sk#0) && isnotnull(ws_sold_date_sk#0))
                           :           +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                           +- Project [d_date_sk#0, d_year#0]
                              +- Filter (((isnotnull(d_year#0) && d_year#0 IN (2001,2002)) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
                                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q75
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [sales_cnt_diff#0L ASC NULLS FIRST], true
      +- 'Project [d_year#0 AS prev_year#0, d_year#0 AS year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0L AS prev_yr_cnt#0L, sales_cnt#0L AS curr_yr_cnt#0L, (sales_cnt#0L - sales_cnt#0L) AS sales_cnt_diff#0L, CheckOverflow((promote_precision(cast(sales_amt#0 as decimal(19,2))) - promote_precision(cast(sales_amt#0 as decimal(19,2)))), DecimalType(19,2)) AS sales_amt_diff#0]
         +- 'Join Inner, (((((i_brand_id#0 = i_brand_id#0) && (i_class_id#0 = i_class_id#0)) && (i_category_id#0 = i_category_id#0)) && (i_manufact_id#0 = i_manufact_id#0)) && (CheckOverflow((promote_precision(cast(sales_cnt#0L as decimal(17,2))) / promote_precision(cast(sales_cnt#0L as decimal(17,2)))), DecimalType(37,20)) < 0.90000000000000000000))
            :- 'Aggregate [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0], [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sum(cast(sales_cnt#0 as bigint)) AS sales_cnt#0L, MakeDecimal(sum(UnscaledValue(sales_amt#0)),18,2) AS sales_amt#0]
            :  +- 'Aggregate [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0], [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0]
            :     +- 'Union
            :        :- 'Aggregate [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0], [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0]
            :        :  +- 'Union
            :        :     :- 'Project [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, (cs_quantity#0 - coalesce(cr_return_quantity#0, 0)) AS sales_cnt#0, CheckOverflow((promote_precision(cast(cs_ext_sales_price#0 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#0, 0.00) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#0]
            :        :     :  +- 'Join LeftOuter, ((cs_order_number#0 = cr_order_number#0) && (cs_item_sk#0 = cr_item_sk#0))
            :        :     :     :- 'Project [cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, d_year#0]
            :        :     :     :  +- 'Join Inner, (d_date_sk#0 = cs_sold_date_sk#0)
            :        :     :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
            :        :     :     :     :  +- 'Join Inner, (i_item_sk#0 = cs_item_sk#0)
            :        :     :     :     :     :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_ext_sales_price#0]
            :        :     :     :     :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :        :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :        :     :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
            :        :     :     :     :        +- Filter ((((((isnotnull(i_category#0) && (i_category#0 = Books)) && isnotnull(i_item_sk#0)) && isnotnull(i_class_id#0)) && isnotnull(i_brand_id#0)) && isnotnull(i_manufact_id#0)) && isnotnull(i_category_id#0))
            :        :     :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :        :     :     :     +- Project [d_date_sk#0, d_year#0]
            :        :     :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :        :     :     +- Project [cr_item_sk#0, cr_order_number#0, cr_return_quantity#0, cr_return_amount#0]
            :        :     :        +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
            :        :     :           +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
            :        :     +- 'Project [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, (ss_quantity#0 - coalesce(sr_return_quantity#0, 0)) AS sales_cnt#0, CheckOverflow((promote_precision(cast(ss_ext_sales_price#0 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#0, 0.00) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#0]
            :        :        +- 'Join LeftOuter, ((cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L))
            :        :           :- 'Project [ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, d_year#0]
            :        :           :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
            :        :           :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
            :        :           :     :  +- 'Join Inner, (i_item_sk#0 = ss_item_sk#0)
            :        :           :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_ext_sales_price#0]
            :        :           :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :        :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :        :           :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
            :        :           :     :        +- Filter ((((((isnotnull(i_category#0) && (i_category#0 = Books)) && isnotnull(i_item_sk#0)) && isnotnull(i_class_id#0)) && isnotnull(i_brand_id#0)) && isnotnull(i_manufact_id#0)) && isnotnull(i_category_id#0))
            :        :           :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :        :           :     +- Project [d_date_sk#0, d_year#0]
            :        :           :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :        :           :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :        :           +- Project [sr_item_sk#0L, sr_ticket_number#0L, sr_return_quantity#0, sr_return_amt#0]
            :        :              +- Filter (isnotnull(sr_ticket_number#0L) && isnotnull(sr_item_sk#0L))
            :        :                 +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
            :        +- 'Project [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, (ws_quantity#0 - coalesce(wr_return_quantity#0, 0)) AS sales_cnt#0, CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#0, 0.00) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#0]
            :           +- 'Join LeftOuter, ((cast(ws_order_number#0 as bigint) = wr_order_number#0L) && (cast(ws_item_sk#0 as bigint) = wr_item_sk#0L))
            :              :- 'Project [ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, d_year#0]
            :              :  +- 'Join Inner, (d_date_sk#0 = ws_sold_date_sk#0)
            :              :     :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
            :              :     :  +- 'Join Inner, (i_item_sk#0 = ws_item_sk#0)
            :              :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_ext_sales_price#0]
            :              :     :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :              :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :              :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
            :              :     :        +- Filter ((((((isnotnull(i_category#0) && (i_category#0 = Books)) && isnotnull(i_item_sk#0)) && isnotnull(i_class_id#0)) && isnotnull(i_brand_id#0)) && isnotnull(i_manufact_id#0)) && isnotnull(i_category_id#0))
            :              :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :     +- Project [d_date_sk#0, d_year#0]
            :              :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              +- Project [wr_item_sk#0L, wr_order_number#0L, wr_return_quantity#0, wr_return_amt#0]
            :                 +- Filter (isnotnull(wr_item_sk#0L) && isnotnull(wr_order_number#0L))
            :                    +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
            +- 'Aggregate [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0], [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sum(cast(sales_cnt#0 as bigint)) AS sales_cnt#0L, MakeDecimal(sum(UnscaledValue(sales_amt#0)),18,2) AS sales_amt#0]
               +- 'Aggregate [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0], [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0]
                  +- 'Union
                     :- 'Aggregate [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0], [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0]
                     :  +- 'Union
                     :     :- 'Project [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, (cs_quantity#0 - coalesce(cr_return_quantity#0, 0)) AS sales_cnt#0, CheckOverflow((promote_precision(cast(cs_ext_sales_price#0 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#0, 0.00) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#0]
                     :     :  +- 'Join LeftOuter, ((cs_order_number#0 = cr_order_number#0) && (cs_item_sk#0 = cr_item_sk#0))
                     :     :     :- 'Project [cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, d_year#0]
                     :     :     :  +- 'Join Inner, (d_date_sk#0 = cs_sold_date_sk#0)
                     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
                     :     :     :     :  +- 'Join Inner, (i_item_sk#0 = cs_item_sk#0)
                     :     :     :     :     :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_ext_sales_price#0]
                     :     :     :     :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                     :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                     :     :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
                     :     :     :     :        +- Filter ((((((isnotnull(i_category#0) && (i_category#0 = Books)) && isnotnull(i_item_sk#0)) && isnotnull(i_brand_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_manufact_id#0))
                     :     :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :     :     :     +- Project [d_date_sk#0, d_year#0]
                     :     :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :     :     +- Project [cr_item_sk#0, cr_order_number#0, cr_return_quantity#0, cr_return_amount#0]
                     :     :        +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
                     :     :           +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
                     :     +- 'Project [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, (ss_quantity#0 - coalesce(sr_return_quantity#0, 0)) AS sales_cnt#0, CheckOverflow((promote_precision(cast(ss_ext_sales_price#0 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#0, 0.00) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#0]
                     :        +- 'Join LeftOuter, ((cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L))
                     :           :- 'Project [ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, d_year#0]
                     :           :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                     :           :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
                     :           :     :  +- 'Join Inner, (i_item_sk#0 = ss_item_sk#0)
                     :           :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_ext_sales_price#0]
                     :           :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                     :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                     :           :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
                     :           :     :        +- Filter ((((((isnotnull(i_category#0) && (i_category#0 = Books)) && isnotnull(i_item_sk#0)) && isnotnull(i_brand_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_manufact_id#0))
                     :           :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :           :     +- Project [d_date_sk#0, d_year#0]
                     :           :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                     :           :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :           +- Project [sr_item_sk#0L, sr_ticket_number#0L, sr_return_quantity#0, sr_return_amt#0]
                     :              +- Filter (isnotnull(sr_ticket_number#0L) && isnotnull(sr_item_sk#0L))
                     :                 +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
                     +- 'Project [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, (ws_quantity#0 - coalesce(wr_return_quantity#0, 0)) AS sales_cnt#0, CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#0, 0.00) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#0]
                        +- 'Join LeftOuter, ((cast(ws_order_number#0 as bigint) = wr_order_number#0L) && (cast(ws_item_sk#0 as bigint) = wr_item_sk#0L))
                           :- 'Project [ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, d_year#0]
                           :  +- 'Join Inner, (d_date_sk#0 = ws_sold_date_sk#0)
                           :     :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
                           :     :  +- 'Join Inner, (i_item_sk#0 = ws_item_sk#0)
                           :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_ext_sales_price#0]
                           :     :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                           :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                           :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
                           :     :        +- Filter ((((((isnotnull(i_category#0) && (i_category#0 = Books)) && isnotnull(i_item_sk#0)) && isnotnull(i_brand_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_manufact_id#0))
                           :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                           :     +- Project [d_date_sk#0, d_year#0]
                           :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                           :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                           +- Project [wr_item_sk#0L, wr_order_number#0L, wr_return_quantity#0, wr_return_amt#0]
                              +- Filter (isnotnull(wr_item_sk#0L) && isnotnull(wr_order_number#0L))
                                 +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet


================================================================================================
q76
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [channel#0 ASC NULLS FIRST, col_name#0 ASC NULLS FIRST, d_year#0 ASC NULLS FIRST, d_qoy#0 ASC NULLS FIRST, i_category#0 ASC NULLS FIRST], true
      +- 'Aggregate [channel#0, col_name#0, d_year#0, d_qoy#0, i_category#0], [channel#0, col_name#0, d_year#0, d_qoy#0, i_category#0, count(1) AS sales_cnt#0L, MakeDecimal(sum(UnscaledValue(ext_sales_price#0)),17,2) AS sales_amt#0]
         +- 'Union
            :- 'Project [store AS channel#0, ss_store_sk#0 AS col_name#0, d_year#0, d_qoy#0, i_category#0, ss_ext_sales_price#0 AS ext_sales_price#0]
            :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :- 'Project [ss_sold_date_sk#0, ss_store_sk#0, ss_ext_sales_price#0, i_category#0]
            :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_ext_sales_price#0]
            :     :     :  +- Filter ((isnull(ss_store_sk#0) && isnotnull(ss_item_sk#0)) && isnotnull(ss_sold_date_sk#0))
            :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     +- Project [i_item_sk#0, i_category#0]
            :     :        +- Filter isnotnull(i_item_sk#0)
            :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     +- Project [d_date_sk#0, d_year#0, d_qoy#0]
            :        +- Filter isnotnull(d_date_sk#0)
            :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :- 'Project [web AS channel#0, ws_ship_customer_sk#0 AS col_name#0, d_year#0, d_qoy#0, i_category#0, ws_ext_sales_price#0 AS ext_sales_price#0]
            :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :- 'Project [ws_sold_date_sk#0, ws_ship_customer_sk#0, ws_ext_sales_price#0, i_category#0]
            :     :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_ship_customer_sk#0, ws_ext_sales_price#0]
            :     :     :  +- Filter ((isnull(ws_ship_customer_sk#0) && isnotnull(ws_item_sk#0)) && isnotnull(ws_sold_date_sk#0))
            :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     +- Project [i_item_sk#0, i_category#0]
            :     :        +- Filter isnotnull(i_item_sk#0)
            :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     +- Project [d_date_sk#0, d_year#0, d_qoy#0]
            :        +- Filter isnotnull(d_date_sk#0)
            :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- 'Project [catalog AS channel#0, cs_ship_addr_sk#0 AS col_name#0, d_year#0, d_qoy#0, i_category#0, cs_ext_sales_price#0 AS ext_sales_price#0]
               +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                  :- 'Project [cs_sold_date_sk#0, cs_ship_addr_sk#0, cs_ext_sales_price#0, i_category#0]
                  :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                  :     :- Project [cs_sold_date_sk#0, cs_ship_addr_sk#0, cs_item_sk#0, cs_ext_sales_price#0]
                  :     :  +- Filter ((isnull(cs_ship_addr_sk#0) && isnotnull(cs_item_sk#0)) && isnotnull(cs_sold_date_sk#0))
                  :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                  :     +- Project [i_item_sk#0, i_category#0]
                  :        +- Filter isnotnull(i_item_sk#0)
                  :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  +- Project [d_date_sk#0, d_year#0, d_qoy#0]
                     +- Filter isnotnull(d_date_sk#0)
                        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q77
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [channel#0 ASC NULLS FIRST, id#0 ASC NULLS FIRST], true
      +- 'Aggregate [channel#0, id#0, spark_grouping_id#0], [channel#0, id#0, sum(sales#0) AS sales#0, sum(returns#0) AS returns#0, sum(profit#0) AS profit#0]
         +- 'Expand [List(sales#0, returns#0, profit#0, channel#0, id#0, 0), List(sales#0, returns#0, profit#0, channel#0, null, 1), List(sales#0, returns#0, profit#0, null, null, 3)], [sales#0, returns#0, profit#0, channel#0, id#0, spark_grouping_id#0]
            +- 'Union
               :- 'Project [sales#0, coalesce(returns#0, 0.00) AS returns#0, CheckOverflow((promote_precision(cast(profit#0 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#0, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS profit#0, store channel AS channel#0, s_store_sk#0 AS id#0]
               :  +- 'Join LeftOuter, (s_store_sk#0 = s_store_sk#0)
               :     :- 'Aggregate [s_store_sk#0], [s_store_sk#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS profit#0]
               :     :  +- 'Project [ss_ext_sales_price#0, ss_net_profit#0, s_store_sk#0]
               :     :     +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :     :        :- 'Project [ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
               :     :        :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :        :     :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
               :     :        :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0))
               :     :        :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :        :     +- Project [d_date_sk#0]
               :     :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 11172)) && (d_date#0 <= 11202)) && isnotnull(d_date_sk#0))
               :     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :        +- Project [s_store_sk#0]
               :     :           +- Filter isnotnull(s_store_sk#0)
               :     :              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :     +- 'Aggregate [s_store_sk#0], [s_store_sk#0, MakeDecimal(sum(UnscaledValue(sr_return_amt#0)),17,2) AS returns#0, MakeDecimal(sum(UnscaledValue(sr_net_loss#0)),17,2) AS profit_loss#0]
               :        +- 'Project [sr_return_amt#0, sr_net_loss#0, s_store_sk#0]
               :           +- 'Join Inner, (sr_store_sk#0L = cast(s_store_sk#0 as bigint))
               :              :- 'Project [sr_store_sk#0L, sr_return_amt#0, sr_net_loss#0]
               :              :  +- 'Join Inner, (sr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
               :              :     :- Project [sr_returned_date_sk#0L, sr_store_sk#0L, sr_return_amt#0, sr_net_loss#0]
               :              :     :  +- Filter (isnotnull(sr_returned_date_sk#0L) && isnotnull(sr_store_sk#0L))
               :              :     :     +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               :              :     +- Project [d_date_sk#0]
               :              :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 11172)) && (d_date#0 <= 11202)) && isnotnull(d_date_sk#0))
               :              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :              +- Project [s_store_sk#0]
               :                 +- Filter isnotnull(s_store_sk#0)
               :                    +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :- 'Project [sales#0, returns#0, CheckOverflow((promote_precision(cast(profit#0 as decimal(18,2))) - promote_precision(cast(profit_loss#0 as decimal(18,2)))), DecimalType(18,2)) AS profit#0, catalog channel AS channel#0, cs_call_center_sk#0 AS id#0]
               :  +- 'Join Inner
               :     :- 'Aggregate [cs_call_center_sk#0], [cs_call_center_sk#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(cs_net_profit#0)),17,2) AS profit#0]
               :     :  +- 'Project [cs_call_center_sk#0, cs_ext_sales_price#0, cs_net_profit#0]
               :     :     +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :     :        :- Project [cs_sold_date_sk#0, cs_call_center_sk#0, cs_ext_sales_price#0, cs_net_profit#0]
               :     :        :  +- Filter isnotnull(cs_sold_date_sk#0)
               :     :        :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :        +- Project [d_date_sk#0]
               :     :           +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 11172)) && (d_date#0 <= 11202)) && isnotnull(d_date_sk#0))
               :     :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- 'Aggregate [MakeDecimal(sum(UnscaledValue(cr_return_amount#0)),17,2) AS returns#0, MakeDecimal(sum(UnscaledValue(cr_net_loss#0)),17,2) AS profit_loss#0]
               :        +- 'Project [cr_return_amount#0, cr_net_loss#0]
               :           +- 'Join Inner, (cr_returned_date_sk#0 = d_date_sk#0)
               :              :- Project [cr_returned_date_sk#0, cr_return_amount#0, cr_net_loss#0]
               :              :  +- Filter isnotnull(cr_returned_date_sk#0)
               :              :     +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
               :              +- Project [d_date_sk#0]
               :                 +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 11172)) && (d_date#0 <= 11202)) && isnotnull(d_date_sk#0))
               :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               +- 'Project [sales#0, coalesce(returns#0, 0.00) AS returns#0, CheckOverflow((promote_precision(cast(profit#0 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#0, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS profit#0, web channel AS channel#0, wp_web_page_sk#0 AS id#0]
                  +- 'Join LeftOuter, (wp_web_page_sk#0 = wp_web_page_sk#0)
                     :- 'Aggregate [wp_web_page_sk#0], [wp_web_page_sk#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(ws_net_profit#0)),17,2) AS profit#0]
                     :  +- 'Project [ws_ext_sales_price#0, ws_net_profit#0, wp_web_page_sk#0]
                     :     +- 'Join Inner, (ws_web_page_sk#0 = wp_web_page_sk#0)
                     :        :- 'Project [ws_web_page_sk#0, ws_ext_sales_price#0, ws_net_profit#0]
                     :        :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                     :        :     :- Project [ws_sold_date_sk#0, ws_web_page_sk#0, ws_ext_sales_price#0, ws_net_profit#0]
                     :        :     :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_web_page_sk#0))
                     :        :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                     :        :     +- Project [d_date_sk#0]
                     :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 11172)) && (d_date#0 <= 11202)) && isnotnull(d_date_sk#0))
                     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :        +- Project [wp_web_page_sk#0]
                     :           +- Filter isnotnull(wp_web_page_sk#0)
                     :              +- Relation[wp_web_page_sk#0,wp_web_page_id#0,wp_rec_start_date#0,wp_rec_end_date#0,wp_creation_date_sk#0,wp_access_date_sk#0,wp_autogen_flag#0,wp_customer_sk#0,wp_url#0,wp_type#0,wp_char_count#0,wp_link_count#0,wp_image_count#0,wp_max_ad_count#0] parquet
                     +- 'Aggregate [wp_web_page_sk#0], [wp_web_page_sk#0, MakeDecimal(sum(UnscaledValue(wr_return_amt#0)),17,2) AS returns#0, MakeDecimal(sum(UnscaledValue(wr_net_loss#0)),17,2) AS profit_loss#0]
                        +- 'Project [wr_return_amt#0, wr_net_loss#0, wp_web_page_sk#0]
                           +- 'Join Inner, (wr_web_page_sk#0L = cast(wp_web_page_sk#0 as bigint))
                              :- 'Project [wr_web_page_sk#0L, wr_return_amt#0, wr_net_loss#0]
                              :  +- 'Join Inner, (wr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
                              :     :- Project [wr_returned_date_sk#0L, wr_web_page_sk#0L, wr_return_amt#0, wr_net_loss#0]
                              :     :  +- Filter (isnotnull(wr_returned_date_sk#0L) && isnotnull(wr_web_page_sk#0L))
                              :     :     +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
                              :     +- Project [d_date_sk#0]
                              :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 11172)) && (d_date#0 <= 11202)) && isnotnull(d_date_sk#0))
                              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              +- Project [wp_web_page_sk#0]
                                 +- Filter isnotnull(wp_web_page_sk#0)
                                    +- Relation[wp_web_page_sk#0,wp_web_page_id#0,wp_rec_start_date#0,wp_rec_end_date#0,wp_creation_date_sk#0,wp_access_date_sk#0,wp_autogen_flag#0,wp_customer_sk#0,wp_url#0,wp_type#0,wp_char_count#0,wp_link_count#0,wp_image_count#0,wp_max_ad_count#0] parquet


================================================================================================
q78
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Project [ratio#0, store_qty#0L, store_wholesale_cost#0, store_sales_price#0, other_chan_qty#0L, other_chan_wholesale_cost#0, other_chan_sales_price#0]
      +- 'Sort [ratio#0 ASC NULLS FIRST, ss_qty#0L DESC NULLS LAST, ss_wc#0 DESC NULLS LAST, ss_sp#0 DESC NULLS LAST, other_chan_qty#0L ASC NULLS FIRST, other_chan_wholesale_cost#0 ASC NULLS FIRST, other_chan_sales_price#0 ASC NULLS FIRST, round((cast(ss_qty#0L as double) / cast(coalesce((ws_qty#0L + cs_qty#0L), 1) as double)), 2) ASC NULLS FIRST], true
         +- 'Project [round((cast(ss_qty#0L as double) / cast(coalesce((ws_qty#0L + cs_qty#0L), 1) as double)), 2) AS ratio#0, ss_qty#0L AS store_qty#0L, ss_wc#0 AS store_wholesale_cost#0, ss_sp#0 AS store_sales_price#0, (coalesce(ws_qty#0L, 0) + coalesce(cs_qty#0L, 0)) AS other_chan_qty#0L, CheckOverflow((promote_precision(cast(coalesce(ws_wc#0, 0.00) as decimal(18,2))) + promote_precision(cast(coalesce(cs_wc#0, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_wholesale_cost#0, CheckOverflow((promote_precision(cast(coalesce(ws_sp#0, 0.00) as decimal(18,2))) + promote_precision(cast(coalesce(cs_sp#0, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_sales_price#0, ss_qty#0L, ss_sp#0, cs_qty#0L, ws_qty#0L, ss_wc#0]
            +- 'Join Inner, (((cs_sold_year#0 = ss_sold_year#0) && (cs_item_sk#0 = ss_item_sk#0)) && (cs_customer_sk#0 = ss_customer_sk#0))
               :- 'Project [ss_sold_year#0, ss_item_sk#0, ss_customer_sk#0, ss_qty#0L, ss_wc#0, ss_sp#0, ws_qty#0L, ws_wc#0, ws_sp#0]
               :  +- 'Join Inner, (((ws_sold_year#0 = ss_sold_year#0) && (ws_item_sk#0 = ss_item_sk#0)) && (ws_customer_sk#0 = ss_customer_sk#0))
               :     :- 'Aggregate [d_year#0, ss_item_sk#0, ss_customer_sk#0], [d_year#0 AS ss_sold_year#0, ss_item_sk#0, ss_customer_sk#0, sum(cast(ss_quantity#0 as bigint)) AS ss_qty#0L, MakeDecimal(sum(UnscaledValue(ss_wholesale_cost#0)),17,2) AS ss_wc#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS ss_sp#0]
               :     :  +- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_quantity#0, ss_wholesale_cost#0, ss_sales_price#0, d_year#0]
               :     :     +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :        :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_quantity#0, ss_wholesale_cost#0, ss_sales_price#0]
               :     :        :  +- 'Filter isnull(sr_ticket_number#0L)
               :     :        :     +- 'Join LeftOuter, ((sr_ticket_number#0L = cast(ss_ticket_number#0 as bigint)) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L))
               :     :        :        :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_ticket_number#0, ss_quantity#0, ss_wholesale_cost#0, ss_sales_price#0]
               :     :        :        :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_customer_sk#0)) && isnotnull(ss_item_sk#0))
               :     :        :        :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :        :        +- Project [sr_item_sk#0L, sr_ticket_number#0L]
               :     :        :           +- Filter (isnotnull(sr_ticket_number#0L) && isnotnull(sr_item_sk#0L))
               :     :        :              +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               :     :        +- Project [d_date_sk#0, d_year#0]
               :     :           +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
               :     :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- 'Filter (coalesce(ws_qty#0L, 0) > 0)
               :        +- 'Aggregate [d_year#0, ws_item_sk#0, ws_bill_customer_sk#0], [d_year#0 AS ws_sold_year#0, ws_item_sk#0, ws_bill_customer_sk#0 AS ws_customer_sk#0, sum(cast(ws_quantity#0 as bigint)) AS ws_qty#0L, MakeDecimal(sum(UnscaledValue(ws_wholesale_cost#0)),17,2) AS ws_wc#0, MakeDecimal(sum(UnscaledValue(ws_sales_price#0)),17,2) AS ws_sp#0]
               :           +- 'Project [ws_item_sk#0, ws_bill_customer_sk#0, ws_quantity#0, ws_wholesale_cost#0, ws_sales_price#0, d_year#0]
               :              +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :                 :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_bill_customer_sk#0, ws_quantity#0, ws_wholesale_cost#0, ws_sales_price#0]
               :                 :  +- 'Filter isnull(wr_order_number#0L)
               :                 :     +- 'Join LeftOuter, ((wr_order_number#0L = cast(ws_order_number#0 as bigint)) && (cast(ws_item_sk#0 as bigint) = wr_item_sk#0L))
               :                 :        :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_bill_customer_sk#0, ws_order_number#0, ws_quantity#0, ws_wholesale_cost#0, ws_sales_price#0]
               :                 :        :  +- Filter ((isnotnull(ws_sold_date_sk#0) && isnotnull(ws_bill_customer_sk#0)) && isnotnull(ws_item_sk#0))
               :                 :        :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :                 :        +- Project [wr_item_sk#0L, wr_order_number#0L]
               :                 :           +- Filter (isnotnull(wr_order_number#0L) && isnotnull(wr_item_sk#0L))
               :                 :              +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
               :                 +- Project [d_date_sk#0, d_year#0]
               :                    +- Filter ((isnotnull(d_date_sk#0) && (d_year#0 = 2000)) && isnotnull(d_year#0))
               :                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               +- 'Filter (coalesce(cs_qty#0L, 0) > 0)
                  +- 'Aggregate [d_year#0, cs_item_sk#0, cs_bill_customer_sk#0], [d_year#0 AS cs_sold_year#0, cs_item_sk#0, cs_bill_customer_sk#0 AS cs_customer_sk#0, sum(cast(cs_quantity#0 as bigint)) AS cs_qty#0L, MakeDecimal(sum(UnscaledValue(cs_wholesale_cost#0)),17,2) AS cs_wc#0, MakeDecimal(sum(UnscaledValue(cs_sales_price#0)),17,2) AS cs_sp#0]
                     +- 'Project [cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0, cs_wholesale_cost#0, cs_sales_price#0, d_year#0]
                        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                           :- 'Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0, cs_wholesale_cost#0, cs_sales_price#0]
                           :  +- 'Filter isnull(cr_order_number#0)
                           :     +- 'Join LeftOuter, ((cr_order_number#0 = cs_order_number#0) && (cs_item_sk#0 = cr_item_sk#0))
                           :        :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_wholesale_cost#0, cs_sales_price#0]
                           :        :  +- Filter ((isnotnull(cs_sold_date_sk#0) && isnotnull(cs_item_sk#0)) && isnotnull(cs_bill_customer_sk#0))
                           :        :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                           :        +- Project [cr_item_sk#0, cr_order_number#0]
                           :           +- Filter (isnotnull(cr_order_number#0) && isnotnull(cr_item_sk#0))
                           :              +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
                           +- Project [d_date_sk#0, d_year#0]
                              +- Filter ((isnotnull(d_date_sk#0) && isnotnull(d_year#0)) && (d_year#0 = 2000))
                                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q79
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Project [c_last_name#0, c_first_name#0, substring(s_city, 1, 30)#0, ss_ticket_number#0, amt#0, profit#0]
      +- 'Sort [c_last_name#0 ASC NULLS FIRST, c_first_name#0 ASC NULLS FIRST, substring(s_city#0, 1, 30) ASC NULLS FIRST, profit#0 ASC NULLS FIRST], true
         +- 'Project [c_last_name#0, c_first_name#0, substring(s_city#0, 1, 30) AS substring(s_city, 1, 30)#0, ss_ticket_number#0, amt#0, profit#0, s_city#0]
            +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
               :- 'Aggregate [ss_ticket_number#0, ss_customer_sk#0, ss_addr_sk#0, s_city#0], [ss_ticket_number#0, ss_customer_sk#0, s_city#0, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#0)),17,2) AS amt#0, MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS profit#0]
               :  +- 'Project [ss_customer_sk#0, ss_addr_sk#0, ss_ticket_number#0, ss_coupon_amt#0, ss_net_profit#0, s_city#0]
               :     +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
               :        :- 'Project [ss_customer_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_ticket_number#0, ss_coupon_amt#0, ss_net_profit#0, s_city#0]
               :        :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :        :     :- 'Project [ss_customer_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_ticket_number#0, ss_coupon_amt#0, ss_net_profit#0]
               :        :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :        :     :     :- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_ticket_number#0, ss_coupon_amt#0, ss_net_profit#0]
               :        :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_hdemo_sk#0)) && isnotnull(ss_customer_sk#0))
               :        :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :        :     :     +- Project [d_date_sk#0]
               :        :     :        +- Filter (((isnotnull(d_dow#0) && (d_dow#0 = 1)) && d_year#0 IN (1999,2000,2001)) && isnotnull(d_date_sk#0))
               :        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :        :     +- Project [s_store_sk#0, s_city#0]
               :        :        +- Filter (((isnotnull(s_number_employees#0) && (s_number_employees#0 >= 200)) && (s_number_employees#0 <= 295)) && isnotnull(s_store_sk#0))
               :        :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :        +- Project [hd_demo_sk#0]
               :           +- Filter (((hd_dep_count#0 = 6) || (hd_vehicle_count#0 > 2)) && isnotnull(hd_demo_sk#0))
               :              +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
               +- Project [c_customer_sk#0, c_first_name#0, c_last_name#0]
                  +- Filter isnotnull(c_customer_sk#0)
                     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet


================================================================================================
q80
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [channel#0 ASC NULLS FIRST, id#0 ASC NULLS FIRST], true
      +- 'Aggregate [channel#0, id#0, spark_grouping_id#0], [channel#0, id#0, sum(sales#0) AS sales#0, sum(returns#0) AS returns#0, sum(profit#0) AS profit#0]
         +- 'Expand [List(sales#0, returns#0, profit#0, channel#0, id#0, 0), List(sales#0, returns#0, profit#0, channel#0, null, 1), List(sales#0, returns#0, profit#0, null, null, 3)], [sales#0, returns#0, profit#0, channel#0, id#0, spark_grouping_id#0]
            +- 'Union
               :- 'Aggregate [s_store_id#0], [MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS sales#0, sum(coalesce(cast(sr_return_amt#0 as decimal(12,2)), 0.00)) AS returns#0, sum(CheckOverflow((promote_precision(cast(ss_net_profit#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#0, store channel AS channel#0, concat(store, s_store_id#0) AS id#0]
               :  +- 'Project [ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0, s_store_id#0]
               :     +- 'Join Inner, (ss_promo_sk#0 = p_promo_sk#0)
               :        :- 'Project [ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0, s_store_id#0]
               :        :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :        :     :- 'Project [ss_item_sk#0, ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0, s_store_id#0]
               :        :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :        :     :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0]
               :        :     :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :        :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0]
               :        :     :     :     :  +- 'Join LeftOuter, ((cast(ss_item_sk#0 as bigint) = sr_item_sk#0L) && (cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L))
               :        :     :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ticket_number#0, ss_ext_sales_price#0, ss_net_profit#0]
               :        :     :     :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0)) && isnotnull(ss_promo_sk#0))
               :        :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :        :     :     :     :     +- Project [sr_item_sk#0L, sr_ticket_number#0L, sr_return_amt#0, sr_net_loss#0]
               :        :     :     :     :        +- Filter (isnotnull(sr_item_sk#0L) && isnotnull(sr_ticket_number#0L))
               :        :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               :        :     :     :     +- Project [d_date_sk#0]
               :        :     :     :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 11192)) && (d_date#0 <= 11222)) && isnotnull(d_date_sk#0))
               :        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :        :     :     +- Project [s_store_sk#0, s_store_id#0]
               :        :     :        +- Filter isnotnull(s_store_sk#0)
               :        :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :        :     +- Project [i_item_sk#0]
               :        :        +- Filter ((isnotnull(i_current_price#0) && (i_current_price#0 > 50.00)) && isnotnull(i_item_sk#0))
               :        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :        +- Project [p_promo_sk#0]
               :           +- Filter ((isnotnull(p_channel_tv#0) && (p_channel_tv#0 = N)) && isnotnull(p_promo_sk#0))
               :              +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
               :- 'Aggregate [cp_catalog_page_id#0], [MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS sales#0, sum(coalesce(cast(cr_return_amount#0 as decimal(12,2)), 0.00)) AS returns#0, sum(CheckOverflow((promote_precision(cast(cs_net_profit#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#0, catalog channel AS channel#0, concat(catalog_page, cp_catalog_page_id#0) AS id#0]
               :  +- 'Project [cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0, cp_catalog_page_id#0]
               :     +- 'Join Inner, (cs_promo_sk#0 = p_promo_sk#0)
               :        :- 'Project [cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0, cp_catalog_page_id#0]
               :        :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
               :        :     :- 'Project [cs_item_sk#0, cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0, cp_catalog_page_id#0]
               :        :     :  +- 'Join Inner, (cs_catalog_page_sk#0 = cp_catalog_page_sk#0)
               :        :     :     :- 'Project [cs_catalog_page_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0]
               :        :     :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :        :     :     :     :- 'Project [cs_sold_date_sk#0, cs_catalog_page_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0]
               :        :     :     :     :  +- 'Join LeftOuter, ((cs_item_sk#0 = cr_item_sk#0) && (cs_order_number#0 = cr_order_number#0))
               :        :     :     :     :     :- Project [cs_sold_date_sk#0, cs_catalog_page_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, cs_ext_sales_price#0, cs_net_profit#0]
               :        :     :     :     :     :  +- Filter (((isnotnull(cs_sold_date_sk#0) && isnotnull(cs_catalog_page_sk#0)) && isnotnull(cs_item_sk#0)) && isnotnull(cs_promo_sk#0))
               :        :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :        :     :     :     :     +- Project [cr_item_sk#0, cr_order_number#0, cr_return_amount#0, cr_net_loss#0]
               :        :     :     :     :        +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
               :        :     :     :     :           +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
               :        :     :     :     +- Project [d_date_sk#0]
               :        :     :     :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 11192)) && (d_date#0 <= 11222)) && isnotnull(d_date_sk#0))
               :        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :        :     :     +- Project [cp_catalog_page_sk#0, cp_catalog_page_id#0]
               :        :     :        +- Filter isnotnull(cp_catalog_page_sk#0)
               :        :     :           +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#0,cp_start_date_sk#0,cp_end_date_sk#0,cp_department#0,cp_catalog_number#0,cp_catalog_page_number#0,cp_description#0,cp_type#0] parquet
               :        :     +- Project [i_item_sk#0]
               :        :        +- Filter ((isnotnull(i_current_price#0) && (i_current_price#0 > 50.00)) && isnotnull(i_item_sk#0))
               :        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :        +- Project [p_promo_sk#0]
               :           +- Filter ((isnotnull(p_channel_tv#0) && (p_channel_tv#0 = N)) && isnotnull(p_promo_sk#0))
               :              +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
               +- 'Aggregate [web_site_id#0], [MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS sales#0, sum(coalesce(cast(wr_return_amt#0 as decimal(12,2)), 0.00)) AS returns#0, sum(CheckOverflow((promote_precision(cast(ws_net_profit#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#0, web channel AS channel#0, concat(web_site, web_site_id#0) AS id#0]
                  +- 'Project [ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0, web_site_id#0]
                     +- 'Join Inner, (ws_promo_sk#0 = p_promo_sk#0)
                        :- 'Project [ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0, web_site_id#0]
                        :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                        :     :- 'Project [ws_item_sk#0, ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0, web_site_id#0]
                        :     :  +- 'Join Inner, (ws_web_site_sk#0 = web_site_sk#0)
                        :     :     :- 'Project [ws_item_sk#0, ws_web_site_sk#0, ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0]
                        :     :     :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                        :     :     :     :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_web_site_sk#0, ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0]
                        :     :     :     :  +- 'Join LeftOuter, ((cast(ws_item_sk#0 as bigint) = wr_item_sk#0L) && (cast(ws_order_number#0 as bigint) = wr_order_number#0L))
                        :     :     :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_web_site_sk#0, ws_promo_sk#0, ws_order_number#0, ws_ext_sales_price#0, ws_net_profit#0]
                        :     :     :     :     :  +- Filter (((isnotnull(ws_sold_date_sk#0) && isnotnull(ws_web_site_sk#0)) && isnotnull(ws_item_sk#0)) && isnotnull(ws_promo_sk#0))
                        :     :     :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                        :     :     :     :     +- Project [wr_item_sk#0L, wr_order_number#0L, wr_return_amt#0, wr_net_loss#0]
                        :     :     :     :        +- Filter (isnotnull(wr_item_sk#0L) && isnotnull(wr_order_number#0L))
                        :     :     :     :           +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
                        :     :     :     +- Project [d_date_sk#0]
                        :     :     :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 11192)) && (d_date#0 <= 11222)) && isnotnull(d_date_sk#0))
                        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        :     :     +- Project [web_site_sk#0, web_site_id#0]
                        :     :        +- Filter isnotnull(web_site_sk#0)
                        :     :           +- Relation[web_site_sk#0,web_site_id#0,web_rec_start_date#0,web_rec_end_date#0,web_name#0,web_open_date_sk#0,web_close_date_sk#0,web_class#0,web_manager#0,web_mkt_id#0,web_mkt_class#0,web_mkt_desc#0,web_market_manager#0,web_company_id#0,web_company_name#0,web_street_number#0,web_street_name#0,web_street_type#0,web_suite_number#0,web_city#0,web_county#0,web_state#0,web_zip#0,web_country#0,... 2 more fields] parquet
                        :     +- Project [i_item_sk#0]
                        :        +- Filter ((isnotnull(i_current_price#0) && (i_current_price#0 > 50.00)) && isnotnull(i_item_sk#0))
                        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        +- Project [p_promo_sk#0]
                           +- Filter ((isnotnull(p_channel_tv#0) && (p_channel_tv#0 = N)) && isnotnull(p_promo_sk#0))
                              +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet


================================================================================================
q81
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [c_customer_id#0 ASC NULLS FIRST, c_salutation#0 ASC NULLS FIRST, c_first_name#0 ASC NULLS FIRST, c_last_name#0 ASC NULLS FIRST, ca_street_number#0 ASC NULLS FIRST, ca_street_name#0 ASC NULLS FIRST, ca_street_type#0 ASC NULLS FIRST, ca_suite_number#0 ASC NULLS FIRST, ca_city#0 ASC NULLS FIRST, ca_county#0 ASC NULLS FIRST, ca_state#0 ASC NULLS FIRST, ca_zip#0 ASC NULLS FIRST, ca_country#0 ASC NULLS FIRST, ca_gmt_offset#0 ASC NULLS FIRST, ca_location_type#0 ASC NULLS FIRST, ctr_total_return#0 ASC NULLS FIRST], true
      +- 'Project [c_customer_id#0, c_salutation#0, c_first_name#0, c_last_name#0, ca_street_number#0, ca_street_name#0, ca_street_type#0, ca_suite_number#0, ca_city#0, ca_county#0, ca_state#0, ca_zip#0, ca_country#0, ca_gmt_offset#0, ca_location_type#0, ctr_total_return#0]
         +- 'Join Inner, (ca_address_sk#0 = c_current_addr_sk#0)
            :- 'Project [ctr_total_return#0, c_customer_id#0, c_current_addr_sk#0, c_salutation#0, c_first_name#0, c_last_name#0]
            :  +- 'Join Inner, (ctr_customer_sk#0 = c_customer_sk#0)
            :     :- 'Project [ctr_customer_sk#0, ctr_total_return#0]
            :     :  +- 'Join Inner, ((cast(ctr_total_return#0 as decimal(24,7)) > (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#0) && (ctr_state#0 = ctr_state#7497#0))
            :     :     :- 'Filter isnotnull(ctr_total_return#0)
            :     :     :  +- 'Aggregate [cr_returning_customer_sk#0, ca_state#0], [cr_returning_customer_sk#0 AS ctr_customer_sk#0, ca_state#0 AS ctr_state#0, MakeDecimal(sum(UnscaledValue(cr_return_amt_inc_tax#0)),17,2) AS ctr_total_return#0]
            :     :     :     +- 'Project [cr_returning_customer_sk#0, cr_return_amt_inc_tax#0, ca_state#0]
            :     :     :        +- 'Join Inner, (cr_returning_addr_sk#0 = ca_address_sk#0)
            :     :     :           :- 'Project [cr_returning_customer_sk#0, cr_returning_addr_sk#0, cr_return_amt_inc_tax#0]
            :     :     :           :  +- 'Join Inner, (cr_returned_date_sk#0 = d_date_sk#0)
            :     :     :           :     :- Project [cr_returned_date_sk#0, cr_returning_customer_sk#0, cr_returning_addr_sk#0, cr_return_amt_inc_tax#0]
            :     :     :           :     :  +- Filter ((isnotnull(cr_returned_date_sk#0) && isnotnull(cr_returning_addr_sk#0)) && isnotnull(cr_returning_customer_sk#0))
            :     :     :           :     :     +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
            :     :     :           :     +- Project [d_date_sk#0]
            :     :     :           :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
            :     :     :           :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :           +- Project [ca_address_sk#0, ca_state#0]
            :     :     :              +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_state#0))
            :     :     :                 +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
            :     :     +- 'Filter isnotnull((CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#0)
            :     :        +- 'Aggregate [ctr_state#0], [CheckOverflow((promote_precision(avg(ctr_total_return#0)) * 1.200000), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#0, ctr_state#0 AS ctr_state#7497#0]
            :     :           +- 'Aggregate [cr_returning_customer_sk#0, ca_state#0], [ca_state#0 AS ctr_state#0, MakeDecimal(sum(UnscaledValue(cr_return_amt_inc_tax#0)),17,2) AS ctr_total_return#0]
            :     :              +- 'Project [cr_returning_customer_sk#0, cr_return_amt_inc_tax#0, ca_state#0]
            :     :                 +- 'Join Inner, (cr_returning_addr_sk#0 = ca_address_sk#0)
            :     :                    :- 'Project [cr_returning_customer_sk#0, cr_returning_addr_sk#0, cr_return_amt_inc_tax#0]
            :     :                    :  +- 'Join Inner, (cr_returned_date_sk#0 = d_date_sk#0)
            :     :                    :     :- Project [cr_returned_date_sk#0, cr_returning_customer_sk#0, cr_returning_addr_sk#0, cr_return_amt_inc_tax#0]
            :     :                    :     :  +- Filter (isnotnull(cr_returned_date_sk#0) && isnotnull(cr_returning_addr_sk#0))
            :     :                    :     :     +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
            :     :                    :     +- Project [d_date_sk#0]
            :     :                    :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
            :     :                    :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                    +- Project [ca_address_sk#0, ca_state#0]
            :     :                       +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_state#0))
            :     :                          +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
            :     +- Project [c_customer_sk#0, c_customer_id#0, c_current_addr_sk#0, c_salutation#0, c_first_name#0, c_last_name#0]
            :        +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_current_addr_sk#0))
            :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            +- Project [ca_address_sk#0, ca_street_number#0, ca_street_name#0, ca_street_type#0, ca_suite_number#0, ca_city#0, ca_county#0, ca_state#0, ca_zip#0, ca_country#0, ca_gmt_offset#0, ca_location_type#0]
               +- Filter ((isnotnull(ca_state#0) && (ca_state#0 = GA)) && isnotnull(ca_address_sk#0))
                  +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet


================================================================================================
q82
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_item_id#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_item_id#0, i_item_desc#0, i_current_price#0], [i_item_id#0, i_item_desc#0, i_current_price#0]
         +- 'Project [i_item_id#0, i_item_desc#0, i_current_price#0]
            +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :- 'Project [i_item_sk#0, i_item_id#0, i_item_desc#0, i_current_price#0]
               :  +- 'Join Inner, (d_date_sk#0 = inv_date_sk#0)
               :     :- 'Project [i_item_sk#0, i_item_id#0, i_item_desc#0, i_current_price#0, inv_date_sk#0]
               :     :  +- 'Join Inner, (inv_item_sk#0 = i_item_sk#0)
               :     :     :- Project [i_item_sk#0, i_item_id#0, i_item_desc#0, i_current_price#0]
               :     :     :  +- Filter ((((isnotnull(i_current_price#0) && (i_current_price#0 >= 62.00)) && (cast(i_current_price#0 as decimal(12,2)) <= 92.00)) && i_manufact_id#0 IN (129,270,821,423)) && isnotnull(i_item_sk#0))
               :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :     :     +- Project [inv_date_sk#0, inv_item_sk#0]
               :     :        +- Filter ((((isnotnull(inv_quantity_on_hand#0) && (inv_quantity_on_hand#0 >= 100)) && (inv_quantity_on_hand#0 <= 500)) && isnotnull(inv_item_sk#0)) && isnotnull(inv_date_sk#0))
               :     :           +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
               :     +- Project [d_date_sk#0]
               :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 11102)) && (d_date#0 <= 11162)) && isnotnull(d_date_sk#0))
               :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               +- Project [ss_item_sk#0]
                  +- Filter isnotnull(ss_item_sk#0)
                     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet


================================================================================================
q83
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [item_id#0 ASC NULLS FIRST, sr_item_qty#0L ASC NULLS FIRST], true
      +- 'Project [item_id#0, sr_item_qty#0L, (((cast(sr_item_qty#0L as double) / cast(((sr_item_qty#0L + cr_item_qty#0L) + wr_item_qty#0L) as double)) / 3.0) * 100.0) AS sr_dev#0, cr_item_qty#0L, (((cast(cr_item_qty#0L as double) / cast(((sr_item_qty#0L + cr_item_qty#0L) + wr_item_qty#0L) as double)) / 3.0) * 100.0) AS cr_dev#0, wr_item_qty#0L, (((cast(wr_item_qty#0L as double) / cast(((sr_item_qty#0L + cr_item_qty#0L) + wr_item_qty#0L) as double)) / 3.0) * 100.0) AS wr_dev#0, CheckOverflow((promote_precision(cast(cast(((sr_item_qty#0L + cr_item_qty#0L) + wr_item_qty#0L) as decimal(20,0)) as decimal(21,1))) / 3.0), DecimalType(27,6)) AS average#0]
         +- 'Join Inner, (item_id#0 = item_id#0)
            :- 'Project [item_id#0, sr_item_qty#0L, cr_item_qty#0L]
            :  +- 'Join Inner, (item_id#0 = item_id#0)
            :     :- 'Aggregate [i_item_id#0], [i_item_id#0 AS item_id#0, sum(cast(sr_return_quantity#0 as bigint)) AS sr_item_qty#0L]
            :     :  +- 'Project [sr_return_quantity#0, i_item_id#0]
            :     :     +- 'Join Inner, (sr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
            :     :        :- 'Project [sr_returned_date_sk#0L, sr_return_quantity#0, i_item_id#0]
            :     :        :  +- 'Join Inner, (sr_item_sk#0L = cast(i_item_sk#0 as bigint))
            :     :        :     :- Project [sr_returned_date_sk#0L, sr_item_sk#0L, sr_return_quantity#0]
            :     :        :     :  +- Filter (isnotnull(sr_item_sk#0L) && isnotnull(sr_returned_date_sk#0L))
            :     :        :     :     +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
            :     :        :     +- Project [i_item_sk#0, i_item_id#0]
            :     :        :        +- Filter (isnotnull(i_item_sk#0) && isnotnull(i_item_id#0))
            :     :        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :        +- 'Project [d_date_sk#0]
            :     :           +- 'Join LeftSemi, (d_date#0 = d_date#26#0)
            :     :              :- Project [d_date_sk#0, d_date#0]
            :     :              :  +- Filter isnotnull(d_date#0)
            :     :              :     +- Filter isnotnull(d_date_sk#0)
            :     :              :        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              +- 'Project [d_date#0 AS d_date#26#0]
            :     :                 +- 'Filter isnotnull(d_date#0)
            :     :                    +- 'Join LeftSemi, (d_week_seq#0 = d_week_seq#28#0)
            :     :                       :- Project [d_date#0, d_week_seq#0]
            :     :                       :  +- Filter isnotnull(d_week_seq#0)
            :     :                       :     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                       +- Project [d_week_seq#0 AS d_week_seq#28#0]
            :     :                          +- Filter isnotnull(d_week_seq#0)
            :     :                             +- Filter cast(d_date#0 as string) IN (2000-06-30,2000-09-27,2000-11-17)
            :     :                                +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     +- 'Aggregate [i_item_id#0], [i_item_id#0 AS item_id#0, sum(cast(cr_return_quantity#0 as bigint)) AS cr_item_qty#0L]
            :        +- 'Project [cr_return_quantity#0, i_item_id#0]
            :           +- 'Join Inner, (cr_returned_date_sk#0 = d_date_sk#0)
            :              :- 'Project [cr_returned_date_sk#0, cr_return_quantity#0, i_item_id#0]
            :              :  +- 'Join Inner, (cr_item_sk#0 = i_item_sk#0)
            :              :     :- Project [cr_returned_date_sk#0, cr_item_sk#0, cr_return_quantity#0]
            :              :     :  +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_returned_date_sk#0))
            :              :     :     +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
            :              :     +- Project [i_item_sk#0, i_item_id#0]
            :              :        +- Filter (isnotnull(i_item_sk#0) && isnotnull(i_item_id#0))
            :              :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              +- 'Project [d_date_sk#0]
            :                 +- 'Join LeftSemi, (d_date#0 = d_date#26#0)
            :                    :- Project [d_date_sk#0, d_date#0]
            :                    :  +- Filter isnotnull(d_date#0)
            :                    :     +- Filter isnotnull(d_date_sk#0)
            :                    :        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                    +- 'Project [d_date#0 AS d_date#26#0]
            :                       +- 'Filter isnotnull(d_date#0)
            :                          +- 'Join LeftSemi, (d_week_seq#0 = d_week_seq#28#0)
            :                             :- Project [d_date#0, d_week_seq#0]
            :                             :  +- Filter isnotnull(d_week_seq#0)
            :                             :     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                             +- Project [d_week_seq#0 AS d_week_seq#28#0]
            :                                +- Filter isnotnull(d_week_seq#0)
            :                                   +- Filter cast(d_date#0 as string) IN (2000-06-30,2000-09-27,2000-11-17)
            :                                      +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- 'Aggregate [i_item_id#0], [i_item_id#0 AS item_id#0, sum(cast(wr_return_quantity#0 as bigint)) AS wr_item_qty#0L]
               +- 'Project [wr_return_quantity#0, i_item_id#0]
                  +- 'Join Inner, (wr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
                     :- 'Project [wr_returned_date_sk#0L, wr_return_quantity#0, i_item_id#0]
                     :  +- 'Join Inner, (wr_item_sk#0L = cast(i_item_sk#0 as bigint))
                     :     :- Project [wr_returned_date_sk#0L, wr_item_sk#0L, wr_return_quantity#0]
                     :     :  +- Filter (isnotnull(wr_item_sk#0L) && isnotnull(wr_returned_date_sk#0L))
                     :     :     +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
                     :     +- Project [i_item_sk#0, i_item_id#0]
                     :        +- Filter (isnotnull(i_item_sk#0) && isnotnull(i_item_id#0))
                     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     +- 'Project [d_date_sk#0]
                        +- 'Join LeftSemi, (d_date#0 = d_date#26#0)
                           :- Project [d_date_sk#0, d_date#0]
                           :  +- Filter isnotnull(d_date#0)
                           :     +- Filter isnotnull(d_date_sk#0)
                           :        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                           +- 'Project [d_date#0 AS d_date#26#0]
                              +- 'Filter isnotnull(d_date#0)
                                 +- 'Join LeftSemi, (d_week_seq#0 = d_week_seq#28#0)
                                    :- Project [d_date#0, d_week_seq#0]
                                    :  +- Filter isnotnull(d_week_seq#0)
                                    :     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                                    +- Project [d_week_seq#0 AS d_week_seq#28#0]
                                       +- Filter isnotnull(d_week_seq#0)
                                          +- Filter cast(d_date#0 as string) IN (2000-06-30,2000-09-27,2000-11-17)
                                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q84
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Project [customer_id#0, customername#0]
      +- 'Sort [c_customer_id#0 ASC NULLS FIRST], true
         +- 'Project [c_customer_id#0 AS customer_id#0, concat(c_last_name#0, , , c_first_name#0) AS customername#0, c_customer_id#0]
            +- 'Join Inner, (sr_cdemo_sk#0L = cast(cd_demo_sk#0 as bigint))
               :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, cd_demo_sk#0]
               :  +- 'Join Inner, (ib_income_band_sk#0 = hd_income_band_sk#0)
               :     :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, cd_demo_sk#0, hd_income_band_sk#0]
               :     :  +- 'Join Inner, (hd_demo_sk#0 = c_current_hdemo_sk#0)
               :     :     :- 'Project [c_customer_id#0, c_current_hdemo_sk#0, c_first_name#0, c_last_name#0, cd_demo_sk#0]
               :     :     :  +- 'Join Inner, (cd_demo_sk#0 = c_current_cdemo_sk#0)
               :     :     :     :- 'Project [c_customer_id#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_first_name#0, c_last_name#0]
               :     :     :     :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
               :     :     :     :     :- Project [c_customer_id#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, c_first_name#0, c_last_name#0]
               :     :     :     :     :  +- Filter ((isnotnull(c_current_addr_sk#0) && isnotnull(c_current_cdemo_sk#0)) && isnotnull(c_current_hdemo_sk#0))
               :     :     :     :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
               :     :     :     :     +- Project [ca_address_sk#0]
               :     :     :     :        +- Filter ((isnotnull(ca_city#0) && (ca_city#0 = Edgewood)) && isnotnull(ca_address_sk#0))
               :     :     :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               :     :     :     +- Project [cd_demo_sk#0]
               :     :     :        +- Filter isnotnull(cd_demo_sk#0)
               :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
               :     :     +- Project [hd_demo_sk#0, hd_income_band_sk#0]
               :     :        +- Filter (isnotnull(hd_demo_sk#0) && isnotnull(hd_income_band_sk#0))
               :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
               :     +- Project [ib_income_band_sk#0]
               :        +- Filter ((((isnotnull(ib_lower_bound#0) && isnotnull(ib_upper_bound#0)) && (ib_lower_bound#0 >= 38128)) && (ib_upper_bound#0 <= 88128)) && isnotnull(ib_income_band_sk#0))
               :           +- Relation[ib_income_band_sk#0,ib_lower_bound#0,ib_upper_bound#0] parquet
               +- Project [sr_cdemo_sk#0L]
                  +- Filter isnotnull(sr_cdemo_sk#0L)
                     +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet


================================================================================================
q85
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Project [substring(r_reason_desc, 1, 20)#0, avg(ws_quantity)#0, avg(wr_refunded_cash)#0, avg(wr_fee)#0]
      +- 'Sort [substring(r_reason_desc, 1, 20)#0 ASC NULLS FIRST, aggOrder#0 ASC NULLS FIRST, avg(wr_refunded_cash)#0 ASC NULLS FIRST, avg(wr_fee)#0 ASC NULLS FIRST], true
         +- 'Aggregate [r_reason_desc#0], [substring(r_reason_desc#0, 1, 20) AS substring(r_reason_desc, 1, 20)#0, avg(cast(ws_quantity#0 as bigint)) AS avg(ws_quantity)#0, cast((avg(UnscaledValue(wr_refunded_cash#0)) / 100.0) as decimal(11,6)) AS avg(wr_refunded_cash)#0, cast((avg(UnscaledValue(wr_fee#0)) / 100.0) as decimal(11,6)) AS avg(wr_fee)#0, avg(cast(ws_quantity#0 as bigint)) AS aggOrder#0]
            +- 'Project [ws_quantity#0, wr_fee#0, wr_refunded_cash#0, r_reason_desc#0]
               +- 'Join Inner, (cast(r_reason_sk#0 as bigint) = wr_reason_sk#0L)
                  :- 'Project [ws_quantity#0, wr_reason_sk#0L, wr_fee#0, wr_refunded_cash#0]
                  :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                  :     :- 'Project [ws_sold_date_sk#0, ws_quantity#0, wr_reason_sk#0L, wr_fee#0, wr_refunded_cash#0]
                  :     :  +- 'Join Inner, ((cast(ca_address_sk#0 as bigint) = wr_refunded_addr_sk#0L) && ((((ca_state#0 IN (IN,OH,NJ) && (ws_net_profit#0 >= 100.00)) && (ws_net_profit#0 <= 200.00)) || ((ca_state#0 IN (WI,CT,KY) && (ws_net_profit#0 >= 150.00)) && (ws_net_profit#0 <= 300.00))) || ((ca_state#0 IN (LA,IA,AR) && (ws_net_profit#0 >= 50.00)) && (ws_net_profit#0 <= 250.00))))
                  :     :     :- 'Project [ws_sold_date_sk#0, ws_quantity#0, ws_net_profit#0, wr_refunded_addr_sk#0L, wr_reason_sk#0L, wr_fee#0, wr_refunded_cash#0]
                  :     :     :  +- 'Join Inner, (((cast(cd_demo_sk#0 as bigint) = wr_returning_cdemo_sk#0L) && (cd_marital_status#0 = cd_marital_status#0)) && (cd_education_status#0 = cd_education_status#0))
                  :     :     :     :- 'Project [ws_sold_date_sk#0, ws_quantity#0, ws_net_profit#0, wr_refunded_addr_sk#0L, wr_returning_cdemo_sk#0L, wr_reason_sk#0L, wr_fee#0, wr_refunded_cash#0, cd_marital_status#0, cd_education_status#0]
                  :     :     :     :  +- 'Join Inner, (((((((cd_marital_status#0 = M) && (cd_education_status#0 = Advanced Degree)) && (ws_sales_price#0 >= 100.00)) && (ws_sales_price#0 <= 150.00)) || ((((cd_marital_status#0 = S) && (cd_education_status#0 = College)) && (ws_sales_price#0 >= 50.00)) && (ws_sales_price#0 <= 100.00))) || ((((cd_marital_status#0 = W) && (cd_education_status#0 = 2 yr Degree)) && (ws_sales_price#0 >= 150.00)) && (ws_sales_price#0 <= 200.00))) && (cast(cd_demo_sk#0 as bigint) = wr_refunded_cdemo_sk#0L))
                  :     :     :     :     :- 'Project [ws_sold_date_sk#0, ws_quantity#0, ws_sales_price#0, ws_net_profit#0, wr_refunded_cdemo_sk#0L, wr_refunded_addr_sk#0L, wr_returning_cdemo_sk#0L, wr_reason_sk#0L, wr_fee#0, wr_refunded_cash#0]
                  :     :     :     :     :  +- 'Join Inner, (ws_web_page_sk#0 = wp_web_page_sk#0)
                  :     :     :     :     :     :- 'Project [ws_sold_date_sk#0, ws_web_page_sk#0, ws_quantity#0, ws_sales_price#0, ws_net_profit#0, wr_refunded_cdemo_sk#0L, wr_refunded_addr_sk#0L, wr_returning_cdemo_sk#0L, wr_reason_sk#0L, wr_fee#0, wr_refunded_cash#0]
                  :     :     :     :     :     :  +- 'Join Inner, ((cast(ws_item_sk#0 as bigint) = wr_item_sk#0L) && (cast(ws_order_number#0 as bigint) = wr_order_number#0L))
                  :     :     :     :     :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_web_page_sk#0, ws_order_number#0, ws_quantity#0, ws_sales_price#0, ws_net_profit#0]
                  :     :     :     :     :     :     :  +- Filter (((isnotnull(ws_item_sk#0) && isnotnull(ws_order_number#0)) && isnotnull(ws_web_page_sk#0)) && isnotnull(ws_sold_date_sk#0))
                  :     :     :     :     :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                  :     :     :     :     :     :     +- Project [wr_item_sk#0L, wr_refunded_cdemo_sk#0L, wr_refunded_addr_sk#0L, wr_returning_cdemo_sk#0L, wr_reason_sk#0L, wr_order_number#0L, wr_fee#0, wr_refunded_cash#0]
                  :     :     :     :     :     :        +- Filter (((((isnotnull(wr_item_sk#0L) && isnotnull(wr_order_number#0L)) && isnotnull(wr_refunded_cdemo_sk#0L)) && isnotnull(wr_returning_cdemo_sk#0L)) && isnotnull(wr_refunded_addr_sk#0L)) && isnotnull(wr_reason_sk#0L))
                  :     :     :     :     :     :           +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
                  :     :     :     :     :     +- Project [wp_web_page_sk#0]
                  :     :     :     :     :        +- Filter isnotnull(wp_web_page_sk#0)
                  :     :     :     :     :           +- Relation[wp_web_page_sk#0,wp_web_page_id#0,wp_rec_start_date#0,wp_rec_end_date#0,wp_creation_date_sk#0,wp_access_date_sk#0,wp_autogen_flag#0,wp_customer_sk#0,wp_url#0,wp_type#0,wp_char_count#0,wp_link_count#0,wp_image_count#0,wp_max_ad_count#0] parquet
                  :     :     :     :     +- Project [cd_demo_sk#0, cd_marital_status#0, cd_education_status#0]
                  :     :     :     :        +- Filter ((isnotnull(cd_demo_sk#0) && isnotnull(cd_education_status#0)) && isnotnull(cd_marital_status#0))
                  :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
                  :     :     :     +- Project [cd_demo_sk#0, cd_marital_status#0, cd_education_status#0]
                  :     :     :        +- Filter ((isnotnull(cd_demo_sk#0) && isnotnull(cd_education_status#0)) && isnotnull(cd_marital_status#0))
                  :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
                  :     :     +- Project [ca_address_sk#0, ca_state#0]
                  :     :        +- Filter ((isnotnull(ca_country#0) && (ca_country#0 = United States)) && isnotnull(ca_address_sk#0))
                  :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                  :     +- Project [d_date_sk#0]
                  :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
                  :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  +- Project [r_reason_sk#0, r_reason_desc#0]
                     +- Filter isnotnull(r_reason_sk#0)
                        +- Relation[r_reason_sk#0,r_reason_id#0,r_reason_desc#0] parquet


================================================================================================
q86
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [lochierarchy#0 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#0 as int) = 0) THEN i_category#0 END ASC NULLS FIRST, rank_within_parent#0 ASC NULLS FIRST], true
      +- 'Project [total_sum#0, i_category#0, i_class#0, lochierarchy#0, rank_within_parent#0]
         +- 'Window [rank(_w3#0) windowspecdefinition(_w1#0, _w2#0, _w3#0 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#0], [_w1#0, _w2#0], [_w3#0 DESC NULLS LAST]
            +- 'Aggregate [i_category#0, i_class#0, spark_grouping_id#0], [MakeDecimal(sum(UnscaledValue(ws_net_paid#0)),17,2) AS total_sum#0, i_category#0, i_class#0, (cast((shiftright(spark_grouping_id#0, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#0, 0) & 1) as tinyint)) AS lochierarchy#0, (cast((shiftright(spark_grouping_id#0, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#0, 0) & 1) as tinyint)) AS _w1#0, CASE WHEN (cast(cast((shiftright(spark_grouping_id#0, 0) & 1) as tinyint) as int) = 0) THEN i_category#0 END AS _w2#0, MakeDecimal(sum(UnscaledValue(ws_net_paid#0)),17,2) AS _w3#0]
               +- 'Expand [List(ws_net_paid#0, i_category#0, i_class#0, 0), List(ws_net_paid#0, i_category#0, null, 1), List(ws_net_paid#0, null, null, 3)], [ws_net_paid#0, i_category#0, i_class#0, spark_grouping_id#0]
                  +- 'Project [ws_net_paid#0, i_category#0, i_class#0]
                     +- 'Join Inner, (i_item_sk#0 = ws_item_sk#0)
                        :- 'Project [ws_item_sk#0, ws_net_paid#0]
                        :  +- 'Join Inner, (d_date_sk#0 = ws_sold_date_sk#0)
                        :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_net_paid#0]
                        :     :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_item_sk#0))
                        :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                        :     +- Project [d_date_sk#0]
                        :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
                        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        +- Project [i_item_sk#0, i_class#0, i_category#0]
                           +- Filter isnotnull(i_item_sk#0)
                              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q87
================================================================================================

'Aggregate [count(1) AS count(1)#0L]
+- 'Aggregate [c_last_name#0, c_first_name#0, d_date#0]
   +- 'Join LeftAnti, (((c_last_name#0 <=> c_last_name#0) && (c_first_name#0 <=> c_first_name#0)) && (d_date#0 <=> d_date#0))
      :- 'Aggregate [c_last_name#0, c_first_name#0, d_date#0], [c_last_name#0, c_first_name#0, d_date#0]
      :  +- 'Join LeftAnti, (((c_last_name#0 <=> c_last_name#0) && (c_first_name#0 <=> c_first_name#0)) && (d_date#0 <=> d_date#0))
      :     :- 'Aggregate [c_last_name#0, c_first_name#0, d_date#0], [c_last_name#0, c_first_name#0, d_date#0]
      :     :  +- 'Project [c_last_name#0, c_first_name#0, d_date#0]
      :     :     +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
      :     :        :- 'Project [ss_customer_sk#0, d_date#0]
      :     :        :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
      :     :        :     :- Project [ss_sold_date_sk#0, ss_customer_sk#0]
      :     :        :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_customer_sk#0))
      :     :        :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :     :        :     +- Project [d_date_sk#0, d_date#0]
      :     :        :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
      :     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :     :        +- Project [c_customer_sk#0, c_first_name#0, c_last_name#0]
      :     :           +- Filter isnotnull(c_customer_sk#0)
      :     :              +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
      :     +- 'Aggregate [c_last_name#0, c_first_name#0, d_date#0], [c_last_name#0, c_first_name#0, d_date#0]
      :        +- 'Project [c_last_name#0, c_first_name#0, d_date#0]
      :           +- 'Join Inner, (cs_bill_customer_sk#0 = c_customer_sk#0)
      :              :- 'Project [cs_bill_customer_sk#0, d_date#0]
      :              :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
      :              :     :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0]
      :              :     :  +- Filter (isnotnull(cs_sold_date_sk#0) && isnotnull(cs_bill_customer_sk#0))
      :              :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
      :              :     +- Project [d_date_sk#0, d_date#0]
      :              :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
      :              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :              +- Project [c_customer_sk#0, c_first_name#0, c_last_name#0]
      :                 +- Filter isnotnull(c_customer_sk#0)
      :                    +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
      +- 'Aggregate [c_last_name#0, c_first_name#0, d_date#0], [c_last_name#0, c_first_name#0, d_date#0]
         +- 'Project [c_last_name#0, c_first_name#0, d_date#0]
            +- 'Join Inner, (ws_bill_customer_sk#0 = c_customer_sk#0)
               :- 'Project [ws_bill_customer_sk#0, d_date#0]
               :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :     :- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0]
               :     :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_bill_customer_sk#0))
               :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     +- Project [d_date_sk#0, d_date#0]
               :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
               :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               +- Project [c_customer_sk#0, c_first_name#0, c_last_name#0]
                  +- Filter isnotnull(c_customer_sk#0)
                     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet


================================================================================================
q88
================================================================================================

'Join Inner
:- 'Join Inner
:  :- 'Join Inner
:  :  :- 'Join Inner
:  :  :  :- 'Join Inner
:  :  :  :  :- 'Join Inner
:  :  :  :  :  :- 'Join Inner
:  :  :  :  :  :  :- 'Aggregate [count(1) AS h8_30_to_9#0L]
:  :  :  :  :  :  :  +- 'Project
:  :  :  :  :  :  :     +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
:  :  :  :  :  :  :        :- 'Project [ss_store_sk#0]
:  :  :  :  :  :  :        :  +- 'Join Inner, (ss_sold_time_sk#0 = t_time_sk#0)
:  :  :  :  :  :  :        :     :- 'Project [ss_sold_time_sk#0, ss_store_sk#0]
:  :  :  :  :  :  :        :     :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
:  :  :  :  :  :  :        :     :     :- Project [ss_sold_time_sk#0, ss_hdemo_sk#0, ss_store_sk#0]
:  :  :  :  :  :  :        :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#0) && isnotnull(ss_sold_time_sk#0)) && isnotnull(ss_store_sk#0))
:  :  :  :  :  :  :        :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
:  :  :  :  :  :  :        :     :     +- Project [hd_demo_sk#0]
:  :  :  :  :  :  :        :     :        +- Filter (((((hd_dep_count#0 = 4) && (hd_vehicle_count#0 <= 6)) || ((hd_dep_count#0 = 2) && (hd_vehicle_count#0 <= 4))) || ((hd_dep_count#0 = 0) && (hd_vehicle_count#0 <= 2))) && isnotnull(hd_demo_sk#0))
:  :  :  :  :  :  :        :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
:  :  :  :  :  :  :        :     +- Project [t_time_sk#0]
:  :  :  :  :  :  :        :        +- Filter ((((isnotnull(t_hour#0) && isnotnull(t_minute#0)) && (t_hour#0 = 8)) && (t_minute#0 >= 30)) && isnotnull(t_time_sk#0))
:  :  :  :  :  :  :        :           +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet
:  :  :  :  :  :  :        +- Project [s_store_sk#0]
:  :  :  :  :  :  :           +- Filter ((isnotnull(s_store_name#0) && (s_store_name#0 = ese)) && isnotnull(s_store_sk#0))
:  :  :  :  :  :  :              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
:  :  :  :  :  :  +- 'Aggregate [count(1) AS h9_to_9_30#0L]
:  :  :  :  :  :     +- 'Project
:  :  :  :  :  :        +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
:  :  :  :  :  :           :- 'Project [ss_store_sk#0]
:  :  :  :  :  :           :  +- 'Join Inner, (ss_sold_time_sk#0 = t_time_sk#0)
:  :  :  :  :  :           :     :- 'Project [ss_sold_time_sk#0, ss_store_sk#0]
:  :  :  :  :  :           :     :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
:  :  :  :  :  :           :     :     :- Project [ss_sold_time_sk#0, ss_hdemo_sk#0, ss_store_sk#0]
:  :  :  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#0) && isnotnull(ss_sold_time_sk#0)) && isnotnull(ss_store_sk#0))
:  :  :  :  :  :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
:  :  :  :  :  :           :     :     +- Project [hd_demo_sk#0]
:  :  :  :  :  :           :     :        +- Filter (((((hd_dep_count#0 = 4) && (hd_vehicle_count#0 <= 6)) || ((hd_dep_count#0 = 2) && (hd_vehicle_count#0 <= 4))) || ((hd_dep_count#0 = 0) && (hd_vehicle_count#0 <= 2))) && isnotnull(hd_demo_sk#0))
:  :  :  :  :  :           :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
:  :  :  :  :  :           :     +- Project [t_time_sk#0]
:  :  :  :  :  :           :        +- Filter ((((isnotnull(t_hour#0) && isnotnull(t_minute#0)) && (t_hour#0 = 9)) && (t_minute#0 < 30)) && isnotnull(t_time_sk#0))
:  :  :  :  :  :           :           +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet
:  :  :  :  :  :           +- Project [s_store_sk#0]
:  :  :  :  :  :              +- Filter ((isnotnull(s_store_name#0) && (s_store_name#0 = ese)) && isnotnull(s_store_sk#0))
:  :  :  :  :  :                 +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
:  :  :  :  :  +- 'Aggregate [count(1) AS h9_30_to_10#0L]
:  :  :  :  :     +- 'Project
:  :  :  :  :        +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
:  :  :  :  :           :- 'Project [ss_store_sk#0]
:  :  :  :  :           :  +- 'Join Inner, (ss_sold_time_sk#0 = t_time_sk#0)
:  :  :  :  :           :     :- 'Project [ss_sold_time_sk#0, ss_store_sk#0]
:  :  :  :  :           :     :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
:  :  :  :  :           :     :     :- Project [ss_sold_time_sk#0, ss_hdemo_sk#0, ss_store_sk#0]
:  :  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#0) && isnotnull(ss_sold_time_sk#0)) && isnotnull(ss_store_sk#0))
:  :  :  :  :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
:  :  :  :  :           :     :     +- Project [hd_demo_sk#0]
:  :  :  :  :           :     :        +- Filter (((((hd_dep_count#0 = 4) && (hd_vehicle_count#0 <= 6)) || ((hd_dep_count#0 = 2) && (hd_vehicle_count#0 <= 4))) || ((hd_dep_count#0 = 0) && (hd_vehicle_count#0 <= 2))) && isnotnull(hd_demo_sk#0))
:  :  :  :  :           :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
:  :  :  :  :           :     +- Project [t_time_sk#0]
:  :  :  :  :           :        +- Filter ((((isnotnull(t_hour#0) && isnotnull(t_minute#0)) && (t_hour#0 = 9)) && (t_minute#0 >= 30)) && isnotnull(t_time_sk#0))
:  :  :  :  :           :           +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet
:  :  :  :  :           +- Project [s_store_sk#0]
:  :  :  :  :              +- Filter ((isnotnull(s_store_name#0) && (s_store_name#0 = ese)) && isnotnull(s_store_sk#0))
:  :  :  :  :                 +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
:  :  :  :  +- 'Aggregate [count(1) AS h10_to_10_30#0L]
:  :  :  :     +- 'Project
:  :  :  :        +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
:  :  :  :           :- 'Project [ss_store_sk#0]
:  :  :  :           :  +- 'Join Inner, (ss_sold_time_sk#0 = t_time_sk#0)
:  :  :  :           :     :- 'Project [ss_sold_time_sk#0, ss_store_sk#0]
:  :  :  :           :     :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
:  :  :  :           :     :     :- Project [ss_sold_time_sk#0, ss_hdemo_sk#0, ss_store_sk#0]
:  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#0) && isnotnull(ss_sold_time_sk#0)) && isnotnull(ss_store_sk#0))
:  :  :  :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
:  :  :  :           :     :     +- Project [hd_demo_sk#0]
:  :  :  :           :     :        +- Filter (((((hd_dep_count#0 = 4) && (hd_vehicle_count#0 <= 6)) || ((hd_dep_count#0 = 2) && (hd_vehicle_count#0 <= 4))) || ((hd_dep_count#0 = 0) && (hd_vehicle_count#0 <= 2))) && isnotnull(hd_demo_sk#0))
:  :  :  :           :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
:  :  :  :           :     +- Project [t_time_sk#0]
:  :  :  :           :        +- Filter ((((isnotnull(t_hour#0) && isnotnull(t_minute#0)) && (t_hour#0 = 10)) && (t_minute#0 < 30)) && isnotnull(t_time_sk#0))
:  :  :  :           :           +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet
:  :  :  :           +- Project [s_store_sk#0]
:  :  :  :              +- Filter ((isnotnull(s_store_name#0) && (s_store_name#0 = ese)) && isnotnull(s_store_sk#0))
:  :  :  :                 +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
:  :  :  +- 'Aggregate [count(1) AS h10_30_to_11#0L]
:  :  :     +- 'Project
:  :  :        +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
:  :  :           :- 'Project [ss_store_sk#0]
:  :  :           :  +- 'Join Inner, (ss_sold_time_sk#0 = t_time_sk#0)
:  :  :           :     :- 'Project [ss_sold_time_sk#0, ss_store_sk#0]
:  :  :           :     :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
:  :  :           :     :     :- Project [ss_sold_time_sk#0, ss_hdemo_sk#0, ss_store_sk#0]
:  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#0) && isnotnull(ss_sold_time_sk#0)) && isnotnull(ss_store_sk#0))
:  :  :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
:  :  :           :     :     +- Project [hd_demo_sk#0]
:  :  :           :     :        +- Filter (((((hd_dep_count#0 = 4) && (hd_vehicle_count#0 <= 6)) || ((hd_dep_count#0 = 2) && (hd_vehicle_count#0 <= 4))) || ((hd_dep_count#0 = 0) && (hd_vehicle_count#0 <= 2))) && isnotnull(hd_demo_sk#0))
:  :  :           :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
:  :  :           :     +- Project [t_time_sk#0]
:  :  :           :        +- Filter ((((isnotnull(t_hour#0) && isnotnull(t_minute#0)) && (t_hour#0 = 10)) && (t_minute#0 >= 30)) && isnotnull(t_time_sk#0))
:  :  :           :           +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet
:  :  :           +- Project [s_store_sk#0]
:  :  :              +- Filter ((isnotnull(s_store_name#0) && (s_store_name#0 = ese)) && isnotnull(s_store_sk#0))
:  :  :                 +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
:  :  +- 'Aggregate [count(1) AS h11_to_11_30#0L]
:  :     +- 'Project
:  :        +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
:  :           :- 'Project [ss_store_sk#0]
:  :           :  +- 'Join Inner, (ss_sold_time_sk#0 = t_time_sk#0)
:  :           :     :- 'Project [ss_sold_time_sk#0, ss_store_sk#0]
:  :           :     :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
:  :           :     :     :- Project [ss_sold_time_sk#0, ss_hdemo_sk#0, ss_store_sk#0]
:  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#0) && isnotnull(ss_sold_time_sk#0)) && isnotnull(ss_store_sk#0))
:  :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
:  :           :     :     +- Project [hd_demo_sk#0]
:  :           :     :        +- Filter (((((hd_dep_count#0 = 4) && (hd_vehicle_count#0 <= 6)) || ((hd_dep_count#0 = 2) && (hd_vehicle_count#0 <= 4))) || ((hd_dep_count#0 = 0) && (hd_vehicle_count#0 <= 2))) && isnotnull(hd_demo_sk#0))
:  :           :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
:  :           :     +- Project [t_time_sk#0]
:  :           :        +- Filter ((((isnotnull(t_hour#0) && isnotnull(t_minute#0)) && (t_hour#0 = 11)) && (t_minute#0 < 30)) && isnotnull(t_time_sk#0))
:  :           :           +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet
:  :           +- Project [s_store_sk#0]
:  :              +- Filter ((isnotnull(s_store_name#0) && (s_store_name#0 = ese)) && isnotnull(s_store_sk#0))
:  :                 +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
:  +- 'Aggregate [count(1) AS h11_30_to_12#0L]
:     +- 'Project
:        +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
:           :- 'Project [ss_store_sk#0]
:           :  +- 'Join Inner, (ss_sold_time_sk#0 = t_time_sk#0)
:           :     :- 'Project [ss_sold_time_sk#0, ss_store_sk#0]
:           :     :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
:           :     :     :- Project [ss_sold_time_sk#0, ss_hdemo_sk#0, ss_store_sk#0]
:           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#0) && isnotnull(ss_sold_time_sk#0)) && isnotnull(ss_store_sk#0))
:           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
:           :     :     +- Project [hd_demo_sk#0]
:           :     :        +- Filter (((((hd_dep_count#0 = 4) && (hd_vehicle_count#0 <= 6)) || ((hd_dep_count#0 = 2) && (hd_vehicle_count#0 <= 4))) || ((hd_dep_count#0 = 0) && (hd_vehicle_count#0 <= 2))) && isnotnull(hd_demo_sk#0))
:           :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
:           :     +- Project [t_time_sk#0]
:           :        +- Filter ((((isnotnull(t_hour#0) && isnotnull(t_minute#0)) && (t_hour#0 = 11)) && (t_minute#0 >= 30)) && isnotnull(t_time_sk#0))
:           :           +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet
:           +- Project [s_store_sk#0]
:              +- Filter ((isnotnull(s_store_name#0) && (s_store_name#0 = ese)) && isnotnull(s_store_sk#0))
:                 +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
+- 'Aggregate [count(1) AS h12_to_12_30#0L]
   +- 'Project
      +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
         :- 'Project [ss_store_sk#0]
         :  +- 'Join Inner, (ss_sold_time_sk#0 = t_time_sk#0)
         :     :- 'Project [ss_sold_time_sk#0, ss_store_sk#0]
         :     :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
         :     :     :- Project [ss_sold_time_sk#0, ss_hdemo_sk#0, ss_store_sk#0]
         :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#0) && isnotnull(ss_sold_time_sk#0)) && isnotnull(ss_store_sk#0))
         :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :     :     +- Project [hd_demo_sk#0]
         :     :        +- Filter (((((hd_dep_count#0 = 4) && (hd_vehicle_count#0 <= 6)) || ((hd_dep_count#0 = 2) && (hd_vehicle_count#0 <= 4))) || ((hd_dep_count#0 = 0) && (hd_vehicle_count#0 <= 2))) && isnotnull(hd_demo_sk#0))
         :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
         :     +- Project [t_time_sk#0]
         :        +- Filter ((((isnotnull(t_hour#0) && isnotnull(t_minute#0)) && (t_hour#0 = 12)) && (t_minute#0 < 30)) && isnotnull(t_time_sk#0))
         :           +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet
         +- Project [s_store_sk#0]
            +- Filter ((isnotnull(s_store_name#0) && (s_store_name#0 = ese)) && isnotnull(s_store_sk#0))
               +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet


================================================================================================
q89
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [CheckOverflow((promote_precision(cast(sum_sales#0 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#0 ASC NULLS FIRST], true
      +- 'Project [i_category#0, i_class#0, i_brand#0, s_store_name#0, s_company_name#0, d_moy#0, sum_sales#0, avg_monthly_sales#0]
         +- 'Filter (CASE WHEN NOT (avg_monthly_sales#0 = 0.000000) THEN CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#0 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(22,6)))) / promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(38,16)) ELSE null END > 0.1000000000000000)
            +- 'Window [avg(_w0#0) windowspecdefinition(i_category#0, i_brand#0, s_store_name#0, s_company_name#0, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0]
               +- 'Aggregate [i_category#0, i_class#0, i_brand#0, s_store_name#0, s_company_name#0, d_moy#0], [i_category#0, i_class#0, i_brand#0, s_store_name#0, s_company_name#0, d_moy#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS sum_sales#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS _w0#0]
                  +- 'Project [i_brand#0, i_class#0, i_category#0, ss_sales_price#0, d_moy#0, s_store_name#0, s_company_name#0]
                     +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                        :- 'Project [i_brand#0, i_class#0, i_category#0, ss_store_sk#0, ss_sales_price#0, d_moy#0]
                        :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                        :     :- 'Project [i_brand#0, i_class#0, i_category#0, ss_sold_date_sk#0, ss_store_sk#0, ss_sales_price#0]
                        :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                        :     :     :- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0]
                        :     :     :  +- Filter (((i_category#0 IN (Books,Electronics,Sports) && i_class#0 IN (computers,stereo,football)) || (i_category#0 IN (Men,Jewelry,Women) && i_class#0 IN (shirts,birdal,dresses))) && isnotnull(i_item_sk#0))
                        :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :     :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_sales_price#0]
                        :     :        +- Filter ((isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0))
                        :     :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        :     +- Project [d_date_sk#0, d_moy#0]
                        :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 1999)) && isnotnull(d_date_sk#0))
                        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        +- Project [s_store_sk#0, s_store_name#0, s_company_name#0]
                           +- Filter isnotnull(s_store_sk#0)
                              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet


================================================================================================
q90
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [am_pm_ratio#0 ASC NULLS FIRST], true
      +- 'Project [CheckOverflow((promote_precision(cast(amc#0L as decimal(15,4))) / promote_precision(cast(pmc#0L as decimal(15,4)))), DecimalType(35,20)) AS am_pm_ratio#0]
         +- 'Join Inner
            :- 'Aggregate [count(1) AS amc#0L]
            :  +- 'Project
            :     +- 'Join Inner, (ws_web_page_sk#0 = wp_web_page_sk#0)
            :        :- 'Project [ws_web_page_sk#0]
            :        :  +- 'Join Inner, (ws_sold_time_sk#0 = t_time_sk#0)
            :        :     :- 'Project [ws_sold_time_sk#0, ws_web_page_sk#0]
            :        :     :  +- 'Join Inner, (ws_ship_hdemo_sk#0 = hd_demo_sk#0)
            :        :     :     :- Project [ws_sold_time_sk#0, ws_ship_hdemo_sk#0, ws_web_page_sk#0]
            :        :     :     :  +- Filter ((isnotnull(ws_ship_hdemo_sk#0) && isnotnull(ws_sold_time_sk#0)) && isnotnull(ws_web_page_sk#0))
            :        :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :        :     :     +- Project [hd_demo_sk#0]
            :        :     :        +- Filter ((isnotnull(hd_dep_count#0) && (hd_dep_count#0 = 6)) && isnotnull(hd_demo_sk#0))
            :        :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
            :        :     +- Project [t_time_sk#0]
            :        :        +- Filter (((isnotnull(t_hour#0) && (t_hour#0 >= 8)) && (t_hour#0 <= 9)) && isnotnull(t_time_sk#0))
            :        :           +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet
            :        +- Project [wp_web_page_sk#0]
            :           +- Filter (((isnotnull(wp_char_count#0) && (wp_char_count#0 >= 5000)) && (wp_char_count#0 <= 5200)) && isnotnull(wp_web_page_sk#0))
            :              +- Relation[wp_web_page_sk#0,wp_web_page_id#0,wp_rec_start_date#0,wp_rec_end_date#0,wp_creation_date_sk#0,wp_access_date_sk#0,wp_autogen_flag#0,wp_customer_sk#0,wp_url#0,wp_type#0,wp_char_count#0,wp_link_count#0,wp_image_count#0,wp_max_ad_count#0] parquet
            +- 'Aggregate [count(1) AS pmc#0L]
               +- 'Project
                  +- 'Join Inner, (ws_web_page_sk#0 = wp_web_page_sk#0)
                     :- 'Project [ws_web_page_sk#0]
                     :  +- 'Join Inner, (ws_sold_time_sk#0 = t_time_sk#0)
                     :     :- 'Project [ws_sold_time_sk#0, ws_web_page_sk#0]
                     :     :  +- 'Join Inner, (ws_ship_hdemo_sk#0 = hd_demo_sk#0)
                     :     :     :- Project [ws_sold_time_sk#0, ws_ship_hdemo_sk#0, ws_web_page_sk#0]
                     :     :     :  +- Filter ((isnotnull(ws_ship_hdemo_sk#0) && isnotnull(ws_sold_time_sk#0)) && isnotnull(ws_web_page_sk#0))
                     :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                     :     :     +- Project [hd_demo_sk#0]
                     :     :        +- Filter ((isnotnull(hd_dep_count#0) && (hd_dep_count#0 = 6)) && isnotnull(hd_demo_sk#0))
                     :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
                     :     +- Project [t_time_sk#0]
                     :        +- Filter (((isnotnull(t_hour#0) && (t_hour#0 >= 19)) && (t_hour#0 <= 20)) && isnotnull(t_time_sk#0))
                     :           +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet
                     +- Project [wp_web_page_sk#0]
                        +- Filter (((isnotnull(wp_char_count#0) && (wp_char_count#0 >= 5000)) && (wp_char_count#0 <= 5200)) && isnotnull(wp_web_page_sk#0))
                           +- Relation[wp_web_page_sk#0,wp_web_page_id#0,wp_rec_start_date#0,wp_rec_end_date#0,wp_creation_date_sk#0,wp_access_date_sk#0,wp_autogen_flag#0,wp_customer_sk#0,wp_url#0,wp_type#0,wp_char_count#0,wp_link_count#0,wp_image_count#0,wp_max_ad_count#0] parquet


================================================================================================
q91
================================================================================================

'Sort [Returns_Loss#0 DESC NULLS LAST], true
+- 'Aggregate [cc_call_center_id#0, cc_name#0, cc_manager#0, cd_marital_status#0, cd_education_status#0], [cc_call_center_id#0 AS Call_Center#0, cc_name#0 AS Call_Center_Name#0, cc_manager#0 AS Manager#0, MakeDecimal(sum(UnscaledValue(cr_net_loss#0)),17,2) AS Returns_Loss#0]
   +- 'Project [cc_call_center_id#0, cc_name#0, cc_manager#0, cr_net_loss#0, cd_marital_status#0, cd_education_status#0]
      +- 'Join Inner, (hd_demo_sk#0 = c_current_hdemo_sk#0)
         :- 'Project [cc_call_center_id#0, cc_name#0, cc_manager#0, cr_net_loss#0, c_current_hdemo_sk#0, cd_marital_status#0, cd_education_status#0]
         :  +- 'Join Inner, (cd_demo_sk#0 = c_current_cdemo_sk#0)
         :     :- 'Project [cc_call_center_id#0, cc_name#0, cc_manager#0, cr_net_loss#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0]
         :     :  +- 'Join Inner, (ca_address_sk#0 = c_current_addr_sk#0)
         :     :     :- 'Project [cc_call_center_id#0, cc_name#0, cc_manager#0, cr_net_loss#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0]
         :     :     :  +- 'Join Inner, (cr_returning_customer_sk#0 = c_customer_sk#0)
         :     :     :     :- 'Project [cc_call_center_id#0, cc_name#0, cc_manager#0, cr_returning_customer_sk#0, cr_net_loss#0]
         :     :     :     :  +- 'Join Inner, (cr_returned_date_sk#0 = d_date_sk#0)
         :     :     :     :     :- 'Project [cc_call_center_id#0, cc_name#0, cc_manager#0, cr_returned_date_sk#0, cr_returning_customer_sk#0, cr_net_loss#0]
         :     :     :     :     :  +- 'Join Inner, (cr_call_center_sk#0 = cc_call_center_sk#0)
         :     :     :     :     :     :- Project [cc_call_center_sk#0, cc_call_center_id#0, cc_name#0, cc_manager#0]
         :     :     :     :     :     :  +- Filter isnotnull(cc_call_center_sk#0)
         :     :     :     :     :     :     +- Relation[cc_call_center_sk#0,cc_call_center_id#0,cc_rec_start_date#0,cc_rec_end_date#0,cc_closed_date_sk#0,cc_open_date_sk#0,cc_name#0,cc_class#0,cc_employees#0,cc_sq_ft#0,cc_hours#0,cc_manager#0,cc_mkt_id#0,cc_mkt_class#0,cc_mkt_desc#0,cc_market_manager#0,cc_division#0,cc_division_name#0,cc_company#0,cc_company_name#0,cc_street_number#0,cc_street_name#0,cc_street_type#0,cc_suite_number#0,... 7 more fields] parquet
         :     :     :     :     :     +- Project [cr_returned_date_sk#0, cr_returning_customer_sk#0, cr_call_center_sk#0, cr_net_loss#0]
         :     :     :     :     :        +- Filter ((isnotnull(cr_call_center_sk#0) && isnotnull(cr_returned_date_sk#0)) && isnotnull(cr_returning_customer_sk#0))
         :     :     :     :     :           +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
         :     :     :     :     +- Project [d_date_sk#0]
         :     :     :     :        +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 1998)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
         :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :     :     :     +- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0]
         :     :     :        +- Filter (((isnotnull(c_customer_sk#0) && isnotnull(c_current_addr_sk#0)) && isnotnull(c_current_cdemo_sk#0)) && isnotnull(c_current_hdemo_sk#0))
         :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
         :     :     +- Project [ca_address_sk#0]
         :     :        +- Filter ((isnotnull(ca_gmt_offset#0) && (ca_gmt_offset#0 = -7.00)) && isnotnull(ca_address_sk#0))
         :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
         :     +- Project [cd_demo_sk#0, cd_marital_status#0, cd_education_status#0]
         :        +- Filter ((((cd_marital_status#0 = M) && (cd_education_status#0 = Unknown)) || ((cd_marital_status#0 = W) && (cd_education_status#0 = Advanced Degree))) && isnotnull(cd_demo_sk#0))
         :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
         +- Project [hd_demo_sk#0]
            +- Filter ((isnotnull(hd_buy_potential#0) && StartsWith(hd_buy_potential#0, Unknown)) && isnotnull(hd_demo_sk#0))
               +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet


================================================================================================
q92
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [Excess Discount Amount #0 ASC NULLS FIRST], true
      +- 'Aggregate [MakeDecimal(sum(UnscaledValue(ws_ext_discount_amt#0)),17,2) AS Excess Discount Amount #0]
         +- 'Project [ws_ext_discount_amt#0]
            +- 'Join Inner, (d_date_sk#0 = ws_sold_date_sk#0)
               :- 'Project [ws_sold_date_sk#0, ws_ext_discount_amt#0]
               :  +- 'Join Inner, ((cast(ws_ext_discount_amt#0 as decimal(14,7)) > (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(ws_ext_discount_amt) AS DECIMAL(11,6)))#0) && (ws_item_sk#134#0 = i_item_sk#0))
               :     :- 'Project [ws_sold_date_sk#0, ws_ext_discount_amt#0, i_item_sk#0]
               :     :  +- 'Join Inner, (i_item_sk#0 = ws_item_sk#0)
               :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_ext_discount_amt#0]
               :     :     :  +- Filter ((isnotnull(ws_item_sk#0) && isnotnull(ws_ext_discount_amt#0)) && isnotnull(ws_sold_date_sk#0))
               :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :     +- Project [i_item_sk#0]
               :     :        +- Filter ((isnotnull(i_manufact_id#0) && (i_manufact_id#0 = 350)) && isnotnull(i_item_sk#0))
               :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :     +- 'Filter isnotnull((CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(ws_ext_discount_amt) AS DECIMAL(11,6)))#0)
               :        +- 'Aggregate [ws_item_sk#0], [CheckOverflow((1.300000 * promote_precision(cast((avg(UnscaledValue(ws_ext_discount_amt#0)) / 100.0) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(ws_ext_discount_amt) AS DECIMAL(11,6)))#0, ws_item_sk#0 AS ws_item_sk#134#0]
               :           +- 'Project [ws_item_sk#0, ws_ext_discount_amt#0]
               :              +- 'Join Inner, (d_date_sk#0 = ws_sold_date_sk#0)
               :                 :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_ext_discount_amt#0]
               :                 :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_item_sk#0))
               :                 :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :                 +- Project [d_date_sk#0]
               :                    +- Filter (((isnotnull(d_date#0) && (cast(d_date#0 as string) >= 2000-01-27)) && (d_date#0 <= 11073)) && isnotnull(d_date_sk#0))
               :                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               +- Project [d_date_sk#0]
                  +- Filter (((isnotnull(d_date#0) && (cast(d_date#0 as string) >= 2000-01-27)) && (d_date#0 <= 11073)) && isnotnull(d_date_sk#0))
                     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q93
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [sumsales#0 ASC NULLS FIRST, ss_customer_sk#0 ASC NULLS FIRST], true
      +- 'Aggregate [ss_customer_sk#0], [ss_customer_sk#0, sum(act_sales#0) AS sumsales#0]
         +- 'Project [ss_customer_sk#0, CASE WHEN isnotnull(sr_return_quantity#0) THEN CheckOverflow((promote_precision(cast(cast((ss_quantity#0 - sr_return_quantity#0) as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#0 as decimal(12,2)))), DecimalType(18,2)) ELSE CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#0 as decimal(12,2)))), DecimalType(18,2)) END AS act_sales#0]
            +- 'Join Inner, (sr_reason_sk#0L = cast(r_reason_sk#0 as bigint))
               :- 'Project [ss_customer_sk#0, ss_quantity#0, ss_sales_price#0, sr_reason_sk#0L, sr_return_quantity#0]
               :  +- 'Join Inner, ((sr_item_sk#0L = cast(ss_item_sk#0 as bigint)) && (sr_ticket_number#0L = cast(ss_ticket_number#0 as bigint)))
               :     :- Project [ss_item_sk#0, ss_customer_sk#0, ss_ticket_number#0, ss_quantity#0, ss_sales_price#0]
               :     :  +- Filter (isnotnull(ss_ticket_number#0) && isnotnull(ss_item_sk#0))
               :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     +- Project [sr_item_sk#0L, sr_reason_sk#0L, sr_ticket_number#0L, sr_return_quantity#0]
               :        +- Filter ((isnotnull(sr_item_sk#0L) && isnotnull(sr_ticket_number#0L)) && isnotnull(sr_reason_sk#0L))
               :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               +- Project [r_reason_sk#0]
                  +- Filter ((isnotnull(r_reason_desc#0) && (r_reason_desc#0 = reason 28)) && isnotnull(r_reason_sk#0))
                     +- Relation[r_reason_sk#0,r_reason_id#0,r_reason_desc#0] parquet


================================================================================================
q94
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [order count #0L ASC NULLS FIRST], true
      +- 'Aggregate [count(distinct ws_order_number#0) AS order count #0L, MakeDecimal(sum(UnscaledValue(ws_ext_ship_cost#0)),17,2) AS total shipping cost #0, MakeDecimal(sum(UnscaledValue(ws_net_profit#0)),17,2) AS total net profit #0]
         +- 'Project [ws_order_number#0, ws_ext_ship_cost#0, ws_net_profit#0]
            +- 'Join Inner, (ws_web_site_sk#0 = web_site_sk#0)
               :- 'Project [ws_web_site_sk#0, ws_order_number#0, ws_ext_ship_cost#0, ws_net_profit#0]
               :  +- 'Join Inner, (ws_ship_addr_sk#0 = ca_address_sk#0)
               :     :- 'Project [ws_ship_addr_sk#0, ws_web_site_sk#0, ws_order_number#0, ws_ext_ship_cost#0, ws_net_profit#0]
               :     :  +- 'Join Inner, (ws_ship_date_sk#0 = d_date_sk#0)
               :     :     :- 'Join LeftAnti, (cast(ws_order_number#0 as bigint) = wr_order_number#0L)
               :     :     :  :- 'Project [ws_ship_date_sk#0, ws_ship_addr_sk#0, ws_web_site_sk#0, ws_order_number#0, ws_ext_ship_cost#0, ws_net_profit#0]
               :     :     :  :  +- 'Join LeftSemi, ((ws_order_number#0 = ws_order_number#148#0) && NOT (ws_warehouse_sk#0 = ws_warehouse_sk#146#0))
               :     :     :  :     :- Project [ws_ship_date_sk#0, ws_ship_addr_sk#0, ws_web_site_sk#0, ws_warehouse_sk#0, ws_order_number#0, ws_ext_ship_cost#0, ws_net_profit#0]
               :     :     :  :     :  +- Filter (isnotnull(ws_warehouse_sk#0) && isnotnull(ws_order_number#0))
               :     :     :  :     :     +- Filter ((isnotnull(ws_ship_date_sk#0) && isnotnull(ws_ship_addr_sk#0)) && isnotnull(ws_web_site_sk#0))
               :     :     :  :     :        +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :     :  :     +- Project [ws_warehouse_sk#0 AS ws_warehouse_sk#146#0, ws_order_number#0 AS ws_order_number#148#0]
               :     :     :  :        +- Filter (isnotnull(ws_warehouse_sk#0) && isnotnull(ws_order_number#0))
               :     :     :  :           +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :     :  +- Project [wr_order_number#0L]
               :     :     :     +- Filter isnotnull(wr_order_number#0L)
               :     :     :        +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
               :     :     +- Project [d_date_sk#0]
               :     :        +- Filter (((isnotnull(d_date#0) && (cast(d_date#0 as string) >= 1999-02-01)) && (d_date#0 <= 10683)) && isnotnull(d_date_sk#0))
               :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [ca_address_sk#0]
               :        +- Filter ((isnotnull(ca_state#0) && (ca_state#0 = IL)) && isnotnull(ca_address_sk#0))
               :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               +- Project [web_site_sk#0]
                  +- Filter ((isnotnull(web_company_name#0) && (web_company_name#0 = pri)) && isnotnull(web_site_sk#0))
                     +- Relation[web_site_sk#0,web_site_id#0,web_rec_start_date#0,web_rec_end_date#0,web_name#0,web_open_date_sk#0,web_close_date_sk#0,web_class#0,web_manager#0,web_mkt_id#0,web_mkt_class#0,web_mkt_desc#0,web_market_manager#0,web_company_id#0,web_company_name#0,web_street_number#0,web_street_name#0,web_street_type#0,web_suite_number#0,web_city#0,web_county#0,web_state#0,web_zip#0,web_country#0,... 2 more fields] parquet


================================================================================================
q95
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [order count #0L ASC NULLS FIRST], true
      +- 'Aggregate [count(distinct ws_order_number#0) AS order count #0L, MakeDecimal(sum(UnscaledValue(ws_ext_ship_cost#0)),17,2) AS total shipping cost #0, MakeDecimal(sum(UnscaledValue(ws_net_profit#0)),17,2) AS total net profit #0]
         +- 'Project [ws_order_number#0, ws_ext_ship_cost#0, ws_net_profit#0]
            +- 'Join Inner, (ws_web_site_sk#0 = web_site_sk#0)
               :- 'Project [ws_web_site_sk#0, ws_order_number#0, ws_ext_ship_cost#0, ws_net_profit#0]
               :  +- 'Join Inner, (ws_ship_addr_sk#0 = ca_address_sk#0)
               :     :- 'Project [ws_ship_addr_sk#0, ws_web_site_sk#0, ws_order_number#0, ws_ext_ship_cost#0, ws_net_profit#0]
               :     :  +- 'Join Inner, (ws_ship_date_sk#0 = d_date_sk#0)
               :     :     :- 'Join LeftSemi, (cast(ws_order_number#0 as bigint) = wr_order_number#0L)
               :     :     :  :- 'Join LeftSemi, (ws_order_number#0 = ws_order_number#148#0)
               :     :     :  :  :- Project [ws_ship_date_sk#0, ws_ship_addr_sk#0, ws_web_site_sk#0, ws_order_number#0, ws_ext_ship_cost#0, ws_net_profit#0]
               :     :     :  :  :  +- Filter isnotnull(ws_order_number#0)
               :     :     :  :  :     +- Filter ((isnotnull(ws_ship_date_sk#0) && isnotnull(ws_ship_addr_sk#0)) && isnotnull(ws_web_site_sk#0))
               :     :     :  :  :        +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :     :  :  +- 'Project [ws_order_number#0 AS ws_order_number#148#0]
               :     :     :  :     +- 'Join Inner, ((ws_order_number#0 = ws_order_number#0) && NOT (ws_warehouse_sk#0 = ws_warehouse_sk#0))
               :     :     :  :        :- Project [ws_warehouse_sk#0, ws_order_number#0]
               :     :     :  :        :  +- Filter (isnotnull(ws_order_number#0) && isnotnull(ws_warehouse_sk#0))
               :     :     :  :        :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :     :  :        +- Project [ws_warehouse_sk#0, ws_order_number#0]
               :     :     :  :           +- Filter (isnotnull(ws_order_number#0) && isnotnull(ws_warehouse_sk#0))
               :     :     :  :              +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :     :  +- 'Project [wr_order_number#0L]
               :     :     :     +- 'Join Inner, (wr_order_number#0L = cast(ws_order_number#0 as bigint))
               :     :     :        :- Project [wr_order_number#0L]
               :     :     :        :  +- Filter isnotnull(wr_order_number#0L)
               :     :     :        :     +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
               :     :     :        +- 'Project [ws_order_number#0]
               :     :     :           +- 'Join Inner, ((ws_order_number#0 = ws_order_number#0) && NOT (ws_warehouse_sk#0 = ws_warehouse_sk#0))
               :     :     :              :- Project [ws_warehouse_sk#0, ws_order_number#0]
               :     :     :              :  +- Filter (isnotnull(ws_order_number#0) && isnotnull(ws_warehouse_sk#0))
               :     :     :              :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :     :              +- Project [ws_warehouse_sk#0, ws_order_number#0]
               :     :     :                 +- Filter (isnotnull(ws_order_number#0) && isnotnull(ws_warehouse_sk#0))
               :     :     :                    +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :     +- Project [d_date_sk#0]
               :     :        +- Filter (((isnotnull(d_date#0) && (cast(d_date#0 as string) >= 1999-02-01)) && (d_date#0 <= 10683)) && isnotnull(d_date_sk#0))
               :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [ca_address_sk#0]
               :        +- Filter ((isnotnull(ca_state#0) && (ca_state#0 = IL)) && isnotnull(ca_address_sk#0))
               :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               +- Project [web_site_sk#0]
                  +- Filter ((isnotnull(web_company_name#0) && (web_company_name#0 = pri)) && isnotnull(web_site_sk#0))
                     +- Relation[web_site_sk#0,web_site_id#0,web_rec_start_date#0,web_rec_end_date#0,web_name#0,web_open_date_sk#0,web_close_date_sk#0,web_class#0,web_manager#0,web_mkt_id#0,web_mkt_class#0,web_mkt_desc#0,web_market_manager#0,web_company_id#0,web_company_name#0,web_street_number#0,web_street_name#0,web_street_type#0,web_suite_number#0,web_city#0,web_county#0,web_state#0,web_zip#0,web_country#0,... 2 more fields] parquet


================================================================================================
q96
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [count(1)#0L ASC NULLS FIRST], true
      +- 'Aggregate [count(1) AS count(1)#0L]
         +- 'Project
            +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :- 'Project [ss_store_sk#0]
               :  +- 'Join Inner, (ss_sold_time_sk#0 = t_time_sk#0)
               :     :- 'Project [ss_sold_time_sk#0, ss_store_sk#0]
               :     :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
               :     :     :- Project [ss_sold_time_sk#0, ss_hdemo_sk#0, ss_store_sk#0]
               :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#0) && isnotnull(ss_sold_time_sk#0)) && isnotnull(ss_store_sk#0))
               :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     +- Project [hd_demo_sk#0]
               :     :        +- Filter ((isnotnull(hd_dep_count#0) && (hd_dep_count#0 = 7)) && isnotnull(hd_demo_sk#0))
               :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
               :     +- Project [t_time_sk#0]
               :        +- Filter ((((isnotnull(t_hour#0) && isnotnull(t_minute#0)) && (t_hour#0 = 20)) && (t_minute#0 >= 30)) && isnotnull(t_time_sk#0))
               :           +- Relation[t_time_sk#0,t_time_id#0,t_time#0,t_hour#0,t_minute#0,t_second#0,t_am_pm#0,t_shift#0,t_sub_shift#0,t_meal_time#0] parquet
               +- Project [s_store_sk#0]
                  +- Filter ((isnotnull(s_store_name#0) && (s_store_name#0 = ese)) && isnotnull(s_store_sk#0))
                     +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet


================================================================================================
q97
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Aggregate [sum(cast(CASE WHEN (isnotnull(customer_sk#0) && isnull(customer_sk#0)) THEN 1 ELSE 0 END as bigint)) AS store_only#0L, sum(cast(CASE WHEN (isnull(customer_sk#0) && isnotnull(customer_sk#0)) THEN 1 ELSE 0 END as bigint)) AS catalog_only#0L, sum(cast(CASE WHEN (isnotnull(customer_sk#0) && isnotnull(customer_sk#0)) THEN 1 ELSE 0 END as bigint)) AS store_and_catalog#0L]
      +- 'Project [customer_sk#0, customer_sk#0]
         +- 'Join FullOuter, ((customer_sk#0 = customer_sk#0) && (item_sk#0 = item_sk#0))
            :- 'Aggregate [ss_customer_sk#0, ss_item_sk#0], [ss_customer_sk#0 AS customer_sk#0, ss_item_sk#0 AS item_sk#0]
            :  +- 'Project [ss_item_sk#0, ss_customer_sk#0]
            :     +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :        :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0]
            :        :  +- Filter isnotnull(ss_sold_date_sk#0)
            :        :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :        +- Project [d_date_sk#0]
            :           +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
            :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- 'Aggregate [cs_bill_customer_sk#0, cs_item_sk#0], [cs_bill_customer_sk#0 AS customer_sk#0, cs_item_sk#0 AS item_sk#0]
               +- 'Project [cs_bill_customer_sk#0, cs_item_sk#0]
                  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                     :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0]
                     :  +- Filter isnotnull(cs_sold_date_sk#0)
                     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                     +- Project [d_date_sk#0]
                        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
                           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q98
================================================================================================

'Project [i_item_desc#0, i_category#0, i_class#0, i_current_price#0, itemrevenue#0, revenueratio#0]
+- 'Sort [i_category#0 ASC NULLS FIRST, i_class#0 ASC NULLS FIRST, i_item_id#0 ASC NULLS FIRST, i_item_desc#0 ASC NULLS FIRST, revenueratio#0 ASC NULLS FIRST], true
   +- 'Project [i_item_desc#0, i_category#0, i_class#0, i_current_price#0, itemrevenue#0, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(_w0#0) * 100.00), DecimalType(21,2)) as decimal(27,2))) / promote_precision(_we0#0)), DecimalType(38,17)) AS revenueratio#0, i_item_id#0]
      +- 'Window [sum(_w1#0) windowspecdefinition(i_class#0, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#0], [i_class#0]
         +- 'Aggregate [i_item_id#0, i_item_desc#0, i_category#0, i_class#0, i_current_price#0], [i_item_desc#0, i_category#0, i_class#0, i_current_price#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS itemrevenue#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS _w0#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS _w1#0, i_item_id#0]
            +- 'Project [ss_ext_sales_price#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
               +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                  :- 'Project [ss_sold_date_sk#0, ss_ext_sales_price#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                  :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                  :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ext_sales_price#0]
                  :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                  :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :     +- Project [i_item_sk#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                  :        +- Filter (i_category#0 IN (Sports,Books,Home) && isnotnull(i_item_sk#0))
                  :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  +- Project [d_date_sk#0]
                     +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10644)) && (d_date#0 <= 10674)) && isnotnull(d_date_sk#0))
                        +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q99
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [substring(w_warehouse_name, 1, 20)#0 ASC NULLS FIRST, sm_type#0 ASC NULLS FIRST, cc_name#0 ASC NULLS FIRST], true
      +- 'Aggregate [substring(w_warehouse_name#0, 1, 20), sm_type#0, cc_name#0], [substring(w_warehouse_name#0, 1, 20) AS substring(w_warehouse_name, 1, 20)#0, sm_type#0, cc_name#0, sum(cast(CASE WHEN ((cs_ship_date_sk#0 - cs_sold_date_sk#0) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days #0L, sum(cast(CASE WHEN (((cs_ship_date_sk#0 - cs_sold_date_sk#0) > 30) && ((cs_ship_date_sk#0 - cs_sold_date_sk#0) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31 - 60 days #0L, sum(cast(CASE WHEN (((cs_ship_date_sk#0 - cs_sold_date_sk#0) > 60) && ((cs_ship_date_sk#0 - cs_sold_date_sk#0) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61 - 90 days #0L, sum(cast(CASE WHEN (((cs_ship_date_sk#0 - cs_sold_date_sk#0) > 90) && ((cs_ship_date_sk#0 - cs_sold_date_sk#0) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91 - 120 days #0L, sum(cast(CASE WHEN ((cs_ship_date_sk#0 - cs_sold_date_sk#0) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days #0L]
         +- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, w_warehouse_name#0, sm_type#0, cc_name#0]
            +- 'Join Inner, (cs_ship_date_sk#0 = d_date_sk#0)
               :- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, w_warehouse_name#0, sm_type#0, cc_name#0]
               :  +- 'Join Inner, (cs_call_center_sk#0 = cc_call_center_sk#0)
               :     :- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_call_center_sk#0, w_warehouse_name#0, sm_type#0]
               :     :  +- 'Join Inner, (cs_ship_mode_sk#0 = sm_ship_mode_sk#0)
               :     :     :- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_call_center_sk#0, cs_ship_mode_sk#0, w_warehouse_name#0]
               :     :     :  +- 'Join Inner, (cs_warehouse_sk#0 = w_warehouse_sk#0)
               :     :     :     :- Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_call_center_sk#0, cs_ship_mode_sk#0, cs_warehouse_sk#0]
               :     :     :     :  +- Filter (((isnotnull(cs_warehouse_sk#0) && isnotnull(cs_ship_mode_sk#0)) && isnotnull(cs_call_center_sk#0)) && isnotnull(cs_ship_date_sk#0))
               :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :     :     +- Project [w_warehouse_sk#0, w_warehouse_name#0]
               :     :     :        +- Filter isnotnull(w_warehouse_sk#0)
               :     :     :           +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
               :     :     +- Project [sm_ship_mode_sk#0, sm_type#0]
               :     :        +- Filter isnotnull(sm_ship_mode_sk#0)
               :     :           +- Relation[sm_ship_mode_sk#0,sm_ship_mode_id#0,sm_type#0,sm_code#0,sm_carrier#0,sm_contract#0] parquet
               :     +- Project [cc_call_center_sk#0, cc_name#0]
               :        +- Filter isnotnull(cc_call_center_sk#0)
               :           +- Relation[cc_call_center_sk#0,cc_call_center_id#0,cc_rec_start_date#0,cc_rec_end_date#0,cc_closed_date_sk#0,cc_open_date_sk#0,cc_name#0,cc_class#0,cc_employees#0,cc_sq_ft#0,cc_hours#0,cc_manager#0,cc_mkt_id#0,cc_mkt_class#0,cc_mkt_desc#0,cc_market_manager#0,cc_division#0,cc_division_name#0,cc_company#0,cc_company_name#0,cc_street_number#0,cc_street_name#0,cc_street_type#0,cc_suite_number#0,... 7 more fields] parquet
               +- Project [d_date_sk#0]
                  +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
                     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q5a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [channel#0 ASC NULLS FIRST, id#0 ASC NULLS FIRST], true
      +- 'Aggregate [channel#0, id#0, sales#0, returns#0, profit#0], [channel#0, id#0, sales#0, returns#0, profit#0]
         +- 'Union
            :- 'Aggregate [channel#0, id#0, sales#0, returns#0, profit#0], [channel#0, id#0, sales#0, returns#0, profit#0]
            :  +- 'Union
            :     :- 'Aggregate [channel#0, id#0], [channel#0, id#0, cast(sum(sales#0) as decimal(37,2)) AS sales#0, cast(sum(returns#0) as decimal(37,2)) AS returns#0, cast(sum(profit#0) as decimal(38,2)) AS profit#0]
            :     :  +- 'Union
            :     :     :- 'Aggregate [s_store_id#0], [store channel AS channel#0, concat(store, s_store_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(return_amt#0)),17,2) AS returns#0, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#0)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#0)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
            :     :     :  +- 'Project [sales_price#0, profit#0, return_amt#0, net_loss#0, s_store_id#0]
            :     :     :     +- 'Join Inner, (store_sk#0L = cast(s_store_sk#0 as bigint))
            :     :     :        :- 'Project [store_sk#0L, sales_price#0, profit#0, return_amt#0, net_loss#0]
            :     :     :        :  +- 'Join Inner, (date_sk#0L = cast(d_date_sk#0 as bigint))
            :     :     :        :     :- Union
            :     :     :        :     :  :- Project [cast(ss_store_sk#0 as bigint) AS store_sk#0L, cast(ss_sold_date_sk#0 as bigint) AS date_sk#0L, ss_ext_sales_price#0 AS sales_price#0, ss_net_profit#0 AS profit#0, 0.00 AS return_amt#0, 0.00 AS net_loss#0]
            :     :     :        :     :  :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && (isnotnull(cast(ss_sold_date_sk#0 as bigint)) && isnotnull(cast(ss_store_sk#0 as bigint))))
            :     :     :        :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :        :     :  +- Project [sr_store_sk#0L AS store_sk#0L, sr_returned_date_sk#0L AS date_sk#0L, 0.00 AS sales_price#0, 0.00 AS profit#0, sr_return_amt#0 AS return_amt#0, sr_net_loss#0 AS net_loss#0]
            :     :     :        :     :     +- Filter (isnotnull(sr_returned_date_sk#0L) && isnotnull(sr_store_sk#0L))
            :     :     :        :     :        +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
            :     :     :        :     +- Project [d_date_sk#0]
            :     :     :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10456)) && isnotnull(d_date_sk#0))
            :     :     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :        +- Project [s_store_sk#0, s_store_id#0]
            :     :     :           +- Filter isnotnull(s_store_sk#0)
            :     :     :              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :     :     :- 'Aggregate [cp_catalog_page_id#0], [catalog channel AS channel#0, concat(catalog_page, cp_catalog_page_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(return_amt#0)),17,2) AS returns#0, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#0)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#0)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
            :     :     :  +- 'Project [sales_price#0, profit#0, return_amt#0, net_loss#0, cp_catalog_page_id#0]
            :     :     :     +- 'Join Inner, (page_sk#0 = cp_catalog_page_sk#0)
            :     :     :        :- 'Project [page_sk#0, sales_price#0, profit#0, return_amt#0, net_loss#0]
            :     :     :        :  +- 'Join Inner, (date_sk#0 = d_date_sk#0)
            :     :     :        :     :- Union
            :     :     :        :     :  :- Project [cs_catalog_page_sk#0 AS page_sk#0, cs_sold_date_sk#0 AS date_sk#0, cs_ext_sales_price#0 AS sales_price#0, cs_net_profit#0 AS profit#0, 0.00 AS return_amt#0, 0.00 AS net_loss#0]
            :     :     :        :     :  :  +- Filter (isnotnull(cs_sold_date_sk#0) && isnotnull(cs_catalog_page_sk#0))
            :     :     :        :     :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :        :     :  +- Project [cr_catalog_page_sk#0 AS page_sk#0, cr_returned_date_sk#0 AS date_sk#0, 0.00 AS sales_price#0, 0.00 AS profit#0, cr_return_amount#0 AS return_amt#0, cr_net_loss#0 AS net_loss#0]
            :     :     :        :     :     +- Filter (isnotnull(cr_returned_date_sk#0) && isnotnull(cr_catalog_page_sk#0))
            :     :     :        :     :        +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
            :     :     :        :     +- Project [d_date_sk#0]
            :     :     :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10456)) && isnotnull(d_date_sk#0))
            :     :     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :        +- Project [cp_catalog_page_sk#0, cp_catalog_page_id#0]
            :     :     :           +- Filter isnotnull(cp_catalog_page_sk#0)
            :     :     :              +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#0,cp_start_date_sk#0,cp_end_date_sk#0,cp_department#0,cp_catalog_number#0,cp_catalog_page_number#0,cp_description#0,cp_type#0] parquet
            :     :     +- 'Aggregate [web_site_id#0], [web channel AS channel#0, concat(web_site, web_site_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(return_amt#0)),17,2) AS returns#0, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#0)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#0)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
            :     :        +- 'Project [sales_price#0, profit#0, return_amt#0, net_loss#0, web_site_id#0]
            :     :           +- 'Join Inner, (wsr_web_site_sk#0 = web_site_sk#0)
            :     :              :- 'Project [wsr_web_site_sk#0, sales_price#0, profit#0, return_amt#0, net_loss#0]
            :     :              :  +- 'Join Inner, (date_sk#0L = cast(d_date_sk#0 as bigint))
            :     :              :     :- 'Union
            :     :              :     :  :- Project [ws_web_site_sk#0 AS wsr_web_site_sk#0, cast(ws_sold_date_sk#0 as bigint) AS date_sk#0L, ws_ext_sales_price#0 AS sales_price#0, ws_net_profit#0 AS profit#0, 0.00 AS return_amt#0, 0.00 AS net_loss#0]
            :     :              :     :  :  +- Filter (isnotnull(ws_sold_date_sk#0) && (isnotnull(cast(ws_sold_date_sk#0 as bigint)) && isnotnull(ws_web_site_sk#0)))
            :     :              :     :  :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :              :     :  +- 'Project [ws_web_site_sk#0 AS wsr_web_site_sk#0, wr_returned_date_sk#0L AS date_sk#0L, 0.00 AS sales_price#0, 0.00 AS profit#0, wr_return_amt#0 AS return_amt#0, wr_net_loss#0 AS net_loss#0]
            :     :              :     :     +- 'Join Inner, ((wr_item_sk#0L = cast(ws_item_sk#0 as bigint)) && (wr_order_number#0L = cast(ws_order_number#0 as bigint)))
            :     :              :     :        :- Project [wr_returned_date_sk#0L, wr_item_sk#0L, wr_order_number#0L, wr_return_amt#0, wr_net_loss#0]
            :     :              :     :        :  +- Filter (isnotnull(wr_item_sk#0L) && isnotnull(wr_order_number#0L))
            :     :              :     :        :     +- Filter isnotnull(wr_returned_date_sk#0L)
            :     :              :     :        :        +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
            :     :              :     :        +- Project [ws_item_sk#0, ws_web_site_sk#0, ws_order_number#0]
            :     :              :     :           +- Filter ((isnotnull(ws_item_sk#0) && isnotnull(ws_order_number#0)) && isnotnull(ws_web_site_sk#0))
            :     :              :     :              +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :              :     +- Project [d_date_sk#0]
            :     :              :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10456)) && isnotnull(d_date_sk#0))
            :     :              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              +- Project [web_site_sk#0, web_site_id#0]
            :     :                 +- Filter isnotnull(web_site_sk#0)
            :     :                    +- Relation[web_site_sk#0,web_site_id#0,web_rec_start_date#0,web_rec_end_date#0,web_name#0,web_open_date_sk#0,web_close_date_sk#0,web_class#0,web_manager#0,web_mkt_id#0,web_mkt_class#0,web_mkt_desc#0,web_market_manager#0,web_company_id#0,web_company_name#0,web_street_number#0,web_street_name#0,web_street_type#0,web_suite_number#0,web_city#0,web_county#0,web_state#0,web_zip#0,web_country#0,... 2 more fields] parquet
            :     +- 'Aggregate [channel#0], [channel#0, null AS id#0, sum(sales#0) AS sum(sales)#0, sum(returns#0) AS sum(returns)#0, sum(profit#0) AS sum(profit)#0]
            :        +- 'Aggregate [channel#0, id#0], [channel#0, sum(sales#0) AS sales#0, sum(returns#0) AS returns#0, sum(profit#0) AS profit#0]
            :           +- 'Union
            :              :- 'Aggregate [s_store_id#0], [store channel AS channel#0, concat(store, s_store_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(return_amt#0)),17,2) AS returns#0, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#0)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#0)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
            :              :  +- 'Project [sales_price#0, profit#0, return_amt#0, net_loss#0, s_store_id#0]
            :              :     +- 'Join Inner, (store_sk#0L = cast(s_store_sk#0 as bigint))
            :              :        :- 'Project [store_sk#0L, sales_price#0, profit#0, return_amt#0, net_loss#0]
            :              :        :  +- 'Join Inner, (date_sk#0L = cast(d_date_sk#0 as bigint))
            :              :        :     :- Union
            :              :        :     :  :- Project [cast(ss_store_sk#0 as bigint) AS store_sk#0L, cast(ss_sold_date_sk#0 as bigint) AS date_sk#0L, ss_ext_sales_price#0 AS sales_price#0, ss_net_profit#0 AS profit#0, 0.00 AS return_amt#0, 0.00 AS net_loss#0]
            :              :        :     :  :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && (isnotnull(cast(ss_sold_date_sk#0 as bigint)) && isnotnull(cast(ss_store_sk#0 as bigint))))
            :              :        :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :              :        :     :  +- Project [sr_store_sk#0L AS store_sk#0L, sr_returned_date_sk#0L AS date_sk#0L, 0.00 AS sales_price#0, 0.00 AS profit#0, sr_return_amt#0 AS return_amt#0, sr_net_loss#0 AS net_loss#0]
            :              :        :     :     +- Filter (isnotnull(sr_returned_date_sk#0L) && isnotnull(sr_store_sk#0L))
            :              :        :     :        +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
            :              :        :     +- Project [d_date_sk#0]
            :              :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10456)) && isnotnull(d_date_sk#0))
            :              :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :        +- Project [s_store_sk#0, s_store_id#0]
            :              :           +- Filter isnotnull(s_store_sk#0)
            :              :              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :              :- 'Aggregate [cp_catalog_page_id#0], [catalog channel AS channel#0, concat(catalog_page, cp_catalog_page_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(return_amt#0)),17,2) AS returns#0, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#0)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#0)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
            :              :  +- 'Project [sales_price#0, profit#0, return_amt#0, net_loss#0, cp_catalog_page_id#0]
            :              :     +- 'Join Inner, (page_sk#0 = cp_catalog_page_sk#0)
            :              :        :- 'Project [page_sk#0, sales_price#0, profit#0, return_amt#0, net_loss#0]
            :              :        :  +- 'Join Inner, (date_sk#0 = d_date_sk#0)
            :              :        :     :- Union
            :              :        :     :  :- Project [cs_catalog_page_sk#0 AS page_sk#0, cs_sold_date_sk#0 AS date_sk#0, cs_ext_sales_price#0 AS sales_price#0, cs_net_profit#0 AS profit#0, 0.00 AS return_amt#0, 0.00 AS net_loss#0]
            :              :        :     :  :  +- Filter (isnotnull(cs_sold_date_sk#0) && isnotnull(cs_catalog_page_sk#0))
            :              :        :     :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :              :        :     :  +- Project [cr_catalog_page_sk#0 AS page_sk#0, cr_returned_date_sk#0 AS date_sk#0, 0.00 AS sales_price#0, 0.00 AS profit#0, cr_return_amount#0 AS return_amt#0, cr_net_loss#0 AS net_loss#0]
            :              :        :     :     +- Filter (isnotnull(cr_returned_date_sk#0) && isnotnull(cr_catalog_page_sk#0))
            :              :        :     :        +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
            :              :        :     +- Project [d_date_sk#0]
            :              :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10456)) && isnotnull(d_date_sk#0))
            :              :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :        +- Project [cp_catalog_page_sk#0, cp_catalog_page_id#0]
            :              :           +- Filter isnotnull(cp_catalog_page_sk#0)
            :              :              +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#0,cp_start_date_sk#0,cp_end_date_sk#0,cp_department#0,cp_catalog_number#0,cp_catalog_page_number#0,cp_description#0,cp_type#0] parquet
            :              +- 'Aggregate [web_site_id#0], [web channel AS channel#0, concat(web_site, web_site_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(return_amt#0)),17,2) AS returns#0, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#0)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#0)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
            :                 +- 'Project [sales_price#0, profit#0, return_amt#0, net_loss#0, web_site_id#0]
            :                    +- 'Join Inner, (wsr_web_site_sk#0 = web_site_sk#0)
            :                       :- 'Project [wsr_web_site_sk#0, sales_price#0, profit#0, return_amt#0, net_loss#0]
            :                       :  +- 'Join Inner, (date_sk#0L = cast(d_date_sk#0 as bigint))
            :                       :     :- 'Union
            :                       :     :  :- Project [ws_web_site_sk#0 AS wsr_web_site_sk#0, cast(ws_sold_date_sk#0 as bigint) AS date_sk#0L, ws_ext_sales_price#0 AS sales_price#0, ws_net_profit#0 AS profit#0, 0.00 AS return_amt#0, 0.00 AS net_loss#0]
            :                       :     :  :  +- Filter (isnotnull(ws_sold_date_sk#0) && (isnotnull(cast(ws_sold_date_sk#0 as bigint)) && isnotnull(ws_web_site_sk#0)))
            :                       :     :  :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                       :     :  +- 'Project [ws_web_site_sk#0 AS wsr_web_site_sk#0, wr_returned_date_sk#0L AS date_sk#0L, 0.00 AS sales_price#0, 0.00 AS profit#0, wr_return_amt#0 AS return_amt#0, wr_net_loss#0 AS net_loss#0]
            :                       :     :     +- 'Join Inner, ((wr_item_sk#0L = cast(ws_item_sk#0 as bigint)) && (wr_order_number#0L = cast(ws_order_number#0 as bigint)))
            :                       :     :        :- Project [wr_returned_date_sk#0L, wr_item_sk#0L, wr_order_number#0L, wr_return_amt#0, wr_net_loss#0]
            :                       :     :        :  +- Filter (isnotnull(wr_item_sk#0L) && isnotnull(wr_order_number#0L))
            :                       :     :        :     +- Filter isnotnull(wr_returned_date_sk#0L)
            :                       :     :        :        +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
            :                       :     :        +- Project [ws_item_sk#0, ws_web_site_sk#0, ws_order_number#0]
            :                       :     :           +- Filter ((isnotnull(ws_item_sk#0) && isnotnull(ws_order_number#0)) && isnotnull(ws_web_site_sk#0))
            :                       :     :              +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                       :     +- Project [d_date_sk#0]
            :                       :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10456)) && isnotnull(d_date_sk#0))
            :                       :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                       +- Project [web_site_sk#0, web_site_id#0]
            :                          +- Filter isnotnull(web_site_sk#0)
            :                             +- Relation[web_site_sk#0,web_site_id#0,web_rec_start_date#0,web_rec_end_date#0,web_name#0,web_open_date_sk#0,web_close_date_sk#0,web_class#0,web_manager#0,web_mkt_id#0,web_mkt_class#0,web_mkt_desc#0,web_market_manager#0,web_company_id#0,web_company_name#0,web_street_number#0,web_street_name#0,web_street_type#0,web_suite_number#0,web_city#0,web_county#0,web_state#0,web_zip#0,web_country#0,... 2 more fields] parquet
            +- 'Aggregate [null AS channel#0, null AS id#0, sum(sales#0) AS sum(sales)#0, sum(returns#0) AS sum(returns)#0, sum(profit#0) AS sum(profit)#0]
               +- 'Aggregate [channel#0, id#0], [sum(sales#0) AS sales#0, sum(returns#0) AS returns#0, sum(profit#0) AS profit#0]
                  +- 'Union
                     :- 'Aggregate [s_store_id#0], [store channel AS channel#0, concat(store, s_store_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(return_amt#0)),17,2) AS returns#0, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#0)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#0)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
                     :  +- 'Project [sales_price#0, profit#0, return_amt#0, net_loss#0, s_store_id#0]
                     :     +- 'Join Inner, (store_sk#0L = cast(s_store_sk#0 as bigint))
                     :        :- 'Project [store_sk#0L, sales_price#0, profit#0, return_amt#0, net_loss#0]
                     :        :  +- 'Join Inner, (date_sk#0L = cast(d_date_sk#0 as bigint))
                     :        :     :- Union
                     :        :     :  :- Project [cast(ss_store_sk#0 as bigint) AS store_sk#0L, cast(ss_sold_date_sk#0 as bigint) AS date_sk#0L, ss_ext_sales_price#0 AS sales_price#0, ss_net_profit#0 AS profit#0, 0.00 AS return_amt#0, 0.00 AS net_loss#0]
                     :        :     :  :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && (isnotnull(cast(ss_sold_date_sk#0 as bigint)) && isnotnull(cast(ss_store_sk#0 as bigint))))
                     :        :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                     :        :     :  +- Project [sr_store_sk#0L AS store_sk#0L, sr_returned_date_sk#0L AS date_sk#0L, 0.00 AS sales_price#0, 0.00 AS profit#0, sr_return_amt#0 AS return_amt#0, sr_net_loss#0 AS net_loss#0]
                     :        :     :     +- Filter (isnotnull(sr_returned_date_sk#0L) && isnotnull(sr_store_sk#0L))
                     :        :     :        +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
                     :        :     +- Project [d_date_sk#0]
                     :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10456)) && isnotnull(d_date_sk#0))
                     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :        +- Project [s_store_sk#0, s_store_id#0]
                     :           +- Filter isnotnull(s_store_sk#0)
                     :              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                     :- 'Aggregate [cp_catalog_page_id#0], [catalog channel AS channel#0, concat(catalog_page, cp_catalog_page_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(return_amt#0)),17,2) AS returns#0, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#0)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#0)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
                     :  +- 'Project [sales_price#0, profit#0, return_amt#0, net_loss#0, cp_catalog_page_id#0]
                     :     +- 'Join Inner, (page_sk#0 = cp_catalog_page_sk#0)
                     :        :- 'Project [page_sk#0, sales_price#0, profit#0, return_amt#0, net_loss#0]
                     :        :  +- 'Join Inner, (date_sk#0 = d_date_sk#0)
                     :        :     :- Union
                     :        :     :  :- Project [cs_catalog_page_sk#0 AS page_sk#0, cs_sold_date_sk#0 AS date_sk#0, cs_ext_sales_price#0 AS sales_price#0, cs_net_profit#0 AS profit#0, 0.00 AS return_amt#0, 0.00 AS net_loss#0]
                     :        :     :  :  +- Filter (isnotnull(cs_sold_date_sk#0) && isnotnull(cs_catalog_page_sk#0))
                     :        :     :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                     :        :     :  +- Project [cr_catalog_page_sk#0 AS page_sk#0, cr_returned_date_sk#0 AS date_sk#0, 0.00 AS sales_price#0, 0.00 AS profit#0, cr_return_amount#0 AS return_amt#0, cr_net_loss#0 AS net_loss#0]
                     :        :     :     +- Filter (isnotnull(cr_returned_date_sk#0) && isnotnull(cr_catalog_page_sk#0))
                     :        :     :        +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
                     :        :     +- Project [d_date_sk#0]
                     :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10456)) && isnotnull(d_date_sk#0))
                     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :        +- Project [cp_catalog_page_sk#0, cp_catalog_page_id#0]
                     :           +- Filter isnotnull(cp_catalog_page_sk#0)
                     :              +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#0,cp_start_date_sk#0,cp_end_date_sk#0,cp_department#0,cp_catalog_number#0,cp_catalog_page_number#0,cp_description#0,cp_type#0] parquet
                     +- 'Aggregate [web_site_id#0], [web channel AS channel#0, concat(web_site, web_site_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(return_amt#0)),17,2) AS returns#0, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#0)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#0)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
                        +- 'Project [sales_price#0, profit#0, return_amt#0, net_loss#0, web_site_id#0]
                           +- 'Join Inner, (wsr_web_site_sk#0 = web_site_sk#0)
                              :- 'Project [wsr_web_site_sk#0, sales_price#0, profit#0, return_amt#0, net_loss#0]
                              :  +- 'Join Inner, (date_sk#0L = cast(d_date_sk#0 as bigint))
                              :     :- 'Union
                              :     :  :- Project [ws_web_site_sk#0 AS wsr_web_site_sk#0, cast(ws_sold_date_sk#0 as bigint) AS date_sk#0L, ws_ext_sales_price#0 AS sales_price#0, ws_net_profit#0 AS profit#0, 0.00 AS return_amt#0, 0.00 AS net_loss#0]
                              :     :  :  +- Filter (isnotnull(ws_sold_date_sk#0) && (isnotnull(cast(ws_sold_date_sk#0 as bigint)) && isnotnull(ws_web_site_sk#0)))
                              :     :  :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                              :     :  +- 'Project [ws_web_site_sk#0 AS wsr_web_site_sk#0, wr_returned_date_sk#0L AS date_sk#0L, 0.00 AS sales_price#0, 0.00 AS profit#0, wr_return_amt#0 AS return_amt#0, wr_net_loss#0 AS net_loss#0]
                              :     :     +- 'Join Inner, ((wr_item_sk#0L = cast(ws_item_sk#0 as bigint)) && (wr_order_number#0L = cast(ws_order_number#0 as bigint)))
                              :     :        :- Project [wr_returned_date_sk#0L, wr_item_sk#0L, wr_order_number#0L, wr_return_amt#0, wr_net_loss#0]
                              :     :        :  +- Filter (isnotnull(wr_item_sk#0L) && isnotnull(wr_order_number#0L))
                              :     :        :     +- Filter isnotnull(wr_returned_date_sk#0L)
                              :     :        :        +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
                              :     :        +- Project [ws_item_sk#0, ws_web_site_sk#0, ws_order_number#0]
                              :     :           +- Filter ((isnotnull(ws_item_sk#0) && isnotnull(ws_order_number#0)) && isnotnull(ws_web_site_sk#0))
                              :     :              +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                              :     +- Project [d_date_sk#0]
                              :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10456)) && isnotnull(d_date_sk#0))
                              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              +- Project [web_site_sk#0, web_site_id#0]
                                 +- Filter isnotnull(web_site_sk#0)
                                    +- Relation[web_site_sk#0,web_site_id#0,web_rec_start_date#0,web_rec_end_date#0,web_name#0,web_open_date_sk#0,web_close_date_sk#0,web_class#0,web_manager#0,web_mkt_id#0,web_mkt_class#0,web_mkt_desc#0,web_market_manager#0,web_company_id#0,web_company_name#0,web_street_number#0,web_street_name#0,web_street_type#0,web_suite_number#0,web_city#0,web_county#0,web_state#0,web_zip#0,web_country#0,... 2 more fields] parquet


================================================================================================
q6
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Project [state#0, cnt#0L]
      +- 'Sort [cnt#0L ASC NULLS FIRST, ca_state#0 ASC NULLS FIRST], true
         +- 'Project [state#0, cnt#0L, ca_state#0]
            +- 'Filter (count(1)#0L >= 10)
               +- 'Aggregate [ca_state#0], [ca_state#0 AS state#0, count(1) AS cnt#0L, ca_state#0, count(1) AS count(1)#0L]
                  +- 'Project [ca_state#0]
                     +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                        :- 'Project [ca_state#0, ss_item_sk#0]
                        :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                        :     :- 'Project [ca_state#0, ss_sold_date_sk#0, ss_item_sk#0]
                        :     :  +- 'Join Inner, (c_customer_sk#0 = ss_customer_sk#0)
                        :     :     :- 'Project [ca_state#0, c_customer_sk#0]
                        :     :     :  +- 'Join Inner, (ca_address_sk#0 = c_current_addr_sk#0)
                        :     :     :     :- Project [ca_address_sk#0, ca_state#0]
                        :     :     :     :  +- Filter isnotnull(ca_address_sk#0)
                        :     :     :     :     +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                        :     :     :     +- Project [c_customer_sk#0, c_current_addr_sk#0]
                        :     :     :        +- Filter (isnotnull(c_current_addr_sk#0) && isnotnull(c_customer_sk#0))
                        :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                        :     :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0]
                        :     :        +- Filter ((isnotnull(ss_customer_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_item_sk#0))
                        :     :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        :     +- Project [d_date_sk#0]
                        :        +- Filter ((isnotnull(d_month_seq#0) && (d_month_seq#0 = scalar-subquery#0 [])) && isnotnull(d_date_sk#0))
                        :           :  +- Aggregate [d_month_seq#27], [d_month_seq#27]
                        :           :     +- Project [d_month_seq#27]
                        :           :        +- Filter (((isnotnull(d_year#30) && isnotnull(d_moy#32)) && (d_year#30 = 2000)) && (d_moy#32 = 1))
                        :           :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        +- 'Project [i_item_sk#0]
                           +- 'Filter (cast(i_current_price#0 as decimal(14,7)) > CheckOverflow((1.200000 * promote_precision(avg(i_current_price)#0)), DecimalType(14,7)))
                              +- 'Join LeftOuter, (i_category#315#0 = i_category#0)
                                 :- Project [i_item_sk#0, i_current_price#0, i_category#0]
                                 :  +- Filter (isnotnull(i_current_price#0) && isnotnull(i_item_sk#0))
                                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                                 +- Aggregate [i_category#0], [cast((avg(UnscaledValue(i_current_price#0)) / 100.0) as decimal(11,6)) AS avg(i_current_price)#0, i_category#0 AS i_category#315#0]
                                    +- Project [i_current_price#0, i_category#0]
                                       +- Filter isnotnull(i_category#0)
                                          +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q10a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [cd_gender#0 ASC NULLS FIRST, cd_marital_status#0 ASC NULLS FIRST, cd_education_status#0 ASC NULLS FIRST, cd_purchase_estimate#0 ASC NULLS FIRST, cd_credit_rating#0 ASC NULLS FIRST, cd_dep_count#0 ASC NULLS FIRST, cd_dep_employed_count#0 ASC NULLS FIRST, cd_dep_college_count#0 ASC NULLS FIRST], true
      +- 'Aggregate [cd_gender#0, cd_marital_status#0, cd_education_status#0, cd_purchase_estimate#0, cd_credit_rating#0, cd_dep_count#0, cd_dep_employed_count#0, cd_dep_college_count#0], [cd_gender#0, cd_marital_status#0, cd_education_status#0, count(1) AS cnt1#0L, cd_purchase_estimate#0, count(1) AS cnt2#0L, cd_credit_rating#0, count(1) AS cnt3#0L, cd_dep_count#0, count(1) AS cnt4#0L, cd_dep_employed_count#0, count(1) AS cnt5#0L, cd_dep_college_count#0, count(1) AS cnt6#0L]
         +- 'Project [cd_gender#0, cd_marital_status#0, cd_education_status#0, cd_purchase_estimate#0, cd_credit_rating#0, cd_dep_count#0, cd_dep_employed_count#0, cd_dep_college_count#0]
            +- 'Join Inner, (cd_demo_sk#0 = c_current_cdemo_sk#0)
               :- 'Project [c_current_cdemo_sk#0]
               :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
               :     :- 'Project [c_current_cdemo_sk#0, c_current_addr_sk#0]
               :     :  +- 'Join LeftSemi, (c_customer_sk#0 = customer_sk#0)
               :     :     :- 'Join LeftSemi, (c_customer_sk#0 = ss_customer_sk#0)
               :     :     :  :- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_addr_sk#0]
               :     :     :  :  +- Filter isnotnull(c_customer_sk#0)
               :     :     :  :     +- Filter (isnotnull(c_current_addr_sk#0) && isnotnull(c_current_cdemo_sk#0))
               :     :     :  :        +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
               :     :     :  +- 'Project [ss_customer_sk#0]
               :     :     :     +- 'Filter isnotnull(ss_customer_sk#0)
               :     :     :        +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :     :           :- Project [ss_sold_date_sk#0, ss_customer_sk#0]
               :     :     :           :  +- Filter isnotnull(ss_sold_date_sk#0)
               :     :     :           :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     :           +- Project [d_date_sk#0]
               :     :     :              +- Filter (((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2002)) && (d_moy#0 >= 4)) && (d_moy#0 <= 7)) && isnotnull(d_date_sk#0))
               :     :     :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     +- 'Union
               :     :        :- 'Project [ws_bill_customer_sk#0 AS customer_sk#0]
               :     :        :  +- 'Filter isnotnull(ws_bill_customer_sk#0)
               :     :        :     +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :     :        :        :- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0]
               :     :        :        :  +- Filter isnotnull(ws_sold_date_sk#0)
               :     :        :        :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :        :        +- Project [d_date_sk#0]
               :     :        :           +- Filter (((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2002)) && (d_moy#0 >= 4)) && (d_moy#0 <= 7)) && isnotnull(d_date_sk#0))
               :     :        :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :        +- 'Project [cs_ship_customer_sk#0 AS customer_sk#0]
               :     :           +- 'Filter isnotnull(cs_ship_customer_sk#0)
               :     :              +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :     :                 :- Project [cs_sold_date_sk#0, cs_ship_customer_sk#0]
               :     :                 :  +- Filter isnotnull(cs_sold_date_sk#0)
               :     :                 :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :                 +- Project [d_date_sk#0]
               :     :                    +- Filter (((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2002)) && (d_moy#0 >= 4)) && (d_moy#0 <= 7)) && isnotnull(d_date_sk#0))
               :     :                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [ca_address_sk#0]
               :        +- Filter (ca_county#0 IN (Walker County,Richland County,Gaines County,Douglas County,Dona Ana County) && isnotnull(ca_address_sk#0))
               :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               +- Filter isnotnull(cd_demo_sk#0)
                  +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet


================================================================================================
q11
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [customer_id#0 ASC NULLS FIRST, customer_first_name#0 ASC NULLS FIRST, customer_last_name#0 ASC NULLS FIRST, customer_email_address#0 ASC NULLS FIRST], true
      +- 'Project [customer_id#0, customer_first_name#0, customer_last_name#0, customer_email_address#0]
         +- 'Join Inner, ((customer_id#0 = customer_id#0) && (CASE WHEN (year_total#0 > 0.00) THEN CheckOverflow((promote_precision(year_total#0) / promote_precision(year_total#0)), DecimalType(38,20)) ELSE 0E-20 END > CASE WHEN (year_total#0 > 0.00) THEN CheckOverflow((promote_precision(year_total#0) / promote_precision(year_total#0)), DecimalType(38,20)) ELSE 0E-20 END))
            :- 'Project [customer_id#0, year_total#0, customer_id#0, customer_first_name#0, customer_last_name#0, customer_email_address#0, year_total#0, year_total#0]
            :  +- 'Join Inner, (customer_id#0 = customer_id#0)
            :     :- 'Join Inner, (customer_id#0 = customer_id#0)
            :     :  :- 'Union
            :     :  :  :- 'Filter isnotnull(customer_id#0)
            :     :  :  :  +- 'Filter (isnotnull(year_total#0) && (year_total#0 > 0.00))
            :     :  :  :     +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, d_year#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0], [c_customer_id#0 AS customer_id#0, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ss_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#0 as decimal(8,2)))), DecimalType(8,2)))),18,2) AS year_total#0]
            :     :  :  :        +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ss_ext_discount_amt#0, ss_ext_list_price#0, d_year#0]
            :     :  :  :           +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :  :  :              :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ss_sold_date_sk#0, ss_ext_discount_amt#0, ss_ext_list_price#0]
            :     :  :  :              :  +- 'Join Inner, (c_customer_sk#0 = ss_customer_sk#0)
            :     :  :  :              :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
            :     :  :  :              :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :     :  :  :              :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :     :  :  :              :     +- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_ext_discount_amt#0, ss_ext_list_price#0]
            :     :  :  :              :        +- Filter (isnotnull(ss_customer_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :  :  :              :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :  :  :              +- Project [d_date_sk#0, d_year#0]
            :     :  :  :                 +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
            :     :  :  :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :  :  +- Filter isnotnull(customer_id#0)
            :     :  :     +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :     :  +- 'Union
            :     :     :- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, d_year#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0], [c_customer_id#0 AS customer_id#0, c_first_name#0 AS customer_first_name#0, c_last_name#0 AS customer_last_name#0, c_email_address#0 AS customer_email_address#0, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ss_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#0 as decimal(8,2)))), DecimalType(8,2)))),18,2) AS year_total#0]
            :     :     :  +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ss_ext_discount_amt#0, ss_ext_list_price#0, d_year#0]
            :     :     :     +- 'Filter isnotnull(c_customer_id#0)
            :     :     :        +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :           :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ss_sold_date_sk#0, ss_ext_discount_amt#0, ss_ext_list_price#0]
            :     :     :           :  +- 'Join Inner, (c_customer_sk#0 = ss_customer_sk#0)
            :     :     :           :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
            :     :     :           :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :     :     :           :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :     :     :           :     +- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_ext_discount_amt#0, ss_ext_list_price#0]
            :     :     :           :        +- Filter (isnotnull(ss_customer_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :           :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :           +- Project [d_date_sk#0, d_year#0]
            :     :     :              +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :     :     :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     +- Filter isnotnull(customer_id#0)
            :     :        +- LocalRelation <empty>, [customer_id#0, customer_first_name#0, customer_last_name#0, customer_email_address#0, year_total#0]
            :     +- 'Union
            :        :- Filter isnotnull(customer_id#0)
            :        :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :        +- 'Filter isnotnull(customer_id#0)
            :           +- 'Filter (isnotnull(year_total#0) && (year_total#0 > 0.00))
            :              +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, d_year#0], [c_customer_id#0 AS customer_id#0, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ws_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#0 as decimal(8,2)))), DecimalType(8,2)))),18,2) AS year_total#0]
            :                 +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ws_ext_discount_amt#0, ws_ext_list_price#0, d_year#0]
            :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :                       :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ws_sold_date_sk#0, ws_ext_discount_amt#0, ws_ext_list_price#0]
            :                       :  +- 'Join Inner, (c_customer_sk#0 = ws_bill_customer_sk#0)
            :                       :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
            :                       :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :                       :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :                       :     +- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0, ws_ext_discount_amt#0, ws_ext_list_price#0]
            :                       :        +- Filter (isnotnull(ws_bill_customer_sk#0) && isnotnull(ws_sold_date_sk#0))
            :                       :           +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                       +- Project [d_date_sk#0, d_year#0]
            :                          +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
            :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- 'Union
               :- Filter isnotnull(customer_id#0)
               :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
               +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, d_year#0], [c_customer_id#0 AS customer_id#0, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ws_ext_list_price#0 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#0 as decimal(8,2)))), DecimalType(8,2)))),18,2) AS year_total#0]
                  +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ws_ext_discount_amt#0, ws_ext_list_price#0, d_year#0]
                     +- 'Filter isnotnull(c_customer_id#0)
                        +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                           :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0, ws_sold_date_sk#0, ws_ext_discount_amt#0, ws_ext_list_price#0]
                           :  +- 'Join Inner, (c_customer_sk#0 = ws_bill_customer_sk#0)
                           :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0, c_birth_country#0, c_login#0, c_email_address#0]
                           :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
                           :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                           :     +- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0, ws_ext_discount_amt#0, ws_ext_list_price#0]
                           :        +- Filter (isnotnull(ws_bill_customer_sk#0) && isnotnull(ws_sold_date_sk#0))
                           :           +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                           +- Project [d_date_sk#0, d_year#0]
                              +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
                                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q12
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_category#0 ASC NULLS FIRST, i_class#0 ASC NULLS FIRST, i_item_id#0 ASC NULLS FIRST, i_item_desc#0 ASC NULLS FIRST, revenueratio#0 ASC NULLS FIRST], true
      +- 'Project [i_item_id#0, i_item_desc#0, i_category#0, i_class#0, i_current_price#0, itemrevenue#0, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(_w0#0) * 100.00), DecimalType(21,2)) as decimal(27,2))) / promote_precision(_we0#0)), DecimalType(38,17)) AS revenueratio#0]
         +- 'Window [sum(_w1#0) windowspecdefinition(i_class#0, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#0], [i_class#0]
            +- 'Aggregate [i_item_id#0, i_item_desc#0, i_category#0, i_class#0, i_current_price#0], [i_item_id#0, i_item_desc#0, i_category#0, i_class#0, i_current_price#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS itemrevenue#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS _w0#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS _w1#0]
               +- 'Project [ws_ext_sales_price#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                     :- 'Project [ws_sold_date_sk#0, ws_ext_sales_price#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                     :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_ext_sales_price#0]
                     :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                     :     +- Project [i_item_sk#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                     :        +- Filter (i_category#0 IN (Sports,Books,Home) && isnotnull(i_item_sk#0))
                     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     +- Project [d_date_sk#0]
                        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10644)) && (d_date#0 <= 10674)) && isnotnull(d_date_sk#0))
                           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q14
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [channel#0 ASC NULLS FIRST, i_brand_id#0 ASC NULLS FIRST, i_class_id#0 ASC NULLS FIRST, i_category_id#0 ASC NULLS FIRST], true
      +- 'Join Inner, (((i_brand_id#0 = i_brand_id#0) && (i_class_id#0 = i_class_id#0)) && (i_category_id#0 = i_category_id#0))
         :- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
         :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
         :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8220 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8221 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8226]
         :     :     +- Union
         :     :        :- Project [ss_quantity#290 AS quantity#8220, ss_list_price#292 AS list_price#8221]
         :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
         :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
         :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
         :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
         :     :        :     +- Project [d_date_sk#24]
         :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
         :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
         :     :        :- Project [cs_quantity#183 AS quantity#8222, cs_list_price#185 AS list_price#8223]
         :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
         :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
         :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
         :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
         :     :        :     +- Project [d_date_sk#24]
         :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
         :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
         :     :        +- Project [ws_quantity#149 AS quantity#8224, ws_list_price#151 AS list_price#8225]
         :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
         :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
         :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
         :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
         :     :              +- Project [d_date_sk#24]
         :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
         :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
         :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [store AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0]
         :        +- 'Project [ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :           +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
         :              :- 'Project [ss_sold_date_sk#0, ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
         :              :     :- 'Join LeftSemi, (ss_item_sk#0 = ss_item_sk#0)
         :              :     :  :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_quantity#0, ss_list_price#0]
         :              :     :  :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
         :              :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
         :              :     :     +- 'Filter isnotnull(i_item_sk#0)
         :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
         :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
         :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
         :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
         :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
         :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
         :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
         :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
         :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
         :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
         :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
         :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_class_id#0))
         :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :     :                 :     :     +- Project [d_date_sk#0]
         :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1998)) && (d_year#0 <= 2000)) && isnotnull(d_date_sk#0))
         :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
         :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
         :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
         :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
         :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
         :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
         :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :     :                 :           +- Project [d_date_sk#0]
         :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1998)) && (d_year#0 <= 2000)) && isnotnull(d_date_sk#0))
         :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
         :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
         :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
         :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
         :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
         :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
         :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :     :                       +- Project [d_date_sk#0]
         :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1998)) && (d_year#0 <= 2000)) && isnotnull(d_date_sk#0))
         :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
         :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :        :  +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_class_id#0))
         :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
         :              :           +- 'Filter isnotnull(i_item_sk#0)
         :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
         :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
         :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
         :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
         :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
         :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
         :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
         :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
         :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
         :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
         :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
         :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_class_id#0))
         :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :                       :     :     +- Project [d_date_sk#0]
         :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1998)) && (d_year#0 <= 2000)) && isnotnull(d_date_sk#0))
         :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
         :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
         :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
         :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
         :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
         :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
         :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :                       :           +- Project [d_date_sk#0]
         :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1998)) && (d_year#0 <= 2000)) && isnotnull(d_date_sk#0))
         :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
         :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
         :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
         :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
         :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
         :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
         :              :                             :        +- Filter isnotnull(i_item_sk#0)
         :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :              :                             +- Project [d_date_sk#0]
         :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1998)) && (d_year#0 <= 2000)) && isnotnull(d_date_sk#0))
         :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :              +- Project [d_date_sk#0]
         :                 +- Filter ((isnotnull(d_week_seq#0) && (d_week_seq#0 = scalar-subquery#0 [])) && isnotnull(d_date_sk#0))
         :                    :  +- Project [d_week_seq#28]
         :                    :     +- Filter (((((isnotnull(d_year#30) && isnotnull(d_dom#33)) && isnotnull(d_moy#32)) && (d_year#30 = 1999)) && (d_moy#32 = 12)) && (d_dom#33 = 16))
         :                    :        +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
         :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         +- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
               :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8220 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8221 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8226]
               :     +- Union
               :        :- Project [ss_quantity#290 AS quantity#8220, ss_list_price#292 AS list_price#8221]
               :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
               :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
               :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
               :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
               :        :     +- Project [d_date_sk#24]
               :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
               :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               :        :- Project [cs_quantity#183 AS quantity#8222, cs_list_price#185 AS list_price#8223]
               :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
               :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
               :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
               :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
               :        :     +- Project [d_date_sk#24]
               :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
               :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               :        +- Project [ws_quantity#149 AS quantity#8224, ws_list_price#151 AS list_price#8225]
               :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
               :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
               :              :  +- Filter isnotnull(ws_sold_date_sk#131)
               :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
               :              +- Project [d_date_sk#24]
               :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
               :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [store AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0]
                  +- 'Project [ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                        :- 'Project [ss_sold_date_sk#0, ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                        :     :- 'Join LeftSemi, (ss_item_sk#0 = ss_item_sk#0)
                        :     :  :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_quantity#0, ss_list_price#0]
                        :     :  :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                        :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
                        :     :     +- 'Filter isnotnull(i_item_sk#0)
                        :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
                        :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                        :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                        :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                        :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                        :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                        :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
                        :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                        :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                        :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
                        :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                        :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_class_id#0))
                        :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :     :                 :     :     +- Project [d_date_sk#0]
                        :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1998)) && (d_year#0 <= 2000)) && isnotnull(d_date_sk#0))
                        :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                        :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                        :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
                        :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                        :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                        :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
                        :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :     :                 :           +- Project [d_date_sk#0]
                        :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1998)) && (d_year#0 <= 2000)) && isnotnull(d_date_sk#0))
                        :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                        :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                        :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
                        :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                        :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                        :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :     :                       :        +- Filter isnotnull(i_item_sk#0)
                        :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :     :                       +- Project [d_date_sk#0]
                        :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1998)) && (d_year#0 <= 2000)) && isnotnull(d_date_sk#0))
                        :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
                        :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :        :  +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_category_id#0)) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0))
                        :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
                        :           +- 'Filter isnotnull(i_item_sk#0)
                        :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
                        :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                        :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                        :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                        :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                        :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                        :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
                        :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                        :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                        :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
                        :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                        :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                        :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_class_id#0))
                        :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :                       :     :     +- Project [d_date_sk#0]
                        :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1998)) && (d_year#0 <= 2000)) && isnotnull(d_date_sk#0))
                        :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                        :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                        :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
                        :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                        :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                        :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                       :           :        +- Filter isnotnull(i_item_sk#0)
                        :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :                       :           +- Project [d_date_sk#0]
                        :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1998)) && (d_year#0 <= 2000)) && isnotnull(d_date_sk#0))
                        :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                        :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                        :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
                        :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                        :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                        :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                        :                             :        +- Filter isnotnull(i_item_sk#0)
                        :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                        :                             +- Project [d_date_sk#0]
                        :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1998)) && (d_year#0 <= 2000)) && isnotnull(d_date_sk#0))
                        :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                        +- Project [d_date_sk#0]
                           +- Filter ((isnotnull(d_week_seq#0) && (d_week_seq#0 = scalar-subquery#0 [])) && isnotnull(d_date_sk#0))
                              :  +- Project [d_week_seq#28]
                              :     +- Filter (((((isnotnull(d_year#30) && isnotnull(d_dom#33)) && isnotnull(d_moy#32)) && (d_year#30 = 1998)) && (d_moy#32 = 12)) && (d_dom#33 = 16))
                              :        +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q14a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [channel#0 ASC NULLS FIRST, i_brand_id#0 ASC NULLS FIRST, i_class_id#0 ASC NULLS FIRST, i_category_id#0 ASC NULLS FIRST], true
      +- 'Aggregate [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum_sales#0, number_sales#0L], [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum_sales#0, number_sales#0L]
         +- 'Union
            :- 'Aggregate [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum_sales#0, number_sales#0L], [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum_sales#0, number_sales#0L]
            :  +- 'Union
            :     :- 'Aggregate [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum_sales#0, number_sales#0L], [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum_sales#0, number_sales#0L]
            :     :  +- 'Union
            :     :     :- 'Aggregate [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum_sales#0, number_sales#0L], [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum_sales#0, number_sales#0L]
            :     :     :  +- 'Union
            :     :     :     :- 'Aggregate [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0], [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(sales#0) AS sum_sales#0, sum(number_sales#0L) AS number_sales#0L]
            :     :     :     :  +- 'Union
            :     :     :     :     :- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            :     :     :     :     :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
            :     :     :     :     :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
            :     :     :     :     :     :     +- Union
            :     :     :     :     :     :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
            :     :     :     :     :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
            :     :     :     :     :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
            :     :     :     :     :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
            :     :     :     :     :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :     :     :     :     :     :        :     +- Project [d_date_sk#24]
            :     :     :     :     :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
            :     :     :     :     :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :     :     :     :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
            :     :     :     :     :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
            :     :     :     :     :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
            :     :     :     :     :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
            :     :     :     :     :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
            :     :     :     :     :     :        :     +- Project [d_date_sk#24]
            :     :     :     :     :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :     :     :     :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :     :     :     :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
            :     :     :     :     :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
            :     :     :     :     :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
            :     :     :     :     :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
            :     :     :     :     :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
            :     :     :     :     :     :              +- Project [d_date_sk#24]
            :     :     :     :     :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :     :     :     :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :     :     :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [store AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0]
            :     :     :     :     :        +- 'Project [ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :           +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :- 'Project [ss_sold_date_sk#0, ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :     :- 'Join LeftSemi, (ss_item_sk#0 = ss_item_sk#0)
            :     :     :     :     :              :     :  :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_quantity#0, ss_list_price#0]
            :     :     :     :     :              :     :  :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :     :     :              :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :     :     :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :     :     :     :              :     :     +- 'Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :     :     :     :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :     :     :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :     :     :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :     :     :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :     :     :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :     :     :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :     :     :     :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :     :     :     :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :     :     :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :     :     :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :     :     :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :     :                 :     :     +- Project [d_date_sk#0]
            :     :     :     :     :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :     :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :     :     :     :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :     :     :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :     :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :     :                 :           +- Project [d_date_sk#0]
            :     :     :     :     :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :     :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :     :     :     :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :     :     :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :     :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :     :                       +- Project [d_date_sk#0]
            :     :     :     :     :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :     :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
            :     :     :     :     :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :        :  +- Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :     :     :     :              :           +- 'Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :     :     :     :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :     :     :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :     :     :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :     :     :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :     :     :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :     :     :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :     :     :     :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :     :     :     :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :     :     :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :     :     :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :     :     :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :                       :     :     +- Project [d_date_sk#0]
            :     :     :     :     :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :     :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :     :     :     :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :     :     :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :     :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :                       :           +- Project [d_date_sk#0]
            :     :     :     :     :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :     :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :     :     :     :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :     :     :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :     :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                             :        +- Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :                             +- Project [d_date_sk#0]
            :     :     :     :     :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :     :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :              +- Project [d_date_sk#0]
            :     :     :     :     :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
            :     :     :     :     :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            :     :     :     :     :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
            :     :     :     :     :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
            :     :     :     :     :     :     +- Union
            :     :     :     :     :     :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
            :     :     :     :     :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
            :     :     :     :     :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
            :     :     :     :     :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
            :     :     :     :     :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :     :     :     :     :     :        :     +- Project [d_date_sk#24]
            :     :     :     :     :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
            :     :     :     :     :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :     :     :     :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
            :     :     :     :     :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
            :     :     :     :     :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
            :     :     :     :     :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
            :     :     :     :     :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
            :     :     :     :     :     :        :     +- Project [d_date_sk#24]
            :     :     :     :     :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :     :     :     :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :     :     :     :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
            :     :     :     :     :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
            :     :     :     :     :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
            :     :     :     :     :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
            :     :     :     :     :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
            :     :     :     :     :     :              +- Project [d_date_sk#24]
            :     :     :     :     :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :     :     :     :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :     :     :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [catalog AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0]
            :     :     :     :     :        +- 'Project [cs_quantity#0, cs_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :           +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :- 'Project [cs_sold_date_sk#0, cs_quantity#0, cs_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :     :- 'Join LeftSemi, (cs_item_sk#0 = ss_item_sk#0)
            :     :     :     :     :              :     :  :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0]
            :     :     :     :     :              :     :  :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :     :     :              :     :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :     :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :     :     :     :              :     :     +- 'Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :     :     :     :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :     :     :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :     :     :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :     :     :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :     :     :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :     :     :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :     :     :     :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :     :     :     :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :     :     :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :     :     :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :     :     :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :     :                 :     :     +- Project [d_date_sk#0]
            :     :     :     :     :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :     :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :     :     :     :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :     :     :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :     :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :     :                 :           +- Project [d_date_sk#0]
            :     :     :     :     :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :     :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :     :     :     :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :     :     :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :     :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :     :                       +- Project [d_date_sk#0]
            :     :     :     :     :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :     :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
            :     :     :     :     :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :        :  +- Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :     :     :     :              :           +- 'Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :     :     :     :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :     :     :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :     :     :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :     :     :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :     :     :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :     :     :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :     :     :     :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :     :     :     :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :     :     :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :     :     :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :     :     :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :                       :     :     +- Project [d_date_sk#0]
            :     :     :     :     :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :     :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :     :     :     :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :     :     :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :     :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :                       :           +- Project [d_date_sk#0]
            :     :     :     :     :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :     :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :     :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :     :     :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :     :     :     :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :     :     :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :     :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :     :              :                             :        +- Filter isnotnull(i_item_sk#0)
            :     :     :     :     :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :     :              :                             +- Project [d_date_sk#0]
            :     :     :     :     :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :     :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     :              +- Project [d_date_sk#0]
            :     :     :     :     :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
            :     :     :     :     :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :     +- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            :     :     :     :        +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
            :     :     :     :           :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
            :     :     :     :           :     +- Union
            :     :     :     :           :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
            :     :     :     :           :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
            :     :     :     :           :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
            :     :     :     :           :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
            :     :     :     :           :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :     :     :     :           :        :     +- Project [d_date_sk#24]
            :     :     :     :           :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
            :     :     :     :           :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :     :           :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
            :     :     :     :           :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
            :     :     :     :           :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
            :     :     :     :           :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
            :     :     :     :           :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
            :     :     :     :           :        :     +- Project [d_date_sk#24]
            :     :     :     :           :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :     :     :           :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :     :           :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
            :     :     :     :           :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
            :     :     :     :           :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
            :     :     :     :           :              :  +- Filter isnotnull(ws_sold_date_sk#131)
            :     :     :     :           :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
            :     :     :     :           :              +- Project [d_date_sk#24]
            :     :     :     :           :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :     :     :           :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :     :           +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [web AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0]
            :     :     :     :              +- 'Project [ws_quantity#0, ws_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                 +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :                    :- 'Project [ws_sold_date_sk#0, ws_quantity#0, ws_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :     :                    :     :- 'Join LeftSemi, (ws_item_sk#0 = ss_item_sk#0)
            :     :     :     :                    :     :  :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_quantity#0, ws_list_price#0]
            :     :     :     :                    :     :  :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :     :                    :     :  :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :                    :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :     :     :                    :     :     +- 'Filter isnotnull(i_item_sk#0)
            :     :     :     :                    :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :     :     :                    :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :     :                    :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :                    :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :     :                    :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :     :                    :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :     :                    :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :     :                    :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :     :     :                    :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :                    :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :     :                    :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :     :     :                    :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :     :                    :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :     :                    :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :     :                    :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :                    :     :                 :     :     +- Project [d_date_sk#0]
            :     :     :     :                    :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :                    :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :                    :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :                    :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :     :                    :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :     :     :                    :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :     :                    :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :                    :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
            :     :     :     :                    :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :                    :     :                 :           +- Project [d_date_sk#0]
            :     :     :     :                    :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :                    :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :                    :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :                    :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :     :                    :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :     :     :                    :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :     :                    :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :                    :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :     :                       :        +- Filter isnotnull(i_item_sk#0)
            :     :     :     :                    :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :                    :     :                       +- Project [d_date_sk#0]
            :     :     :     :                    :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :                    :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :                    :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
            :     :     :     :                    :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :        :  +- Filter isnotnull(i_item_sk#0)
            :     :     :     :                    :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :                    :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :     :     :                    :           +- 'Filter isnotnull(i_item_sk#0)
            :     :     :     :                    :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :     :     :                    :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :     :                    :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :                    :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :     :                    :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :     :                    :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :     :                    :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :     :                    :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :     :     :                    :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :                    :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :     :                    :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :     :     :                    :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :     :                    :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :     :                    :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :     :                    :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :                    :                       :     :     +- Project [d_date_sk#0]
            :     :     :     :                    :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :                    :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :                    :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :                    :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :     :                    :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :     :     :                    :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :     :                    :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :                    :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :                       :           :        +- Filter isnotnull(i_item_sk#0)
            :     :     :     :                    :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :                    :                       :           +- Project [d_date_sk#0]
            :     :     :     :                    :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :                    :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :                    :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :                    :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :     :                    :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :     :     :                    :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :     :                    :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :                    :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :     :                    :                             :        +- Filter isnotnull(i_item_sk#0)
            :     :     :     :                    :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :     :                    :                             +- Project [d_date_sk#0]
            :     :     :     :                    :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :     :                    :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :                    +- Project [d_date_sk#0]
            :     :     :     :                       +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
            :     :     :     :                          +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     +- 'Aggregate [channel#0, i_brand_id#0, i_class_id#0], [channel#0, i_brand_id#0, i_class_id#0, null AS i_category_id#0, sum(sum_sales#0) AS sum(sum_sales)#0, sum(number_sales#0L) AS sum(number_sales)#0L]
            :     :     :        +- 'Aggregate [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0], [channel#0, i_brand_id#0, i_class_id#0, sum(sales#0) AS sum_sales#0, sum(number_sales#0L) AS number_sales#0L]
            :     :     :           +- 'Union
            :     :     :              :- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            :     :     :              :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
            :     :     :              :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
            :     :     :              :     :     +- Union
            :     :     :              :     :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
            :     :     :              :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
            :     :     :              :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
            :     :     :              :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
            :     :     :              :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :     :     :              :     :        :     +- Project [d_date_sk#24]
            :     :     :              :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
            :     :     :              :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :              :     :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
            :     :     :              :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
            :     :     :              :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
            :     :     :              :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
            :     :     :              :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
            :     :     :              :     :        :     +- Project [d_date_sk#24]
            :     :     :              :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :     :              :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :              :     :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
            :     :     :              :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
            :     :     :              :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
            :     :     :              :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
            :     :     :              :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
            :     :     :              :     :              +- Project [d_date_sk#24]
            :     :     :              :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :     :              :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :              :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [store AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0]
            :     :     :              :        +- 'Project [ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :           +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :- 'Project [ss_sold_date_sk#0, ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :              :              :     :- 'Join LeftSemi, (ss_item_sk#0 = ss_item_sk#0)
            :     :     :              :              :     :  :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_quantity#0, ss_list_price#0]
            :     :     :              :              :     :  :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :              :              :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :              :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :     :              :              :     :     +- 'Filter isnotnull(i_item_sk#0)
            :     :     :              :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :     :              :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :              :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :              :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :              :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :              :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :              :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :     :              :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :              :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :     :              :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :              :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :              :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :              :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :     :                 :     :     +- Project [d_date_sk#0]
            :     :     :              :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :              :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :              :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :     :              :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :              :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :              :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
            :     :     :              :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :     :                 :           +- Project [d_date_sk#0]
            :     :     :              :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :              :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :              :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :     :              :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :              :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :              :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
            :     :     :              :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :     :                       +- Project [d_date_sk#0]
            :     :     :              :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :              :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
            :     :     :              :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :        :  +- Filter isnotnull(i_item_sk#0)
            :     :     :              :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :     :              :              :           +- 'Filter isnotnull(i_item_sk#0)
            :     :     :              :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :     :              :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :              :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :              :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :              :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :              :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :              :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :     :              :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :              :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :     :              :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :              :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :              :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :              :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :                       :     :     +- Project [d_date_sk#0]
            :     :     :              :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :              :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :              :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :     :              :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :              :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :              :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
            :     :     :              :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :                       :           +- Project [d_date_sk#0]
            :     :     :              :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :              :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :              :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :     :              :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :              :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :              :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                             :        +- Filter isnotnull(i_item_sk#0)
            :     :     :              :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :                             +- Project [d_date_sk#0]
            :     :     :              :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :              :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              :              +- Project [d_date_sk#0]
            :     :     :              :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
            :     :     :              :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              :- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            :     :     :              :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
            :     :     :              :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
            :     :     :              :     :     +- Union
            :     :     :              :     :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
            :     :     :              :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
            :     :     :              :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
            :     :     :              :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
            :     :     :              :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :     :     :              :     :        :     +- Project [d_date_sk#24]
            :     :     :              :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
            :     :     :              :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :              :     :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
            :     :     :              :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
            :     :     :              :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
            :     :     :              :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
            :     :     :              :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
            :     :     :              :     :        :     +- Project [d_date_sk#24]
            :     :     :              :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :     :              :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :              :     :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
            :     :     :              :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
            :     :     :              :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
            :     :     :              :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
            :     :     :              :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
            :     :     :              :     :              +- Project [d_date_sk#24]
            :     :     :              :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :     :              :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :              :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [catalog AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0]
            :     :     :              :        +- 'Project [cs_quantity#0, cs_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :           +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :- 'Project [cs_sold_date_sk#0, cs_quantity#0, cs_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :              :              :     :- 'Join LeftSemi, (cs_item_sk#0 = ss_item_sk#0)
            :     :     :              :              :     :  :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0]
            :     :     :              :              :     :  :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :              :              :     :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :              :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :     :              :              :     :     +- 'Filter isnotnull(i_item_sk#0)
            :     :     :              :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :     :              :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :              :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :              :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :              :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :              :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :              :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :     :              :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :              :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :     :              :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :              :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :              :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :              :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :     :                 :     :     +- Project [d_date_sk#0]
            :     :     :              :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :              :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :              :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :     :              :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :              :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :              :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
            :     :     :              :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :     :                 :           +- Project [d_date_sk#0]
            :     :     :              :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :              :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :              :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :     :              :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :              :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :              :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
            :     :     :              :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :     :                       +- Project [d_date_sk#0]
            :     :     :              :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :              :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
            :     :     :              :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :        :  +- Filter isnotnull(i_item_sk#0)
            :     :     :              :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :     :              :              :           +- 'Filter isnotnull(i_item_sk#0)
            :     :     :              :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :     :              :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :              :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :              :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :              :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :              :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :              :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :     :              :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :              :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :     :              :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :              :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :              :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :              :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :                       :     :     +- Project [d_date_sk#0]
            :     :     :              :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :              :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :              :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :     :              :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :              :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :              :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
            :     :     :              :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :                       :           +- Project [d_date_sk#0]
            :     :     :              :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :              :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :              :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :              :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :     :              :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :              :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :              :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :              :              :                             :        +- Filter isnotnull(i_item_sk#0)
            :     :     :              :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :              :              :                             +- Project [d_date_sk#0]
            :     :     :              :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :              :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              :              +- Project [d_date_sk#0]
            :     :     :              :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
            :     :     :              :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              +- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            :     :     :                 +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
            :     :     :                    :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
            :     :     :                    :     +- Union
            :     :     :                    :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
            :     :     :                    :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
            :     :     :                    :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
            :     :     :                    :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
            :     :     :                    :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :     :     :                    :        :     +- Project [d_date_sk#24]
            :     :     :                    :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
            :     :     :                    :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :                    :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
            :     :     :                    :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
            :     :     :                    :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
            :     :     :                    :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
            :     :     :                    :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
            :     :     :                    :        :     +- Project [d_date_sk#24]
            :     :     :                    :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :     :                    :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :                    :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
            :     :     :                    :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
            :     :     :                    :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
            :     :     :                    :              :  +- Filter isnotnull(ws_sold_date_sk#131)
            :     :     :                    :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
            :     :     :                    :              +- Project [d_date_sk#24]
            :     :     :                    :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :     :                    :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :     :                    +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [web AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0]
            :     :     :                       +- 'Project [ws_quantity#0, ws_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :                             :- 'Project [ws_sold_date_sk#0, ws_quantity#0, ws_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :                             :     :- 'Join LeftSemi, (ws_item_sk#0 = ss_item_sk#0)
            :     :     :                             :     :  :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_quantity#0, ws_list_price#0]
            :     :     :                             :     :  :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :                             :     :  :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :                             :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :     :                             :     :     +- 'Filter isnotnull(i_item_sk#0)
            :     :     :                             :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :     :                             :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :                             :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :                             :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :                             :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :                             :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :                             :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :                             :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :     :                             :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :                             :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :                             :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :     :                             :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :                             :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :                             :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :                             :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :                             :     :                 :     :     +- Project [d_date_sk#0]
            :     :     :                             :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :                             :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :                             :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :                             :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :                             :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :     :                             :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :                             :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :                             :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
            :     :     :                             :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :                             :     :                 :           +- Project [d_date_sk#0]
            :     :     :                             :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :                             :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :                             :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :                             :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :                             :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :     :                             :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :                             :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :                             :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :     :                       :        +- Filter isnotnull(i_item_sk#0)
            :     :     :                             :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :                             :     :                       +- Project [d_date_sk#0]
            :     :     :                             :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :                             :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :                             :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
            :     :     :                             :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :        :  +- Filter isnotnull(i_item_sk#0)
            :     :     :                             :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :                             :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :     :                             :           +- 'Filter isnotnull(i_item_sk#0)
            :     :     :                             :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :     :                             :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :                             :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :                             :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :                             :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :                             :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :     :                             :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :     :                             :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :     :                             :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :                             :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :                             :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :     :                             :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :                             :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :                             :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :     :                             :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :                             :                       :     :     +- Project [d_date_sk#0]
            :     :     :                             :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :                             :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :                             :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :                             :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :                             :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :     :                             :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :     :                             :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :                             :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :                       :           :        +- Filter isnotnull(i_item_sk#0)
            :     :     :                             :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :                             :                       :           +- Project [d_date_sk#0]
            :     :     :                             :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :                             :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :                             :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :     :                             :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :     :                             :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :     :                             :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :     :                             :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :     :                             :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :     :                             :                             :        +- Filter isnotnull(i_item_sk#0)
            :     :     :                             :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :                             :                             +- Project [d_date_sk#0]
            :     :     :                             :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :     :                             :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :                             +- Project [d_date_sk#0]
            :     :     :                                +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
            :     :     :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     +- 'Aggregate [channel#0, i_brand_id#0], [channel#0, i_brand_id#0, null AS i_class_id#0, null AS i_category_id#0, sum(sum_sales#0) AS sum(sum_sales)#0, sum(number_sales#0L) AS sum(number_sales)#0L]
            :     :        +- 'Aggregate [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0], [channel#0, i_brand_id#0, sum(sales#0) AS sum_sales#0, sum(number_sales#0L) AS number_sales#0L]
            :     :           +- 'Union
            :     :              :- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            :     :              :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
            :     :              :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
            :     :              :     :     +- Union
            :     :              :     :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
            :     :              :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
            :     :              :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
            :     :              :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
            :     :              :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :     :              :     :        :     +- Project [d_date_sk#24]
            :     :              :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
            :     :              :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :              :     :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
            :     :              :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
            :     :              :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
            :     :              :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
            :     :              :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
            :     :              :     :        :     +- Project [d_date_sk#24]
            :     :              :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :              :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :              :     :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
            :     :              :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
            :     :              :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
            :     :              :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
            :     :              :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
            :     :              :     :              +- Project [d_date_sk#24]
            :     :              :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :              :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :              :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [store AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0]
            :     :              :        +- 'Project [ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :           +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :- 'Project [ss_sold_date_sk#0, ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :              :              :     :- 'Join LeftSemi, (ss_item_sk#0 = ss_item_sk#0)
            :     :              :              :     :  :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_quantity#0, ss_list_price#0]
            :     :              :              :     :  :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :              :              :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :              :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :              :              :     :     +- 'Filter isnotnull(i_item_sk#0)
            :     :              :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :              :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :              :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :              :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :              :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :              :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :              :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :              :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :              :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :              :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :              :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :              :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :              :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :     :                 :     :     +- Project [d_date_sk#0]
            :     :              :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :              :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :              :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :              :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :              :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :              :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
            :     :              :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :     :                 :           +- Project [d_date_sk#0]
            :     :              :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :              :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :              :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :              :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :              :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :              :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
            :     :              :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :     :                       +- Project [d_date_sk#0]
            :     :              :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :              :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
            :     :              :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :        :  +- Filter isnotnull(i_item_sk#0)
            :     :              :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :              :              :           +- 'Filter isnotnull(i_item_sk#0)
            :     :              :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :              :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :              :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :              :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :              :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :              :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :              :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :              :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :              :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :              :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :              :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :              :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :              :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :                       :     :     +- Project [d_date_sk#0]
            :     :              :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :              :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :              :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :              :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :              :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :              :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
            :     :              :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :                       :           +- Project [d_date_sk#0]
            :     :              :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :              :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :              :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :              :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :              :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :              :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                             :        +- Filter isnotnull(i_item_sk#0)
            :     :              :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :                             +- Project [d_date_sk#0]
            :     :              :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :              :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :              +- Project [d_date_sk#0]
            :     :              :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
            :     :              :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            :     :              :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
            :     :              :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
            :     :              :     :     +- Union
            :     :              :     :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
            :     :              :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
            :     :              :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
            :     :              :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
            :     :              :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :     :              :     :        :     +- Project [d_date_sk#24]
            :     :              :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
            :     :              :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :              :     :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
            :     :              :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
            :     :              :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
            :     :              :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
            :     :              :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
            :     :              :     :        :     +- Project [d_date_sk#24]
            :     :              :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :              :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :              :     :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
            :     :              :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
            :     :              :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
            :     :              :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
            :     :              :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
            :     :              :     :              +- Project [d_date_sk#24]
            :     :              :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :              :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :              :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [catalog AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0]
            :     :              :        +- 'Project [cs_quantity#0, cs_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :           +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :- 'Project [cs_sold_date_sk#0, cs_quantity#0, cs_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :              :              :     :- 'Join LeftSemi, (cs_item_sk#0 = ss_item_sk#0)
            :     :              :              :     :  :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0]
            :     :              :              :     :  :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :              :              :     :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :              :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :              :              :     :     +- 'Filter isnotnull(i_item_sk#0)
            :     :              :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :              :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :              :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :              :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :              :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :              :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :              :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :              :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :              :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :              :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :              :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :              :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :              :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :     :                 :     :     +- Project [d_date_sk#0]
            :     :              :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :              :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :              :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :              :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :              :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :              :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
            :     :              :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :     :                 :           +- Project [d_date_sk#0]
            :     :              :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :              :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :              :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :              :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :              :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :              :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
            :     :              :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :     :                       +- Project [d_date_sk#0]
            :     :              :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :              :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
            :     :              :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :        :  +- Filter isnotnull(i_item_sk#0)
            :     :              :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :              :              :           +- 'Filter isnotnull(i_item_sk#0)
            :     :              :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :              :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :              :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :              :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :              :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :              :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :              :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :              :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :              :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :              :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :              :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :              :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :              :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :                       :     :     +- Project [d_date_sk#0]
            :     :              :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :              :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :              :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :              :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :              :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :              :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
            :     :              :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :                       :           +- Project [d_date_sk#0]
            :     :              :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :              :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :              :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :              :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :              :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :              :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :              :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :              :              :                             :        +- Filter isnotnull(i_item_sk#0)
            :     :              :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              :              :                             +- Project [d_date_sk#0]
            :     :              :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :              :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :              +- Project [d_date_sk#0]
            :     :              :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
            :     :              :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              +- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            :     :                 +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
            :     :                    :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
            :     :                    :     +- Union
            :     :                    :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
            :     :                    :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
            :     :                    :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
            :     :                    :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
            :     :                    :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :     :                    :        :     +- Project [d_date_sk#24]
            :     :                    :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
            :     :                    :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :                    :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
            :     :                    :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
            :     :                    :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
            :     :                    :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
            :     :                    :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
            :     :                    :        :     +- Project [d_date_sk#24]
            :     :                    :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :                    :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :                    :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
            :     :                    :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
            :     :                    :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
            :     :                    :              :  +- Filter isnotnull(ws_sold_date_sk#131)
            :     :                    :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
            :     :                    :              +- Project [d_date_sk#24]
            :     :                    :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :     :                    :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :     :                    +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [web AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0]
            :     :                       +- 'Project [ws_quantity#0, ws_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :                             :- 'Project [ws_sold_date_sk#0, ws_quantity#0, ws_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :                             :     :- 'Join LeftSemi, (ws_item_sk#0 = ss_item_sk#0)
            :     :                             :     :  :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_quantity#0, ws_list_price#0]
            :     :                             :     :  :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :                             :     :  :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :                             :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :                             :     :     +- 'Filter isnotnull(i_item_sk#0)
            :     :                             :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :                             :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :                             :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :                             :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :                             :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :                             :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :                             :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :                             :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :                             :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :                             :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :                             :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :                             :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :                             :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :                             :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :                             :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :                             :     :                 :     :     +- Project [d_date_sk#0]
            :     :                             :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :                             :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                             :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :                             :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :                             :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :                             :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :                             :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :                             :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
            :     :                             :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :                             :     :                 :           +- Project [d_date_sk#0]
            :     :                             :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :                             :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                             :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :                             :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :                             :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :                             :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :                             :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :                             :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :     :                       :        +- Filter isnotnull(i_item_sk#0)
            :     :                             :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :                             :     :                       +- Project [d_date_sk#0]
            :     :                             :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :                             :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                             :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
            :     :                             :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :        :  +- Filter isnotnull(i_item_sk#0)
            :     :                             :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :                             :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :     :                             :           +- 'Filter isnotnull(i_item_sk#0)
            :     :                             :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :     :                             :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :                             :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :                             :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :                             :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :                             :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :     :                             :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :     :                             :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :     :                             :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :                             :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :                             :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :     :                             :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :                             :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :                             :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :     :                             :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :                             :                       :     :     +- Project [d_date_sk#0]
            :     :                             :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :                             :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                             :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :                             :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :                             :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :     :                             :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :     :                             :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :                             :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :                       :           :        +- Filter isnotnull(i_item_sk#0)
            :     :                             :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :                             :                       :           +- Project [d_date_sk#0]
            :     :                             :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :                             :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                             :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :                             :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :                             :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :     :                             :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :     :                             :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :                             :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :     :                             :                             :        +- Filter isnotnull(i_item_sk#0)
            :     :                             :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :                             :                             +- Project [d_date_sk#0]
            :     :                             :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :     :                             :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                             +- Project [d_date_sk#0]
            :     :                                +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
            :     :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     +- 'Aggregate [channel#0], [channel#0, null AS i_brand_id#0, null AS i_class_id#0, null AS i_category_id#0, sum(sum_sales#0) AS sum(sum_sales)#0, sum(number_sales#0L) AS sum(number_sales)#0L]
            :        +- 'Aggregate [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0], [channel#0, sum(sales#0) AS sum_sales#0, sum(number_sales#0L) AS number_sales#0L]
            :           +- 'Union
            :              :- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            :              :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
            :              :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
            :              :     :     +- Union
            :              :     :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
            :              :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
            :              :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
            :              :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
            :              :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :              :     :        :     +- Project [d_date_sk#24]
            :              :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
            :              :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :              :     :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
            :              :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
            :              :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
            :              :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
            :              :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
            :              :     :        :     +- Project [d_date_sk#24]
            :              :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :              :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :              :     :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
            :              :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
            :              :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
            :              :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
            :              :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
            :              :     :              +- Project [d_date_sk#24]
            :              :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :              :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :              :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [store AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0]
            :              :        +- 'Project [ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :           +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :              :              :- 'Project [ss_sold_date_sk#0, ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :              :              :     :- 'Join LeftSemi, (ss_item_sk#0 = ss_item_sk#0)
            :              :              :     :  :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_quantity#0, ss_list_price#0]
            :              :              :     :  :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :              :              :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :              :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :              :              :     :     +- 'Filter isnotnull(i_item_sk#0)
            :              :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :              :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :              :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :              :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :              :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :              :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :              :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :              :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :              :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :              :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :              :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :              :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :              :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :              :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :     :                 :     :     +- Project [d_date_sk#0]
            :              :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :              :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :              :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :              :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :              :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :              :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :              :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
            :              :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :     :                 :           +- Project [d_date_sk#0]
            :              :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :              :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :              :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :              :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :              :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :              :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :              :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
            :              :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :     :                       +- Project [d_date_sk#0]
            :              :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :              :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
            :              :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :        :  +- Filter isnotnull(i_item_sk#0)
            :              :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :              :              :           +- 'Filter isnotnull(i_item_sk#0)
            :              :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :              :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :              :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :              :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :              :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :              :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :              :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :              :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :              :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :              :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :              :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :              :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :              :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :              :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :                       :     :     +- Project [d_date_sk#0]
            :              :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :              :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :              :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :              :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :              :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :              :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :              :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
            :              :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :                       :           +- Project [d_date_sk#0]
            :              :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :              :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :              :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :              :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :              :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :              :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :              :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                             :        +- Filter isnotnull(i_item_sk#0)
            :              :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :                             +- Project [d_date_sk#0]
            :              :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :              :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :              +- Project [d_date_sk#0]
            :              :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
            :              :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            :              :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
            :              :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
            :              :     :     +- Union
            :              :     :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
            :              :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
            :              :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
            :              :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
            :              :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :              :     :        :     +- Project [d_date_sk#24]
            :              :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
            :              :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :              :     :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
            :              :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
            :              :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
            :              :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
            :              :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
            :              :     :        :     +- Project [d_date_sk#24]
            :              :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :              :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :              :     :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
            :              :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
            :              :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
            :              :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
            :              :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
            :              :     :              +- Project [d_date_sk#24]
            :              :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :              :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :              :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [catalog AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0]
            :              :        +- 'Project [cs_quantity#0, cs_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :           +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :              :              :- 'Project [cs_sold_date_sk#0, cs_quantity#0, cs_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :              :              :     :- 'Join LeftSemi, (cs_item_sk#0 = ss_item_sk#0)
            :              :              :     :  :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0]
            :              :              :     :  :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :              :              :     :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :              :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :              :              :     :     +- 'Filter isnotnull(i_item_sk#0)
            :              :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :              :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :              :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :              :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :              :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :              :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :              :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :              :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :              :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :              :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :              :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :              :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :              :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :              :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :     :                 :     :     +- Project [d_date_sk#0]
            :              :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :              :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :              :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :              :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :              :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :              :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :              :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
            :              :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :     :                 :           +- Project [d_date_sk#0]
            :              :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :              :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :              :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :              :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :              :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :              :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :              :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
            :              :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :     :                       +- Project [d_date_sk#0]
            :              :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :              :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
            :              :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :        :  +- Filter isnotnull(i_item_sk#0)
            :              :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :              :              :           +- 'Filter isnotnull(i_item_sk#0)
            :              :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :              :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :              :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :              :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :              :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :              :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :              :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :              :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :              :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :              :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :              :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :              :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :              :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :              :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :                       :     :     +- Project [d_date_sk#0]
            :              :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :              :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :              :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :              :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :              :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :              :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :              :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
            :              :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :                       :           +- Project [d_date_sk#0]
            :              :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :              :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :              :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :              :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :              :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :              :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :              :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :              :              :                             :        +- Filter isnotnull(i_item_sk#0)
            :              :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :              :                             +- Project [d_date_sk#0]
            :              :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :              :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :              +- Project [d_date_sk#0]
            :              :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
            :              :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              +- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
            :                 +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
            :                    :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
            :                    :     +- Union
            :                    :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
            :                    :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
            :                    :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
            :                    :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
            :                    :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
            :                    :        :     +- Project [d_date_sk#24]
            :                    :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
            :                    :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :                    :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
            :                    :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
            :                    :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
            :                    :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
            :                    :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
            :                    :        :     +- Project [d_date_sk#24]
            :                    :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :                    :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :                    :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
            :                    :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
            :                    :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
            :                    :              :  +- Filter isnotnull(ws_sold_date_sk#131)
            :                    :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
            :                    :              +- Project [d_date_sk#24]
            :                    :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
            :                    :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
            :                    +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [web AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0]
            :                       +- 'Project [ws_quantity#0, ws_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :                             :- 'Project [ws_sold_date_sk#0, ws_quantity#0, ws_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :                             :     :- 'Join LeftSemi, (ws_item_sk#0 = ss_item_sk#0)
            :                             :     :  :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_quantity#0, ws_list_price#0]
            :                             :     :  :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :                             :     :  :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                             :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :                             :     :     +- 'Filter isnotnull(i_item_sk#0)
            :                             :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :                             :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :                             :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                             :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :                             :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :                             :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :                             :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :                             :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :                             :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :                             :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :                             :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :                             :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :                             :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :                             :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :                             :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                             :     :                 :     :     +- Project [d_date_sk#0]
            :                             :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :                             :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                             :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :                             :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :                             :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :                             :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :                             :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :                             :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
            :                             :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                             :     :                 :           +- Project [d_date_sk#0]
            :                             :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :                             :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                             :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :                             :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :                             :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :                             :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :                             :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                             :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :     :                       :        +- Filter isnotnull(i_item_sk#0)
            :                             :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                             :     :                       +- Project [d_date_sk#0]
            :                             :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :                             :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                             :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
            :                             :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :        :  +- Filter isnotnull(i_item_sk#0)
            :                             :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                             :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
            :                             :           +- 'Filter isnotnull(i_item_sk#0)
            :                             :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
            :                             :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :                             :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                             :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :                             :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :                             :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
            :                             :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
            :                             :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
            :                             :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :                             :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :                             :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
            :                             :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :                             :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :                             :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
            :                             :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                             :                       :     :     +- Project [d_date_sk#0]
            :                             :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :                             :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                             :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :                             :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :                             :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
            :                             :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :                             :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :                             :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :                       :           :        +- Filter isnotnull(i_item_sk#0)
            :                             :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                             :                       :           +- Project [d_date_sk#0]
            :                             :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :                             :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                             :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :                             :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :                             :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
            :                             :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :                             :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                             :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
            :                             :                             :        +- Filter isnotnull(i_item_sk#0)
            :                             :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                             :                             +- Project [d_date_sk#0]
            :                             :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
            :                             :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                             +- Project [d_date_sk#0]
            :                                +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
            :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- 'Aggregate [null AS channel#0, null AS i_brand_id#0, null AS i_class_id#0, null AS i_category_id#0, sum(sum_sales#0) AS sum(sum_sales)#0, sum(number_sales#0L) AS sum(number_sales)#0L]
               +- 'Aggregate [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0], [sum(sales#0) AS sum_sales#0, sum(number_sales#0L) AS number_sales#0L]
                  +- 'Union
                     :- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
                     :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
                     :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
                     :     :     +- Union
                     :     :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
                     :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
                     :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
                     :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
                     :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
                     :     :        :     +- Project [d_date_sk#24]
                     :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
                     :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                     :     :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
                     :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
                     :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
                     :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
                     :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
                     :     :        :     +- Project [d_date_sk#24]
                     :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
                     :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                     :     :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
                     :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
                     :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
                     :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
                     :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
                     :     :              +- Project [d_date_sk#24]
                     :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
                     :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                     :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [store AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#292 as decimal(12,2)))), DecimalType(18,2)))#0]
                     :        +- 'Project [ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :           +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                     :              :- 'Project [ss_sold_date_sk#0, ss_quantity#0, ss_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                     :              :     :- 'Join LeftSemi, (ss_item_sk#0 = ss_item_sk#0)
                     :              :     :  :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_quantity#0, ss_list_price#0]
                     :              :     :  :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                     :              :     :  :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                     :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
                     :              :     :     +- 'Filter isnotnull(i_item_sk#0)
                     :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
                     :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                     :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                     :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                     :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                     :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                     :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
                     :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                     :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                     :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
                     :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                     :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                     :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                     :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :     :                 :     :     +- Project [d_date_sk#0]
                     :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                     :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                     :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                     :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
                     :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                     :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                     :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
                     :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :     :                 :           +- Project [d_date_sk#0]
                     :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                     :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                     :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                     :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
                     :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                     :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                     :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
                     :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :     :                       +- Project [d_date_sk#0]
                     :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                     :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
                     :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :        :  +- Filter isnotnull(i_item_sk#0)
                     :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
                     :              :           +- 'Filter isnotnull(i_item_sk#0)
                     :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
                     :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                     :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                     :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                     :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                     :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                     :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
                     :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                     :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                     :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
                     :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                     :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                     :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                     :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :                       :     :     +- Project [d_date_sk#0]
                     :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                     :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                     :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                     :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
                     :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                     :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                     :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
                     :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :                       :           +- Project [d_date_sk#0]
                     :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                     :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                     :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                     :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
                     :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                     :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                     :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                             :        +- Filter isnotnull(i_item_sk#0)
                     :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :                             +- Project [d_date_sk#0]
                     :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                     :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :              +- Project [d_date_sk#0]
                     :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
                     :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
                     :  +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
                     :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
                     :     :     +- Union
                     :     :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
                     :     :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
                     :     :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
                     :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
                     :     :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
                     :     :        :     +- Project [d_date_sk#24]
                     :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
                     :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                     :     :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
                     :     :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
                     :     :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
                     :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
                     :     :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
                     :     :        :     +- Project [d_date_sk#24]
                     :     :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
                     :     :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                     :     :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
                     :     :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
                     :     :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
                     :     :              :  +- Filter isnotnull(ws_sold_date_sk#131)
                     :     :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
                     :     :              +- Project [d_date_sk#24]
                     :     :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
                     :     :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                     :     +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [catalog AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#183 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#185 as decimal(12,2)))), DecimalType(18,2)))#0]
                     :        +- 'Project [cs_quantity#0, cs_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :           +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                     :              :- 'Project [cs_sold_date_sk#0, cs_quantity#0, cs_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                     :              :     :- 'Join LeftSemi, (cs_item_sk#0 = ss_item_sk#0)
                     :              :     :  :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0]
                     :              :     :  :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                     :              :     :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                     :              :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
                     :              :     :     +- 'Filter isnotnull(i_item_sk#0)
                     :              :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
                     :              :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                     :              :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                     :              :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                     :              :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                     :              :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                     :              :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
                     :              :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                     :              :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                     :              :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
                     :              :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                     :              :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                     :              :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                     :              :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :     :                 :     :     +- Project [d_date_sk#0]
                     :              :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                     :              :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :              :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                     :              :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                     :              :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
                     :              :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                     :              :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                     :              :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
                     :              :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :     :                 :           +- Project [d_date_sk#0]
                     :              :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                     :              :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :              :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                     :              :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                     :              :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
                     :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                     :              :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                     :              :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :     :                       :        +- Filter isnotnull(i_item_sk#0)
                     :              :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :     :                       +- Project [d_date_sk#0]
                     :              :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                     :              :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :              :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
                     :              :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :        :  +- Filter isnotnull(i_item_sk#0)
                     :              :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
                     :              :           +- 'Filter isnotnull(i_item_sk#0)
                     :              :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
                     :              :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                     :              :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                     :              :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                     :              :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                     :              :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                     :              :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
                     :              :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                     :              :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                     :              :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
                     :              :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                     :              :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                     :              :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                     :              :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :                       :     :     +- Project [d_date_sk#0]
                     :              :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                     :              :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :              :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                     :              :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                     :              :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
                     :              :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                     :              :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                     :              :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                       :           :        +- Filter isnotnull(i_item_sk#0)
                     :              :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :                       :           +- Project [d_date_sk#0]
                     :              :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                     :              :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :              :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                     :              :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                     :              :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
                     :              :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                     :              :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                     :              :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                     :              :                             :        +- Filter isnotnull(i_item_sk#0)
                     :              :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :              :                             +- Project [d_date_sk#0]
                     :              :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                     :              :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :              +- Project [d_date_sk#0]
                     :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
                     :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     +- 'Project [channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sales#0, number_sales#0L]
                        +- 'Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0) && (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0 as decimal(32,6)) > cast(scalar-subquery#0 [] as decimal(32,6))))
                           :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#8290 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#8291 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#8296]
                           :     +- Union
                           :        :- Project [ss_quantity#290 AS quantity#8290, ss_list_price#292 AS list_price#8291]
                           :        :  +- Join Inner, (ss_sold_date_sk#280 = d_date_sk#24)
                           :        :     :- Project [ss_sold_date_sk#280, ss_quantity#290, ss_list_price#292]
                           :        :     :  +- Filter isnotnull(ss_sold_date_sk#280)
                           :        :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
                           :        :     +- Project [d_date_sk#24]
                           :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1999)) && (d_year#30 <= 2001)) && isnotnull(d_date_sk#24))
                           :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                           :        :- Project [cs_quantity#183 AS quantity#8292, cs_list_price#185 AS list_price#8293]
                           :        :  +- Join Inner, (cs_sold_date_sk#165 = d_date_sk#24)
                           :        :     :- Project [cs_sold_date_sk#165, cs_quantity#183, cs_list_price#185]
                           :        :     :  +- Filter isnotnull(cs_sold_date_sk#165)
                           :        :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#166,cs_ship_date_sk#167,cs_bill_customer_sk#168,cs_bill_cdemo_sk#169,cs_bill_hdemo_sk#170,cs_bill_addr_sk#171,cs_ship_customer_sk#172,cs_ship_cdemo_sk#173,cs_ship_hdemo_sk#174,cs_ship_addr_sk#175,cs_call_center_sk#176,cs_catalog_page_sk#177,cs_ship_mode_sk#178,cs_warehouse_sk#179,cs_item_sk#180,cs_promo_sk#181,cs_order_number#182,cs_quantity#183,cs_wholesale_cost#184,cs_list_price#185,cs_sales_price#186,cs_ext_discount_amt#187,cs_ext_sales_price#188,... 10 more fields] parquet
                           :        :     +- Project [d_date_sk#24]
                           :        :        +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
                           :        :           +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                           :        +- Project [ws_quantity#149 AS quantity#8294, ws_list_price#151 AS list_price#8295]
                           :           +- Join Inner, (ws_sold_date_sk#131 = d_date_sk#24)
                           :              :- Project [ws_sold_date_sk#131, ws_quantity#149, ws_list_price#151]
                           :              :  +- Filter isnotnull(ws_sold_date_sk#131)
                           :              :     +- Relation[ws_sold_date_sk#131,ws_sold_time_sk#132,ws_ship_date_sk#133,ws_item_sk#134,ws_bill_customer_sk#135,ws_bill_cdemo_sk#136,ws_bill_hdemo_sk#137,ws_bill_addr_sk#138,ws_ship_customer_sk#139,ws_ship_cdemo_sk#140,ws_ship_hdemo_sk#141,ws_ship_addr_sk#142,ws_web_page_sk#143,ws_web_site_sk#144,ws_ship_mode_sk#145,ws_warehouse_sk#146,ws_promo_sk#147,ws_order_number#148,ws_quantity#149,ws_wholesale_cost#150,ws_list_price#151,ws_sales_price#152,ws_ext_discount_amt#153,ws_ext_sales_price#154,... 10 more fields] parquet
                           :              +- Project [d_date_sk#24]
                           :                 +- Filter (((isnotnull(d_year#30) && (d_year#30 >= 1998)) && (d_year#30 <= 2000)) && isnotnull(d_date_sk#24))
                           :                    +- Relation[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
                           +- 'Aggregate [i_brand_id#0, i_class_id#0, i_category_id#0], [web AS channel#0, i_brand_id#0, i_class_id#0, i_category_id#0, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sales#0, count(1) AS number_sales#0L, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#0 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#0 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#149 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#151 as decimal(12,2)))), DecimalType(18,2)))#0]
                              +- 'Project [ws_quantity#0, ws_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                 +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                                    :- 'Project [ws_sold_date_sk#0, ws_quantity#0, ws_list_price#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                                    :     :- 'Join LeftSemi, (ws_item_sk#0 = ss_item_sk#0)
                                    :     :  :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_quantity#0, ws_list_price#0]
                                    :     :  :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                                    :     :  :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                                    :     :  +- 'Project [i_item_sk#0 AS ss_item_sk#0]
                                    :     :     +- 'Filter isnotnull(i_item_sk#0)
                                    :     :        +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
                                    :     :           :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :     :           :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                                    :     :           :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                                    :     :           +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                                    :     :              +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                                    :     :                 :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                                    :     :                 :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                                    :     :                 :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
                                    :     :                 :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                                    :     :                 :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :     :                 :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                                    :     :                 :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
                                    :     :                 :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                                    :     :                 :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                                    :     :                 :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :     :                 :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                                    :     :                 :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                                    :     :                 :     :     +- Project [d_date_sk#0]
                                    :     :                 :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                                    :     :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                                    :     :                 :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :     :                 :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                                    :     :                 :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :     :                 :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                                    :     :                 :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
                                    :     :                 :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                                    :     :                 :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                                    :     :                 :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :     :                 :           :        +- Filter isnotnull(i_item_sk#0)
                                    :     :                 :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                                    :     :                 :           +- Project [d_date_sk#0]
                                    :     :                 :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                                    :     :                 :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                                    :     :                 +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :     :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                                    :     :                       :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :     :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                                    :     :                       :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
                                    :     :                       :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                                    :     :                       :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                                    :     :                       :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :     :                       :        +- Filter isnotnull(i_item_sk#0)
                                    :     :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                                    :     :                       +- Project [d_date_sk#0]
                                    :     :                          +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                                    :     :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                                    :     +- 'Join LeftSemi, (i_item_sk#0 = ss_item_sk#0)
                                    :        :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :        :  +- Filter isnotnull(i_item_sk#0)
                                    :        :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                                    :        +- 'Project [i_item_sk#0 AS ss_item_sk#0]
                                    :           +- 'Filter isnotnull(i_item_sk#0)
                                    :              +- 'Join Inner, (((i_brand_id#0 = brand_id#0) && (i_class_id#0 = class_id#0)) && (i_category_id#0 = category_id#0))
                                    :                 :- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :                 :  +- Filter ((isnotnull(i_brand_id#0) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                                    :                 :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                                    :                 +- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                                    :                    +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                                    :                       :- 'Aggregate [brand_id#0, class_id#0, category_id#0], [brand_id#0, class_id#0, category_id#0]
                                    :                       :  +- 'Join LeftSemi, (((brand_id#0 <=> i_brand_id#0) && (class_id#0 <=> i_class_id#0)) && (category_id#0 <=> i_category_id#0))
                                    :                       :     :- 'Project [i_brand_id#0 AS brand_id#0, i_class_id#0 AS class_id#0, i_category_id#0 AS category_id#0]
                                    :                       :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                                    :                       :     :     :- 'Project [ss_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :                       :     :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                                    :                       :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0]
                                    :                       :     :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                                    :                       :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                                    :                       :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :                       :     :     :        +- Filter (((isnotnull(i_item_sk#0) && isnotnull(i_brand_id#0)) && isnotnull(i_class_id#0)) && isnotnull(i_category_id#0))
                                    :                       :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                                    :                       :     :     +- Project [d_date_sk#0]
                                    :                       :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                                    :                       :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                                    :                       :     +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :                       :        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                                    :                       :           :- 'Project [cs_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :                       :           :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                                    :                       :           :     :- Project [cs_sold_date_sk#0, cs_item_sk#0]
                                    :                       :           :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                                    :                       :           :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                                    :                       :           :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :                       :           :        +- Filter isnotnull(i_item_sk#0)
                                    :                       :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                                    :                       :           +- Project [d_date_sk#0]
                                    :                       :              +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                                    :                       :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                                    :                       +- 'Project [i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :                          +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                                    :                             :- 'Project [ws_sold_date_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :                             :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                                    :                             :     :- Project [ws_sold_date_sk#0, ws_item_sk#0]
                                    :                             :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                                    :                             :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                                    :                             :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0]
                                    :                             :        +- Filter isnotnull(i_item_sk#0)
                                    :                             :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                                    :                             +- Project [d_date_sk#0]
                                    :                                +- Filter (((isnotnull(d_year#0) && (d_year#0 >= 1999)) && (d_year#0 <= 2001)) && isnotnull(d_date_sk#0))
                                    :                                   +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                                    +- Project [d_date_sk#0]
                                       +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2000)) && (d_moy#0 = 11)) && isnotnull(d_date_sk#0))
                                          +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q18a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [ca_country#0 ASC NULLS FIRST, ca_state#0 ASC NULLS FIRST, ca_county#0 ASC NULLS FIRST, i_item_id#0 ASC NULLS FIRST], true
      +- 'Union
         :- 'Aggregate [i_item_id#0, ca_country#0, ca_state#0, ca_county#0], [i_item_id#0, ca_country#0, ca_state#0, ca_county#0, avg(agg1#0) AS agg1#0, avg(agg2#0) AS agg2#0, avg(agg3#0) AS agg3#0, avg(agg4#0) AS agg4#0, avg(agg5#0) AS agg5#0, avg(agg6#0) AS agg6#0, avg(agg7#0) AS agg7#0]
         :  +- 'Project [i_item_id#0, ca_country#0, ca_state#0, ca_county#0, cast(cs_quantity#0 as decimal(12,2)) AS agg1#0, cast(cs_list_price#0 as decimal(12,2)) AS agg2#0, cast(cs_coupon_amt#0 as decimal(12,2)) AS agg3#0, cast(cs_sales_price#0 as decimal(12,2)) AS agg4#0, cast(cs_net_profit#0 as decimal(12,2)) AS agg5#0, cast(c_birth_year#0 as decimal(12,2)) AS agg6#0, cast(cd_dep_count#0 as decimal(12,2)) AS agg7#0]
         :     +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
         :        :- 'Project [cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, ca_county#0, ca_state#0, ca_country#0]
         :        :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
         :        :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, ca_county#0, ca_state#0, ca_country#0]
         :        :     :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
         :        :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_current_addr_sk#0, c_birth_year#0]
         :        :     :     :  +- 'Join Inner, (c_current_cdemo_sk#0 = cd_demo_sk#0)
         :        :     :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_current_cdemo_sk#0, c_current_addr_sk#0, c_birth_year#0]
         :        :     :     :     :  +- 'Join Inner, (cs_bill_customer_sk#0 = c_customer_sk#0)
         :        :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0]
         :        :     :     :     :     :  +- 'Join Inner, (cs_bill_cdemo_sk#0 = cd_demo_sk#0)
         :        :     :     :     :     :     :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_bill_cdemo_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0]
         :        :     :     :     :     :     :  +- Filter (((isnotnull(cs_bill_cdemo_sk#0) && isnotnull(cs_bill_customer_sk#0)) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_item_sk#0))
         :        :     :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
         :        :     :     :     :     :     +- Project [cd_demo_sk#0, cd_dep_count#0]
         :        :     :     :     :     :        +- Filter ((((isnotnull(cd_gender#0) && isnotnull(cd_education_status#0)) && (cd_gender#0 = M)) && (cd_education_status#0 = College)) && isnotnull(cd_demo_sk#0))
         :        :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
         :        :     :     :     :     +- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_addr_sk#0, c_birth_year#0]
         :        :     :     :     :        +- Filter (((c_birth_month#0 IN (9,5,12,4,1,10) && isnotnull(c_customer_sk#0)) && isnotnull(c_current_cdemo_sk#0)) && isnotnull(c_current_addr_sk#0))
         :        :     :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
         :        :     :     :     +- Project [cd_demo_sk#0]
         :        :     :     :        +- Filter isnotnull(cd_demo_sk#0)
         :        :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
         :        :     :     +- Project [ca_address_sk#0, ca_county#0, ca_state#0, ca_country#0]
         :        :     :        +- Filter (ca_state#0 IN (ND,WI,AL,NC,OK,MS,TN) && isnotnull(ca_address_sk#0))
         :        :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
         :        :     +- Project [d_date_sk#0]
         :        :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
         :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :        +- Project [i_item_sk#0, i_item_id#0]
         :           +- Filter isnotnull(i_item_sk#0)
         :              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :- 'Aggregate [i_item_id#0, ca_country#0, ca_state#0], [i_item_id#0, ca_country#0, ca_state#0, null AS county#0, avg(agg1#0) AS agg1#0, avg(agg2#0) AS agg2#0, avg(agg3#0) AS agg3#0, avg(agg4#0) AS agg4#0, avg(agg5#0) AS agg5#0, avg(agg6#0) AS agg6#0, avg(agg7#0) AS agg7#0]
         :  +- 'Project [i_item_id#0, ca_country#0, ca_state#0, cast(cs_quantity#0 as decimal(12,2)) AS agg1#0, cast(cs_list_price#0 as decimal(12,2)) AS agg2#0, cast(cs_coupon_amt#0 as decimal(12,2)) AS agg3#0, cast(cs_sales_price#0 as decimal(12,2)) AS agg4#0, cast(cs_net_profit#0 as decimal(12,2)) AS agg5#0, cast(c_birth_year#0 as decimal(12,2)) AS agg6#0, cast(cd_dep_count#0 as decimal(12,2)) AS agg7#0]
         :     +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
         :        :- 'Project [cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, ca_state#0, ca_country#0]
         :        :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
         :        :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, ca_state#0, ca_country#0]
         :        :     :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
         :        :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_current_addr_sk#0, c_birth_year#0]
         :        :     :     :  +- 'Join Inner, (c_current_cdemo_sk#0 = cd_demo_sk#0)
         :        :     :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_current_cdemo_sk#0, c_current_addr_sk#0, c_birth_year#0]
         :        :     :     :     :  +- 'Join Inner, (cs_bill_customer_sk#0 = c_customer_sk#0)
         :        :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0]
         :        :     :     :     :     :  +- 'Join Inner, (cs_bill_cdemo_sk#0 = cd_demo_sk#0)
         :        :     :     :     :     :     :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_bill_cdemo_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0]
         :        :     :     :     :     :     :  +- Filter (((isnotnull(cs_bill_cdemo_sk#0) && isnotnull(cs_bill_customer_sk#0)) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_item_sk#0))
         :        :     :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
         :        :     :     :     :     :     +- Project [cd_demo_sk#0, cd_dep_count#0]
         :        :     :     :     :     :        +- Filter ((((isnotnull(cd_gender#0) && isnotnull(cd_education_status#0)) && (cd_gender#0 = M)) && (cd_education_status#0 = College)) && isnotnull(cd_demo_sk#0))
         :        :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
         :        :     :     :     :     +- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_addr_sk#0, c_birth_year#0]
         :        :     :     :     :        +- Filter (((c_birth_month#0 IN (9,5,12,4,1,10) && isnotnull(c_customer_sk#0)) && isnotnull(c_current_cdemo_sk#0)) && isnotnull(c_current_addr_sk#0))
         :        :     :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
         :        :     :     :     +- Project [cd_demo_sk#0]
         :        :     :     :        +- Filter isnotnull(cd_demo_sk#0)
         :        :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
         :        :     :     +- Project [ca_address_sk#0, ca_state#0, ca_country#0]
         :        :     :        +- Filter (ca_state#0 IN (ND,WI,AL,NC,OK,MS,TN) && isnotnull(ca_address_sk#0))
         :        :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
         :        :     +- Project [d_date_sk#0]
         :        :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
         :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :        +- Project [i_item_sk#0, i_item_id#0]
         :           +- Filter isnotnull(i_item_sk#0)
         :              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :- 'Aggregate [i_item_id#0, ca_country#0], [i_item_id#0, ca_country#0, null AS ca_state#0, null AS county#0, avg(agg1#0) AS agg1#0, avg(agg2#0) AS agg2#0, avg(agg3#0) AS agg3#0, avg(agg4#0) AS agg4#0, avg(agg5#0) AS agg5#0, avg(agg6#0) AS agg6#0, avg(agg7#0) AS agg7#0]
         :  +- 'Project [i_item_id#0, ca_country#0, cast(cs_quantity#0 as decimal(12,2)) AS agg1#0, cast(cs_list_price#0 as decimal(12,2)) AS agg2#0, cast(cs_coupon_amt#0 as decimal(12,2)) AS agg3#0, cast(cs_sales_price#0 as decimal(12,2)) AS agg4#0, cast(cs_net_profit#0 as decimal(12,2)) AS agg5#0, cast(c_birth_year#0 as decimal(12,2)) AS agg6#0, cast(cd_dep_count#0 as decimal(12,2)) AS agg7#0]
         :     +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
         :        :- 'Project [cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, ca_country#0]
         :        :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
         :        :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0, ca_country#0]
         :        :     :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
         :        :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_current_addr_sk#0, c_birth_year#0]
         :        :     :     :  +- 'Join Inner, (c_current_cdemo_sk#0 = cd_demo_sk#0)
         :        :     :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_current_cdemo_sk#0, c_current_addr_sk#0, c_birth_year#0]
         :        :     :     :     :  +- 'Join Inner, (cs_bill_customer_sk#0 = c_customer_sk#0)
         :        :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0]
         :        :     :     :     :     :  +- 'Join Inner, (cs_bill_cdemo_sk#0 = cd_demo_sk#0)
         :        :     :     :     :     :     :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_bill_cdemo_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0]
         :        :     :     :     :     :     :  +- Filter (((isnotnull(cs_bill_cdemo_sk#0) && isnotnull(cs_bill_customer_sk#0)) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_item_sk#0))
         :        :     :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
         :        :     :     :     :     :     +- Project [cd_demo_sk#0, cd_dep_count#0]
         :        :     :     :     :     :        +- Filter ((((isnotnull(cd_gender#0) && isnotnull(cd_education_status#0)) && (cd_gender#0 = M)) && (cd_education_status#0 = College)) && isnotnull(cd_demo_sk#0))
         :        :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
         :        :     :     :     :     +- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_addr_sk#0, c_birth_year#0]
         :        :     :     :     :        +- Filter (((c_birth_month#0 IN (9,5,12,4,1,10) && isnotnull(c_customer_sk#0)) && isnotnull(c_current_cdemo_sk#0)) && isnotnull(c_current_addr_sk#0))
         :        :     :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
         :        :     :     :     +- Project [cd_demo_sk#0]
         :        :     :     :        +- Filter isnotnull(cd_demo_sk#0)
         :        :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
         :        :     :     +- Project [ca_address_sk#0, ca_country#0]
         :        :     :        +- Filter (ca_state#0 IN (ND,WI,AL,NC,OK,MS,TN) && isnotnull(ca_address_sk#0))
         :        :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
         :        :     +- Project [d_date_sk#0]
         :        :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
         :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :        +- Project [i_item_sk#0, i_item_id#0]
         :           +- Filter isnotnull(i_item_sk#0)
         :              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :- 'Aggregate [i_item_id#0], [i_item_id#0, null AS ca_country#0, null AS ca_state#0, null AS county#0, avg(agg1#0) AS agg1#0, avg(agg2#0) AS agg2#0, avg(agg3#0) AS agg3#0, avg(agg4#0) AS agg4#0, avg(agg5#0) AS agg5#0, avg(agg6#0) AS agg6#0, avg(agg7#0) AS agg7#0]
         :  +- 'Project [i_item_id#0, cast(cs_quantity#0 as decimal(12,2)) AS agg1#0, cast(cs_list_price#0 as decimal(12,2)) AS agg2#0, cast(cs_coupon_amt#0 as decimal(12,2)) AS agg3#0, cast(cs_sales_price#0 as decimal(12,2)) AS agg4#0, cast(cs_net_profit#0 as decimal(12,2)) AS agg5#0, cast(c_birth_year#0 as decimal(12,2)) AS agg6#0, cast(cd_dep_count#0 as decimal(12,2)) AS agg7#0]
         :     +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
         :        :- 'Project [cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0]
         :        :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
         :        :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0]
         :        :     :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
         :        :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_current_addr_sk#0, c_birth_year#0]
         :        :     :     :  +- 'Join Inner, (c_current_cdemo_sk#0 = cd_demo_sk#0)
         :        :     :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_current_cdemo_sk#0, c_current_addr_sk#0, c_birth_year#0]
         :        :     :     :     :  +- 'Join Inner, (cs_bill_customer_sk#0 = c_customer_sk#0)
         :        :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0]
         :        :     :     :     :     :  +- 'Join Inner, (cs_bill_cdemo_sk#0 = cd_demo_sk#0)
         :        :     :     :     :     :     :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_bill_cdemo_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0]
         :        :     :     :     :     :     :  +- Filter (((isnotnull(cs_bill_cdemo_sk#0) && isnotnull(cs_bill_customer_sk#0)) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_item_sk#0))
         :        :     :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
         :        :     :     :     :     :     +- Project [cd_demo_sk#0, cd_dep_count#0]
         :        :     :     :     :     :        +- Filter ((((isnotnull(cd_gender#0) && isnotnull(cd_education_status#0)) && (cd_gender#0 = M)) && (cd_education_status#0 = College)) && isnotnull(cd_demo_sk#0))
         :        :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
         :        :     :     :     :     +- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_addr_sk#0, c_birth_year#0]
         :        :     :     :     :        +- Filter (((c_birth_month#0 IN (9,5,12,4,1,10) && isnotnull(c_customer_sk#0)) && isnotnull(c_current_cdemo_sk#0)) && isnotnull(c_current_addr_sk#0))
         :        :     :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
         :        :     :     :     +- Project [cd_demo_sk#0]
         :        :     :     :        +- Filter isnotnull(cd_demo_sk#0)
         :        :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
         :        :     :     +- Project [ca_address_sk#0]
         :        :     :        +- Filter (ca_state#0 IN (ND,WI,AL,NC,OK,MS,TN) && isnotnull(ca_address_sk#0))
         :        :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
         :        :     +- Project [d_date_sk#0]
         :        :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
         :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :        +- Project [i_item_sk#0, i_item_id#0]
         :           +- Filter isnotnull(i_item_sk#0)
         :              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         +- 'Aggregate [null AS i_item_id#0, null AS ca_country#0, null AS ca_state#0, null AS county#0, avg(agg1#0) AS agg1#0, avg(agg2#0) AS agg2#0, avg(agg3#0) AS agg3#0, avg(agg4#0) AS agg4#0, avg(agg5#0) AS agg5#0, avg(agg6#0) AS agg6#0, avg(agg7#0) AS agg7#0]
            +- 'Project [cast(cs_quantity#0 as decimal(12,2)) AS agg1#0, cast(cs_list_price#0 as decimal(12,2)) AS agg2#0, cast(cs_coupon_amt#0 as decimal(12,2)) AS agg3#0, cast(cs_sales_price#0 as decimal(12,2)) AS agg4#0, cast(cs_net_profit#0 as decimal(12,2)) AS agg5#0, cast(c_birth_year#0 as decimal(12,2)) AS agg6#0, cast(cd_dep_count#0 as decimal(12,2)) AS agg7#0]
               +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                  :- 'Project [cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0]
                  :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                  :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_birth_year#0]
                  :     :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
                  :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_current_addr_sk#0, c_birth_year#0]
                  :     :     :  +- 'Join Inner, (c_current_cdemo_sk#0 = cd_demo_sk#0)
                  :     :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0, c_current_cdemo_sk#0, c_current_addr_sk#0, c_birth_year#0]
                  :     :     :     :  +- 'Join Inner, (cs_bill_customer_sk#0 = c_customer_sk#0)
                  :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0, cd_dep_count#0]
                  :     :     :     :     :  +- 'Join Inner, (cs_bill_cdemo_sk#0 = cd_demo_sk#0)
                  :     :     :     :     :     :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_bill_cdemo_sk#0, cs_item_sk#0, cs_quantity#0, cs_list_price#0, cs_sales_price#0, cs_coupon_amt#0, cs_net_profit#0]
                  :     :     :     :     :     :  +- Filter (((isnotnull(cs_bill_cdemo_sk#0) && isnotnull(cs_bill_customer_sk#0)) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_item_sk#0))
                  :     :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                  :     :     :     :     :     +- Project [cd_demo_sk#0, cd_dep_count#0]
                  :     :     :     :     :        +- Filter ((((isnotnull(cd_gender#0) && isnotnull(cd_education_status#0)) && (cd_gender#0 = M)) && (cd_education_status#0 = College)) && isnotnull(cd_demo_sk#0))
                  :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
                  :     :     :     :     +- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_addr_sk#0, c_birth_year#0]
                  :     :     :     :        +- Filter (((c_birth_month#0 IN (9,5,12,4,1,10) && isnotnull(c_customer_sk#0)) && isnotnull(c_current_cdemo_sk#0)) && isnotnull(c_current_addr_sk#0))
                  :     :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                  :     :     :     +- Project [cd_demo_sk#0]
                  :     :     :        +- Filter isnotnull(cd_demo_sk#0)
                  :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
                  :     :     +- Project [ca_address_sk#0]
                  :     :        +- Filter (ca_state#0 IN (ND,WI,AL,NC,OK,MS,TN) && isnotnull(ca_address_sk#0))
                  :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
                  :     +- Project [d_date_sk#0]
                  :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                  :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  +- Project [i_item_sk#0]
                     +- Filter isnotnull(i_item_sk#0)
                        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q20
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_category#0 ASC NULLS FIRST, i_class#0 ASC NULLS FIRST, i_item_id#0 ASC NULLS FIRST, i_item_desc#0 ASC NULLS FIRST, revenueratio#0 ASC NULLS FIRST], true
      +- 'Project [i_item_id#0, i_item_desc#0, i_category#0, i_class#0, i_current_price#0, itemrevenue#0, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(_w0#0) * 100.00), DecimalType(21,2)) as decimal(27,2))) / promote_precision(_we0#0)), DecimalType(38,17)) AS revenueratio#0]
         +- 'Window [sum(_w1#0) windowspecdefinition(i_class#0, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#0], [i_class#0]
            +- 'Aggregate [i_item_id#0, i_item_desc#0, i_category#0, i_class#0, i_current_price#0], [i_item_id#0, i_item_desc#0, i_category#0, i_class#0, i_current_price#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS itemrevenue#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS _w0#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS _w1#0]
               +- 'Project [cs_ext_sales_price#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                     :- 'Project [cs_sold_date_sk#0, cs_ext_sales_price#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                     :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                     :     :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_ext_sales_price#0]
                     :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                     :     +- Project [i_item_sk#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
                     :        +- Filter (i_category#0 IN (Sports,Books,Home) && isnotnull(i_item_sk#0))
                     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     +- Project [d_date_sk#0]
                        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10644)) && (d_date#0 <= 10674)) && isnotnull(d_date_sk#0))
                           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q22
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [qoh#0 ASC NULLS FIRST, i_product_name#0 ASC NULLS FIRST, i_brand#0 ASC NULLS FIRST, i_class#0 ASC NULLS FIRST, i_category#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_product_name#0, i_brand#0, i_class#0, i_category#0, spark_grouping_id#0], [i_product_name#0, i_brand#0, i_class#0, i_category#0, avg(cast(inv_quantity_on_hand#0 as bigint)) AS qoh#0]
         +- 'Expand [List(inv_quantity_on_hand#0, i_product_name#0, i_brand#0, i_class#0, i_category#0, 0), List(inv_quantity_on_hand#0, i_product_name#0, i_brand#0, i_class#0, null, 1), List(inv_quantity_on_hand#0, i_product_name#0, i_brand#0, null, null, 3), List(inv_quantity_on_hand#0, i_product_name#0, null, null, null, 7), List(inv_quantity_on_hand#0, null, null, null, null, 15)], [inv_quantity_on_hand#0, i_product_name#0, i_brand#0, i_class#0, i_category#0, spark_grouping_id#0]
            +- 'Project [inv_quantity_on_hand#0, i_product_name#0, i_brand#0, i_class#0, i_category#0]
               +- 'Join Inner
                  :- 'Project [inv_quantity_on_hand#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
                  :  +- 'Join Inner, (inv_item_sk#0 = i_item_sk#0)
                  :     :- 'Project [inv_item_sk#0, inv_quantity_on_hand#0]
                  :     :  +- 'Join Inner, (inv_date_sk#0 = d_date_sk#0)
                  :     :     :- Project [inv_date_sk#0, inv_item_sk#0, inv_quantity_on_hand#0]
                  :     :     :  +- Filter (isnotnull(inv_date_sk#0) && isnotnull(inv_item_sk#0))
                  :     :     :     +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
                  :     :     +- Project [d_date_sk#0]
                  :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1200)) && (d_month_seq#0 <= 1211)) && isnotnull(d_date_sk#0))
                  :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
                  :        +- Filter isnotnull(i_item_sk#0)
                  :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  +- Project
                     +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet


================================================================================================
q22a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [qoh#0 ASC NULLS FIRST, i_product_name#0 ASC NULLS FIRST, i_brand#0 ASC NULLS FIRST, i_class#0 ASC NULLS FIRST, i_category#0 ASC NULLS FIRST], true
      +- 'Union
         :- 'Aggregate [i_product_name#0, i_brand#0, i_class#0, i_category#0], [i_product_name#0, i_brand#0, i_class#0, i_category#0, avg(qoh#0) AS qoh#0]
         :  +- 'Aggregate [i_product_name#0, i_brand#0, i_class#0, i_category#0], [i_product_name#0, i_brand#0, i_class#0, i_category#0, avg(cast(inv_quantity_on_hand#0 as bigint)) AS qoh#0]
         :     +- 'Project [inv_quantity_on_hand#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
         :        +- 'Join Inner, (inv_warehouse_sk#0 = w_warehouse_sk#0)
         :           :- 'Project [inv_warehouse_sk#0, inv_quantity_on_hand#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
         :           :  +- 'Join Inner, (inv_item_sk#0 = i_item_sk#0)
         :           :     :- 'Project [inv_item_sk#0, inv_warehouse_sk#0, inv_quantity_on_hand#0]
         :           :     :  +- 'Join Inner, (inv_date_sk#0 = d_date_sk#0)
         :           :     :     :- Filter ((isnotnull(inv_date_sk#0) && isnotnull(inv_item_sk#0)) && isnotnull(inv_warehouse_sk#0))
         :           :     :     :  +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
         :           :     :     +- Project [d_date_sk#0]
         :           :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
         :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :           :     +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
         :           :        +- Filter isnotnull(i_item_sk#0)
         :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :           +- Project [w_warehouse_sk#0]
         :              +- Filter isnotnull(w_warehouse_sk#0)
         :                 +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
         :- 'Aggregate [i_product_name#0, i_brand#0, i_class#0], [i_product_name#0, i_brand#0, i_class#0, null AS i_category#0, avg(qoh#0) AS qoh#0]
         :  +- 'Aggregate [i_product_name#0, i_brand#0, i_class#0, i_category#0], [i_product_name#0, i_brand#0, i_class#0, avg(cast(inv_quantity_on_hand#0 as bigint)) AS qoh#0]
         :     +- 'Project [inv_quantity_on_hand#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
         :        +- 'Join Inner, (inv_warehouse_sk#0 = w_warehouse_sk#0)
         :           :- 'Project [inv_warehouse_sk#0, inv_quantity_on_hand#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
         :           :  +- 'Join Inner, (inv_item_sk#0 = i_item_sk#0)
         :           :     :- 'Project [inv_item_sk#0, inv_warehouse_sk#0, inv_quantity_on_hand#0]
         :           :     :  +- 'Join Inner, (inv_date_sk#0 = d_date_sk#0)
         :           :     :     :- Filter ((isnotnull(inv_date_sk#0) && isnotnull(inv_item_sk#0)) && isnotnull(inv_warehouse_sk#0))
         :           :     :     :  +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
         :           :     :     +- Project [d_date_sk#0]
         :           :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
         :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :           :     +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
         :           :        +- Filter isnotnull(i_item_sk#0)
         :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :           +- Project [w_warehouse_sk#0]
         :              +- Filter isnotnull(w_warehouse_sk#0)
         :                 +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
         :- 'Aggregate [i_product_name#0, i_brand#0], [i_product_name#0, i_brand#0, null AS i_class#0, null AS i_category#0, avg(qoh#0) AS qoh#0]
         :  +- 'Aggregate [i_product_name#0, i_brand#0, i_class#0, i_category#0], [i_product_name#0, i_brand#0, avg(cast(inv_quantity_on_hand#0 as bigint)) AS qoh#0]
         :     +- 'Project [inv_quantity_on_hand#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
         :        +- 'Join Inner, (inv_warehouse_sk#0 = w_warehouse_sk#0)
         :           :- 'Project [inv_warehouse_sk#0, inv_quantity_on_hand#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
         :           :  +- 'Join Inner, (inv_item_sk#0 = i_item_sk#0)
         :           :     :- 'Project [inv_item_sk#0, inv_warehouse_sk#0, inv_quantity_on_hand#0]
         :           :     :  +- 'Join Inner, (inv_date_sk#0 = d_date_sk#0)
         :           :     :     :- Filter ((isnotnull(inv_date_sk#0) && isnotnull(inv_item_sk#0)) && isnotnull(inv_warehouse_sk#0))
         :           :     :     :  +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
         :           :     :     +- Project [d_date_sk#0]
         :           :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
         :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :           :     +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
         :           :        +- Filter isnotnull(i_item_sk#0)
         :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :           +- Project [w_warehouse_sk#0]
         :              +- Filter isnotnull(w_warehouse_sk#0)
         :                 +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
         :- 'Aggregate [i_product_name#0], [i_product_name#0, null AS i_brand#0, null AS i_class#0, null AS i_category#0, avg(qoh#0) AS qoh#0]
         :  +- 'Aggregate [i_product_name#0, i_brand#0, i_class#0, i_category#0], [i_product_name#0, avg(cast(inv_quantity_on_hand#0 as bigint)) AS qoh#0]
         :     +- 'Project [inv_quantity_on_hand#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
         :        +- 'Join Inner, (inv_warehouse_sk#0 = w_warehouse_sk#0)
         :           :- 'Project [inv_warehouse_sk#0, inv_quantity_on_hand#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
         :           :  +- 'Join Inner, (inv_item_sk#0 = i_item_sk#0)
         :           :     :- 'Project [inv_item_sk#0, inv_warehouse_sk#0, inv_quantity_on_hand#0]
         :           :     :  +- 'Join Inner, (inv_date_sk#0 = d_date_sk#0)
         :           :     :     :- Filter ((isnotnull(inv_date_sk#0) && isnotnull(inv_item_sk#0)) && isnotnull(inv_warehouse_sk#0))
         :           :     :     :  +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
         :           :     :     +- Project [d_date_sk#0]
         :           :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
         :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :           :     +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
         :           :        +- Filter isnotnull(i_item_sk#0)
         :           :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :           +- Project [w_warehouse_sk#0]
         :              +- Filter isnotnull(w_warehouse_sk#0)
         :                 +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
         +- 'Aggregate [null AS i_product_name#0, null AS i_brand#0, null AS i_class#0, null AS i_category#0, avg(qoh#0) AS qoh#0]
            +- 'Aggregate [i_product_name#0, i_brand#0, i_class#0, i_category#0], [avg(cast(inv_quantity_on_hand#0 as bigint)) AS qoh#0]
               +- 'Project [inv_quantity_on_hand#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
                  +- 'Join Inner, (inv_warehouse_sk#0 = w_warehouse_sk#0)
                     :- 'Project [inv_warehouse_sk#0, inv_quantity_on_hand#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
                     :  +- 'Join Inner, (inv_item_sk#0 = i_item_sk#0)
                     :     :- 'Project [inv_item_sk#0, inv_warehouse_sk#0, inv_quantity_on_hand#0]
                     :     :  +- 'Join Inner, (inv_date_sk#0 = d_date_sk#0)
                     :     :     :- Filter ((isnotnull(inv_date_sk#0) && isnotnull(inv_item_sk#0)) && isnotnull(inv_warehouse_sk#0))
                     :     :     :  +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
                     :     :     +- Project [d_date_sk#0]
                     :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :     +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
                     :        +- Filter isnotnull(i_item_sk#0)
                     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     +- Project [w_warehouse_sk#0]
                        +- Filter isnotnull(w_warehouse_sk#0)
                           +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet


================================================================================================
q24
================================================================================================

'Sort [c_last_name#0 ASC NULLS FIRST, c_first_name#0 ASC NULLS FIRST, s_store_name#0 ASC NULLS FIRST], true
+- 'Project [c_last_name#0, c_first_name#0, s_store_name#0, paid#0]
   +- 'Filter (isnotnull(sum(netpaid#8608)#0) && (cast(sum(netpaid#8608)#0 as decimal(33,8)) > cast(scalar-subquery#0 [] as decimal(33,8))))
      :  +- Aggregate [CheckOverflow((0.050000 * promote_precision(avg(netpaid#8608))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#8612]
      :     +- Aggregate [c_last_name#91, c_first_name#90, s_store_name#58, ca_state#617, s_state#77, i_color#320, i_current_price#308, i_manager_id#323, i_units#321, i_size#318], [MakeDecimal(sum(UnscaledValue(ss_net_paid#300)),17,2) AS netpaid#8608]
      :        +- Project [ss_net_paid#300, s_store_name#58, s_state#77, i_current_price#308, i_size#318, i_color#320, i_units#321, i_manager_id#323, c_first_name#90, c_last_name#91, ca_state#617]
      :           +- Join Inner, (((c_current_addr_sk#86 = ca_address_sk#609) && (c_birth_country#96 = upper(ca_country#619))) && (s_zip#78 = ca_zip#618))
      :              :- Project [ss_net_paid#300, s_store_name#58, s_state#77, s_zip#78, i_current_price#308, i_size#318, i_color#320, i_units#321, i_manager_id#323, c_current_addr_sk#86, c_first_name#90, c_last_name#91, c_birth_country#96]
      :              :  +- Join Inner, (ss_customer_sk#283 = c_customer_sk#82)
      :              :     :- Project [ss_customer_sk#283, ss_net_paid#300, s_store_name#58, s_state#77, s_zip#78, i_current_price#308, i_size#318, i_color#320, i_units#321, i_manager_id#323]
      :              :     :  +- Join Inner, (ss_item_sk#282 = i_item_sk#303)
      :              :     :     :- Project [ss_item_sk#282, ss_customer_sk#283, ss_net_paid#300, s_store_name#58, s_state#77, s_zip#78]
      :              :     :     :  +- Join Inner, (ss_store_sk#287 = s_store_sk#53)
      :              :     :     :     :- Project [ss_item_sk#282, ss_customer_sk#283, ss_store_sk#287, ss_net_paid#300]
      :              :     :     :     :  +- Join Inner, ((cast(ss_ticket_number#289 as bigint) = sr_ticket_number#13L) && (cast(ss_item_sk#282 as bigint) = sr_item_sk#6L))
      :              :     :     :     :     :- Project [ss_item_sk#282, ss_customer_sk#283, ss_store_sk#287, ss_ticket_number#289, ss_net_paid#300]
      :              :     :     :     :     :  +- Filter (((isnotnull(ss_ticket_number#289) && isnotnull(ss_item_sk#282)) && isnotnull(ss_store_sk#287)) && isnotnull(ss_customer_sk#283))
      :              :     :     :     :     :     +- Relation[ss_sold_date_sk#280,ss_sold_time_sk#281,ss_item_sk#282,ss_customer_sk#283,ss_cdemo_sk#284,ss_hdemo_sk#285,ss_addr_sk#286,ss_store_sk#287,ss_promo_sk#288,ss_ticket_number#289,ss_quantity#290,ss_wholesale_cost#291,ss_list_price#292,ss_sales_price#293,ss_ext_discount_amt#294,ss_ext_sales_price#295,ss_ext_wholesale_cost#296,ss_ext_list_price#297,ss_ext_tax#298,ss_coupon_amt#299,ss_net_paid#300,ss_net_paid_inc_tax#301,ss_net_profit#302] parquet
      :              :     :     :     :     +- Project [sr_item_sk#6L, sr_ticket_number#13L]
      :              :     :     :     :        +- Filter (isnotnull(sr_ticket_number#13L) && isnotnull(sr_item_sk#6L))
      :              :     :     :     :           +- Relation[sr_returned_date_sk#4L,sr_return_time_sk#5L,sr_item_sk#6L,sr_customer_sk#7L,sr_cdemo_sk#8L,sr_hdemo_sk#9L,sr_addr_sk#10L,sr_store_sk#11L,sr_reason_sk#12L,sr_ticket_number#13L,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet
      :              :     :     :     +- Project [s_store_sk#53, s_store_name#58, s_state#77, s_zip#78]
      :              :     :     :        +- Filter (((isnotnull(s_market_id#63) && (s_market_id#63 = 8)) && isnotnull(s_store_sk#53)) && isnotnull(s_zip#78))
      :              :     :     :           +- Relation[s_store_sk#53,s_store_id#54,s_rec_start_date#55,s_rec_end_date#56,s_closed_date_sk#57,s_store_name#58,s_number_employees#59,s_floor_space#60,s_hours#61,s_manager#62,s_market_id#63,s_geography_class#64,s_market_desc#65,s_market_manager#66,s_division_id#67,s_division_name#68,s_company_id#69,s_company_name#70,s_street_number#71,s_street_name#72,s_street_type#73,s_suite_number#74,s_city#75,s_county#76,... 5 more fields] parquet
      :              :     :     +- Project [i_item_sk#303, i_current_price#308, i_size#318, i_color#320, i_units#321, i_manager_id#323]
      :              :     :        +- Filter isnotnull(i_item_sk#303)
      :              :     :           +- Relation[i_item_sk#303,i_item_id#304,i_rec_start_date#305,i_rec_end_date#306,i_item_desc#307,i_current_price#308,i_wholesale_cost#309,i_brand_id#310,i_brand#311,i_class_id#312,i_class#313,i_category_id#314,i_category#315,i_manufact_id#316,i_manufact#317,i_size#318,i_formulation#319,i_color#320,i_units#321,i_container#322,i_manager_id#323,i_product_name#324] parquet
      :              :     +- Project [c_customer_sk#82, c_current_addr_sk#86, c_first_name#90, c_last_name#91, c_birth_country#96]
      :              :        +- Filter ((isnotnull(c_customer_sk#82) && isnotnull(c_current_addr_sk#86)) && isnotnull(c_birth_country#96))
      :              :           +- Relation[c_customer_sk#82,c_customer_id#83,c_current_cdemo_sk#84,c_current_hdemo_sk#85,c_current_addr_sk#86,c_first_shipto_date_sk#87,c_first_sales_date_sk#88,c_salutation#89,c_first_name#90,c_last_name#91,c_preferred_cust_flag#92,c_birth_day#93,c_birth_month#94,c_birth_year#95,c_birth_country#96,c_login#97,c_email_address#98,c_last_review_date#99] parquet
      :              +- Project [ca_address_sk#609, ca_state#617, ca_zip#618, ca_country#619]
      :                 +- Filter (isnotnull(ca_address_sk#609) && isnotnull(ca_zip#618))
      :                    +- Relation[ca_address_sk#609,ca_address_id#610,ca_street_number#611,ca_street_name#612,ca_street_type#613,ca_suite_number#614,ca_city#615,ca_county#616,ca_state#617,ca_zip#618,ca_country#619,ca_gmt_offset#620,ca_location_type#621] parquet
      +- 'Aggregate [c_last_name#0, c_first_name#0, s_store_name#0], [c_last_name#0, c_first_name#0, s_store_name#0, sum(netpaid#0) AS paid#0, sum(netpaid#0) AS sum(netpaid#8608)#0]
         +- 'Aggregate [c_last_name#0, c_first_name#0, s_store_name#0, ca_state#0, s_state#0, i_color#0, i_current_price#0, i_manager_id#0, i_units#0, i_size#0], [c_last_name#0, c_first_name#0, s_store_name#0, MakeDecimal(sum(UnscaledValue(ss_net_paid#0)),17,2) AS netpaid#0]
            +- 'Project [ss_net_paid#0, s_store_name#0, s_state#0, i_current_price#0, i_size#0, i_color#0, i_units#0, i_manager_id#0, c_first_name#0, c_last_name#0, ca_state#0]
               +- 'Join Inner, (((c_current_addr_sk#0 = ca_address_sk#0) && (c_birth_country#0 = upper(ca_country#0))) && (s_zip#0 = ca_zip#0))
                  :- 'Project [ss_net_paid#0, s_store_name#0, s_state#0, s_zip#0, i_current_price#0, i_size#0, i_color#0, i_units#0, i_manager_id#0, c_current_addr_sk#0, c_first_name#0, c_last_name#0, c_birth_country#0]
                  :  +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
                  :     :- 'Project [ss_customer_sk#0, ss_net_paid#0, s_store_name#0, s_state#0, s_zip#0, i_current_price#0, i_size#0, i_color#0, i_units#0, i_manager_id#0]
                  :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                  :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_net_paid#0, s_store_name#0, s_state#0, s_zip#0]
                  :     :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                  :     :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_net_paid#0]
                  :     :     :     :  +- 'Join Inner, ((cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L))
                  :     :     :     :     :- Project [ss_item_sk#0, ss_customer_sk#0, ss_store_sk#0, ss_ticket_number#0, ss_net_paid#0]
                  :     :     :     :     :  +- Filter (((isnotnull(ss_ticket_number#0) && isnotnull(ss_item_sk#0)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_customer_sk#0))
                  :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :     :     :     :     +- Project [sr_item_sk#0L, sr_ticket_number#0L]
                  :     :     :     :        +- Filter (isnotnull(sr_ticket_number#0L) && isnotnull(sr_item_sk#0L))
                  :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
                  :     :     :     +- Project [s_store_sk#0, s_store_name#0, s_state#0, s_zip#0]
                  :     :     :        +- Filter (((isnotnull(s_market_id#0) && (s_market_id#0 = 8)) && isnotnull(s_store_sk#0)) && isnotnull(s_zip#0))
                  :     :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                  :     :     +- Project [i_item_sk#0, i_current_price#0, i_size#0, i_color#0, i_units#0, i_manager_id#0]
                  :     :        +- Filter ((isnotnull(i_color#0) && (i_color#0 = pale)) && isnotnull(i_item_sk#0))
                  :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  :     +- Project [c_customer_sk#0, c_current_addr_sk#0, c_first_name#0, c_last_name#0, c_birth_country#0]
                  :        +- Filter ((isnotnull(c_customer_sk#0) && isnotnull(c_current_addr_sk#0)) && isnotnull(c_birth_country#0))
                  :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                  +- Project [ca_address_sk#0, ca_state#0, ca_zip#0, ca_country#0]
                     +- Filter (isnotnull(ca_address_sk#0) && isnotnull(ca_zip#0))
                        +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet


================================================================================================
q27a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_item_id#0 ASC NULLS FIRST, s_state#0 ASC NULLS FIRST], true
      +- 'Union
         :- 'Aggregate [i_item_id#0, s_state#0], [i_item_id#0, s_state#0, 0 AS g_state#0, avg(cast(agg1#0 as bigint)) AS agg1#0, cast((avg(UnscaledValue(agg2#0)) / 100.0) as decimal(11,6)) AS agg2#0, cast((avg(UnscaledValue(agg3#0)) / 100.0) as decimal(11,6)) AS agg3#0, cast((avg(UnscaledValue(agg4#0)) / 100.0) as decimal(11,6)) AS agg4#0]
         :  +- 'Project [i_item_id#0, s_state#0, ss_quantity#0 AS agg1#0, ss_list_price#0 AS agg2#0, ss_coupon_amt#0 AS agg3#0, ss_sales_price#0 AS agg4#0]
         :     +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
         :        :- 'Project [ss_item_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0, s_state#0]
         :        :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
         :        :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
         :        :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
         :        :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
         :        :     :     :  +- 'Join Inner, (ss_cdemo_sk#0 = cd_demo_sk#0)
         :        :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_cdemo_sk#0, ss_store_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
         :        :     :     :     :  +- Filter (((isnotnull(ss_cdemo_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
         :        :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :        :     :     :     +- Project [cd_demo_sk#0]
         :        :     :     :        +- Filter ((((((isnotnull(cd_education_status#0) && isnotnull(cd_marital_status#0)) && isnotnull(cd_gender#0)) && (cd_gender#0 = F)) && (cd_marital_status#0 = W)) && (cd_education_status#0 = Primary)) && isnotnull(cd_demo_sk#0))
         :        :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
         :        :     :     +- Project [d_date_sk#0]
         :        :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 1998)) && isnotnull(d_date_sk#0))
         :        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :        :     +- Project [s_store_sk#0, s_state#0]
         :        :        +- Filter ((isnotnull(s_state#0) && (s_state#0 = TN)) && isnotnull(s_store_sk#0))
         :        :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
         :        +- Project [i_item_sk#0, i_item_id#0]
         :           +- Filter isnotnull(i_item_sk#0)
         :              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         :- 'Aggregate [i_item_id#0], [i_item_id#0, null AS s_state#0, 1 AS g_state#0, avg(cast(agg1#0 as bigint)) AS agg1#0, cast((avg(UnscaledValue(agg2#0)) / 100.0) as decimal(11,6)) AS agg2#0, cast((avg(UnscaledValue(agg3#0)) / 100.0) as decimal(11,6)) AS agg3#0, cast((avg(UnscaledValue(agg4#0)) / 100.0) as decimal(11,6)) AS agg4#0]
         :  +- 'Project [i_item_id#0, ss_quantity#0 AS agg1#0, ss_list_price#0 AS agg2#0, ss_coupon_amt#0 AS agg3#0, ss_sales_price#0 AS agg4#0]
         :     +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
         :        :- 'Project [ss_item_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
         :        :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
         :        :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
         :        :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
         :        :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
         :        :     :     :  +- 'Join Inner, (ss_cdemo_sk#0 = cd_demo_sk#0)
         :        :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_cdemo_sk#0, ss_store_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
         :        :     :     :     :  +- Filter (((isnotnull(ss_cdemo_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
         :        :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
         :        :     :     :     +- Project [cd_demo_sk#0]
         :        :     :     :        +- Filter ((((((isnotnull(cd_education_status#0) && isnotnull(cd_marital_status#0)) && isnotnull(cd_gender#0)) && (cd_gender#0 = F)) && (cd_marital_status#0 = W)) && (cd_education_status#0 = Primary)) && isnotnull(cd_demo_sk#0))
         :        :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
         :        :     :     +- Project [d_date_sk#0]
         :        :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 1998)) && isnotnull(d_date_sk#0))
         :        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
         :        :     +- Project [s_store_sk#0]
         :        :        +- Filter ((isnotnull(s_state#0) && (s_state#0 = TN)) && isnotnull(s_store_sk#0))
         :        :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
         :        +- Project [i_item_sk#0, i_item_id#0]
         :           +- Filter isnotnull(i_item_sk#0)
         :              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
         +- 'Aggregate [null AS i_item_id#0, null AS s_state#0, 1 AS g_state#0, avg(cast(agg1#0 as bigint)) AS agg1#0, cast((avg(UnscaledValue(agg2#0)) / 100.0) as decimal(11,6)) AS agg2#0, cast((avg(UnscaledValue(agg3#0)) / 100.0) as decimal(11,6)) AS agg3#0, cast((avg(UnscaledValue(agg4#0)) / 100.0) as decimal(11,6)) AS agg4#0]
            +- 'Project [ss_quantity#0 AS agg1#0, ss_list_price#0 AS agg2#0, ss_coupon_amt#0 AS agg3#0, ss_sales_price#0 AS agg4#0]
               +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                  :- 'Project [ss_item_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
                  :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                  :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
                  :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                  :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
                  :     :     :  +- 'Join Inner, (ss_cdemo_sk#0 = cd_demo_sk#0)
                  :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_cdemo_sk#0, ss_store_sk#0, ss_quantity#0, ss_list_price#0, ss_sales_price#0, ss_coupon_amt#0]
                  :     :     :     :  +- Filter (((isnotnull(ss_cdemo_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
                  :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :     :     :     +- Project [cd_demo_sk#0]
                  :     :     :        +- Filter ((((((isnotnull(cd_education_status#0) && isnotnull(cd_marital_status#0)) && isnotnull(cd_gender#0)) && (cd_gender#0 = F)) && (cd_marital_status#0 = W)) && (cd_education_status#0 = Primary)) && isnotnull(cd_demo_sk#0))
                  :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
                  :     :     +- Project [d_date_sk#0]
                  :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 1998)) && isnotnull(d_date_sk#0))
                  :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     +- Project [s_store_sk#0]
                  :        +- Filter ((isnotnull(s_state#0) && (s_state#0 = TN)) && isnotnull(s_store_sk#0))
                  :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                  +- Project [i_item_sk#0]
                     +- Filter isnotnull(i_item_sk#0)
                        +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q34
================================================================================================

'Sort [c_last_name#0 ASC NULLS FIRST, c_first_name#0 ASC NULLS FIRST, c_salutation#0 ASC NULLS FIRST, c_preferred_cust_flag#0 DESC NULLS LAST, ss_ticket_number#0 ASC NULLS FIRST], true
+- 'Project [c_last_name#0, c_first_name#0, c_salutation#0, c_preferred_cust_flag#0, ss_ticket_number#0, cnt#0L]
   +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
      :- 'Filter ((cnt#0L >= 15) && (cnt#0L <= 20))
      :  +- 'Aggregate [ss_ticket_number#0, ss_customer_sk#0], [ss_ticket_number#0, ss_customer_sk#0, count(1) AS cnt#0L]
      :     +- 'Project [ss_customer_sk#0, ss_ticket_number#0]
      :        +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
      :           :- 'Project [ss_customer_sk#0, ss_hdemo_sk#0, ss_ticket_number#0]
      :           :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
      :           :     :- 'Project [ss_customer_sk#0, ss_hdemo_sk#0, ss_store_sk#0, ss_ticket_number#0]
      :           :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
      :           :     :     :- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_hdemo_sk#0, ss_store_sk#0, ss_ticket_number#0]
      :           :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_hdemo_sk#0)) && isnotnull(ss_customer_sk#0))
      :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :           :     :     +- Project [d_date_sk#0]
      :           :     :        +- Filter (((((d_dom#0 >= 1) && (d_dom#0 <= 3)) || ((d_dom#0 >= 25) && (d_dom#0 <= 28))) && d_year#0 IN (1999,2000,2001)) && isnotnull(d_date_sk#0))
      :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :           :     +- Project [s_store_sk#0]
      :           :        +- Filter ((isnotnull(s_county#0) && (s_county#0 = Williamson County)) && isnotnull(s_store_sk#0))
      :           :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
      :           +- Project [hd_demo_sk#0]
      :              +- Filter ((((isnotnull(hd_vehicle_count#0) && ((hd_buy_potential#0 = >10000) || (hd_buy_potential#0 = unknown))) && (hd_vehicle_count#0 > 0)) && (CASE WHEN (hd_vehicle_count#0 > 0) THEN (cast(hd_dep_count#0 as double) / cast(hd_vehicle_count#0 as double)) ELSE null END > 1.2)) && isnotnull(hd_demo_sk#0))
      :                 +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
      +- Project [c_customer_sk#0, c_salutation#0, c_first_name#0, c_last_name#0, c_preferred_cust_flag#0]
         +- Filter isnotnull(c_customer_sk#0)
            +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet


================================================================================================
q35
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [ca_state#0 ASC NULLS FIRST, cd_gender#0 ASC NULLS FIRST, cd_marital_status#0 ASC NULLS FIRST, cd_dep_count#0 ASC NULLS FIRST, cd_dep_employed_count#0 ASC NULLS FIRST, cd_dep_college_count#0 ASC NULLS FIRST], true
      +- 'Aggregate [ca_state#0, cd_gender#0, cd_marital_status#0, cd_dep_count#0, cd_dep_employed_count#0, cd_dep_college_count#0], [ca_state#0, cd_gender#0, cd_marital_status#0, cd_dep_count#0, count(1) AS cnt1#0L, avg(cast(cd_dep_count#0 as bigint)) AS avg(cd_dep_count)#0, max(cd_dep_count#0) AS max(cd_dep_count)#0, sum(cast(cd_dep_count#0 as bigint)) AS sum(cd_dep_count)#0L, cd_dep_employed_count#0, count(1) AS cnt2#0L, avg(cast(cd_dep_employed_count#0 as bigint)) AS avg(cd_dep_employed_count)#0, max(cd_dep_employed_count#0) AS max(cd_dep_employed_count)#0, sum(cast(cd_dep_employed_count#0 as bigint)) AS sum(cd_dep_employed_count)#0L, cd_dep_college_count#0, count(1) AS cnt3#0L, avg(cast(cd_dep_college_count#0 as bigint)) AS avg(cd_dep_college_count)#0, max(cd_dep_college_count#0) AS max(cd_dep_college_count)#0, sum(cast(cd_dep_college_count#0 as bigint)) AS sum(cd_dep_college_count)#0L]
         +- 'Project [ca_state#0, cd_gender#0, cd_marital_status#0, cd_dep_count#0, cd_dep_employed_count#0, cd_dep_college_count#0]
            +- 'Join Inner, (cd_demo_sk#0 = c_current_cdemo_sk#0)
               :- 'Project [c_current_cdemo_sk#0, ca_state#0]
               :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
               :     :- 'Project [c_current_cdemo_sk#0, c_current_addr_sk#0]
               :     :  +- 'Filter (exists#0 || exists#0)
               :     :     +- 'Join ExistenceJoin(exists#8727), (c_customer_sk#0 = cs_ship_customer_sk#0)
               :     :        :- 'Join ExistenceJoin(exists#8726), (c_customer_sk#0 = ws_bill_customer_sk#0)
               :     :        :  :- 'Join LeftSemi, (c_customer_sk#0 = ss_customer_sk#0)
               :     :        :  :  :- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_addr_sk#0]
               :     :        :  :  :  +- Filter isnotnull(c_customer_sk#0)
               :     :        :  :  :     +- Filter (isnotnull(c_current_addr_sk#0) && isnotnull(c_current_cdemo_sk#0))
               :     :        :  :  :        +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
               :     :        :  :  +- 'Project [ss_customer_sk#0]
               :     :        :  :     +- 'Filter isnotnull(ss_customer_sk#0)
               :     :        :  :        +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :        :  :           :- Project [ss_sold_date_sk#0, ss_customer_sk#0]
               :     :        :  :           :  +- Filter isnotnull(ss_sold_date_sk#0)
               :     :        :  :           :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :        :  :           +- Project [d_date_sk#0]
               :     :        :  :              +- Filter ((((isnotnull(d_year#0) && isnotnull(d_qoy#0)) && (d_year#0 = 2002)) && (d_qoy#0 < 4)) && isnotnull(d_date_sk#0))
               :     :        :  :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :        :  +- 'Project [ws_bill_customer_sk#0]
               :     :        :     +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :     :        :        :- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0]
               :     :        :        :  +- Filter isnotnull(ws_sold_date_sk#0)
               :     :        :        :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :        :        +- Project [d_date_sk#0]
               :     :        :           +- Filter ((((isnotnull(d_year#0) && isnotnull(d_qoy#0)) && (d_year#0 = 2002)) && (d_qoy#0 < 4)) && isnotnull(d_date_sk#0))
               :     :        :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :        +- 'Project [cs_ship_customer_sk#0]
               :     :           +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :     :              :- Project [cs_sold_date_sk#0, cs_ship_customer_sk#0]
               :     :              :  +- Filter isnotnull(cs_sold_date_sk#0)
               :     :              :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :              +- Project [d_date_sk#0]
               :     :                 +- Filter ((((isnotnull(d_year#0) && isnotnull(d_qoy#0)) && (d_year#0 = 2002)) && (d_qoy#0 < 4)) && isnotnull(d_date_sk#0))
               :     :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [ca_address_sk#0, ca_state#0]
               :        +- Filter isnotnull(ca_address_sk#0)
               :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               +- Project [cd_demo_sk#0, cd_gender#0, cd_marital_status#0, cd_dep_count#0, cd_dep_employed_count#0, cd_dep_college_count#0]
                  +- Filter isnotnull(cd_demo_sk#0)
                     +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet


================================================================================================
q35a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [ca_state#0 ASC NULLS FIRST, cd_gender#0 ASC NULLS FIRST, cd_marital_status#0 ASC NULLS FIRST, cd_dep_count#0 ASC NULLS FIRST, cd_dep_employed_count#0 ASC NULLS FIRST, cd_dep_college_count#0 ASC NULLS FIRST], true
      +- 'Aggregate [ca_state#0, cd_gender#0, cd_marital_status#0, cd_dep_count#0, cd_dep_employed_count#0, cd_dep_college_count#0], [ca_state#0, cd_gender#0, cd_marital_status#0, cd_dep_count#0, count(1) AS cnt1#0L, avg(cast(cd_dep_count#0 as bigint)) AS avg(cd_dep_count)#0, max(cd_dep_count#0) AS max(cd_dep_count)#0, sum(cast(cd_dep_count#0 as bigint)) AS sum(cd_dep_count)#0L, cd_dep_employed_count#0, count(1) AS cnt2#0L, avg(cast(cd_dep_employed_count#0 as bigint)) AS avg(cd_dep_employed_count)#0, max(cd_dep_employed_count#0) AS max(cd_dep_employed_count)#0, sum(cast(cd_dep_employed_count#0 as bigint)) AS sum(cd_dep_employed_count)#0L, cd_dep_college_count#0, count(1) AS cnt3#0L, avg(cast(cd_dep_college_count#0 as bigint)) AS avg(cd_dep_college_count)#0, max(cd_dep_college_count#0) AS max(cd_dep_college_count)#0, sum(cast(cd_dep_college_count#0 as bigint)) AS sum(cd_dep_college_count)#0L]
         +- 'Project [ca_state#0, cd_gender#0, cd_marital_status#0, cd_dep_count#0, cd_dep_employed_count#0, cd_dep_college_count#0]
            +- 'Join Inner, (cd_demo_sk#0 = c_current_cdemo_sk#0)
               :- 'Project [c_current_cdemo_sk#0, ca_state#0]
               :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
               :     :- 'Project [c_current_cdemo_sk#0, c_current_addr_sk#0]
               :     :  +- 'Join LeftSemi, (customsk#0 = c_customer_sk#0)
               :     :     :- 'Join LeftSemi, (c_customer_sk#0 = ss_customer_sk#0)
               :     :     :  :- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_addr_sk#0]
               :     :     :  :  +- Filter isnotnull(c_customer_sk#0)
               :     :     :  :     +- Filter (isnotnull(c_current_addr_sk#0) && isnotnull(c_current_cdemo_sk#0))
               :     :     :  :        +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
               :     :     :  +- 'Project [ss_customer_sk#0]
               :     :     :     +- 'Filter isnotnull(ss_customer_sk#0)
               :     :     :        +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :     :           :- Project [ss_sold_date_sk#0, ss_customer_sk#0]
               :     :     :           :  +- Filter isnotnull(ss_sold_date_sk#0)
               :     :     :           :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     :           +- Project [d_date_sk#0]
               :     :     :              +- Filter ((((isnotnull(d_year#0) && isnotnull(d_qoy#0)) && (d_year#0 = 1999)) && (d_qoy#0 < 4)) && isnotnull(d_date_sk#0))
               :     :     :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     +- 'Union
               :     :        :- 'Project [ws_bill_customer_sk#0 AS customsk#0]
               :     :        :  +- 'Filter isnotnull(ws_bill_customer_sk#0)
               :     :        :     +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :     :        :        :- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0]
               :     :        :        :  +- Filter isnotnull(ws_sold_date_sk#0)
               :     :        :        :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :     :        :        +- Project [d_date_sk#0]
               :     :        :           +- Filter ((((isnotnull(d_year#0) && isnotnull(d_qoy#0)) && (d_year#0 = 1999)) && (d_qoy#0 < 4)) && isnotnull(d_date_sk#0))
               :     :        :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :        +- 'Project [cs_ship_customer_sk#0 AS customsk#0]
               :     :           +- 'Filter isnotnull(cs_ship_customer_sk#0)
               :     :              +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :     :                 :- Project [cs_sold_date_sk#0, cs_ship_customer_sk#0]
               :     :                 :  +- Filter isnotnull(cs_sold_date_sk#0)
               :     :                 :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :                 +- Project [d_date_sk#0]
               :     :                    +- Filter ((((isnotnull(d_year#0) && isnotnull(d_qoy#0)) && (d_year#0 = 1999)) && (d_qoy#0 < 4)) && isnotnull(d_date_sk#0))
               :     :                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [ca_address_sk#0, ca_state#0]
               :        +- Filter isnotnull(ca_address_sk#0)
               :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               +- Project [cd_demo_sk#0, cd_gender#0, cd_marital_status#0, cd_dep_count#0, cd_dep_employed_count#0, cd_dep_college_count#0]
                  +- Filter isnotnull(cd_demo_sk#0)
                     +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet


================================================================================================
q36a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [lochierarchy#0 DESC NULLS LAST, CASE WHEN (lochierarchy#0 = 0) THEN i_category#0 END ASC NULLS FIRST, rank_within_parent#0 ASC NULLS FIRST], true
      +- 'Project [gross_margin#0, i_category#0, i_class#0, lochierarchy#0, rank_within_parent#0]
         +- 'Window [rank(gross_margin#0) windowspecdefinition(lochierarchy#0, _w0#0, gross_margin#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#0], [lochierarchy#0, _w0#0], [gross_margin#0 ASC NULLS FIRST]
            +- 'Aggregate [gross_margin#0, i_category#0, i_class#0, t_category#0, t_class#0, lochierarchy#0], [gross_margin#0, i_category#0, i_class#0, lochierarchy#0, CASE WHEN (t_class#0 = 0) THEN i_category#0 END AS _w0#0]
               +- 'Union
                  :- 'Aggregate [gross_margin#0, i_category#0, i_class#0, t_category#0, t_class#0, lochierarchy#0], [gross_margin#0, i_category#0, i_class#0, t_category#0, t_class#0, lochierarchy#0]
                  :  +- 'Union
                  :     :- 'Aggregate [i_category#0, i_class#0], [cast(CheckOverflow((promote_precision(MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2)) / promote_precision(MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2))), DecimalType(37,20)) as decimal(38,20)) AS gross_margin#0, i_category#0, i_class#0, 0 AS t_category#0, 0 AS t_class#0, 0 AS lochierarchy#0]
                  :     :  +- 'Project [ss_ext_sales_price#0, ss_net_profit#0, i_class#0, i_category#0]
                  :     :     +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
                  :     :        :- 'Project [ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0, i_class#0, i_category#0]
                  :     :        :  +- 'Join Inner, (i_item_sk#0 = ss_item_sk#0)
                  :     :        :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
                  :     :        :     :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                  :     :        :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
                  :     :        :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0)) && isnotnull(ss_store_sk#0))
                  :     :        :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :     :        :     :     +- Project [d_date_sk#0]
                  :     :        :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                  :     :        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     :        :     +- Project [i_item_sk#0, i_class#0, i_category#0]
                  :     :        :        +- Filter isnotnull(i_item_sk#0)
                  :     :        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  :     :        +- Project [s_store_sk#0]
                  :     :           +- Filter ((isnotnull(s_state#0) && (s_state#0 = TN)) && isnotnull(s_store_sk#0))
                  :     :              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                  :     +- 'Aggregate [i_category#0], [cast(CheckOverflow((promote_precision(sum(ss_net_profit#0)) / promote_precision(sum(ss_ext_sales_price#0))), DecimalType(38,11)) as decimal(38,20)) AS gross_margin#0, i_category#0, null AS i_class#0, 0 AS t_category#0, 1 AS t_class#0, 1 AS lochierarchy#0]
                  :        +- 'Aggregate [i_category#0, i_class#0], [MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS ss_net_profit#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS ss_ext_sales_price#0, i_category#0]
                  :           +- 'Project [ss_ext_sales_price#0, ss_net_profit#0, i_class#0, i_category#0]
                  :              +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
                  :                 :- 'Project [ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0, i_class#0, i_category#0]
                  :                 :  +- 'Join Inner, (i_item_sk#0 = ss_item_sk#0)
                  :                 :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
                  :                 :     :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                  :                 :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
                  :                 :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0)) && isnotnull(ss_store_sk#0))
                  :                 :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :                 :     :     +- Project [d_date_sk#0]
                  :                 :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                  :                 :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :                 :     +- Project [i_item_sk#0, i_class#0, i_category#0]
                  :                 :        +- Filter isnotnull(i_item_sk#0)
                  :                 :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  :                 +- Project [s_store_sk#0]
                  :                    +- Filter ((isnotnull(s_state#0) && (s_state#0 = TN)) && isnotnull(s_store_sk#0))
                  :                       +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                  +- 'Aggregate [cast(CheckOverflow((promote_precision(sum(ss_net_profit#0)) / promote_precision(sum(ss_ext_sales_price#0))), DecimalType(38,11)) as decimal(38,20)) AS gross_margin#0, null AS i_category#0, null AS i_class#0, 1 AS t_category#0, 1 AS t_class#0, 2 AS lochierarchy#0]
                     +- 'Aggregate [i_category#0, i_class#0], [MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS ss_net_profit#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS ss_ext_sales_price#0]
                        +- 'Project [ss_ext_sales_price#0, ss_net_profit#0, i_class#0, i_category#0]
                           +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
                              :- 'Project [ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0, i_class#0, i_category#0]
                              :  +- 'Join Inner, (i_item_sk#0 = ss_item_sk#0)
                              :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
                              :     :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                              :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
                              :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_item_sk#0)) && isnotnull(ss_store_sk#0))
                              :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                              :     :     +- Project [d_date_sk#0]
                              :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                              :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              :     +- Project [i_item_sk#0, i_class#0, i_category#0]
                              :        +- Filter isnotnull(i_item_sk#0)
                              :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              +- Project [s_store_sk#0]
                                 +- Filter ((isnotnull(s_state#0) && (s_state#0 = TN)) && isnotnull(s_store_sk#0))
                                    +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet


================================================================================================
q47
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [CheckOverflow((promote_precision(cast(sum_sales#0 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST], true
      +- 'Project [i_category#0, d_year#0, d_moy#0, avg_monthly_sales#0, sum_sales#0, sum_sales#0 AS psum#0, sum_sales#0 AS nsum#0]
         +- 'Join Inner, (((((i_category#0 = i_category#0) && (i_brand#0 = i_brand#0)) && (s_store_name#0 = s_store_name#0)) && (s_company_name#0 = s_company_name#0)) && (rn#0 = (rn#0 - 1)))
            :- 'Project [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0, sum_sales#0, avg_monthly_sales#0, rn#0, sum_sales#0]
            :  +- 'Join Inner, (((((i_category#0 = i_category#0) && (i_brand#0 = i_brand#0)) && (s_store_name#0 = s_store_name#0)) && (s_company_name#0 = s_company_name#0)) && (rn#0 = (rn#0 + 1)))
            :     :- 'Project [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0, sum_sales#0, avg_monthly_sales#0, rn#0]
            :     :  +- 'Filter (((isnotnull(avg_monthly_sales#0) && (avg_monthly_sales#0 > 0.000000)) && (CASE WHEN (avg_monthly_sales#0 > 0.000000) THEN CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#0 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(22,6)))) / promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(38,16)) ELSE null END > 0.1000000000000000)) && isnotnull(rn#0))
            :     :     +- 'Window [avg(_w0#0) windowspecdefinition(i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0]
            :     :        +- 'Filter (isnotnull(d_year#0) && (d_year#0 = 1999))
            :     :           +- 'Window [rank(d_year#0, d_moy#0) windowspecdefinition(i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0], [d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST]
            :     :              +- 'Aggregate [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS sum_sales#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS _w0#0]
            :     :                 +- 'Project [i_brand#0, i_category#0, ss_sales_price#0, d_year#0, d_moy#0, s_store_name#0, s_company_name#0]
            :     :                    +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
            :     :                       :- 'Project [i_brand#0, i_category#0, ss_store_sk#0, ss_sales_price#0, d_year#0, d_moy#0]
            :     :                       :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :                       :     :- 'Project [i_brand#0, i_category#0, ss_sold_date_sk#0, ss_store_sk#0, ss_sales_price#0]
            :     :                       :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :                       :     :     :- Project [i_item_sk#0, i_brand#0, i_category#0]
            :     :                       :     :     :  +- Filter ((isnotnull(i_item_sk#0) && isnotnull(i_category#0)) && isnotnull(i_brand#0))
            :     :                       :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :                       :     :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_sales_price#0]
            :     :                       :     :        +- Filter ((isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0))
            :     :                       :     :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :                       :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
            :     :                       :        +- Filter ((((d_year#0 = 1999) || ((d_year#0 = 1998) && (d_moy#0 = 12))) || ((d_year#0 = 2000) && (d_moy#0 = 1))) && isnotnull(d_date_sk#0))
            :     :                       :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                       +- Project [s_store_sk#0, s_store_name#0, s_company_name#0]
            :     :                          +- Filter ((isnotnull(s_store_sk#0) && isnotnull(s_company_name#0)) && isnotnull(s_store_name#0))
            :     :                             +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :     +- 'Project [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, sum_sales#0, rn#0]
            :        +- 'Filter isnotnull(rn#0)
            :           +- 'Window [rank(d_year#0, d_moy#0) windowspecdefinition(i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0], [d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST]
            :              +- 'Aggregate [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS sum_sales#0]
            :                 +- 'Project [i_brand#0, i_category#0, ss_sales_price#0, d_year#0, d_moy#0, s_store_name#0, s_company_name#0]
            :                    +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
            :                       :- 'Project [i_brand#0, i_category#0, ss_store_sk#0, ss_sales_price#0, d_year#0, d_moy#0]
            :                       :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :                       :     :- 'Project [i_brand#0, i_category#0, ss_sold_date_sk#0, ss_store_sk#0, ss_sales_price#0]
            :                       :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :                       :     :     :- Project [i_item_sk#0, i_brand#0, i_category#0]
            :                       :     :     :  +- Filter ((isnotnull(i_item_sk#0) && isnotnull(i_category#0)) && isnotnull(i_brand#0))
            :                       :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                       :     :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_sales_price#0]
            :                       :     :        +- Filter ((isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0))
            :                       :     :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :                       :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
            :                       :        +- Filter ((((d_year#0 = 1999) || ((d_year#0 = 1998) && (d_moy#0 = 12))) || ((d_year#0 = 2000) && (d_moy#0 = 1))) && isnotnull(d_date_sk#0))
            :                       :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                       +- Project [s_store_sk#0, s_store_name#0, s_company_name#0]
            :                          +- Filter ((isnotnull(s_store_sk#0) && isnotnull(s_store_name#0)) && isnotnull(s_company_name#0))
            :                             +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            +- 'Project [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, sum_sales#0, rn#0]
               +- 'Filter isnotnull(rn#0)
                  +- 'Window [rank(d_year#0, d_moy#0) windowspecdefinition(i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0], [d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST]
                     +- 'Aggregate [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0], [i_category#0, i_brand#0, s_store_name#0, s_company_name#0, d_year#0, d_moy#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS sum_sales#0]
                        +- 'Project [i_brand#0, i_category#0, ss_sales_price#0, d_year#0, d_moy#0, s_store_name#0, s_company_name#0]
                           +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                              :- 'Project [i_brand#0, i_category#0, ss_store_sk#0, ss_sales_price#0, d_year#0, d_moy#0]
                              :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                              :     :- 'Project [i_brand#0, i_category#0, ss_sold_date_sk#0, ss_store_sk#0, ss_sales_price#0]
                              :     :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                              :     :     :- Project [i_item_sk#0, i_brand#0, i_category#0]
                              :     :     :  +- Filter ((isnotnull(i_item_sk#0) && isnotnull(i_category#0)) && isnotnull(i_brand#0))
                              :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              :     :     +- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_sales_price#0]
                              :     :        +- Filter ((isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0))
                              :     :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                              :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
                              :        +- Filter ((((d_year#0 = 1999) || ((d_year#0 = 1998) && (d_moy#0 = 12))) || ((d_year#0 = 2000) && (d_moy#0 = 1))) && isnotnull(d_date_sk#0))
                              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              +- Project [s_store_sk#0, s_store_name#0, s_company_name#0]
                                 +- Filter ((isnotnull(s_store_sk#0) && isnotnull(s_store_name#0)) && isnotnull(s_company_name#0))
                                    +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet


================================================================================================
q49
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [channel#0 ASC NULLS FIRST, return_rank#0 ASC NULLS FIRST, currency_rank#0 ASC NULLS FIRST, item#0 ASC NULLS FIRST], true
      +- 'Aggregate [channel#0, item#0, return_ratio#0, return_rank#0, currency_rank#0], [channel#0, item#0, return_ratio#0, return_rank#0, currency_rank#0]
         +- 'Union
            :- 'Project [web AS channel#0, item#0, return_ratio#0, return_rank#0, currency_rank#0]
            :  +- 'Filter ((return_rank#0 <= 10) || (currency_rank#0 <= 10))
            :     +- 'Window [rank(currency_ratio#0) windowspecdefinition(currency_ratio#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#0], [currency_ratio#0 ASC NULLS FIRST]
            :        +- 'Window [rank(return_ratio#0) windowspecdefinition(return_ratio#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#0], [return_ratio#0 ASC NULLS FIRST]
            :           +- 'Aggregate [ws_item_sk#0], [ws_item_sk#0 AS item#0, CheckOverflow((promote_precision(cast(sum(cast(coalesce(wr_return_quantity#0, 0) as bigint)) as decimal(15,4))) / promote_precision(cast(sum(cast(coalesce(ws_quantity#0, 0) as bigint)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#0, CheckOverflow((promote_precision(cast(sum(coalesce(cast(wr_return_amt#0 as decimal(12,2)), 0.00)) as decimal(15,4))) / promote_precision(cast(sum(coalesce(cast(ws_net_paid#0 as decimal(12,2)), 0.00)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#0]
            :              +- 'Project [ws_item_sk#0, ws_quantity#0, ws_net_paid#0, wr_return_quantity#0, wr_return_amt#0]
            :                 +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :                    :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_quantity#0, ws_net_paid#0, wr_return_quantity#0, wr_return_amt#0]
            :                    :  +- 'Join Inner, ((cast(ws_order_number#0 as bigint) = wr_order_number#0L) && (cast(ws_item_sk#0 as bigint) = wr_item_sk#0L))
            :                    :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_net_paid#0]
            :                    :     :  +- Filter ((((((((isnotnull(ws_net_paid#0) && isnotnull(ws_net_profit#0)) && isnotnull(ws_quantity#0)) && (ws_net_profit#0 > 1.00)) && (ws_net_paid#0 > 0.00)) && (ws_quantity#0 > 0)) && isnotnull(ws_item_sk#0)) && isnotnull(ws_order_number#0)) && isnotnull(ws_sold_date_sk#0))
            :                    :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                    :     +- Project [wr_item_sk#0L, wr_order_number#0L, wr_return_quantity#0, wr_return_amt#0]
            :                    :        +- Filter (((isnotnull(wr_return_amt#0) && (wr_return_amt#0 > 10000.00)) && isnotnull(wr_order_number#0L)) && isnotnull(wr_item_sk#0L))
            :                    :           +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
            :                    +- Project [d_date_sk#0]
            :                       +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 12)) && isnotnull(d_date_sk#0))
            :                          +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :- 'Project [catalog AS channel#0, item#0, return_ratio#0, return_rank#0, currency_rank#0]
            :  +- 'Filter ((return_rank#0 <= 10) || (currency_rank#0 <= 10))
            :     +- 'Window [rank(return_ratio#0) windowspecdefinition(return_ratio#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#0], [return_ratio#0 ASC NULLS FIRST]
            :        +- 'Project [item#0, return_ratio#0, currency_rank#0]
            :           +- 'Window [rank(currency_ratio#0) windowspecdefinition(currency_ratio#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#0], [currency_ratio#0 ASC NULLS FIRST]
            :              +- 'Aggregate [cs_item_sk#0], [cs_item_sk#0 AS item#0, CheckOverflow((promote_precision(cast(sum(cast(coalesce(cr_return_quantity#0, 0) as bigint)) as decimal(15,4))) / promote_precision(cast(sum(cast(coalesce(cs_quantity#0, 0) as bigint)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#0, CheckOverflow((promote_precision(cast(sum(coalesce(cast(cr_return_amount#0 as decimal(12,2)), 0.00)) as decimal(15,4))) / promote_precision(cast(sum(coalesce(cast(cs_net_paid#0 as decimal(12,2)), 0.00)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#0]
            :                 +- 'Project [cs_item_sk#0, cs_quantity#0, cs_net_paid#0, cr_return_quantity#0, cr_return_amount#0]
            :                    +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :                       :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_quantity#0, cs_net_paid#0, cr_return_quantity#0, cr_return_amount#0]
            :                       :  +- 'Join Inner, ((cs_order_number#0 = cr_order_number#0) && (cs_item_sk#0 = cr_item_sk#0))
            :                       :     :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_net_paid#0]
            :                       :     :  +- Filter ((((((((isnotnull(cs_quantity#0) && isnotnull(cs_net_profit#0)) && isnotnull(cs_net_paid#0)) && (cs_net_profit#0 > 1.00)) && (cs_net_paid#0 > 0.00)) && (cs_quantity#0 > 0)) && isnotnull(cs_order_number#0)) && isnotnull(cs_item_sk#0)) && isnotnull(cs_sold_date_sk#0))
            :                       :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :                       :     +- Project [cr_item_sk#0, cr_order_number#0, cr_return_quantity#0, cr_return_amount#0]
            :                       :        +- Filter (((isnotnull(cr_return_amount#0) && (cr_return_amount#0 > 10000.00)) && isnotnull(cr_order_number#0)) && isnotnull(cr_item_sk#0))
            :                       :           +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
            :                       +- Project [d_date_sk#0]
            :                          +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 12)) && isnotnull(d_date_sk#0))
            :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- 'Project [store AS channel#0, item#0, return_ratio#0, return_rank#0, currency_rank#0]
               +- 'Filter ((return_rank#0 <= 10) || (currency_rank#0 <= 10))
                  +- 'Window [rank(return_ratio#0) windowspecdefinition(return_ratio#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#0], [return_ratio#0 ASC NULLS FIRST]
                     +- 'Project [item#0, return_ratio#0, currency_rank#0]
                        +- 'Window [rank(currency_ratio#0) windowspecdefinition(currency_ratio#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#0], [currency_ratio#0 ASC NULLS FIRST]
                           +- 'Aggregate [ss_item_sk#0], [ss_item_sk#0 AS item#0, CheckOverflow((promote_precision(cast(sum(cast(coalesce(sr_return_quantity#0, 0) as bigint)) as decimal(15,4))) / promote_precision(cast(sum(cast(coalesce(ss_quantity#0, 0) as bigint)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#0, CheckOverflow((promote_precision(cast(sum(coalesce(cast(sr_return_amt#0 as decimal(12,2)), 0.00)) as decimal(15,4))) / promote_precision(cast(sum(coalesce(cast(ss_net_paid#0 as decimal(12,2)), 0.00)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#0]
                              +- 'Project [ss_item_sk#0, ss_quantity#0, ss_net_paid#0, sr_return_quantity#0, sr_return_amt#0]
                                 +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                                    :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_quantity#0, ss_net_paid#0, sr_return_quantity#0, sr_return_amt#0]
                                    :  +- 'Join Inner, ((cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L))
                                    :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_net_paid#0]
                                    :     :  +- Filter ((((((((isnotnull(ss_quantity#0) && isnotnull(ss_net_profit#0)) && isnotnull(ss_net_paid#0)) && (ss_net_profit#0 > 1.00)) && (ss_net_paid#0 > 0.00)) && (ss_quantity#0 > 0)) && isnotnull(ss_item_sk#0)) && isnotnull(ss_ticket_number#0)) && isnotnull(ss_sold_date_sk#0))
                                    :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                                    :     +- Project [sr_item_sk#0L, sr_ticket_number#0L, sr_return_quantity#0, sr_return_amt#0]
                                    :        +- Filter (((isnotnull(sr_return_amt#0) && (sr_return_amt#0 > 10000.00)) && isnotnull(sr_ticket_number#0L)) && isnotnull(sr_item_sk#0L))
                                    :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
                                    +- Project [d_date_sk#0]
                                       +- Filter ((((isnotnull(d_year#0) && isnotnull(d_moy#0)) && (d_year#0 = 2001)) && (d_moy#0 = 12)) && isnotnull(d_date_sk#0))
                                          +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q51a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [item_sk#0 ASC NULLS FIRST, d_date#0 ASC NULLS FIRST], true
      +- 'Filter ((isnotnull(web_cumulative#0) && isnotnull(store_cumulative#0)) && (web_cumulative#0 > store_cumulative#0))
         +- 'Aggregate [item_sk#0, d_date#0, web_sales#0, store_sales#0], [item_sk#0, d_date#0, web_sales#0, store_sales#0, max(web_sales#0) AS web_cumulative#0, max(store_sales#0) AS store_cumulative#0]
            +- 'Project [item_sk#0, d_date#0, web_sales#0, store_sales#0, web_sales#0, store_sales#0]
               +- 'Join Inner, ((item_sk#0 = item_sk#0) && (rk#0 >= rk#0))
                  :- 'Filter isnotnull(rk#0)
                  :  +- 'Window [row_number() windowspecdefinition(item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#0], [item_sk#0], [d_date#0 ASC NULLS FIRST]
                  :     +- 'Project [CASE WHEN isnotnull(item_sk#0) THEN item_sk#0 ELSE item_sk#0 END AS item_sk#0, CASE WHEN isnotnull(d_date#0) THEN d_date#0 ELSE d_date#0 END AS d_date#0, cume_sales#0 AS web_sales#0, cume_sales#0 AS store_sales#0]
                  :        +- 'Filter isnotnull(CASE WHEN isnotnull(item_sk#0) THEN item_sk#0 ELSE item_sk#0 END)
                  :           +- 'Join FullOuter, ((item_sk#0 = item_sk#0) && (d_date#0 = d_date#0))
                  :              :- 'Aggregate [item_sk#0, d_date#0, sumws#0], [item_sk#0, d_date#0, sum(sumws#0) AS cume_sales#0]
                  :              :  +- 'Project [item_sk#0, d_date#0, sumws#0, sumws#0]
                  :              :     +- 'Join Inner, ((item_sk#0 = item_sk#0) && (rk#0 >= rk#0))
                  :              :        :- 'Project [item_sk#0, d_date#0, sumws#0, rk#0]
                  :              :        :  +- 'Filter isnotnull(rk#0)
                  :              :        :     +- 'Window [row_number() windowspecdefinition(ws_item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#0], [ws_item_sk#0], [d_date#0 ASC NULLS FIRST]
                  :              :        :        +- 'Aggregate [ws_item_sk#0, d_date#0], [ws_item_sk#0 AS item_sk#0, d_date#0, MakeDecimal(sum(UnscaledValue(ws_sales_price#0)),17,2) AS sumws#0, ws_item_sk#0]
                  :              :        :           +- 'Project [ws_item_sk#0, ws_sales_price#0, d_date#0]
                  :              :        :              +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                  :              :        :                 :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_sales_price#0]
                  :              :        :                 :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                  :              :        :                 :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                  :              :        :                 +- Project [d_date_sk#0, d_date#0]
                  :              :        :                    +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                  :              :        :                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :              :        +- 'Project [item_sk#0, sumws#0, rk#0]
                  :              :           +- 'Filter isnotnull(rk#0)
                  :              :              +- 'Window [row_number() windowspecdefinition(ws_item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#0], [ws_item_sk#0], [d_date#0 ASC NULLS FIRST]
                  :              :                 +- 'Aggregate [ws_item_sk#0, d_date#0], [ws_item_sk#0 AS item_sk#0, d_date#0, MakeDecimal(sum(UnscaledValue(ws_sales_price#0)),17,2) AS sumws#0, ws_item_sk#0]
                  :              :                    +- 'Project [ws_item_sk#0, ws_sales_price#0, d_date#0]
                  :              :                       +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                  :              :                          :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_sales_price#0]
                  :              :                          :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                  :              :                          :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                  :              :                          +- Project [d_date_sk#0, d_date#0]
                  :              :                             +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                  :              :                                +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :              +- 'Aggregate [item_sk#0, d_date#0, sumss#0], [item_sk#0, d_date#0, sum(sumss#0) AS cume_sales#0]
                  :                 +- 'Project [item_sk#0, d_date#0, sumss#0, sumss#0]
                  :                    +- 'Join Inner, ((item_sk#0 = item_sk#0) && (rk#0 >= rk#0))
                  :                       :- 'Project [item_sk#0, d_date#0, sumss#0, rk#0]
                  :                       :  +- 'Filter isnotnull(rk#0)
                  :                       :     +- 'Window [row_number() windowspecdefinition(ss_item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#0], [ss_item_sk#0], [d_date#0 ASC NULLS FIRST]
                  :                       :        +- 'Aggregate [ss_item_sk#0, d_date#0], [ss_item_sk#0 AS item_sk#0, d_date#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS sumss#0, ss_item_sk#0]
                  :                       :           +- 'Project [ss_item_sk#0, ss_sales_price#0, d_date#0]
                  :                       :              +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                  :                       :                 :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_sales_price#0]
                  :                       :                 :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                  :                       :                 :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :                       :                 +- Project [d_date_sk#0, d_date#0]
                  :                       :                    +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                  :                       :                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :                       +- 'Project [item_sk#0, sumss#0, rk#0]
                  :                          +- 'Filter isnotnull(rk#0)
                  :                             +- 'Window [row_number() windowspecdefinition(ss_item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#0], [ss_item_sk#0], [d_date#0 ASC NULLS FIRST]
                  :                                +- 'Aggregate [ss_item_sk#0, d_date#0], [ss_item_sk#0 AS item_sk#0, d_date#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS sumss#0, ss_item_sk#0]
                  :                                   +- 'Project [ss_item_sk#0, ss_sales_price#0, d_date#0]
                  :                                      +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                  :                                         :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_sales_price#0]
                  :                                         :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                  :                                         :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :                                         +- Project [d_date_sk#0, d_date#0]
                  :                                            +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                  :                                               +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  +- 'Project [item_sk#0, web_sales#0, store_sales#0, rk#0]
                     +- 'Filter isnotnull(rk#0)
                        +- 'Window [row_number() windowspecdefinition(item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#0], [item_sk#0], [d_date#0 ASC NULLS FIRST]
                           +- 'Project [CASE WHEN isnotnull(item_sk#0) THEN item_sk#0 ELSE item_sk#0 END AS item_sk#0, CASE WHEN isnotnull(d_date#0) THEN d_date#0 ELSE d_date#0 END AS d_date#0, cume_sales#0 AS web_sales#0, cume_sales#0 AS store_sales#0]
                              +- 'Filter isnotnull(CASE WHEN isnotnull(item_sk#0) THEN item_sk#0 ELSE item_sk#0 END)
                                 +- 'Join FullOuter, ((item_sk#0 = item_sk#0) && (d_date#0 = d_date#0))
                                    :- 'Aggregate [item_sk#0, d_date#0, sumws#0], [item_sk#0, d_date#0, sum(sumws#0) AS cume_sales#0]
                                    :  +- 'Project [item_sk#0, d_date#0, sumws#0, sumws#0]
                                    :     +- 'Join Inner, ((item_sk#0 = item_sk#0) && (rk#0 >= rk#0))
                                    :        :- 'Project [item_sk#0, d_date#0, sumws#0, rk#0]
                                    :        :  +- 'Filter isnotnull(rk#0)
                                    :        :     +- 'Window [row_number() windowspecdefinition(ws_item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#0], [ws_item_sk#0], [d_date#0 ASC NULLS FIRST]
                                    :        :        +- 'Aggregate [ws_item_sk#0, d_date#0], [ws_item_sk#0 AS item_sk#0, d_date#0, MakeDecimal(sum(UnscaledValue(ws_sales_price#0)),17,2) AS sumws#0, ws_item_sk#0]
                                    :        :           +- 'Project [ws_item_sk#0, ws_sales_price#0, d_date#0]
                                    :        :              +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                                    :        :                 :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_sales_price#0]
                                    :        :                 :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                                    :        :                 :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                                    :        :                 +- Project [d_date_sk#0, d_date#0]
                                    :        :                    +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                                    :        :                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                                    :        +- 'Project [item_sk#0, sumws#0, rk#0]
                                    :           +- 'Filter isnotnull(rk#0)
                                    :              +- 'Window [row_number() windowspecdefinition(ws_item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#0], [ws_item_sk#0], [d_date#0 ASC NULLS FIRST]
                                    :                 +- 'Aggregate [ws_item_sk#0, d_date#0], [ws_item_sk#0 AS item_sk#0, d_date#0, MakeDecimal(sum(UnscaledValue(ws_sales_price#0)),17,2) AS sumws#0, ws_item_sk#0]
                                    :                    +- 'Project [ws_item_sk#0, ws_sales_price#0, d_date#0]
                                    :                       +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                                    :                          :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_sales_price#0]
                                    :                          :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                                    :                          :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                                    :                          +- Project [d_date_sk#0, d_date#0]
                                    :                             +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                                    :                                +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                                    +- 'Aggregate [item_sk#0, d_date#0, sumss#0], [item_sk#0, d_date#0, sum(sumss#0) AS cume_sales#0]
                                       +- 'Project [item_sk#0, d_date#0, sumss#0, sumss#0]
                                          +- 'Join Inner, ((item_sk#0 = item_sk#0) && (rk#0 >= rk#0))
                                             :- 'Project [item_sk#0, d_date#0, sumss#0, rk#0]
                                             :  +- 'Filter isnotnull(rk#0)
                                             :     +- 'Window [row_number() windowspecdefinition(ss_item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#0], [ss_item_sk#0], [d_date#0 ASC NULLS FIRST]
                                             :        +- 'Aggregate [ss_item_sk#0, d_date#0], [ss_item_sk#0 AS item_sk#0, d_date#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS sumss#0, ss_item_sk#0]
                                             :           +- 'Project [ss_item_sk#0, ss_sales_price#0, d_date#0]
                                             :              +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                                             :                 :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_sales_price#0]
                                             :                 :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                                             :                 :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                                             :                 +- Project [d_date_sk#0, d_date#0]
                                             :                    +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                                             :                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                                             +- 'Project [item_sk#0, sumss#0, rk#0]
                                                +- 'Filter isnotnull(rk#0)
                                                   +- 'Window [row_number() windowspecdefinition(ss_item_sk#0, d_date#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#0], [ss_item_sk#0], [d_date#0 ASC NULLS FIRST]
                                                      +- 'Aggregate [ss_item_sk#0, d_date#0], [ss_item_sk#0 AS item_sk#0, d_date#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS sumss#0, ss_item_sk#0]
                                                         +- 'Project [ss_item_sk#0, ss_sales_price#0, d_date#0]
                                                            +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                                                               :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_sales_price#0]
                                                               :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                                                               :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                                                               +- Project [d_date_sk#0, d_date#0]
                                                                  +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                                                                     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q57
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [CheckOverflow((promote_precision(cast(sum_sales#0 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, d_year#0 ASC NULLS FIRST], true
      +- 'Project [i_category#0, i_brand#0, d_year#0, d_moy#0, avg_monthly_sales#0, sum_sales#0, sum_sales#0 AS psum#0, sum_sales#0 AS nsum#0]
         +- 'Join Inner, ((((i_category#0 = i_category#0) && (i_brand#0 = i_brand#0)) && (cc_name#0 = cc_name#0)) && (rn#0 = (rn#0 - 1)))
            :- 'Project [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0, sum_sales#0, avg_monthly_sales#0, rn#0, sum_sales#0]
            :  +- 'Join Inner, ((((i_category#0 = i_category#0) && (i_brand#0 = i_brand#0)) && (cc_name#0 = cc_name#0)) && (rn#0 = (rn#0 + 1)))
            :     :- 'Project [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0, sum_sales#0, avg_monthly_sales#0, rn#0]
            :     :  +- 'Filter (((isnotnull(avg_monthly_sales#0) && (avg_monthly_sales#0 > 0.000000)) && (CASE WHEN (avg_monthly_sales#0 > 0.000000) THEN CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#0 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(22,6)))) / promote_precision(cast(avg_monthly_sales#0 as decimal(22,6)))), DecimalType(38,16)) ELSE null END > 0.1000000000000000)) && isnotnull(rn#0))
            :     :     +- 'Window [avg(_w0#0) windowspecdefinition(i_category#0, i_brand#0, cc_name#0, d_year#0, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#0], [i_category#0, i_brand#0, cc_name#0, d_year#0]
            :     :        +- 'Filter (isnotnull(d_year#0) && (d_year#0 = 1999))
            :     :           +- 'Window [rank(d_year#0, d_moy#0) windowspecdefinition(i_category#0, i_brand#0, cc_name#0, d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#0], [i_category#0, i_brand#0, cc_name#0], [d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST]
            :     :              +- 'Aggregate [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0], [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0, MakeDecimal(sum(UnscaledValue(cs_sales_price#0)),17,2) AS sum_sales#0, MakeDecimal(sum(UnscaledValue(cs_sales_price#0)),17,2) AS _w0#0]
            :     :                 +- 'Project [i_brand#0, i_category#0, cs_sales_price#0, d_year#0, d_moy#0, cc_name#0]
            :     :                    +- 'Join Inner, (cc_call_center_sk#0 = cs_call_center_sk#0)
            :     :                       :- 'Project [i_brand#0, i_category#0, cs_call_center_sk#0, cs_sales_price#0, d_year#0, d_moy#0]
            :     :                       :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :                       :     :- 'Project [i_brand#0, i_category#0, cs_sold_date_sk#0, cs_call_center_sk#0, cs_sales_price#0]
            :     :                       :     :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :                       :     :     :- Project [i_item_sk#0, i_brand#0, i_category#0]
            :     :                       :     :     :  +- Filter ((isnotnull(i_item_sk#0) && isnotnull(i_category#0)) && isnotnull(i_brand#0))
            :     :                       :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :                       :     :     +- Project [cs_sold_date_sk#0, cs_call_center_sk#0, cs_item_sk#0, cs_sales_price#0]
            :     :                       :     :        +- Filter ((isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_call_center_sk#0))
            :     :                       :     :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :                       :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
            :     :                       :        +- Filter ((((d_year#0 = 1999) || ((d_year#0 = 1998) && (d_moy#0 = 12))) || ((d_year#0 = 2000) && (d_moy#0 = 1))) && isnotnull(d_date_sk#0))
            :     :                       :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                       +- Project [cc_call_center_sk#0, cc_name#0]
            :     :                          +- Filter (isnotnull(cc_call_center_sk#0) && isnotnull(cc_name#0))
            :     :                             +- Relation[cc_call_center_sk#0,cc_call_center_id#0,cc_rec_start_date#0,cc_rec_end_date#0,cc_closed_date_sk#0,cc_open_date_sk#0,cc_name#0,cc_class#0,cc_employees#0,cc_sq_ft#0,cc_hours#0,cc_manager#0,cc_mkt_id#0,cc_mkt_class#0,cc_mkt_desc#0,cc_market_manager#0,cc_division#0,cc_division_name#0,cc_company#0,cc_company_name#0,cc_street_number#0,cc_street_name#0,cc_street_type#0,cc_suite_number#0,... 7 more fields] parquet
            :     +- 'Project [i_category#0, i_brand#0, cc_name#0, sum_sales#0, rn#0]
            :        +- 'Filter isnotnull(rn#0)
            :           +- 'Window [rank(d_year#0, d_moy#0) windowspecdefinition(i_category#0, i_brand#0, cc_name#0, d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#0], [i_category#0, i_brand#0, cc_name#0], [d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST]
            :              +- 'Aggregate [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0], [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0, MakeDecimal(sum(UnscaledValue(cs_sales_price#0)),17,2) AS sum_sales#0]
            :                 +- 'Project [i_brand#0, i_category#0, cs_sales_price#0, d_year#0, d_moy#0, cc_name#0]
            :                    +- 'Join Inner, (cc_call_center_sk#0 = cs_call_center_sk#0)
            :                       :- 'Project [i_brand#0, i_category#0, cs_call_center_sk#0, cs_sales_price#0, d_year#0, d_moy#0]
            :                       :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :                       :     :- 'Project [i_brand#0, i_category#0, cs_sold_date_sk#0, cs_call_center_sk#0, cs_sales_price#0]
            :                       :     :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :                       :     :     :- Project [i_item_sk#0, i_brand#0, i_category#0]
            :                       :     :     :  +- Filter ((isnotnull(i_item_sk#0) && isnotnull(i_brand#0)) && isnotnull(i_category#0))
            :                       :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                       :     :     +- Project [cs_sold_date_sk#0, cs_call_center_sk#0, cs_item_sk#0, cs_sales_price#0]
            :                       :     :        +- Filter ((isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_call_center_sk#0))
            :                       :     :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :                       :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
            :                       :        +- Filter ((((d_year#0 = 1999) || ((d_year#0 = 1998) && (d_moy#0 = 12))) || ((d_year#0 = 2000) && (d_moy#0 = 1))) && isnotnull(d_date_sk#0))
            :                       :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                       +- Project [cc_call_center_sk#0, cc_name#0]
            :                          +- Filter (isnotnull(cc_call_center_sk#0) && isnotnull(cc_name#0))
            :                             +- Relation[cc_call_center_sk#0,cc_call_center_id#0,cc_rec_start_date#0,cc_rec_end_date#0,cc_closed_date_sk#0,cc_open_date_sk#0,cc_name#0,cc_class#0,cc_employees#0,cc_sq_ft#0,cc_hours#0,cc_manager#0,cc_mkt_id#0,cc_mkt_class#0,cc_mkt_desc#0,cc_market_manager#0,cc_division#0,cc_division_name#0,cc_company#0,cc_company_name#0,cc_street_number#0,cc_street_name#0,cc_street_type#0,cc_suite_number#0,... 7 more fields] parquet
            +- 'Project [i_category#0, i_brand#0, cc_name#0, sum_sales#0, rn#0]
               +- 'Filter isnotnull(rn#0)
                  +- 'Window [rank(d_year#0, d_moy#0) windowspecdefinition(i_category#0, i_brand#0, cc_name#0, d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#0], [i_category#0, i_brand#0, cc_name#0], [d_year#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST]
                     +- 'Aggregate [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0], [i_category#0, i_brand#0, cc_name#0, d_year#0, d_moy#0, MakeDecimal(sum(UnscaledValue(cs_sales_price#0)),17,2) AS sum_sales#0]
                        +- 'Project [i_brand#0, i_category#0, cs_sales_price#0, d_year#0, d_moy#0, cc_name#0]
                           +- 'Join Inner, (cc_call_center_sk#0 = cs_call_center_sk#0)
                              :- 'Project [i_brand#0, i_category#0, cs_call_center_sk#0, cs_sales_price#0, d_year#0, d_moy#0]
                              :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                              :     :- 'Project [i_brand#0, i_category#0, cs_sold_date_sk#0, cs_call_center_sk#0, cs_sales_price#0]
                              :     :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                              :     :     :- Project [i_item_sk#0, i_brand#0, i_category#0]
                              :     :     :  +- Filter ((isnotnull(i_item_sk#0) && isnotnull(i_category#0)) && isnotnull(i_brand#0))
                              :     :     :     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              :     :     +- Project [cs_sold_date_sk#0, cs_call_center_sk#0, cs_item_sk#0, cs_sales_price#0]
                              :     :        +- Filter ((isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_call_center_sk#0))
                              :     :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                              :     +- Project [d_date_sk#0, d_year#0, d_moy#0]
                              :        +- Filter ((((d_year#0 = 1999) || ((d_year#0 = 1998) && (d_moy#0 = 12))) || ((d_year#0 = 2000) && (d_moy#0 = 1))) && isnotnull(d_date_sk#0))
                              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              +- Project [cc_call_center_sk#0, cc_name#0]
                                 +- Filter (isnotnull(cc_call_center_sk#0) && isnotnull(cc_name#0))
                                    +- Relation[cc_call_center_sk#0,cc_call_center_id#0,cc_rec_start_date#0,cc_rec_end_date#0,cc_closed_date_sk#0,cc_open_date_sk#0,cc_name#0,cc_class#0,cc_employees#0,cc_sq_ft#0,cc_hours#0,cc_manager#0,cc_mkt_id#0,cc_mkt_class#0,cc_mkt_desc#0,cc_market_manager#0,cc_division#0,cc_division_name#0,cc_company#0,cc_company_name#0,cc_street_number#0,cc_street_name#0,cc_street_type#0,cc_suite_number#0,... 7 more fields] parquet


================================================================================================
q64
================================================================================================

'Sort [product_name#0 ASC NULLS FIRST, store_name#0 ASC NULLS FIRST, cnt#0L ASC NULLS FIRST, s1#0 ASC NULLS FIRST, s1#0 ASC NULLS FIRST], true
+- 'Project [product_name#0, store_name#0, store_zip#0, b_street_number#0, b_streen_name#0, b_city#0, b_zip#0, c_street_number#0, c_street_name#0, c_city#0, c_zip#0, syear#0, cnt#0L, s1#0, s2#0, s3#0, s1#0, s2#0, s3#0, syear#0, cnt#0L]
   +- 'Join Inner, ((((item_sk#0 = item_sk#0) && (cnt#0L <= cnt#0L)) && (store_name#0 = store_name#0)) && (store_zip#0 = store_zip#0))
      :- 'Aggregate [i_product_name#0, i_item_sk#0, s_store_name#0, s_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, d_year#0, d_year#0, d_year#0], [i_product_name#0 AS product_name#0, i_item_sk#0 AS item_sk#0, s_store_name#0 AS store_name#0, s_zip#0 AS store_zip#0, ca_street_number#0 AS b_street_number#0, ca_street_name#0 AS b_streen_name#0, ca_city#0 AS b_city#0, ca_zip#0 AS b_zip#0, ca_street_number#0 AS c_street_number#0, ca_street_name#0 AS c_street_name#0, ca_city#0 AS c_city#0, ca_zip#0 AS c_zip#0, d_year#0 AS syear#0, count(1) AS cnt#0L, MakeDecimal(sum(UnscaledValue(ss_wholesale_cost#0)),17,2) AS s1#0, MakeDecimal(sum(UnscaledValue(ss_list_price#0)),17,2) AS s2#0, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#0)),17,2) AS s3#0]
      :  +- 'Project [ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, i_item_sk#0, i_product_name#0]
      :     +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
      :        :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
      :        :  +- 'Join Inner, (hd_income_band_sk#0 = ib_income_band_sk#0)
      :        :     :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, hd_income_band_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
      :        :     :  +- 'Join Inner, (hd_income_band_sk#0 = ib_income_band_sk#0)
      :        :     :     :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, hd_income_band_sk#0, hd_income_band_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
      :        :     :     :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
      :        :     :     :     :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_addr_sk#0, d_year#0, d_year#0, hd_income_band_sk#0, hd_income_band_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
      :        :     :     :     :  +- 'Join Inner, (ss_addr_sk#0 = ca_address_sk#0)
      :        :     :     :     :     :- 'Project [ss_item_sk#0, ss_addr_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_addr_sk#0, d_year#0, d_year#0, hd_income_band_sk#0, hd_income_band_sk#0]
      :        :     :     :     :     :  +- 'Join Inner, (c_current_hdemo_sk#0 = hd_demo_sk#0)
      :        :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_addr_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0, hd_income_band_sk#0]
      :        :     :     :     :     :     :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
      :        :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0]
      :        :     :     :     :     :     :     :  +- 'Join Inner, (ss_promo_sk#0 = p_promo_sk#0)
      :        :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0]
      :        :     :     :     :     :     :     :     :  +- 'Join Inner, ((c_current_cdemo_sk#0 = cd_demo_sk#0) && NOT (cd_marital_status#0 = cd_marital_status#0))
      :        :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0, cd_marital_status#0]
      :        :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_cdemo_sk#0 = cd_demo_sk#0)
      :        :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0]
      :        :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (c_first_shipto_date_sk#0 = d_date_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, c_first_shipto_date_sk#0, d_year#0]
      :        :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (c_first_sales_date_sk#0 = d_date_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, c_first_shipto_date_sk#0, c_first_sales_date_sk#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_item_sk#0 = cs_item_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, ((cast(ss_item_sk#0 as bigint) = sr_item_sk#0L) && (cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ticket_number#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter ((((((((isnotnull(ss_item_sk#0) && isnotnull(ss_ticket_number#0)) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_customer_sk#0)) && isnotnull(ss_cdemo_sk#0)) && isnotnull(ss_promo_sk#0)) && isnotnull(ss_hdemo_sk#0)) && isnotnull(ss_addr_sk#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#0L, sr_ticket_number#0L]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#0L) && isnotnull(sr_ticket_number#0L))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- 'Project [cs_item_sk#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- 'Filter (isnotnull(sum(cs_ext_list_price#190)#0) && (cast(sum(cs_ext_list_price#190)#0 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#512 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#513 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#514 as decimal(9,2)))), DecimalType(9,2)))#0)), DecimalType(21,2))))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- 'Aggregate [cs_item_sk#0], [cs_item_sk#0, MakeDecimal(sum(UnscaledValue(cs_ext_list_price#0)),17,2) AS sum(cs_ext_list_price#190)#0, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#0 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#0 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#0 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#512 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#513 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#514 as decimal(9,2)))), DecimalType(9,2)))#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- 'Project [cs_item_sk#0, cs_ext_list_price#0, cr_refunded_cash#0, cr_reversed_charge#0, cr_store_credit#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- 'Join Inner, ((cs_item_sk#0 = cr_item_sk#0) && (cs_order_number#0 = cr_order_number#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#0, cs_order_number#0, cs_ext_list_price#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_order_number#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#0, cr_order_number#0, cr_refunded_cash#0, cr_reversed_charge#0, cr_store_credit#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#0, d_year#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 1999)) && isnotnull(d_date_sk#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#0, s_store_name#0, s_zip#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#0) && isnotnull(s_zip#0)) && isnotnull(s_store_name#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, c_first_shipto_date_sk#0, c_first_sales_date_sk#0]
      :        :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#0) && isnotnull(c_first_sales_date_sk#0)) && isnotnull(c_first_shipto_date_sk#0)) && isnotnull(c_current_cdemo_sk#0)) && isnotnull(c_current_hdemo_sk#0)) && isnotnull(c_current_addr_sk#0))
      :        :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#0, d_year#0]
      :        :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#0)
      :        :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#0, d_year#0]
      :        :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#0)
      :        :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#0, cd_marital_status#0]
      :        :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#0) && isnotnull(cd_marital_status#0))
      :        :     :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
      :        :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#0, cd_marital_status#0]
      :        :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_marital_status#0) && isnotnull(cd_demo_sk#0))
      :        :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
      :        :     :     :     :     :     :     :     +- Project [p_promo_sk#0]
      :        :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#0)
      :        :     :     :     :     :     :     :           +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
      :        :     :     :     :     :     :     +- Project [hd_demo_sk#0, hd_income_band_sk#0]
      :        :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#0) && isnotnull(hd_income_band_sk#0))
      :        :     :     :     :     :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
      :        :     :     :     :     :     +- Project [hd_demo_sk#0, hd_income_band_sk#0]
      :        :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#0) && isnotnull(hd_income_band_sk#0))
      :        :     :     :     :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
      :        :     :     :     :     +- Project [ca_address_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
      :        :     :     :     :        +- Filter isnotnull(ca_address_sk#0)
      :        :     :     :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
      :        :     :     :     +- Project [ca_address_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
      :        :     :     :        +- Filter isnotnull(ca_address_sk#0)
      :        :     :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
      :        :     :     +- Project [ib_income_band_sk#0]
      :        :     :        +- Filter isnotnull(ib_income_band_sk#0)
      :        :     :           +- Relation[ib_income_band_sk#0,ib_lower_bound#0,ib_upper_bound#0] parquet
      :        :     +- Project [ib_income_band_sk#0]
      :        :        +- Filter isnotnull(ib_income_band_sk#0)
      :        :           +- Relation[ib_income_band_sk#0,ib_lower_bound#0,ib_upper_bound#0] parquet
      :        +- Project [i_item_sk#0, i_product_name#0]
      :           +- Filter ((((((isnotnull(i_current_price#0) && i_color#0 IN (purple,burlywood,indian,spring,floral,medium)) && (i_current_price#0 >= 64.00)) && (cast(i_current_price#0 as decimal(12,2)) <= 74.00)) && (cast(i_current_price#0 as decimal(12,2)) >= 65.00)) && (cast(i_current_price#0 as decimal(12,2)) <= 79.00)) && isnotnull(i_item_sk#0))
      :              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
      +- 'Aggregate [i_product_name#0, i_item_sk#0, s_store_name#0, s_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, d_year#0, d_year#0, d_year#0], [i_item_sk#0 AS item_sk#0, s_store_name#0 AS store_name#0, s_zip#0 AS store_zip#0, d_year#0 AS syear#0, count(1) AS cnt#0L, MakeDecimal(sum(UnscaledValue(ss_wholesale_cost#0)),17,2) AS s1#0, MakeDecimal(sum(UnscaledValue(ss_list_price#0)),17,2) AS s2#0, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#0)),17,2) AS s3#0]
         +- 'Project [ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, i_item_sk#0, i_product_name#0]
            +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
               :  +- 'Join Inner, (hd_income_band_sk#0 = ib_income_band_sk#0)
               :     :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, hd_income_band_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
               :     :  +- 'Join Inner, (hd_income_band_sk#0 = ib_income_band_sk#0)
               :     :     :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, d_year#0, d_year#0, hd_income_band_sk#0, hd_income_band_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
               :     :     :  +- 'Join Inner, (c_current_addr_sk#0 = ca_address_sk#0)
               :     :     :     :- 'Project [ss_item_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_addr_sk#0, d_year#0, d_year#0, hd_income_band_sk#0, hd_income_band_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
               :     :     :     :  +- 'Join Inner, (ss_addr_sk#0 = ca_address_sk#0)
               :     :     :     :     :- 'Project [ss_item_sk#0, ss_addr_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_addr_sk#0, d_year#0, d_year#0, hd_income_band_sk#0, hd_income_band_sk#0]
               :     :     :     :     :  +- 'Join Inner, (c_current_hdemo_sk#0 = hd_demo_sk#0)
               :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_addr_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0, hd_income_band_sk#0]
               :     :     :     :     :     :  +- 'Join Inner, (ss_hdemo_sk#0 = hd_demo_sk#0)
               :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0]
               :     :     :     :     :     :     :  +- 'Join Inner, (ss_promo_sk#0 = p_promo_sk#0)
               :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0]
               :     :     :     :     :     :     :     :  +- 'Join Inner, ((c_current_cdemo_sk#0 = cd_demo_sk#0) && NOT (cd_marital_status#0 = cd_marital_status#0))
               :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0, cd_marital_status#0]
               :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_cdemo_sk#0 = cd_demo_sk#0)
               :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, d_year#0, d_year#0]
               :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (c_first_shipto_date_sk#0 = d_date_sk#0)
               :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, c_first_shipto_date_sk#0, d_year#0]
               :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (c_first_sales_date_sk#0 = d_date_sk#0)
               :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, c_first_shipto_date_sk#0, c_first_sales_date_sk#0]
               :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_customer_sk#0 = c_customer_sk#0)
               :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0, s_store_name#0, s_zip#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0, d_year#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, (ss_item_sk#0 = cs_item_sk#0)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- 'Join Inner, ((cast(ss_item_sk#0 as bigint) = sr_item_sk#0L) && (cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_cdemo_sk#0, ss_hdemo_sk#0, ss_addr_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ticket_number#0, ss_wholesale_cost#0, ss_list_price#0, ss_coupon_amt#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter ((((((((isnotnull(ss_item_sk#0) && isnotnull(ss_ticket_number#0)) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_customer_sk#0)) && isnotnull(ss_cdemo_sk#0)) && isnotnull(ss_promo_sk#0)) && isnotnull(ss_hdemo_sk#0)) && isnotnull(ss_addr_sk#0))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#0L, sr_ticket_number#0L]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#0L) && isnotnull(sr_ticket_number#0L))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- 'Project [cs_item_sk#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- 'Filter (isnotnull(sum(cs_ext_list_price#190)#0) && (cast(sum(cs_ext_list_price#190)#0 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#512 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#513 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#514 as decimal(9,2)))), DecimalType(9,2)))#0)), DecimalType(21,2))))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- 'Aggregate [cs_item_sk#0], [cs_item_sk#0, MakeDecimal(sum(UnscaledValue(cs_ext_list_price#0)),17,2) AS sum(cs_ext_list_price#190)#0, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#0 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#0 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#0 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#512 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#513 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#514 as decimal(9,2)))), DecimalType(9,2)))#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- 'Project [cs_item_sk#0, cs_ext_list_price#0, cr_refunded_cash#0, cr_reversed_charge#0, cr_store_credit#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- 'Join Inner, ((cs_item_sk#0 = cr_item_sk#0) && (cs_order_number#0 = cr_order_number#0))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#0, cs_order_number#0, cs_ext_list_price#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_order_number#0))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#0, cr_order_number#0, cr_refunded_cash#0, cr_reversed_charge#0, cr_store_credit#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#0, d_year#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#0, s_store_name#0, s_zip#0]
               :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#0) && isnotnull(s_zip#0)) && isnotnull(s_store_name#0))
               :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#0, c_current_cdemo_sk#0, c_current_hdemo_sk#0, c_current_addr_sk#0, c_first_shipto_date_sk#0, c_first_sales_date_sk#0]
               :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#0) && isnotnull(c_first_sales_date_sk#0)) && isnotnull(c_first_shipto_date_sk#0)) && isnotnull(c_current_cdemo_sk#0)) && isnotnull(c_current_hdemo_sk#0)) && isnotnull(c_current_addr_sk#0))
               :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
               :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#0, d_year#0]
               :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#0)
               :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#0, d_year#0]
               :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#0)
               :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#0, cd_marital_status#0]
               :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#0) && isnotnull(cd_marital_status#0))
               :     :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
               :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#0, cd_marital_status#0]
               :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_marital_status#0) && isnotnull(cd_demo_sk#0))
               :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
               :     :     :     :     :     :     :     +- Project [p_promo_sk#0]
               :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#0)
               :     :     :     :     :     :     :           +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
               :     :     :     :     :     :     +- Project [hd_demo_sk#0, hd_income_band_sk#0]
               :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#0) && isnotnull(hd_income_band_sk#0))
               :     :     :     :     :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
               :     :     :     :     :     +- Project [hd_demo_sk#0, hd_income_band_sk#0]
               :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#0) && isnotnull(hd_income_band_sk#0))
               :     :     :     :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
               :     :     :     :     +- Project [ca_address_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
               :     :     :     :        +- Filter isnotnull(ca_address_sk#0)
               :     :     :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               :     :     :     +- Project [ca_address_sk#0, ca_street_number#0, ca_street_name#0, ca_city#0, ca_zip#0]
               :     :     :        +- Filter isnotnull(ca_address_sk#0)
               :     :     :           +- Relation[ca_address_sk#0,ca_address_id#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] parquet
               :     :     +- Project [ib_income_band_sk#0]
               :     :        +- Filter isnotnull(ib_income_band_sk#0)
               :     :           +- Relation[ib_income_band_sk#0,ib_lower_bound#0,ib_upper_bound#0] parquet
               :     +- Project [ib_income_band_sk#0]
               :        +- Filter isnotnull(ib_income_band_sk#0)
               :           +- Relation[ib_income_band_sk#0,ib_lower_bound#0,ib_upper_bound#0] parquet
               +- Project [i_item_sk#0, i_product_name#0]
                  +- Filter ((((((isnotnull(i_current_price#0) && i_color#0 IN (purple,burlywood,indian,spring,floral,medium)) && (i_current_price#0 >= 64.00)) && (cast(i_current_price#0 as decimal(12,2)) <= 74.00)) && (cast(i_current_price#0 as decimal(12,2)) >= 65.00)) && (cast(i_current_price#0 as decimal(12,2)) <= 79.00)) && isnotnull(i_item_sk#0))
                     +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q67a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [i_category#0 ASC NULLS FIRST, i_class#0 ASC NULLS FIRST, i_brand#0 ASC NULLS FIRST, i_product_name#0 ASC NULLS FIRST, d_year#0 ASC NULLS FIRST, d_qoy#0 ASC NULLS FIRST, d_moy#0 ASC NULLS FIRST, s_store_id#0 ASC NULLS FIRST, sumsales#0 ASC NULLS FIRST, rk#0 ASC NULLS FIRST], true
      +- 'Filter (isnotnull(rk#0) && (rk#0 <= 100))
         +- 'Window [rank(sumsales#0) windowspecdefinition(i_category#0, sumsales#0 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#0], [i_category#0], [sumsales#0 DESC NULLS LAST]
            +- 'Union
               :- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0], [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0, cast(sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), 0.00)) as decimal(38,2)) AS sumsales#0]
               :  +- 'Project [ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :     +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :        :- 'Project [ss_item_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0]
               :        :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :        :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0]
               :        :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :        :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0]
               :        :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
               :        :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :        :     :     +- Project [d_date_sk#0, d_year#0, d_moy#0, d_qoy#0]
               :        :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
               :        :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :        :     +- Project [s_store_sk#0, s_store_id#0]
               :        :        +- Filter isnotnull(s_store_sk#0)
               :        :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :        +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :           +- Filter isnotnull(i_item_sk#0)
               :              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0], [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, null AS s_store_id#0, sum(sumsales#0) AS sumsales#0]
               :  +- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0], [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), 0.00)) AS sumsales#0]
               :     +- 'Project [ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :        +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :           :- 'Project [ss_item_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0]
               :           :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :           :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :           :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0]
               :           :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
               :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :           :     :     +- Project [d_date_sk#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
               :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :           :     +- Project [s_store_sk#0, s_store_id#0]
               :           :        +- Filter isnotnull(s_store_sk#0)
               :           :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :           +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :              +- Filter isnotnull(i_item_sk#0)
               :                 +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0], [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, null AS d_moy#0, null AS s_store_id#0, sum(sumsales#0) AS sumsales#0]
               :  +- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0], [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), 0.00)) AS sumsales#0]
               :     +- 'Project [ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :        +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :           :- 'Project [ss_item_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0]
               :           :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :           :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :           :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0]
               :           :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
               :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :           :     :     +- Project [d_date_sk#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
               :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :           :     +- Project [s_store_sk#0, s_store_id#0]
               :           :        +- Filter isnotnull(s_store_sk#0)
               :           :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :           +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :              +- Filter isnotnull(i_item_sk#0)
               :                 +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0], [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, null AS d_qoy#0, null AS d_moy#0, null AS s_store_id#0, sum(sumsales#0) AS sumsales#0]
               :  +- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0], [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), 0.00)) AS sumsales#0]
               :     +- 'Project [ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :        +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :           :- 'Project [ss_item_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0]
               :           :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :           :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :           :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0]
               :           :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
               :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :           :     :     +- Project [d_date_sk#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
               :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :           :     +- Project [s_store_sk#0, s_store_id#0]
               :           :        +- Filter isnotnull(s_store_sk#0)
               :           :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :           +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :              +- Filter isnotnull(i_item_sk#0)
               :                 +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0], [i_category#0, i_class#0, i_brand#0, i_product_name#0, null AS d_year#0, null AS d_qoy#0, null AS d_moy#0, null AS s_store_id#0, sum(sumsales#0) AS sumsales#0]
               :  +- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0], [i_category#0, i_class#0, i_brand#0, i_product_name#0, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), 0.00)) AS sumsales#0]
               :     +- 'Project [ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :        +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :           :- 'Project [ss_item_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0]
               :           :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :           :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :           :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0]
               :           :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
               :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :           :     :     +- Project [d_date_sk#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
               :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :           :     +- Project [s_store_sk#0, s_store_id#0]
               :           :        +- Filter isnotnull(s_store_sk#0)
               :           :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :           +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :              +- Filter isnotnull(i_item_sk#0)
               :                 +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :- 'Aggregate [i_category#0, i_class#0, i_brand#0], [i_category#0, i_class#0, i_brand#0, null AS i_product_name#0, null AS d_year#0, null AS d_qoy#0, null AS d_moy#0, null AS s_store_id#0, sum(sumsales#0) AS sumsales#0]
               :  +- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0], [i_category#0, i_class#0, i_brand#0, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), 0.00)) AS sumsales#0]
               :     +- 'Project [ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :        +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :           :- 'Project [ss_item_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0]
               :           :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :           :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :           :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0]
               :           :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
               :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :           :     :     +- Project [d_date_sk#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
               :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :           :     +- Project [s_store_sk#0, s_store_id#0]
               :           :        +- Filter isnotnull(s_store_sk#0)
               :           :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :           +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :              +- Filter isnotnull(i_item_sk#0)
               :                 +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :- 'Aggregate [i_category#0, i_class#0], [i_category#0, i_class#0, null AS i_brand#0, null AS i_product_name#0, null AS d_year#0, null AS d_qoy#0, null AS d_moy#0, null AS s_store_id#0, sum(sumsales#0) AS sumsales#0]
               :  +- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0], [i_category#0, i_class#0, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), 0.00)) AS sumsales#0]
               :     +- 'Project [ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :        +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :           :- 'Project [ss_item_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0]
               :           :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :           :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :           :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0]
               :           :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
               :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :           :     :     +- Project [d_date_sk#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
               :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :           :     +- Project [s_store_sk#0, s_store_id#0]
               :           :        +- Filter isnotnull(s_store_sk#0)
               :           :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :           +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :              +- Filter isnotnull(i_item_sk#0)
               :                 +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :- 'Aggregate [i_category#0], [i_category#0, null AS i_class#0, null AS i_brand#0, null AS i_product_name#0, null AS d_year#0, null AS d_qoy#0, null AS d_moy#0, null AS s_store_id#0, sum(sumsales#0) AS sumsales#0]
               :  +- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0], [i_category#0, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), 0.00)) AS sumsales#0]
               :     +- 'Project [ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :        +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :           :- 'Project [ss_item_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0]
               :           :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
               :           :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :           :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0]
               :           :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
               :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :           :     :     +- Project [d_date_sk#0, d_year#0, d_moy#0, d_qoy#0]
               :           :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
               :           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :           :     +- Project [s_store_sk#0, s_store_id#0]
               :           :        +- Filter isnotnull(s_store_sk#0)
               :           :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
               :           +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
               :              +- Filter isnotnull(i_item_sk#0)
               :                 +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               +- 'Aggregate [null AS i_category#0, null AS i_class#0, null AS i_brand#0, null AS i_product_name#0, null AS d_year#0, null AS d_qoy#0, null AS d_moy#0, null AS s_store_id#0, sum(sumsales#0) AS sumsales#0]
                  +- 'Aggregate [i_category#0, i_class#0, i_brand#0, i_product_name#0, d_year#0, d_qoy#0, d_moy#0, s_store_id#0], [sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#0 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#0 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), 0.00)) AS sumsales#0]
                     +- 'Project [ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
                        +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                           :- 'Project [ss_item_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0, s_store_id#0]
                           :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                           :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0, d_year#0, d_moy#0, d_qoy#0]
                           :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                           :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_quantity#0, ss_sales_price#0]
                           :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0))
                           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                           :     :     +- Project [d_date_sk#0, d_year#0, d_moy#0, d_qoy#0]
                           :     :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                           :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                           :     +- Project [s_store_sk#0, s_store_id#0]
                           :        +- Filter isnotnull(s_store_sk#0)
                           :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                           +- Project [i_item_sk#0, i_brand#0, i_class#0, i_category#0, i_product_name#0]
                              +- Filter isnotnull(i_item_sk#0)
                                 +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q70a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [lochierarchy#0 DESC NULLS LAST, CASE WHEN (lochierarchy#0 = 0) THEN s_state#0 END ASC NULLS FIRST, rank_within_parent#0 ASC NULLS FIRST], true
      +- 'Project [total_sum#0, s_state#0, s_county#0, lochierarchy#0, rank_within_parent#0]
         +- 'Window [rank(total_sum#0) windowspecdefinition(lochierarchy#0, _w0#0, total_sum#0 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#0], [lochierarchy#0, _w0#0], [total_sum#0 DESC NULLS LAST]
            +- 'Aggregate [total_sum#0, s_state#0, s_county#0, g_state#0, g_county#0, lochierarchy#0], [total_sum#0, s_state#0, s_county#0, lochierarchy#0, CASE WHEN (g_county#0 = 0) THEN s_state#0 END AS _w0#0]
               +- 'Union
                  :- 'Aggregate [total_sum#0, s_state#0, s_county#0, g_state#0, g_county#0, lochierarchy#0], [total_sum#0, s_state#0, s_county#0, g_state#0, g_county#0, lochierarchy#0]
                  :  +- 'Union
                  :     :- 'Aggregate [s_state#0, s_county#0], [cast(MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) as decimal(27,2)) AS total_sum#0, s_state#0, s_county#0, 0 AS g_state#0, 0 AS g_county#0, 0 AS lochierarchy#0]
                  :     :  +- 'Project [ss_net_profit#0, s_county#0, s_state#0]
                  :     :     +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
                  :     :        :- 'Project [ss_store_sk#0, ss_net_profit#0]
                  :     :        :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                  :     :        :     :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_net_profit#0]
                  :     :        :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0))
                  :     :        :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :     :        :     +- Project [d_date_sk#0]
                  :     :        :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                  :     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     :        +- 'Join LeftSemi, (s_state#0 = s_state#0)
                  :     :           :- Project [s_store_sk#0, s_county#0, s_state#0]
                  :     :           :  +- Filter isnotnull(s_state#0)
                  :     :           :     +- Filter isnotnull(s_store_sk#0)
                  :     :           :        +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                  :     :           +- 'Project [s_state#0]
                  :     :              +- 'Filter isnotnull(s_state#0)
                  :     :                 +- 'Filter (isnotnull(ranking#0) && (ranking#0 <= 5))
                  :     :                    +- 'Window [rank(_w2#0) windowspecdefinition(s_state#0, _w2#0 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#0], [s_state#0], [_w2#0 DESC NULLS LAST]
                  :     :                       +- 'Aggregate [s_state#0], [s_state#0 AS s_state#0, s_state#0, MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS _w2#0]
                  :     :                          +- 'Project [ss_net_profit#0, s_state#0]
                  :     :                             +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                  :     :                                :- 'Project [ss_sold_date_sk#0, ss_net_profit#0, s_state#0]
                  :     :                                :  +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
                  :     :                                :     :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_net_profit#0]
                  :     :                                :     :  +- Filter (isnotnull(ss_store_sk#0) && isnotnull(ss_sold_date_sk#0))
                  :     :                                :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :     :                                :     +- Project [s_store_sk#0, s_state#0]
                  :     :                                :        +- Filter isnotnull(s_store_sk#0)
                  :     :                                :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                  :     :                                +- Project [d_date_sk#0]
                  :     :                                   +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                  :     :                                      +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     +- 'Aggregate [s_state#0], [sum(total_sum#0) AS total_sum#0, s_state#0, null AS s_county#0, 0 AS g_state#0, 1 AS g_county#0, 1 AS lochierarchy#0]
                  :        +- 'Aggregate [s_state#0, s_county#0], [MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS total_sum#0, s_state#0]
                  :           +- 'Project [ss_net_profit#0, s_county#0, s_state#0]
                  :              +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
                  :                 :- 'Project [ss_store_sk#0, ss_net_profit#0]
                  :                 :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                  :                 :     :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_net_profit#0]
                  :                 :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0))
                  :                 :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :                 :     +- Project [d_date_sk#0]
                  :                 :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                  :                 :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :                 +- 'Join LeftSemi, (s_state#0 = s_state#0)
                  :                    :- Project [s_store_sk#0, s_county#0, s_state#0]
                  :                    :  +- Filter isnotnull(s_state#0)
                  :                    :     +- Filter isnotnull(s_store_sk#0)
                  :                    :        +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                  :                    +- 'Project [s_state#0]
                  :                       +- 'Filter isnotnull(s_state#0)
                  :                          +- 'Filter (isnotnull(ranking#0) && (ranking#0 <= 5))
                  :                             +- 'Window [rank(_w2#0) windowspecdefinition(s_state#0, _w2#0 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#0], [s_state#0], [_w2#0 DESC NULLS LAST]
                  :                                +- 'Aggregate [s_state#0], [s_state#0 AS s_state#0, s_state#0, MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS _w2#0]
                  :                                   +- 'Project [ss_net_profit#0, s_state#0]
                  :                                      +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                  :                                         :- 'Project [ss_sold_date_sk#0, ss_net_profit#0, s_state#0]
                  :                                         :  +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
                  :                                         :     :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_net_profit#0]
                  :                                         :     :  +- Filter (isnotnull(ss_store_sk#0) && isnotnull(ss_sold_date_sk#0))
                  :                                         :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                  :                                         :     +- Project [s_store_sk#0, s_state#0]
                  :                                         :        +- Filter isnotnull(s_store_sk#0)
                  :                                         :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                  :                                         +- Project [d_date_sk#0]
                  :                                            +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                  :                                               +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  +- 'Aggregate [sum(total_sum#0) AS total_sum#0, null AS s_state#0, null AS s_county#0, 1 AS g_state#0, 1 AS g_county#0, 2 AS lochierarchy#0]
                     +- 'Aggregate [s_state#0, s_county#0], [MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS total_sum#0]
                        +- 'Project [ss_net_profit#0, s_county#0, s_state#0]
                           +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
                              :- 'Project [ss_store_sk#0, ss_net_profit#0]
                              :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                              :     :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_net_profit#0]
                              :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0))
                              :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                              :     +- Project [d_date_sk#0]
                              :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              +- 'Join LeftSemi, (s_state#0 = s_state#0)
                                 :- Project [s_store_sk#0, s_county#0, s_state#0]
                                 :  +- Filter isnotnull(s_state#0)
                                 :     +- Filter isnotnull(s_store_sk#0)
                                 :        +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                                 +- 'Project [s_state#0]
                                    +- 'Filter isnotnull(s_state#0)
                                       +- 'Filter (isnotnull(ranking#0) && (ranking#0 <= 5))
                                          +- 'Window [rank(_w2#0) windowspecdefinition(s_state#0, _w2#0 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#0], [s_state#0], [_w2#0 DESC NULLS LAST]
                                             +- 'Aggregate [s_state#0], [s_state#0 AS s_state#0, s_state#0, MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS _w2#0]
                                                +- 'Project [ss_net_profit#0, s_state#0]
                                                   +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                                                      :- 'Project [ss_sold_date_sk#0, ss_net_profit#0, s_state#0]
                                                      :  +- 'Join Inner, (s_store_sk#0 = ss_store_sk#0)
                                                      :     :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_net_profit#0]
                                                      :     :  +- Filter (isnotnull(ss_store_sk#0) && isnotnull(ss_sold_date_sk#0))
                                                      :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                                                      :     +- Project [s_store_sk#0, s_state#0]
                                                      :        +- Filter isnotnull(s_store_sk#0)
                                                      :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                                                      +- Project [d_date_sk#0]
                                                         +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                                                            +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q72
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [total_cnt#0L DESC NULLS LAST, i_item_desc#0 ASC NULLS FIRST, w_warehouse_name#0 ASC NULLS FIRST, d_week_seq#0 ASC NULLS FIRST], true
      +- 'Aggregate [i_item_desc#0, w_warehouse_name#0, d_week_seq#0], [i_item_desc#0, w_warehouse_name#0, d_week_seq#0, count(1) AS no_promo#0L, count(1) AS promo#0L, count(1) AS total_cnt#0L]
         +- 'Project [w_warehouse_name#0, i_item_desc#0, d_week_seq#0]
            +- 'Join LeftOuter, ((cr_item_sk#0 = cs_item_sk#0) && (cr_order_number#0 = cs_order_number#0))
               :- 'Project [cs_item_sk#0, cs_order_number#0, w_warehouse_name#0, i_item_desc#0, d_week_seq#0]
               :  +- 'Join LeftOuter, (cs_promo_sk#0 = p_promo_sk#0)
               :     :- 'Project [cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, w_warehouse_name#0, i_item_desc#0, d_week_seq#0]
               :     :  +- 'Join Inner, ((d_date#0 > cast(cast(d_date#0 as timestamp) + interval 5 days as date)) && (cs_ship_date_sk#0 = d_date_sk#0))
               :     :     :- 'Project [cs_ship_date_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, w_warehouse_name#0, i_item_desc#0, d_date#0, d_week_seq#0]
               :     :     :  +- 'Join Inner, ((d_week_seq#0 = d_week_seq#0) && (inv_date_sk#0 = d_date_sk#0))
               :     :     :     :- 'Project [cs_ship_date_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, inv_date_sk#0, w_warehouse_name#0, i_item_desc#0, d_date#0, d_week_seq#0]
               :     :     :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
               :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, inv_date_sk#0, w_warehouse_name#0, i_item_desc#0]
               :     :     :     :     :  +- 'Join Inner, (cs_bill_hdemo_sk#0 = hd_demo_sk#0)
               :     :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_bill_hdemo_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, inv_date_sk#0, w_warehouse_name#0, i_item_desc#0]
               :     :     :     :     :     :  +- 'Join Inner, (cs_bill_cdemo_sk#0 = cd_demo_sk#0)
               :     :     :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_bill_cdemo_sk#0, cs_bill_hdemo_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, inv_date_sk#0, w_warehouse_name#0, i_item_desc#0]
               :     :     :     :     :     :     :  +- 'Join Inner, (i_item_sk#0 = cs_item_sk#0)
               :     :     :     :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_bill_cdemo_sk#0, cs_bill_hdemo_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, inv_date_sk#0, w_warehouse_name#0]
               :     :     :     :     :     :     :     :  +- 'Join Inner, (w_warehouse_sk#0 = inv_warehouse_sk#0)
               :     :     :     :     :     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_bill_cdemo_sk#0, cs_bill_hdemo_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, inv_date_sk#0, inv_warehouse_sk#0]
               :     :     :     :     :     :     :     :     :  +- 'Join Inner, ((inv_quantity_on_hand#0 < cs_quantity#0) && (cs_item_sk#0 = inv_item_sk#0))
               :     :     :     :     :     :     :     :     :     :- Project [cs_sold_date_sk#0, cs_ship_date_sk#0, cs_bill_cdemo_sk#0, cs_bill_hdemo_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, cs_quantity#0]
               :     :     :     :     :     :     :     :     :     :  +- Filter (((((isnotnull(cs_quantity#0) && isnotnull(cs_item_sk#0)) && isnotnull(cs_bill_cdemo_sk#0)) && isnotnull(cs_bill_hdemo_sk#0)) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_ship_date_sk#0))
               :     :     :     :     :     :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
               :     :     :     :     :     :     :     :     :     +- Filter (((isnotnull(inv_quantity_on_hand#0) && isnotnull(inv_item_sk#0)) && isnotnull(inv_warehouse_sk#0)) && isnotnull(inv_date_sk#0))
               :     :     :     :     :     :     :     :     :        +- Relation[inv_date_sk#0,inv_item_sk#0,inv_warehouse_sk#0,inv_quantity_on_hand#0] parquet
               :     :     :     :     :     :     :     :     +- Project [w_warehouse_sk#0, w_warehouse_name#0]
               :     :     :     :     :     :     :     :        +- Filter isnotnull(w_warehouse_sk#0)
               :     :     :     :     :     :     :     :           +- Relation[w_warehouse_sk#0,w_warehouse_id#0,w_warehouse_name#0,w_warehouse_sq_ft#0,w_street_number#0,w_street_name#0,w_street_type#0,w_suite_number#0,w_city#0,w_county#0,w_state#0,w_zip#0,w_country#0,w_gmt_offset#0] parquet
               :     :     :     :     :     :     :     +- Project [i_item_sk#0, i_item_desc#0]
               :     :     :     :     :     :     :        +- Filter isnotnull(i_item_sk#0)
               :     :     :     :     :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               :     :     :     :     :     :     +- Project [cd_demo_sk#0]
               :     :     :     :     :     :        +- Filter ((isnotnull(cd_marital_status#0) && (cd_marital_status#0 = M)) && isnotnull(cd_demo_sk#0))
               :     :     :     :     :     :           +- Relation[cd_demo_sk#0,cd_gender#0,cd_marital_status#0,cd_education_status#0,cd_purchase_estimate#0,cd_credit_rating#0,cd_dep_count#0,cd_dep_employed_count#0,cd_dep_college_count#0] parquet
               :     :     :     :     :     +- Project [hd_demo_sk#0]
               :     :     :     :     :        +- Filter ((isnotnull(hd_buy_potential#0) && (hd_buy_potential#0 = 1001-5000)) && isnotnull(hd_demo_sk#0))
               :     :     :     :     :           +- Relation[hd_demo_sk#0,hd_income_band_sk#0,hd_buy_potential#0,hd_dep_count#0,hd_vehicle_count#0] parquet
               :     :     :     :     +- Project [d_date_sk#0, d_date#0, d_week_seq#0]
               :     :     :     :        +- Filter (((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0)) && isnotnull(d_week_seq#0))
               :     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     :     +- Project [d_date_sk#0, d_week_seq#0]
               :     :     :        +- Filter (isnotnull(d_week_seq#0) && isnotnull(d_date_sk#0))
               :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     :     +- Project [d_date_sk#0, d_date#0]
               :     :        +- Filter (isnotnull(d_date_sk#0) && isnotnull(d_date#0))
               :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- Project [p_promo_sk#0]
               :        +- Filter isnotnull(p_promo_sk#0)
               :           +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
               +- Project [cr_item_sk#0, cr_order_number#0]
                  +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
                     +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet


================================================================================================
q74
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [customer_first_name#0 ASC NULLS FIRST, customer_id#0 ASC NULLS FIRST, customer_last_name#0 ASC NULLS FIRST], true
      +- 'Project [customer_id#0, customer_first_name#0, customer_last_name#0]
         +- 'Join Inner, ((customer_id#0 = customer_id#0) && (CASE WHEN (year_total#0 > 0.00) THEN CheckOverflow((promote_precision(year_total#0) / promote_precision(year_total#0)), DecimalType(37,20)) ELSE null END > CASE WHEN (year_total#0 > 0.00) THEN CheckOverflow((promote_precision(year_total#0) / promote_precision(year_total#0)), DecimalType(37,20)) ELSE null END))
            :- 'Project [customer_id#0, year_total#0, customer_id#0, customer_first_name#0, customer_last_name#0, year_total#0, year_total#0]
            :  +- 'Join Inner, (customer_id#0 = customer_id#0)
            :     :- 'Join Inner, (customer_id#0 = customer_id#0)
            :     :  :- 'Union
            :     :  :  :- 'Filter isnotnull(customer_id#0)
            :     :  :  :  +- 'Filter (isnotnull(year_total#0) && (year_total#0 > 0.00))
            :     :  :  :     +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, d_year#0], [c_customer_id#0 AS customer_id#0, MakeDecimal(sum(UnscaledValue(ss_net_paid#0)),17,2) AS year_total#0]
            :     :  :  :        +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ss_net_paid#0, d_year#0]
            :     :  :  :           +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :  :  :              :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ss_sold_date_sk#0, ss_net_paid#0]
            :     :  :  :              :  +- 'Join Inner, (c_customer_sk#0 = ss_customer_sk#0)
            :     :  :  :              :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0]
            :     :  :  :              :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :     :  :  :              :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :     :  :  :              :     +- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_net_paid#0]
            :     :  :  :              :        +- Filter (isnotnull(ss_customer_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :  :  :              :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :  :  :              +- Project [d_date_sk#0, d_year#0]
            :     :  :  :                 +- Filter (((isnotnull(d_year#0) && d_year#0 IN (2001,2002)) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
            :     :  :  :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :  :  +- Filter isnotnull(customer_id#0)
            :     :  :     +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :     :  +- 'Union
            :     :     :- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, d_year#0], [c_customer_id#0 AS customer_id#0, c_first_name#0 AS customer_first_name#0, c_last_name#0 AS customer_last_name#0, MakeDecimal(sum(UnscaledValue(ss_net_paid#0)),17,2) AS year_total#0]
            :     :     :  +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ss_net_paid#0, d_year#0]
            :     :     :     +- 'Filter isnotnull(c_customer_id#0)
            :     :     :        +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :           :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ss_sold_date_sk#0, ss_net_paid#0]
            :     :     :           :  +- 'Join Inner, (c_customer_sk#0 = ss_customer_sk#0)
            :     :     :           :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0]
            :     :     :           :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :     :     :           :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :     :     :           :     +- Project [ss_sold_date_sk#0, ss_customer_sk#0, ss_net_paid#0]
            :     :     :           :        +- Filter (isnotnull(ss_customer_sk#0) && isnotnull(ss_sold_date_sk#0))
            :     :     :           :           +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :           +- Project [d_date_sk#0, d_year#0]
            :     :     :              +- Filter (((isnotnull(d_year#0) && d_year#0 IN (2001,2002)) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :     :     :                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     +- Filter isnotnull(customer_id#0)
            :     :        +- LocalRelation <empty>, [customer_id#0, customer_first_name#0, customer_last_name#0, year_total#0]
            :     +- 'Union
            :        :- Filter isnotnull(customer_id#0)
            :        :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
            :        +- 'Filter isnotnull(customer_id#0)
            :           +- 'Filter (isnotnull(year_total#0) && (year_total#0 > 0.00))
            :              +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, d_year#0], [c_customer_id#0 AS customer_id#0, MakeDecimal(sum(UnscaledValue(ws_net_paid#0)),17,2) AS year_total#0]
            :                 +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ws_net_paid#0, d_year#0]
            :                    +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :                       :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ws_sold_date_sk#0, ws_net_paid#0]
            :                       :  +- 'Join Inner, (c_customer_sk#0 = ws_bill_customer_sk#0)
            :                       :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0]
            :                       :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
            :                       :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
            :                       :     +- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0, ws_net_paid#0]
            :                       :        +- Filter (isnotnull(ws_bill_customer_sk#0) && isnotnull(ws_sold_date_sk#0))
            :                       :           +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                       +- Project [d_date_sk#0, d_year#0]
            :                          +- Filter (((isnotnull(d_year#0) && d_year#0 IN (2001,2002)) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
            :                             +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            +- 'Union
               :- Filter isnotnull(customer_id#0)
               :  +- LocalRelation <empty>, [customer_id#0, year_total#0]
               +- 'Aggregate [c_customer_id#0, c_first_name#0, c_last_name#0, d_year#0], [c_customer_id#0 AS customer_id#0, MakeDecimal(sum(UnscaledValue(ws_net_paid#0)),17,2) AS year_total#0]
                  +- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ws_net_paid#0, d_year#0]
                     +- 'Filter isnotnull(c_customer_id#0)
                        +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                           :- 'Project [c_customer_id#0, c_first_name#0, c_last_name#0, ws_sold_date_sk#0, ws_net_paid#0]
                           :  +- 'Join Inner, (c_customer_sk#0 = ws_bill_customer_sk#0)
                           :     :- Project [c_customer_sk#0, c_customer_id#0, c_first_name#0, c_last_name#0]
                           :     :  +- Filter (isnotnull(c_customer_sk#0) && isnotnull(c_customer_id#0))
                           :     :     +- Relation[c_customer_sk#0,c_customer_id#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0,c_first_shipto_date_sk#0,c_first_sales_date_sk#0,c_salutation#0,c_first_name#0,c_last_name#0,c_preferred_cust_flag#0,c_birth_day#0,c_birth_month#0,c_birth_year#0,c_birth_country#0,c_login#0,c_email_address#0,c_last_review_date#0] parquet
                           :     +- Project [ws_sold_date_sk#0, ws_bill_customer_sk#0, ws_net_paid#0]
                           :        +- Filter (isnotnull(ws_bill_customer_sk#0) && isnotnull(ws_sold_date_sk#0))
                           :           +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                           +- Project [d_date_sk#0, d_year#0]
                              +- Filter (((isnotnull(d_year#0) && d_year#0 IN (2001,2002)) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
                                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q75
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [sales_cnt_diff#0L ASC NULLS FIRST, sales_amt_diff#0 ASC NULLS FIRST], true
      +- 'Project [d_year#0 AS prev_year#0, d_year#0 AS year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0L AS prev_yr_cnt#0L, sales_cnt#0L AS curr_yr_cnt#0L, (sales_cnt#0L - sales_cnt#0L) AS sales_cnt_diff#0L, CheckOverflow((promote_precision(cast(sales_amt#0 as decimal(19,2))) - promote_precision(cast(sales_amt#0 as decimal(19,2)))), DecimalType(19,2)) AS sales_amt_diff#0]
         +- 'Join Inner, (((((i_brand_id#0 = i_brand_id#0) && (i_class_id#0 = i_class_id#0)) && (i_category_id#0 = i_category_id#0)) && (i_manufact_id#0 = i_manufact_id#0)) && (CheckOverflow((promote_precision(cast(sales_cnt#0L as decimal(17,2))) / promote_precision(cast(sales_cnt#0L as decimal(17,2)))), DecimalType(37,20)) < 0.90000000000000000000))
            :- 'Aggregate [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0], [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sum(cast(sales_cnt#0 as bigint)) AS sales_cnt#0L, MakeDecimal(sum(UnscaledValue(sales_amt#0)),18,2) AS sales_amt#0]
            :  +- 'Aggregate [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0], [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0]
            :     +- 'Union
            :        :- 'Aggregate [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0], [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0]
            :        :  +- 'Union
            :        :     :- 'Project [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, (cs_quantity#0 - coalesce(cr_return_quantity#0, 0)) AS sales_cnt#0, CheckOverflow((promote_precision(cast(cs_ext_sales_price#0 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#0, 0.00) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#0]
            :        :     :  +- 'Join LeftOuter, ((cs_order_number#0 = cr_order_number#0) && (cs_item_sk#0 = cr_item_sk#0))
            :        :     :     :- 'Project [cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, d_year#0]
            :        :     :     :  +- 'Join Inner, (d_date_sk#0 = cs_sold_date_sk#0)
            :        :     :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
            :        :     :     :     :  +- 'Join Inner, (i_item_sk#0 = cs_item_sk#0)
            :        :     :     :     :     :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_ext_sales_price#0]
            :        :     :     :     :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
            :        :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :        :     :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
            :        :     :     :     :        +- Filter ((((((isnotnull(i_category#0) && (i_category#0 = Books)) && isnotnull(i_item_sk#0)) && isnotnull(i_class_id#0)) && isnotnull(i_brand_id#0)) && isnotnull(i_manufact_id#0)) && isnotnull(i_category_id#0))
            :        :     :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :        :     :     :     +- Project [d_date_sk#0, d_year#0]
            :        :     :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :        :     :     +- Project [cr_item_sk#0, cr_order_number#0, cr_return_quantity#0, cr_return_amount#0]
            :        :     :        +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
            :        :     :           +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
            :        :     +- 'Project [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, (ss_quantity#0 - coalesce(sr_return_quantity#0, 0)) AS sales_cnt#0, CheckOverflow((promote_precision(cast(ss_ext_sales_price#0 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#0, 0.00) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#0]
            :        :        +- 'Join LeftOuter, ((cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L))
            :        :           :- 'Project [ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, d_year#0]
            :        :           :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
            :        :           :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
            :        :           :     :  +- 'Join Inner, (i_item_sk#0 = ss_item_sk#0)
            :        :           :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_ext_sales_price#0]
            :        :           :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
            :        :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :        :           :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
            :        :           :     :        +- Filter ((((((isnotnull(i_category#0) && (i_category#0 = Books)) && isnotnull(i_item_sk#0)) && isnotnull(i_class_id#0)) && isnotnull(i_brand_id#0)) && isnotnull(i_manufact_id#0)) && isnotnull(i_category_id#0))
            :        :           :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :        :           :     +- Project [d_date_sk#0, d_year#0]
            :        :           :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :        :           :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :        :           +- Project [sr_item_sk#0L, sr_ticket_number#0L, sr_return_quantity#0, sr_return_amt#0]
            :        :              +- Filter (isnotnull(sr_ticket_number#0L) && isnotnull(sr_item_sk#0L))
            :        :                 +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
            :        +- 'Project [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, (ws_quantity#0 - coalesce(wr_return_quantity#0, 0)) AS sales_cnt#0, CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#0, 0.00) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#0]
            :           +- 'Join LeftOuter, ((cast(ws_order_number#0 as bigint) = wr_order_number#0L) && (cast(ws_item_sk#0 as bigint) = wr_item_sk#0L))
            :              :- 'Project [ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, d_year#0]
            :              :  +- 'Join Inner, (d_date_sk#0 = ws_sold_date_sk#0)
            :              :     :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
            :              :     :  +- 'Join Inner, (i_item_sk#0 = ws_item_sk#0)
            :              :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_ext_sales_price#0]
            :              :     :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
            :              :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :              :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
            :              :     :        +- Filter ((((((isnotnull(i_category#0) && (i_category#0 = Books)) && isnotnull(i_item_sk#0)) && isnotnull(i_class_id#0)) && isnotnull(i_brand_id#0)) && isnotnull(i_manufact_id#0)) && isnotnull(i_category_id#0))
            :              :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :     +- Project [d_date_sk#0, d_year#0]
            :              :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2002)) && isnotnull(d_date_sk#0))
            :              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              +- Project [wr_item_sk#0L, wr_order_number#0L, wr_return_quantity#0, wr_return_amt#0]
            :                 +- Filter (isnotnull(wr_item_sk#0L) && isnotnull(wr_order_number#0L))
            :                    +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
            +- 'Aggregate [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0], [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sum(cast(sales_cnt#0 as bigint)) AS sales_cnt#0L, MakeDecimal(sum(UnscaledValue(sales_amt#0)),18,2) AS sales_amt#0]
               +- 'Aggregate [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0], [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0]
                  +- 'Union
                     :- 'Aggregate [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0], [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, sales_cnt#0, sales_amt#0]
                     :  +- 'Union
                     :     :- 'Project [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, (cs_quantity#0 - coalesce(cr_return_quantity#0, 0)) AS sales_cnt#0, CheckOverflow((promote_precision(cast(cs_ext_sales_price#0 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#0, 0.00) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#0]
                     :     :  +- 'Join LeftOuter, ((cs_order_number#0 = cr_order_number#0) && (cs_item_sk#0 = cr_item_sk#0))
                     :     :     :- 'Project [cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, d_year#0]
                     :     :     :  +- 'Join Inner, (d_date_sk#0 = cs_sold_date_sk#0)
                     :     :     :     :- 'Project [cs_sold_date_sk#0, cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
                     :     :     :     :  +- 'Join Inner, (i_item_sk#0 = cs_item_sk#0)
                     :     :     :     :     :- Project [cs_sold_date_sk#0, cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_ext_sales_price#0]
                     :     :     :     :     :  +- Filter (isnotnull(cs_item_sk#0) && isnotnull(cs_sold_date_sk#0))
                     :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                     :     :     :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
                     :     :     :     :        +- Filter ((((((isnotnull(i_category#0) && (i_category#0 = Books)) && isnotnull(i_item_sk#0)) && isnotnull(i_class_id#0)) && isnotnull(i_manufact_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_brand_id#0))
                     :     :     :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :     :     :     +- Project [d_date_sk#0, d_year#0]
                     :     :     :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                     :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :     :     +- Project [cr_item_sk#0, cr_order_number#0, cr_return_quantity#0, cr_return_amount#0]
                     :     :        +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
                     :     :           +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
                     :     +- 'Project [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, (ss_quantity#0 - coalesce(sr_return_quantity#0, 0)) AS sales_cnt#0, CheckOverflow((promote_precision(cast(ss_ext_sales_price#0 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#0, 0.00) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#0]
                     :        +- 'Join LeftOuter, ((cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L))
                     :           :- 'Project [ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, d_year#0]
                     :           :  +- 'Join Inner, (d_date_sk#0 = ss_sold_date_sk#0)
                     :           :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
                     :           :     :  +- 'Join Inner, (i_item_sk#0 = ss_item_sk#0)
                     :           :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ticket_number#0, ss_quantity#0, ss_ext_sales_price#0]
                     :           :     :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
                     :           :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                     :           :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
                     :           :     :        +- Filter ((((((isnotnull(i_category#0) && (i_category#0 = Books)) && isnotnull(i_item_sk#0)) && isnotnull(i_class_id#0)) && isnotnull(i_manufact_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_brand_id#0))
                     :           :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :           :     +- Project [d_date_sk#0, d_year#0]
                     :           :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                     :           :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :           +- Project [sr_item_sk#0L, sr_ticket_number#0L, sr_return_quantity#0, sr_return_amt#0]
                     :              +- Filter (isnotnull(sr_ticket_number#0L) && isnotnull(sr_item_sk#0L))
                     :                 +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
                     +- 'Project [d_year#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, (ws_quantity#0 - coalesce(wr_return_quantity#0, 0)) AS sales_cnt#0, CheckOverflow((promote_precision(cast(ws_ext_sales_price#0 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#0, 0.00) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#0]
                        +- 'Join LeftOuter, ((cast(ws_order_number#0 as bigint) = wr_order_number#0L) && (cast(ws_item_sk#0 as bigint) = wr_item_sk#0L))
                           :- 'Project [ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0, d_year#0]
                           :  +- 'Join Inner, (d_date_sk#0 = ws_sold_date_sk#0)
                           :     :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_ext_sales_price#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
                           :     :  +- 'Join Inner, (i_item_sk#0 = ws_item_sk#0)
                           :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_order_number#0, ws_quantity#0, ws_ext_sales_price#0]
                           :     :     :  +- Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
                           :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                           :     :     +- Project [i_item_sk#0, i_brand_id#0, i_class_id#0, i_category_id#0, i_manufact_id#0]
                           :     :        +- Filter ((((((isnotnull(i_category#0) && (i_category#0 = Books)) && isnotnull(i_item_sk#0)) && isnotnull(i_class_id#0)) && isnotnull(i_manufact_id#0)) && isnotnull(i_category_id#0)) && isnotnull(i_brand_id#0))
                           :     :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                           :     +- Project [d_date_sk#0, d_year#0]
                           :        +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2001)) && isnotnull(d_date_sk#0))
                           :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                           +- Project [wr_item_sk#0L, wr_order_number#0L, wr_return_quantity#0, wr_return_amt#0]
                              +- Filter (isnotnull(wr_item_sk#0L) && isnotnull(wr_order_number#0L))
                                 +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet


================================================================================================
q77a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [channel#0 ASC NULLS FIRST, id#0 ASC NULLS FIRST], true
      +- 'Aggregate [channel#0, id#0, sales#0, returns#0, profit#0], [channel#0, id#0, sales#0, returns#0, profit#0]
         +- 'Union
            :- 'Aggregate [channel#0, id#0, sales#0, returns#0, profit#0], [channel#0, id#0, sales#0, returns#0, profit#0]
            :  +- 'Union
            :     :- 'Aggregate [channel#0, id#0], [channel#0, id#0, cast(sum(sales#0) as decimal(37,2)) AS sales#0, cast(sum(returns#0) as decimal(37,2)) AS returns#0, cast(sum(profit#0) as decimal(38,2)) AS profit#0]
            :     :  +- 'Union
            :     :     :- 'Project [store channel AS channel#0, s_store_sk#0 AS id#0, sales#0, coalesce(returns#0, 0.00) AS returns#0, CheckOverflow((promote_precision(cast(profit#0 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#0, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
            :     :     :  +- 'Join LeftOuter, (s_store_sk#0 = s_store_sk#0)
            :     :     :     :- 'Aggregate [s_store_sk#0], [s_store_sk#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS profit#0]
            :     :     :     :  +- 'Project [ss_ext_sales_price#0, ss_net_profit#0, s_store_sk#0]
            :     :     :     :     +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
            :     :     :     :        :- 'Project [ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
            :     :     :     :        :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :        :     :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
            :     :     :     :        :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0))
            :     :     :     :        :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :     :        :     +- Project [d_date_sk#0]
            :     :     :     :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :     :     :     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     :        +- Project [s_store_sk#0]
            :     :     :     :           +- Filter isnotnull(s_store_sk#0)
            :     :     :     :              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :     :     :     +- 'Aggregate [s_store_sk#0], [s_store_sk#0, MakeDecimal(sum(UnscaledValue(sr_return_amt#0)),17,2) AS returns#0, MakeDecimal(sum(UnscaledValue(sr_net_loss#0)),17,2) AS profit_loss#0]
            :     :     :        +- 'Project [sr_return_amt#0, sr_net_loss#0, s_store_sk#0]
            :     :     :           +- 'Join Inner, (sr_store_sk#0L = cast(s_store_sk#0 as bigint))
            :     :     :              :- 'Project [sr_store_sk#0L, sr_return_amt#0, sr_net_loss#0]
            :     :     :              :  +- 'Join Inner, (sr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
            :     :     :              :     :- Project [sr_returned_date_sk#0L, sr_store_sk#0L, sr_return_amt#0, sr_net_loss#0]
            :     :     :              :     :  +- Filter (isnotnull(sr_returned_date_sk#0L) && isnotnull(sr_store_sk#0L))
            :     :     :              :     :     +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
            :     :     :              :     +- Project [d_date_sk#0]
            :     :     :              :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :     :     :              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :              +- Project [s_store_sk#0]
            :     :     :                 +- Filter isnotnull(s_store_sk#0)
            :     :     :                    +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :     :     :- 'Project [catalog channel AS channel#0, cs_call_center_sk#0 AS id#0, sales#0, returns#0, CheckOverflow((promote_precision(cast(profit#0 as decimal(18,2))) - promote_precision(cast(profit_loss#0 as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
            :     :     :  +- 'Join Inner
            :     :     :     :- 'Aggregate [cs_call_center_sk#0], [cs_call_center_sk#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(cs_net_profit#0)),17,2) AS profit#0]
            :     :     :     :  +- 'Project [cs_call_center_sk#0, cs_ext_sales_price#0, cs_net_profit#0]
            :     :     :     :     +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :     :        :- Project [cs_sold_date_sk#0, cs_call_center_sk#0, cs_ext_sales_price#0, cs_net_profit#0]
            :     :     :     :        :  +- Filter isnotnull(cs_sold_date_sk#0)
            :     :     :     :        :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :     :        +- Project [d_date_sk#0]
            :     :     :     :           +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :     :     :     :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :     +- 'Aggregate [MakeDecimal(sum(UnscaledValue(cr_return_amount#0)),17,2) AS returns#0, MakeDecimal(sum(UnscaledValue(cr_net_loss#0)),17,2) AS profit_loss#0]
            :     :     :        +- 'Project [cr_return_amount#0, cr_net_loss#0]
            :     :     :           +- 'Join Inner, (cr_returned_date_sk#0 = d_date_sk#0)
            :     :     :              :- Project [cr_returned_date_sk#0, cr_return_amount#0, cr_net_loss#0]
            :     :     :              :  +- Filter isnotnull(cr_returned_date_sk#0)
            :     :     :              :     +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
            :     :     :              +- Project [d_date_sk#0]
            :     :     :                 +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :     :     :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     +- 'Project [web channel AS channel#0, wp_web_page_sk#0 AS id#0, sales#0, coalesce(returns#0, 0.00) AS returns#0, CheckOverflow((promote_precision(cast(profit#0 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#0, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
            :     :        +- 'Join LeftOuter, (wp_web_page_sk#0 = wp_web_page_sk#0)
            :     :           :- 'Aggregate [wp_web_page_sk#0], [wp_web_page_sk#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(ws_net_profit#0)),17,2) AS profit#0]
            :     :           :  +- 'Project [ws_ext_sales_price#0, ws_net_profit#0, wp_web_page_sk#0]
            :     :           :     +- 'Join Inner, (ws_web_page_sk#0 = wp_web_page_sk#0)
            :     :           :        :- 'Project [ws_web_page_sk#0, ws_ext_sales_price#0, ws_net_profit#0]
            :     :           :        :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :           :        :     :- Project [ws_sold_date_sk#0, ws_web_page_sk#0, ws_ext_sales_price#0, ws_net_profit#0]
            :     :           :        :     :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_web_page_sk#0))
            :     :           :        :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :           :        :     +- Project [d_date_sk#0]
            :     :           :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :     :           :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :           :        +- Project [wp_web_page_sk#0]
            :     :           :           +- Filter isnotnull(wp_web_page_sk#0)
            :     :           :              +- Relation[wp_web_page_sk#0,wp_web_page_id#0,wp_rec_start_date#0,wp_rec_end_date#0,wp_creation_date_sk#0,wp_access_date_sk#0,wp_autogen_flag#0,wp_customer_sk#0,wp_url#0,wp_type#0,wp_char_count#0,wp_link_count#0,wp_image_count#0,wp_max_ad_count#0] parquet
            :     :           +- 'Aggregate [wp_web_page_sk#0], [wp_web_page_sk#0, MakeDecimal(sum(UnscaledValue(wr_return_amt#0)),17,2) AS returns#0, MakeDecimal(sum(UnscaledValue(wr_net_loss#0)),17,2) AS profit_loss#0]
            :     :              +- 'Project [wr_return_amt#0, wr_net_loss#0, wp_web_page_sk#0]
            :     :                 +- 'Join Inner, (wr_web_page_sk#0L = cast(wp_web_page_sk#0 as bigint))
            :     :                    :- 'Project [wr_web_page_sk#0L, wr_return_amt#0, wr_net_loss#0]
            :     :                    :  +- 'Join Inner, (wr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
            :     :                    :     :- Project [wr_returned_date_sk#0L, wr_web_page_sk#0L, wr_return_amt#0, wr_net_loss#0]
            :     :                    :     :  +- Filter (isnotnull(wr_returned_date_sk#0L) && isnotnull(wr_web_page_sk#0L))
            :     :                    :     :     +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
            :     :                    :     +- Project [d_date_sk#0]
            :     :                    :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :     :                    :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :                    +- Project [wp_web_page_sk#0]
            :     :                       +- Filter isnotnull(wp_web_page_sk#0)
            :     :                          +- Relation[wp_web_page_sk#0,wp_web_page_id#0,wp_rec_start_date#0,wp_rec_end_date#0,wp_creation_date_sk#0,wp_access_date_sk#0,wp_autogen_flag#0,wp_customer_sk#0,wp_url#0,wp_type#0,wp_char_count#0,wp_link_count#0,wp_image_count#0,wp_max_ad_count#0] parquet
            :     +- 'Aggregate [channel#0], [channel#0, null AS id#0, sum(sales#0) AS sales#0, sum(returns#0) AS returns#0, sum(profit#0) AS profit#0]
            :        +- 'Aggregate [channel#0, id#0], [channel#0, sum(sales#0) AS sales#0, sum(returns#0) AS returns#0, sum(profit#0) AS profit#0]
            :           +- 'Union
            :              :- 'Project [store channel AS channel#0, s_store_sk#0 AS id#0, sales#0, coalesce(returns#0, 0.00) AS returns#0, CheckOverflow((promote_precision(cast(profit#0 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#0, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
            :              :  +- 'Join LeftOuter, (s_store_sk#0 = s_store_sk#0)
            :              :     :- 'Aggregate [s_store_sk#0], [s_store_sk#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS profit#0]
            :              :     :  +- 'Project [ss_ext_sales_price#0, ss_net_profit#0, s_store_sk#0]
            :              :     :     +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
            :              :     :        :- 'Project [ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
            :              :     :        :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :              :     :        :     :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
            :              :     :        :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0))
            :              :     :        :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :              :     :        :     +- Project [d_date_sk#0]
            :              :     :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :              :     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :     :        +- Project [s_store_sk#0]
            :              :     :           +- Filter isnotnull(s_store_sk#0)
            :              :     :              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :              :     +- 'Aggregate [s_store_sk#0], [s_store_sk#0, MakeDecimal(sum(UnscaledValue(sr_return_amt#0)),17,2) AS returns#0, MakeDecimal(sum(UnscaledValue(sr_net_loss#0)),17,2) AS profit_loss#0]
            :              :        +- 'Project [sr_return_amt#0, sr_net_loss#0, s_store_sk#0]
            :              :           +- 'Join Inner, (sr_store_sk#0L = cast(s_store_sk#0 as bigint))
            :              :              :- 'Project [sr_store_sk#0L, sr_return_amt#0, sr_net_loss#0]
            :              :              :  +- 'Join Inner, (sr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
            :              :              :     :- Project [sr_returned_date_sk#0L, sr_store_sk#0L, sr_return_amt#0, sr_net_loss#0]
            :              :              :     :  +- Filter (isnotnull(sr_returned_date_sk#0L) && isnotnull(sr_store_sk#0L))
            :              :              :     :     +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
            :              :              :     +- Project [d_date_sk#0]
            :              :              :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :              :              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :              +- Project [s_store_sk#0]
            :              :                 +- Filter isnotnull(s_store_sk#0)
            :              :                    +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :              :- 'Project [catalog channel AS channel#0, cs_call_center_sk#0 AS id#0, sales#0, returns#0, CheckOverflow((promote_precision(cast(profit#0 as decimal(18,2))) - promote_precision(cast(profit_loss#0 as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
            :              :  +- 'Join Inner
            :              :     :- 'Aggregate [cs_call_center_sk#0], [cs_call_center_sk#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(cs_net_profit#0)),17,2) AS profit#0]
            :              :     :  +- 'Project [cs_call_center_sk#0, cs_ext_sales_price#0, cs_net_profit#0]
            :              :     :     +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :              :     :        :- Project [cs_sold_date_sk#0, cs_call_center_sk#0, cs_ext_sales_price#0, cs_net_profit#0]
            :              :     :        :  +- Filter isnotnull(cs_sold_date_sk#0)
            :              :     :        :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :              :     :        +- Project [d_date_sk#0]
            :              :     :           +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :              :     :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :     +- 'Aggregate [MakeDecimal(sum(UnscaledValue(cr_return_amount#0)),17,2) AS returns#0, MakeDecimal(sum(UnscaledValue(cr_net_loss#0)),17,2) AS profit_loss#0]
            :              :        +- 'Project [cr_return_amount#0, cr_net_loss#0]
            :              :           +- 'Join Inner, (cr_returned_date_sk#0 = d_date_sk#0)
            :              :              :- Project [cr_returned_date_sk#0, cr_return_amount#0, cr_net_loss#0]
            :              :              :  +- Filter isnotnull(cr_returned_date_sk#0)
            :              :              :     +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
            :              :              +- Project [d_date_sk#0]
            :              :                 +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :              :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              +- 'Project [web channel AS channel#0, wp_web_page_sk#0 AS id#0, sales#0, coalesce(returns#0, 0.00) AS returns#0, CheckOverflow((promote_precision(cast(profit#0 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#0, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
            :                 +- 'Join LeftOuter, (wp_web_page_sk#0 = wp_web_page_sk#0)
            :                    :- 'Aggregate [wp_web_page_sk#0], [wp_web_page_sk#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(ws_net_profit#0)),17,2) AS profit#0]
            :                    :  +- 'Project [ws_ext_sales_price#0, ws_net_profit#0, wp_web_page_sk#0]
            :                    :     +- 'Join Inner, (ws_web_page_sk#0 = wp_web_page_sk#0)
            :                    :        :- 'Project [ws_web_page_sk#0, ws_ext_sales_price#0, ws_net_profit#0]
            :                    :        :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :                    :        :     :- Project [ws_sold_date_sk#0, ws_web_page_sk#0, ws_ext_sales_price#0, ws_net_profit#0]
            :                    :        :     :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_web_page_sk#0))
            :                    :        :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                    :        :     +- Project [d_date_sk#0]
            :                    :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :                    :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                    :        +- Project [wp_web_page_sk#0]
            :                    :           +- Filter isnotnull(wp_web_page_sk#0)
            :                    :              +- Relation[wp_web_page_sk#0,wp_web_page_id#0,wp_rec_start_date#0,wp_rec_end_date#0,wp_creation_date_sk#0,wp_access_date_sk#0,wp_autogen_flag#0,wp_customer_sk#0,wp_url#0,wp_type#0,wp_char_count#0,wp_link_count#0,wp_image_count#0,wp_max_ad_count#0] parquet
            :                    +- 'Aggregate [wp_web_page_sk#0], [wp_web_page_sk#0, MakeDecimal(sum(UnscaledValue(wr_return_amt#0)),17,2) AS returns#0, MakeDecimal(sum(UnscaledValue(wr_net_loss#0)),17,2) AS profit_loss#0]
            :                       +- 'Project [wr_return_amt#0, wr_net_loss#0, wp_web_page_sk#0]
            :                          +- 'Join Inner, (wr_web_page_sk#0L = cast(wp_web_page_sk#0 as bigint))
            :                             :- 'Project [wr_web_page_sk#0L, wr_return_amt#0, wr_net_loss#0]
            :                             :  +- 'Join Inner, (wr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
            :                             :     :- Project [wr_returned_date_sk#0L, wr_web_page_sk#0L, wr_return_amt#0, wr_net_loss#0]
            :                             :     :  +- Filter (isnotnull(wr_returned_date_sk#0L) && isnotnull(wr_web_page_sk#0L))
            :                             :     :     +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
            :                             :     +- Project [d_date_sk#0]
            :                             :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :                             :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                             +- Project [wp_web_page_sk#0]
            :                                +- Filter isnotnull(wp_web_page_sk#0)
            :                                   +- Relation[wp_web_page_sk#0,wp_web_page_id#0,wp_rec_start_date#0,wp_rec_end_date#0,wp_creation_date_sk#0,wp_access_date_sk#0,wp_autogen_flag#0,wp_customer_sk#0,wp_url#0,wp_type#0,wp_char_count#0,wp_link_count#0,wp_image_count#0,wp_max_ad_count#0] parquet
            +- 'Aggregate [null AS channel#0, null AS id#0, sum(sales#0) AS sales#0, sum(returns#0) AS returns#0, sum(profit#0) AS profit#0]
               +- 'Aggregate [channel#0, id#0], [sum(sales#0) AS sales#0, sum(returns#0) AS returns#0, sum(profit#0) AS profit#0]
                  +- 'Union
                     :- 'Project [store channel AS channel#0, s_store_sk#0 AS id#0, sales#0, coalesce(returns#0, 0.00) AS returns#0, CheckOverflow((promote_precision(cast(profit#0 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#0, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
                     :  +- 'Join LeftOuter, (s_store_sk#0 = s_store_sk#0)
                     :     :- 'Aggregate [s_store_sk#0], [s_store_sk#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(ss_net_profit#0)),17,2) AS profit#0]
                     :     :  +- 'Project [ss_ext_sales_price#0, ss_net_profit#0, s_store_sk#0]
                     :     :     +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                     :     :        :- 'Project [ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
                     :     :        :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                     :     :        :     :- Project [ss_sold_date_sk#0, ss_store_sk#0, ss_ext_sales_price#0, ss_net_profit#0]
                     :     :        :     :  +- Filter (isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0))
                     :     :        :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                     :     :        :     +- Project [d_date_sk#0]
                     :     :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
                     :     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :     :        +- Project [s_store_sk#0]
                     :     :           +- Filter isnotnull(s_store_sk#0)
                     :     :              +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                     :     +- 'Aggregate [s_store_sk#0], [s_store_sk#0, MakeDecimal(sum(UnscaledValue(sr_return_amt#0)),17,2) AS returns#0, MakeDecimal(sum(UnscaledValue(sr_net_loss#0)),17,2) AS profit_loss#0]
                     :        +- 'Project [sr_return_amt#0, sr_net_loss#0, s_store_sk#0]
                     :           +- 'Join Inner, (sr_store_sk#0L = cast(s_store_sk#0 as bigint))
                     :              :- 'Project [sr_store_sk#0L, sr_return_amt#0, sr_net_loss#0]
                     :              :  +- 'Join Inner, (sr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
                     :              :     :- Project [sr_returned_date_sk#0L, sr_store_sk#0L, sr_return_amt#0, sr_net_loss#0]
                     :              :     :  +- Filter (isnotnull(sr_returned_date_sk#0L) && isnotnull(sr_store_sk#0L))
                     :              :     :     +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
                     :              :     +- Project [d_date_sk#0]
                     :              :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
                     :              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :              +- Project [s_store_sk#0]
                     :                 +- Filter isnotnull(s_store_sk#0)
                     :                    +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                     :- 'Project [catalog channel AS channel#0, cs_call_center_sk#0 AS id#0, sales#0, returns#0, CheckOverflow((promote_precision(cast(profit#0 as decimal(18,2))) - promote_precision(cast(profit_loss#0 as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
                     :  +- 'Join Inner
                     :     :- 'Aggregate [cs_call_center_sk#0], [cs_call_center_sk#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(cs_net_profit#0)),17,2) AS profit#0]
                     :     :  +- 'Project [cs_call_center_sk#0, cs_ext_sales_price#0, cs_net_profit#0]
                     :     :     +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                     :     :        :- Project [cs_sold_date_sk#0, cs_call_center_sk#0, cs_ext_sales_price#0, cs_net_profit#0]
                     :     :        :  +- Filter isnotnull(cs_sold_date_sk#0)
                     :     :        :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                     :     :        +- Project [d_date_sk#0]
                     :     :           +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
                     :     :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :     +- 'Aggregate [MakeDecimal(sum(UnscaledValue(cr_return_amount#0)),17,2) AS returns#0, MakeDecimal(sum(UnscaledValue(cr_net_loss#0)),17,2) AS profit_loss#0]
                     :        +- 'Project [cr_return_amount#0, cr_net_loss#0]
                     :           +- 'Join Inner, (cr_returned_date_sk#0 = d_date_sk#0)
                     :              :- Project [cr_returned_date_sk#0, cr_return_amount#0, cr_net_loss#0]
                     :              :  +- Filter isnotnull(cr_returned_date_sk#0)
                     :              :     +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
                     :              +- Project [d_date_sk#0]
                     :                 +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
                     :                    +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     +- 'Project [web channel AS channel#0, wp_web_page_sk#0 AS id#0, sales#0, coalesce(returns#0, 0.00) AS returns#0, CheckOverflow((promote_precision(cast(profit#0 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#0, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS profit#0]
                        +- 'Join LeftOuter, (wp_web_page_sk#0 = wp_web_page_sk#0)
                           :- 'Aggregate [wp_web_page_sk#0], [wp_web_page_sk#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS sales#0, MakeDecimal(sum(UnscaledValue(ws_net_profit#0)),17,2) AS profit#0]
                           :  +- 'Project [ws_ext_sales_price#0, ws_net_profit#0, wp_web_page_sk#0]
                           :     +- 'Join Inner, (ws_web_page_sk#0 = wp_web_page_sk#0)
                           :        :- 'Project [ws_web_page_sk#0, ws_ext_sales_price#0, ws_net_profit#0]
                           :        :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                           :        :     :- Project [ws_sold_date_sk#0, ws_web_page_sk#0, ws_ext_sales_price#0, ws_net_profit#0]
                           :        :     :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_web_page_sk#0))
                           :        :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                           :        :     +- Project [d_date_sk#0]
                           :        :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
                           :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                           :        +- Project [wp_web_page_sk#0]
                           :           +- Filter isnotnull(wp_web_page_sk#0)
                           :              +- Relation[wp_web_page_sk#0,wp_web_page_id#0,wp_rec_start_date#0,wp_rec_end_date#0,wp_creation_date_sk#0,wp_access_date_sk#0,wp_autogen_flag#0,wp_customer_sk#0,wp_url#0,wp_type#0,wp_char_count#0,wp_link_count#0,wp_image_count#0,wp_max_ad_count#0] parquet
                           +- 'Aggregate [wp_web_page_sk#0], [wp_web_page_sk#0, MakeDecimal(sum(UnscaledValue(wr_return_amt#0)),17,2) AS returns#0, MakeDecimal(sum(UnscaledValue(wr_net_loss#0)),17,2) AS profit_loss#0]
                              +- 'Project [wr_return_amt#0, wr_net_loss#0, wp_web_page_sk#0]
                                 +- 'Join Inner, (wr_web_page_sk#0L = cast(wp_web_page_sk#0 as bigint))
                                    :- 'Project [wr_web_page_sk#0L, wr_return_amt#0, wr_net_loss#0]
                                    :  +- 'Join Inner, (wr_returned_date_sk#0L = cast(d_date_sk#0 as bigint))
                                    :     :- Project [wr_returned_date_sk#0L, wr_web_page_sk#0L, wr_return_amt#0, wr_net_loss#0]
                                    :     :  +- Filter (isnotnull(wr_returned_date_sk#0L) && isnotnull(wr_web_page_sk#0L))
                                    :     :     +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
                                    :     +- Project [d_date_sk#0]
                                    :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
                                    :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                                    +- Project [wp_web_page_sk#0]
                                       +- Filter isnotnull(wp_web_page_sk#0)
                                          +- Relation[wp_web_page_sk#0,wp_web_page_id#0,wp_rec_start_date#0,wp_rec_end_date#0,wp_creation_date_sk#0,wp_access_date_sk#0,wp_autogen_flag#0,wp_customer_sk#0,wp_url#0,wp_type#0,wp_char_count#0,wp_link_count#0,wp_image_count#0,wp_max_ad_count#0] parquet


================================================================================================
q78
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Project [ratio#0, store_qty#0L, store_wholesale_cost#0, store_sales_price#0, other_chan_qty#0L, other_chan_wholesale_cost#0, other_chan_sales_price#0]
      +- 'Sort [ss_sold_year#0 ASC NULLS FIRST, ss_item_sk#0 ASC NULLS FIRST, ss_customer_sk#0 ASC NULLS FIRST, ss_qty#0L DESC NULLS LAST, ss_wc#0 DESC NULLS LAST, ss_sp#0 DESC NULLS LAST, other_chan_qty#0L ASC NULLS FIRST, other_chan_wholesale_cost#0 ASC NULLS FIRST, other_chan_sales_price#0 ASC NULLS FIRST, ratio#0 ASC NULLS FIRST], true
         +- 'Project [round((cast(ss_qty#0L as double) / cast(coalesce((ws_qty#0L + cs_qty#0L), 1) as double)), 2) AS ratio#0, ss_qty#0L AS store_qty#0L, ss_wc#0 AS store_wholesale_cost#0, ss_sp#0 AS store_sales_price#0, (coalesce(ws_qty#0L, 0) + coalesce(cs_qty#0L, 0)) AS other_chan_qty#0L, CheckOverflow((promote_precision(cast(coalesce(ws_wc#0, 0.00) as decimal(18,2))) + promote_precision(cast(coalesce(cs_wc#0, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_wholesale_cost#0, CheckOverflow((promote_precision(cast(coalesce(ws_sp#0, 0.00) as decimal(18,2))) + promote_precision(cast(coalesce(cs_sp#0, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_sales_price#0, ss_item_sk#0, ss_sp#0, ss_wc#0, ss_qty#0L, ss_customer_sk#0, ss_sold_year#0]
            +- 'Join Inner, (((cs_sold_year#0 = ss_sold_year#0) && (cs_item_sk#0 = ss_item_sk#0)) && (cs_customer_sk#0 = ss_customer_sk#0))
               :- 'Project [ss_sold_year#0, ss_item_sk#0, ss_customer_sk#0, ss_qty#0L, ss_wc#0, ss_sp#0, ws_qty#0L, ws_wc#0, ws_sp#0]
               :  +- 'Join Inner, (((ws_sold_year#0 = ss_sold_year#0) && (ws_item_sk#0 = ss_item_sk#0)) && (ws_customer_sk#0 = ss_customer_sk#0))
               :     :- 'Aggregate [d_year#0, ss_item_sk#0, ss_customer_sk#0], [d_year#0 AS ss_sold_year#0, ss_item_sk#0, ss_customer_sk#0, sum(cast(ss_quantity#0 as bigint)) AS ss_qty#0L, MakeDecimal(sum(UnscaledValue(ss_wholesale_cost#0)),17,2) AS ss_wc#0, MakeDecimal(sum(UnscaledValue(ss_sales_price#0)),17,2) AS ss_sp#0]
               :     :  +- 'Project [ss_item_sk#0, ss_customer_sk#0, ss_quantity#0, ss_wholesale_cost#0, ss_sales_price#0, d_year#0]
               :     :     +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :     :        :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_quantity#0, ss_wholesale_cost#0, ss_sales_price#0]
               :     :        :  +- 'Filter isnull(sr_ticket_number#0L)
               :     :        :     +- 'Join LeftOuter, ((sr_ticket_number#0L = cast(ss_ticket_number#0 as bigint)) && (cast(ss_item_sk#0 as bigint) = sr_item_sk#0L))
               :     :        :        :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_customer_sk#0, ss_ticket_number#0, ss_quantity#0, ss_wholesale_cost#0, ss_sales_price#0]
               :     :        :        :  +- Filter ((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_customer_sk#0)) && isnotnull(ss_item_sk#0))
               :     :        :        :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     :        :        +- Project [sr_item_sk#0L, sr_ticket_number#0L]
               :     :        :           +- Filter (isnotnull(sr_ticket_number#0L) && isnotnull(sr_item_sk#0L))
               :     :        :              +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
               :     :        +- Project [d_date_sk#0, d_year#0]
               :     :           +- Filter ((isnotnull(d_year#0) && (d_year#0 = 2000)) && isnotnull(d_date_sk#0))
               :     :              +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               :     +- 'Filter (coalesce(ws_qty#0L, 0) > 0)
               :        +- 'Aggregate [d_year#0, ws_item_sk#0, ws_bill_customer_sk#0], [d_year#0 AS ws_sold_year#0, ws_item_sk#0, ws_bill_customer_sk#0 AS ws_customer_sk#0, sum(cast(ws_quantity#0 as bigint)) AS ws_qty#0L, MakeDecimal(sum(UnscaledValue(ws_wholesale_cost#0)),17,2) AS ws_wc#0, MakeDecimal(sum(UnscaledValue(ws_sales_price#0)),17,2) AS ws_sp#0]
               :           +- 'Project [ws_item_sk#0, ws_bill_customer_sk#0, ws_quantity#0, ws_wholesale_cost#0, ws_sales_price#0, d_year#0]
               :              +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
               :                 :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_bill_customer_sk#0, ws_quantity#0, ws_wholesale_cost#0, ws_sales_price#0]
               :                 :  +- 'Filter isnull(wr_order_number#0L)
               :                 :     +- 'Join LeftOuter, ((wr_order_number#0L = cast(ws_order_number#0 as bigint)) && (cast(ws_item_sk#0 as bigint) = wr_item_sk#0L))
               :                 :        :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_bill_customer_sk#0, ws_order_number#0, ws_quantity#0, ws_wholesale_cost#0, ws_sales_price#0]
               :                 :        :  +- Filter ((isnotnull(ws_sold_date_sk#0) && isnotnull(ws_item_sk#0)) && isnotnull(ws_bill_customer_sk#0))
               :                 :        :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
               :                 :        +- Project [wr_item_sk#0L, wr_order_number#0L]
               :                 :           +- Filter (isnotnull(wr_order_number#0L) && isnotnull(wr_item_sk#0L))
               :                 :              +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
               :                 +- Project [d_date_sk#0, d_year#0]
               :                    +- Filter ((isnotnull(d_date_sk#0) && isnotnull(d_year#0)) && (d_year#0 = 2000))
               :                       +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
               +- 'Filter (coalesce(cs_qty#0L, 0) > 0)
                  +- 'Aggregate [d_year#0, cs_item_sk#0, cs_bill_customer_sk#0], [d_year#0 AS cs_sold_year#0, cs_item_sk#0, cs_bill_customer_sk#0 AS cs_customer_sk#0, sum(cast(cs_quantity#0 as bigint)) AS cs_qty#0L, MakeDecimal(sum(UnscaledValue(cs_wholesale_cost#0)),17,2) AS cs_wc#0, MakeDecimal(sum(UnscaledValue(cs_sales_price#0)),17,2) AS cs_sp#0]
                     +- 'Project [cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0, cs_wholesale_cost#0, cs_sales_price#0, d_year#0]
                        +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                           :- 'Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_quantity#0, cs_wholesale_cost#0, cs_sales_price#0]
                           :  +- 'Filter isnull(cr_order_number#0)
                           :     +- 'Join LeftOuter, ((cr_order_number#0 = cs_order_number#0) && (cs_item_sk#0 = cr_item_sk#0))
                           :        :- Project [cs_sold_date_sk#0, cs_bill_customer_sk#0, cs_item_sk#0, cs_order_number#0, cs_quantity#0, cs_wholesale_cost#0, cs_sales_price#0]
                           :        :  +- Filter ((isnotnull(cs_sold_date_sk#0) && isnotnull(cs_item_sk#0)) && isnotnull(cs_bill_customer_sk#0))
                           :        :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                           :        +- Project [cr_item_sk#0, cr_order_number#0]
                           :           +- Filter (isnotnull(cr_order_number#0) && isnotnull(cr_item_sk#0))
                           :              +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
                           +- Project [d_date_sk#0, d_year#0]
                              +- Filter ((isnotnull(d_date_sk#0) && isnotnull(d_year#0)) && (d_year#0 = 2000))
                                 +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


================================================================================================
q80a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [channel#0 ASC NULLS FIRST, id#0 ASC NULLS FIRST], true
      +- 'Aggregate [channel#0, id#0, sales#0, returns#0, profit#0], [channel#0, id#0, sales#0, returns#0, profit#0]
         +- 'Union
            :- 'Aggregate [channel#0, id#0, sales#0, returns#0, profit#0], [channel#0, id#0, sales#0, returns#0, profit#0]
            :  +- 'Union
            :     :- 'Aggregate [channel#0, id#0], [channel#0, id#0, cast(sum(sales#0) as decimal(37,2)) AS sales#0, cast(sum(returns#0) as decimal(38,2)) AS returns#0, cast(sum(profit#0) as decimal(38,2)) AS profit#0]
            :     :  +- 'Union
            :     :     :- 'Aggregate [s_store_id#0], [store channel AS channel#0, concat(store, s_store_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS sales#0, sum(coalesce(cast(sr_return_amt#0 as decimal(12,2)), 0.00)) AS returns#0, sum(CheckOverflow((promote_precision(cast(ss_net_profit#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#0]
            :     :     :  +- 'Project [ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0, s_store_id#0]
            :     :     :     +- 'Join Inner, (ss_promo_sk#0 = p_promo_sk#0)
            :     :     :        :- 'Project [ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0, s_store_id#0]
            :     :     :        :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :     :     :        :     :- 'Project [ss_item_sk#0, ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0, s_store_id#0]
            :     :     :        :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
            :     :     :        :     :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0]
            :     :     :        :     :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :     :     :        :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0]
            :     :     :        :     :     :     :  +- 'Join LeftOuter, ((cast(ss_item_sk#0 as bigint) = sr_item_sk#0L) && (cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L))
            :     :     :        :     :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ticket_number#0, ss_ext_sales_price#0, ss_net_profit#0]
            :     :     :        :     :     :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0)) && isnotnull(ss_promo_sk#0))
            :     :     :        :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :     :     :        :     :     :     :     +- Project [sr_item_sk#0L, sr_ticket_number#0L, sr_return_amt#0, sr_net_loss#0]
            :     :     :        :     :     :     :        +- Filter (isnotnull(sr_item_sk#0L) && isnotnull(sr_ticket_number#0L))
            :     :     :        :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
            :     :     :        :     :     :     +- Project [d_date_sk#0]
            :     :     :        :     :     :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :     :     :        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :        :     :     +- Project [s_store_sk#0, s_store_id#0]
            :     :     :        :     :        +- Filter isnotnull(s_store_sk#0)
            :     :     :        :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :     :     :        :     +- Project [i_item_sk#0]
            :     :     :        :        +- Filter ((isnotnull(i_current_price#0) && (i_current_price#0 > 50.00)) && isnotnull(i_item_sk#0))
            :     :     :        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :        +- Project [p_promo_sk#0]
            :     :     :           +- Filter ((isnotnull(p_channel_tv#0) && (p_channel_tv#0 = N)) && isnotnull(p_promo_sk#0))
            :     :     :              +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
            :     :     :- 'Aggregate [cp_catalog_page_id#0], [catalog channel AS channel#0, concat(catalog_page, cp_catalog_page_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS sales#0, sum(coalesce(cast(cr_return_amount#0 as decimal(12,2)), 0.00)) AS returns#0, sum(CheckOverflow((promote_precision(cast(cs_net_profit#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#0]
            :     :     :  +- 'Project [cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0, cp_catalog_page_id#0]
            :     :     :     +- 'Join Inner, (cs_promo_sk#0 = p_promo_sk#0)
            :     :     :        :- 'Project [cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0, cp_catalog_page_id#0]
            :     :     :        :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :     :     :        :     :- 'Project [cs_item_sk#0, cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0, cp_catalog_page_id#0]
            :     :     :        :     :  +- 'Join Inner, (cs_catalog_page_sk#0 = cp_catalog_page_sk#0)
            :     :     :        :     :     :- 'Project [cs_catalog_page_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0]
            :     :     :        :     :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :     :     :        :     :     :     :- 'Project [cs_sold_date_sk#0, cs_catalog_page_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0]
            :     :     :        :     :     :     :  +- 'Join LeftOuter, ((cs_item_sk#0 = cr_item_sk#0) && (cs_order_number#0 = cr_order_number#0))
            :     :     :        :     :     :     :     :- Project [cs_sold_date_sk#0, cs_catalog_page_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, cs_ext_sales_price#0, cs_net_profit#0]
            :     :     :        :     :     :     :     :  +- Filter (((isnotnull(cs_sold_date_sk#0) && isnotnull(cs_catalog_page_sk#0)) && isnotnull(cs_item_sk#0)) && isnotnull(cs_promo_sk#0))
            :     :     :        :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :     :     :        :     :     :     :     +- Project [cr_item_sk#0, cr_order_number#0, cr_return_amount#0, cr_net_loss#0]
            :     :     :        :     :     :     :        +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
            :     :     :        :     :     :     :           +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
            :     :     :        :     :     :     +- Project [d_date_sk#0]
            :     :     :        :     :     :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :     :     :        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :     :        :     :     +- Project [cp_catalog_page_sk#0, cp_catalog_page_id#0]
            :     :     :        :     :        +- Filter isnotnull(cp_catalog_page_sk#0)
            :     :     :        :     :           +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#0,cp_start_date_sk#0,cp_end_date_sk#0,cp_department#0,cp_catalog_number#0,cp_catalog_page_number#0,cp_description#0,cp_type#0] parquet
            :     :     :        :     +- Project [i_item_sk#0]
            :     :     :        :        +- Filter ((isnotnull(i_current_price#0) && (i_current_price#0 > 50.00)) && isnotnull(i_item_sk#0))
            :     :     :        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :     :        +- Project [p_promo_sk#0]
            :     :     :           +- Filter ((isnotnull(p_channel_tv#0) && (p_channel_tv#0 = N)) && isnotnull(p_promo_sk#0))
            :     :     :              +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
            :     :     +- 'Aggregate [web_site_id#0], [web channel AS channel#0, concat(web_site, web_site_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS sales#0, sum(coalesce(cast(wr_return_amt#0 as decimal(12,2)), 0.00)) AS returns#0, sum(CheckOverflow((promote_precision(cast(ws_net_profit#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#0]
            :     :        +- 'Project [ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0, web_site_id#0]
            :     :           +- 'Join Inner, (ws_promo_sk#0 = p_promo_sk#0)
            :     :              :- 'Project [ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0, web_site_id#0]
            :     :              :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :     :              :     :- 'Project [ws_item_sk#0, ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0, web_site_id#0]
            :     :              :     :  +- 'Join Inner, (ws_web_site_sk#0 = web_site_sk#0)
            :     :              :     :     :- 'Project [ws_item_sk#0, ws_web_site_sk#0, ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0]
            :     :              :     :     :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :     :              :     :     :     :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_web_site_sk#0, ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0]
            :     :              :     :     :     :  +- 'Join LeftOuter, ((cast(ws_item_sk#0 as bigint) = wr_item_sk#0L) && (cast(ws_order_number#0 as bigint) = wr_order_number#0L))
            :     :              :     :     :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_web_site_sk#0, ws_promo_sk#0, ws_order_number#0, ws_ext_sales_price#0, ws_net_profit#0]
            :     :              :     :     :     :     :  +- Filter (((isnotnull(ws_sold_date_sk#0) && isnotnull(ws_web_site_sk#0)) && isnotnull(ws_item_sk#0)) && isnotnull(ws_promo_sk#0))
            :     :              :     :     :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :     :              :     :     :     :     +- Project [wr_item_sk#0L, wr_order_number#0L, wr_return_amt#0, wr_net_loss#0]
            :     :              :     :     :     :        +- Filter (isnotnull(wr_item_sk#0L) && isnotnull(wr_order_number#0L))
            :     :              :     :     :     :           +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
            :     :              :     :     :     +- Project [d_date_sk#0]
            :     :              :     :     :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :     :              :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :     :              :     :     +- Project [web_site_sk#0, web_site_id#0]
            :     :              :     :        +- Filter isnotnull(web_site_sk#0)
            :     :              :     :           +- Relation[web_site_sk#0,web_site_id#0,web_rec_start_date#0,web_rec_end_date#0,web_name#0,web_open_date_sk#0,web_close_date_sk#0,web_class#0,web_manager#0,web_mkt_id#0,web_mkt_class#0,web_mkt_desc#0,web_market_manager#0,web_company_id#0,web_company_name#0,web_street_number#0,web_street_name#0,web_street_type#0,web_suite_number#0,web_city#0,web_county#0,web_state#0,web_zip#0,web_country#0,... 2 more fields] parquet
            :     :              :     +- Project [i_item_sk#0]
            :     :              :        +- Filter ((isnotnull(i_current_price#0) && (i_current_price#0 > 50.00)) && isnotnull(i_item_sk#0))
            :     :              :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :     :              +- Project [p_promo_sk#0]
            :     :                 +- Filter ((isnotnull(p_channel_tv#0) && (p_channel_tv#0 = N)) && isnotnull(p_promo_sk#0))
            :     :                    +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
            :     +- 'Aggregate [channel#0], [channel#0, null AS id#0, sum(sales#0) AS sales#0, sum(returns#0) AS returns#0, sum(profit#0) AS profit#0]
            :        +- 'Aggregate [channel#0, id#0], [channel#0, sum(sales#0) AS sales#0, sum(returns#0) AS returns#0, sum(profit#0) AS profit#0]
            :           +- 'Union
            :              :- 'Aggregate [s_store_id#0], [store channel AS channel#0, concat(store, s_store_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS sales#0, sum(coalesce(cast(sr_return_amt#0 as decimal(12,2)), 0.00)) AS returns#0, sum(CheckOverflow((promote_precision(cast(ss_net_profit#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#0]
            :              :  +- 'Project [ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0, s_store_id#0]
            :              :     +- 'Join Inner, (ss_promo_sk#0 = p_promo_sk#0)
            :              :        :- 'Project [ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0, s_store_id#0]
            :              :        :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
            :              :        :     :- 'Project [ss_item_sk#0, ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0, s_store_id#0]
            :              :        :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
            :              :        :     :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0]
            :              :        :     :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
            :              :        :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0]
            :              :        :     :     :     :  +- 'Join LeftOuter, ((cast(ss_item_sk#0 as bigint) = sr_item_sk#0L) && (cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L))
            :              :        :     :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ticket_number#0, ss_ext_sales_price#0, ss_net_profit#0]
            :              :        :     :     :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0)) && isnotnull(ss_promo_sk#0))
            :              :        :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
            :              :        :     :     :     :     +- Project [sr_item_sk#0L, sr_ticket_number#0L, sr_return_amt#0, sr_net_loss#0]
            :              :        :     :     :     :        +- Filter (isnotnull(sr_item_sk#0L) && isnotnull(sr_ticket_number#0L))
            :              :        :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
            :              :        :     :     :     +- Project [d_date_sk#0]
            :              :        :     :     :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :              :        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :        :     :     +- Project [s_store_sk#0, s_store_id#0]
            :              :        :     :        +- Filter isnotnull(s_store_sk#0)
            :              :        :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
            :              :        :     +- Project [i_item_sk#0]
            :              :        :        +- Filter ((isnotnull(i_current_price#0) && (i_current_price#0 > 50.00)) && isnotnull(i_item_sk#0))
            :              :        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :        +- Project [p_promo_sk#0]
            :              :           +- Filter ((isnotnull(p_channel_tv#0) && (p_channel_tv#0 = N)) && isnotnull(p_promo_sk#0))
            :              :              +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
            :              :- 'Aggregate [cp_catalog_page_id#0], [catalog channel AS channel#0, concat(catalog_page, cp_catalog_page_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS sales#0, sum(coalesce(cast(cr_return_amount#0 as decimal(12,2)), 0.00)) AS returns#0, sum(CheckOverflow((promote_precision(cast(cs_net_profit#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#0]
            :              :  +- 'Project [cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0, cp_catalog_page_id#0]
            :              :     +- 'Join Inner, (cs_promo_sk#0 = p_promo_sk#0)
            :              :        :- 'Project [cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0, cp_catalog_page_id#0]
            :              :        :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
            :              :        :     :- 'Project [cs_item_sk#0, cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0, cp_catalog_page_id#0]
            :              :        :     :  +- 'Join Inner, (cs_catalog_page_sk#0 = cp_catalog_page_sk#0)
            :              :        :     :     :- 'Project [cs_catalog_page_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0]
            :              :        :     :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
            :              :        :     :     :     :- 'Project [cs_sold_date_sk#0, cs_catalog_page_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0]
            :              :        :     :     :     :  +- 'Join LeftOuter, ((cs_item_sk#0 = cr_item_sk#0) && (cs_order_number#0 = cr_order_number#0))
            :              :        :     :     :     :     :- Project [cs_sold_date_sk#0, cs_catalog_page_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, cs_ext_sales_price#0, cs_net_profit#0]
            :              :        :     :     :     :     :  +- Filter (((isnotnull(cs_sold_date_sk#0) && isnotnull(cs_catalog_page_sk#0)) && isnotnull(cs_item_sk#0)) && isnotnull(cs_promo_sk#0))
            :              :        :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
            :              :        :     :     :     :     +- Project [cr_item_sk#0, cr_order_number#0, cr_return_amount#0, cr_net_loss#0]
            :              :        :     :     :     :        +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
            :              :        :     :     :     :           +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
            :              :        :     :     :     +- Project [d_date_sk#0]
            :              :        :     :     :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :              :        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :              :        :     :     +- Project [cp_catalog_page_sk#0, cp_catalog_page_id#0]
            :              :        :     :        +- Filter isnotnull(cp_catalog_page_sk#0)
            :              :        :     :           +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#0,cp_start_date_sk#0,cp_end_date_sk#0,cp_department#0,cp_catalog_number#0,cp_catalog_page_number#0,cp_description#0,cp_type#0] parquet
            :              :        :     +- Project [i_item_sk#0]
            :              :        :        +- Filter ((isnotnull(i_current_price#0) && (i_current_price#0 > 50.00)) && isnotnull(i_item_sk#0))
            :              :        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :              :        +- Project [p_promo_sk#0]
            :              :           +- Filter ((isnotnull(p_channel_tv#0) && (p_channel_tv#0 = N)) && isnotnull(p_promo_sk#0))
            :              :              +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
            :              +- 'Aggregate [web_site_id#0], [web channel AS channel#0, concat(web_site, web_site_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS sales#0, sum(coalesce(cast(wr_return_amt#0 as decimal(12,2)), 0.00)) AS returns#0, sum(CheckOverflow((promote_precision(cast(ws_net_profit#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#0]
            :                 +- 'Project [ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0, web_site_id#0]
            :                    +- 'Join Inner, (ws_promo_sk#0 = p_promo_sk#0)
            :                       :- 'Project [ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0, web_site_id#0]
            :                       :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
            :                       :     :- 'Project [ws_item_sk#0, ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0, web_site_id#0]
            :                       :     :  +- 'Join Inner, (ws_web_site_sk#0 = web_site_sk#0)
            :                       :     :     :- 'Project [ws_item_sk#0, ws_web_site_sk#0, ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0]
            :                       :     :     :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
            :                       :     :     :     :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_web_site_sk#0, ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0]
            :                       :     :     :     :  +- 'Join LeftOuter, ((cast(ws_item_sk#0 as bigint) = wr_item_sk#0L) && (cast(ws_order_number#0 as bigint) = wr_order_number#0L))
            :                       :     :     :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_web_site_sk#0, ws_promo_sk#0, ws_order_number#0, ws_ext_sales_price#0, ws_net_profit#0]
            :                       :     :     :     :     :  +- Filter (((isnotnull(ws_sold_date_sk#0) && isnotnull(ws_web_site_sk#0)) && isnotnull(ws_item_sk#0)) && isnotnull(ws_promo_sk#0))
            :                       :     :     :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
            :                       :     :     :     :     +- Project [wr_item_sk#0L, wr_order_number#0L, wr_return_amt#0, wr_net_loss#0]
            :                       :     :     :     :        +- Filter (isnotnull(wr_item_sk#0L) && isnotnull(wr_order_number#0L))
            :                       :     :     :     :           +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
            :                       :     :     :     +- Project [d_date_sk#0]
            :                       :     :     :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
            :                       :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
            :                       :     :     +- Project [web_site_sk#0, web_site_id#0]
            :                       :     :        +- Filter isnotnull(web_site_sk#0)
            :                       :     :           +- Relation[web_site_sk#0,web_site_id#0,web_rec_start_date#0,web_rec_end_date#0,web_name#0,web_open_date_sk#0,web_close_date_sk#0,web_class#0,web_manager#0,web_mkt_id#0,web_mkt_class#0,web_mkt_desc#0,web_market_manager#0,web_company_id#0,web_company_name#0,web_street_number#0,web_street_name#0,web_street_type#0,web_suite_number#0,web_city#0,web_county#0,web_state#0,web_zip#0,web_country#0,... 2 more fields] parquet
            :                       :     +- Project [i_item_sk#0]
            :                       :        +- Filter ((isnotnull(i_current_price#0) && (i_current_price#0 > 50.00)) && isnotnull(i_item_sk#0))
            :                       :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
            :                       +- Project [p_promo_sk#0]
            :                          +- Filter ((isnotnull(p_channel_tv#0) && (p_channel_tv#0 = N)) && isnotnull(p_promo_sk#0))
            :                             +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
            +- 'Aggregate [null AS channel#0, null AS id#0, sum(sales#0) AS sales#0, sum(returns#0) AS returns#0, sum(profit#0) AS profit#0]
               +- 'Aggregate [channel#0, id#0], [sum(sales#0) AS sales#0, sum(returns#0) AS returns#0, sum(profit#0) AS profit#0]
                  +- 'Union
                     :- 'Aggregate [s_store_id#0], [store channel AS channel#0, concat(store, s_store_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS sales#0, sum(coalesce(cast(sr_return_amt#0 as decimal(12,2)), 0.00)) AS returns#0, sum(CheckOverflow((promote_precision(cast(ss_net_profit#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#0]
                     :  +- 'Project [ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0, s_store_id#0]
                     :     +- 'Join Inner, (ss_promo_sk#0 = p_promo_sk#0)
                     :        :- 'Project [ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0, s_store_id#0]
                     :        :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
                     :        :     :- 'Project [ss_item_sk#0, ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0, s_store_id#0]
                     :        :     :  +- 'Join Inner, (ss_store_sk#0 = s_store_sk#0)
                     :        :     :     :- 'Project [ss_item_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0]
                     :        :     :     :  +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
                     :        :     :     :     :- 'Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ext_sales_price#0, ss_net_profit#0, sr_return_amt#0, sr_net_loss#0]
                     :        :     :     :     :  +- 'Join LeftOuter, ((cast(ss_item_sk#0 as bigint) = sr_item_sk#0L) && (cast(ss_ticket_number#0 as bigint) = sr_ticket_number#0L))
                     :        :     :     :     :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_store_sk#0, ss_promo_sk#0, ss_ticket_number#0, ss_ext_sales_price#0, ss_net_profit#0]
                     :        :     :     :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#0) && isnotnull(ss_store_sk#0)) && isnotnull(ss_item_sk#0)) && isnotnull(ss_promo_sk#0))
                     :        :     :     :     :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
                     :        :     :     :     :     +- Project [sr_item_sk#0L, sr_ticket_number#0L, sr_return_amt#0, sr_net_loss#0]
                     :        :     :     :     :        +- Filter (isnotnull(sr_item_sk#0L) && isnotnull(sr_ticket_number#0L))
                     :        :     :     :     :           +- Relation[sr_returned_date_sk#0L,sr_return_time_sk#0L,sr_item_sk#0L,sr_customer_sk#0L,sr_cdemo_sk#0L,sr_hdemo_sk#0L,sr_addr_sk#0L,sr_store_sk#0L,sr_reason_sk#0L,sr_ticket_number#0L,sr_return_quantity#0,sr_return_amt#0,sr_return_tax#0,sr_return_amt_inc_tax#0,sr_fee#0,sr_return_ship_cost#0,sr_refunded_cash#0,sr_reversed_charge#0,sr_store_credit#0,sr_net_loss#0] parquet
                     :        :     :     :     +- Project [d_date_sk#0]
                     :        :     :     :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
                     :        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :        :     :     +- Project [s_store_sk#0, s_store_id#0]
                     :        :     :        +- Filter isnotnull(s_store_sk#0)
                     :        :     :           +- Relation[s_store_sk#0,s_store_id#0,s_rec_start_date#0,s_rec_end_date#0,s_closed_date_sk#0,s_store_name#0,s_number_employees#0,s_floor_space#0,s_hours#0,s_manager#0,s_market_id#0,s_geography_class#0,s_market_desc#0,s_market_manager#0,s_division_id#0,s_division_name#0,s_company_id#0,s_company_name#0,s_street_number#0,s_street_name#0,s_street_type#0,s_suite_number#0,s_city#0,s_county#0,... 5 more fields] parquet
                     :        :     +- Project [i_item_sk#0]
                     :        :        +- Filter ((isnotnull(i_current_price#0) && (i_current_price#0 > 50.00)) && isnotnull(i_item_sk#0))
                     :        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :        +- Project [p_promo_sk#0]
                     :           +- Filter ((isnotnull(p_channel_tv#0) && (p_channel_tv#0 = N)) && isnotnull(p_promo_sk#0))
                     :              +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
                     :- 'Aggregate [cp_catalog_page_id#0], [catalog channel AS channel#0, concat(catalog_page, cp_catalog_page_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#0)),17,2) AS sales#0, sum(coalesce(cast(cr_return_amount#0 as decimal(12,2)), 0.00)) AS returns#0, sum(CheckOverflow((promote_precision(cast(cs_net_profit#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#0]
                     :  +- 'Project [cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0, cp_catalog_page_id#0]
                     :     +- 'Join Inner, (cs_promo_sk#0 = p_promo_sk#0)
                     :        :- 'Project [cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0, cp_catalog_page_id#0]
                     :        :  +- 'Join Inner, (cs_item_sk#0 = i_item_sk#0)
                     :        :     :- 'Project [cs_item_sk#0, cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0, cp_catalog_page_id#0]
                     :        :     :  +- 'Join Inner, (cs_catalog_page_sk#0 = cp_catalog_page_sk#0)
                     :        :     :     :- 'Project [cs_catalog_page_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0]
                     :        :     :     :  +- 'Join Inner, (cs_sold_date_sk#0 = d_date_sk#0)
                     :        :     :     :     :- 'Project [cs_sold_date_sk#0, cs_catalog_page_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_ext_sales_price#0, cs_net_profit#0, cr_return_amount#0, cr_net_loss#0]
                     :        :     :     :     :  +- 'Join LeftOuter, ((cs_item_sk#0 = cr_item_sk#0) && (cs_order_number#0 = cr_order_number#0))
                     :        :     :     :     :     :- Project [cs_sold_date_sk#0, cs_catalog_page_sk#0, cs_item_sk#0, cs_promo_sk#0, cs_order_number#0, cs_ext_sales_price#0, cs_net_profit#0]
                     :        :     :     :     :     :  +- Filter (((isnotnull(cs_sold_date_sk#0) && isnotnull(cs_catalog_page_sk#0)) && isnotnull(cs_item_sk#0)) && isnotnull(cs_promo_sk#0))
                     :        :     :     :     :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#0,cs_ship_date_sk#0,cs_bill_customer_sk#0,cs_bill_cdemo_sk#0,cs_bill_hdemo_sk#0,cs_bill_addr_sk#0,cs_ship_customer_sk#0,cs_ship_cdemo_sk#0,cs_ship_hdemo_sk#0,cs_ship_addr_sk#0,cs_call_center_sk#0,cs_catalog_page_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0,cs_item_sk#0,cs_promo_sk#0,cs_order_number#0,cs_quantity#0,cs_wholesale_cost#0,cs_list_price#0,cs_sales_price#0,cs_ext_discount_amt#0,cs_ext_sales_price#0,... 10 more fields] parquet
                     :        :     :     :     :     +- Project [cr_item_sk#0, cr_order_number#0, cr_return_amount#0, cr_net_loss#0]
                     :        :     :     :     :        +- Filter (isnotnull(cr_item_sk#0) && isnotnull(cr_order_number#0))
                     :        :     :     :     :           +- Relation[cr_returned_date_sk#0,cr_returned_time_sk#0,cr_item_sk#0,cr_refunded_customer_sk#0,cr_refunded_cdemo_sk#0,cr_refunded_hdemo_sk#0,cr_refunded_addr_sk#0,cr_returning_customer_sk#0,cr_returning_cdemo_sk#0,cr_returning_hdemo_sk#0,cr_returning_addr_sk#0,cr_call_center_sk#0,cr_catalog_page_sk#0,cr_ship_mode_sk#0,cr_warehouse_sk#0,cr_reason_sk#0,cr_order_number#0,cr_return_quantity#0,cr_return_amount#0,cr_return_tax#0,cr_return_amt_inc_tax#0,cr_fee#0,cr_return_ship_cost#0,cr_refunded_cash#0,... 3 more fields] parquet
                     :        :     :     :     +- Project [d_date_sk#0]
                     :        :     :     :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
                     :        :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                     :        :     :     +- Project [cp_catalog_page_sk#0, cp_catalog_page_id#0]
                     :        :     :        +- Filter isnotnull(cp_catalog_page_sk#0)
                     :        :     :           +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#0,cp_start_date_sk#0,cp_end_date_sk#0,cp_department#0,cp_catalog_number#0,cp_catalog_page_number#0,cp_description#0,cp_type#0] parquet
                     :        :     +- Project [i_item_sk#0]
                     :        :        +- Filter ((isnotnull(i_current_price#0) && (i_current_price#0 > 50.00)) && isnotnull(i_item_sk#0))
                     :        :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                     :        +- Project [p_promo_sk#0]
                     :           +- Filter ((isnotnull(p_channel_tv#0) && (p_channel_tv#0 = N)) && isnotnull(p_promo_sk#0))
                     :              +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet
                     +- 'Aggregate [web_site_id#0], [web channel AS channel#0, concat(web_site, web_site_id#0) AS id#0, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#0)),17,2) AS sales#0, sum(coalesce(cast(wr_return_amt#0 as decimal(12,2)), 0.00)) AS returns#0, sum(CheckOverflow((promote_precision(cast(ws_net_profit#0 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#0 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#0]
                        +- 'Project [ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0, web_site_id#0]
                           +- 'Join Inner, (ws_promo_sk#0 = p_promo_sk#0)
                              :- 'Project [ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0, web_site_id#0]
                              :  +- 'Join Inner, (ws_item_sk#0 = i_item_sk#0)
                              :     :- 'Project [ws_item_sk#0, ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0, web_site_id#0]
                              :     :  +- 'Join Inner, (ws_web_site_sk#0 = web_site_sk#0)
                              :     :     :- 'Project [ws_item_sk#0, ws_web_site_sk#0, ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0]
                              :     :     :  +- 'Join Inner, (ws_sold_date_sk#0 = d_date_sk#0)
                              :     :     :     :- 'Project [ws_sold_date_sk#0, ws_item_sk#0, ws_web_site_sk#0, ws_promo_sk#0, ws_ext_sales_price#0, ws_net_profit#0, wr_return_amt#0, wr_net_loss#0]
                              :     :     :     :  +- 'Join LeftOuter, ((cast(ws_item_sk#0 as bigint) = wr_item_sk#0L) && (cast(ws_order_number#0 as bigint) = wr_order_number#0L))
                              :     :     :     :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_web_site_sk#0, ws_promo_sk#0, ws_order_number#0, ws_ext_sales_price#0, ws_net_profit#0]
                              :     :     :     :     :  +- Filter (((isnotnull(ws_sold_date_sk#0) && isnotnull(ws_web_site_sk#0)) && isnotnull(ws_item_sk#0)) && isnotnull(ws_promo_sk#0))
                              :     :     :     :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                              :     :     :     :     +- Project [wr_item_sk#0L, wr_order_number#0L, wr_return_amt#0, wr_net_loss#0]
                              :     :     :     :        +- Filter (isnotnull(wr_item_sk#0L) && isnotnull(wr_order_number#0L))
                              :     :     :     :           +- Relation[wr_returned_date_sk#0L,wr_returned_time_sk#0L,wr_item_sk#0L,wr_refunded_customer_sk#0L,wr_refunded_cdemo_sk#0L,wr_refunded_hdemo_sk#0L,wr_refunded_addr_sk#0L,wr_returning_customer_sk#0L,wr_returning_cdemo_sk#0L,wr_returning_hdemo_sk#0L,wr_returning_addr_sk#0L,wr_web_page_sk#0L,wr_reason_sk#0L,wr_order_number#0L,wr_return_quantity#0,wr_return_amt#0,wr_return_tax#0,wr_return_amt_inc_tax#0,wr_fee#0,wr_return_ship_cost#0,wr_refunded_cash#0,wr_reversed_charge#0,wr_account_credit#0,wr_net_loss#0] parquet
                              :     :     :     +- Project [d_date_sk#0]
                              :     :     :        +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10442)) && (d_date#0 <= 10472)) && isnotnull(d_date_sk#0))
                              :     :     :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              :     :     +- Project [web_site_sk#0, web_site_id#0]
                              :     :        +- Filter isnotnull(web_site_sk#0)
                              :     :           +- Relation[web_site_sk#0,web_site_id#0,web_rec_start_date#0,web_rec_end_date#0,web_name#0,web_open_date_sk#0,web_close_date_sk#0,web_class#0,web_manager#0,web_mkt_id#0,web_mkt_class#0,web_mkt_desc#0,web_market_manager#0,web_company_id#0,web_company_name#0,web_street_number#0,web_street_name#0,web_street_type#0,web_suite_number#0,web_city#0,web_county#0,web_state#0,web_zip#0,web_country#0,... 2 more fields] parquet
                              :     +- Project [i_item_sk#0]
                              :        +- Filter ((isnotnull(i_current_price#0) && (i_current_price#0 > 50.00)) && isnotnull(i_item_sk#0))
                              :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                              +- Project [p_promo_sk#0]
                                 +- Filter ((isnotnull(p_channel_tv#0) && (p_channel_tv#0 = N)) && isnotnull(p_promo_sk#0))
                                    +- Relation[p_promo_sk#0,p_promo_id#0,p_start_date_sk#0,p_end_date_sk#0,p_item_sk#0,p_cost#0,p_response_target#0,p_promo_name#0,p_channel_dmail#0,p_channel_email#0,p_channel_catalog#0,p_channel_tv#0,p_channel_radio#0,p_channel_press#0,p_channel_event#0,p_channel_demo#0,p_channel_details#0,p_purpose#0,p_discount_active#0] parquet


================================================================================================
q86a
================================================================================================

'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [lochierarchy#0 DESC NULLS LAST, CASE WHEN (lochierarchy#0 = 0) THEN i_category#0 END ASC NULLS FIRST, rank_within_parent#0 ASC NULLS FIRST], true
      +- 'Project [total_sum#0, i_category#0, i_class#0, lochierarchy#0, rank_within_parent#0]
         +- 'Window [rank(total_sum#0) windowspecdefinition(lochierarchy#0, _w0#0, total_sum#0 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#0], [lochierarchy#0, _w0#0], [total_sum#0 DESC NULLS LAST]
            +- 'Aggregate [total_sum#0, i_category#0, i_class#0, g_category#0, g_class#0, lochierarchy#0], [total_sum#0, i_category#0, i_class#0, lochierarchy#0, CASE WHEN (g_class#0 = 0) THEN i_category#0 END AS _w0#0]
               +- 'Union
                  :- 'Aggregate [total_sum#0, i_category#0, i_class#0, g_category#0, g_class#0, lochierarchy#0], [total_sum#0, i_category#0, i_class#0, g_category#0, g_class#0, lochierarchy#0]
                  :  +- 'Union
                  :     :- 'Aggregate [i_category#0, i_class#0], [cast(MakeDecimal(sum(UnscaledValue(ws_net_paid#0)),17,2) as decimal(27,2)) AS total_sum#0, i_category#0, i_class#0, 0 AS g_category#0, 0 AS g_class#0, 0 AS lochierarchy#0]
                  :     :  +- 'Project [ws_net_paid#0, i_class#0, i_category#0]
                  :     :     +- 'Join Inner, (i_item_sk#0 = ws_item_sk#0)
                  :     :        :- 'Project [ws_item_sk#0, ws_net_paid#0]
                  :     :        :  +- 'Join Inner, (d_date_sk#0 = ws_sold_date_sk#0)
                  :     :        :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_net_paid#0]
                  :     :        :     :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_item_sk#0))
                  :     :        :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                  :     :        :     +- Project [d_date_sk#0]
                  :     :        :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                  :     :        :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :     :        +- Project [i_item_sk#0, i_class#0, i_category#0]
                  :     :           +- Filter isnotnull(i_item_sk#0)
                  :     :              +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  :     +- 'Aggregate [i_category#0], [sum(total_sum#0) AS total_sum#0, i_category#0, null AS i_class#0, 0 AS g_category#0, 1 AS g_class#0, 1 AS lochierarchy#0]
                  :        +- 'Aggregate [i_category#0, i_class#0], [MakeDecimal(sum(UnscaledValue(ws_net_paid#0)),17,2) AS total_sum#0, i_category#0]
                  :           +- 'Project [ws_net_paid#0, i_class#0, i_category#0]
                  :              +- 'Join Inner, (i_item_sk#0 = ws_item_sk#0)
                  :                 :- 'Project [ws_item_sk#0, ws_net_paid#0]
                  :                 :  +- 'Join Inner, (d_date_sk#0 = ws_sold_date_sk#0)
                  :                 :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_net_paid#0]
                  :                 :     :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_item_sk#0))
                  :                 :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                  :                 :     +- Project [d_date_sk#0]
                  :                 :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                  :                 :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                  :                 +- Project [i_item_sk#0, i_class#0, i_category#0]
                  :                    +- Filter isnotnull(i_item_sk#0)
                  :                       +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
                  +- 'Aggregate [sum(total_sum#0) AS total_sum#0, null AS i_category#0, null AS i_class#0, 1 AS g_category#0, 1 AS g_class#0, 2 AS lochierarchy#0]
                     +- 'Aggregate [i_category#0, i_class#0], [MakeDecimal(sum(UnscaledValue(ws_net_paid#0)),17,2) AS total_sum#0]
                        +- 'Project [ws_net_paid#0, i_class#0, i_category#0]
                           +- 'Join Inner, (i_item_sk#0 = ws_item_sk#0)
                              :- 'Project [ws_item_sk#0, ws_net_paid#0]
                              :  +- 'Join Inner, (d_date_sk#0 = ws_sold_date_sk#0)
                              :     :- Project [ws_sold_date_sk#0, ws_item_sk#0, ws_net_paid#0]
                              :     :  +- Filter (isnotnull(ws_sold_date_sk#0) && isnotnull(ws_item_sk#0))
                              :     :     +- Relation[ws_sold_date_sk#0,ws_sold_time_sk#0,ws_ship_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_bill_cdemo_sk#0,ws_bill_hdemo_sk#0,ws_bill_addr_sk#0,ws_ship_customer_sk#0,ws_ship_cdemo_sk#0,ws_ship_hdemo_sk#0,ws_ship_addr_sk#0,ws_web_page_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0,ws_promo_sk#0,ws_order_number#0,ws_quantity#0,ws_wholesale_cost#0,ws_list_price#0,ws_sales_price#0,ws_ext_discount_amt#0,ws_ext_sales_price#0,... 10 more fields] parquet
                              :     +- Project [d_date_sk#0]
                              :        +- Filter (((isnotnull(d_month_seq#0) && (d_month_seq#0 >= 1212)) && (d_month_seq#0 <= 1223)) && isnotnull(d_date_sk#0))
                              :           +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet
                              +- Project [i_item_sk#0, i_class#0, i_category#0]
                                 +- Filter isnotnull(i_item_sk#0)
                                    +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet


================================================================================================
q98
================================================================================================

'Sort [i_category#0 ASC NULLS FIRST, i_class#0 ASC NULLS FIRST, i_item_id#0 ASC NULLS FIRST, i_item_desc#0 ASC NULLS FIRST, revenueratio#0 ASC NULLS FIRST], true
+- 'Project [i_item_id#0, i_item_desc#0, i_category#0, i_class#0, i_current_price#0, itemrevenue#0, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(_w0#0) * 100.00), DecimalType(21,2)) as decimal(27,2))) / promote_precision(_we0#0)), DecimalType(38,17)) AS revenueratio#0]
   +- 'Window [sum(_w1#0) windowspecdefinition(i_class#0, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#0], [i_class#0]
      +- 'Aggregate [i_item_id#0, i_item_desc#0, i_category#0, i_class#0, i_current_price#0], [i_item_id#0, i_item_desc#0, i_category#0, i_class#0, i_current_price#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS itemrevenue#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS _w0#0, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#0)),17,2) AS _w1#0]
         +- 'Project [ss_ext_sales_price#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
            +- 'Join Inner, (ss_sold_date_sk#0 = d_date_sk#0)
               :- 'Project [ss_sold_date_sk#0, ss_ext_sales_price#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
               :  +- 'Join Inner, (ss_item_sk#0 = i_item_sk#0)
               :     :- Project [ss_sold_date_sk#0, ss_item_sk#0, ss_ext_sales_price#0]
               :     :  +- Filter (isnotnull(ss_item_sk#0) && isnotnull(ss_sold_date_sk#0))
               :     :     +- Relation[ss_sold_date_sk#0,ss_sold_time_sk#0,ss_item_sk#0,ss_customer_sk#0,ss_cdemo_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_promo_sk#0,ss_ticket_number#0,ss_quantity#0,ss_wholesale_cost#0,ss_list_price#0,ss_sales_price#0,ss_ext_discount_amt#0,ss_ext_sales_price#0,ss_ext_wholesale_cost#0,ss_ext_list_price#0,ss_ext_tax#0,ss_coupon_amt#0,ss_net_paid#0,ss_net_paid_inc_tax#0,ss_net_profit#0] parquet
               :     +- Project [i_item_sk#0, i_item_id#0, i_item_desc#0, i_current_price#0, i_class#0, i_category#0]
               :        +- Filter (i_category#0 IN (Sports,Books,Home) && isnotnull(i_item_sk#0))
               :           +- Relation[i_item_sk#0,i_item_id#0,i_rec_start_date#0,i_rec_end_date#0,i_item_desc#0,i_current_price#0,i_wholesale_cost#0,i_brand_id#0,i_brand#0,i_class_id#0,i_class#0,i_category_id#0,i_category#0,i_manufact_id#0,i_manufact#0,i_size#0,i_formulation#0,i_color#0,i_units#0,i_container#0,i_manager_id#0,i_product_name#0] parquet
               +- Project [d_date_sk#0]
                  +- Filter (((isnotnull(d_date#0) && (d_date#0 >= 10644)) && (d_date#0 <= 10674)) && isnotnull(d_date_sk#0))
                     +- Relation[d_date_sk#0,d_date_id#0,d_date#0,d_month_seq#0,d_week_seq#0,d_quarter_seq#0,d_year#0,d_dow#0,d_moy#0,d_dom#0,d_qoy#0,d_fy_year#0,d_fy_quarter_seq#0,d_fy_week_seq#0,d_day_name#0,d_quarter_name#0,d_holiday#0,d_weekend#0,d_following_holiday#0,d_first_dom#0,d_last_dom#0,d_same_day_ly#0,d_same_day_lq#0,d_current_day#0,... 4 more fields] parquet


