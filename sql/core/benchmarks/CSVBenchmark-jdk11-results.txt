================================================================================================
Benchmark to measure CSV read/write performance
================================================================================================

OpenJDK 64-Bit Server VM 11.0.14.1+1-LTS on Mac OS X 12.2.1
Apple M1 Pro
Parsing quoted values:                    Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
One quoted string                                 13626          13931         452          0.0      272527.0       1.0X

OpenJDK 64-Bit Server VM 11.0.14.1+1-LTS on Mac OS X 12.2.1
Apple M1 Pro
Wide rows with 1000 columns:              Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
Select 1000 columns                               58231          58436         334          0.0       58230.9       1.0X
Select 100 columns                                15337          15352          17          0.1       15336.9       3.8X
Select one column                                 11952          12000          43          0.1       11951.8       4.9X
count()                                            2771           2790          31          0.4        2771.4      21.0X
Select 100 columns, one bad input field           27527          27564          35          0.0       27526.5       2.1X
Select 100 columns, corrupt record field          33589          33888         259          0.0       33589.0       1.7X

OpenJDK 64-Bit Server VM 11.0.14.1+1-LTS on Mac OS X 12.2.1
Apple M1 Pro
Count a dataset with 10 columns:          Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
Select 10 columns + count()                        6818           6828          12          1.5         681.8       1.0X
Select 1 column + count()                          4417           4440          24          2.3         441.7       1.5X
count()                                            1274           1300          24          7.8         127.4       5.4X

OpenJDK 64-Bit Server VM 11.0.14.1+1-LTS on Mac OS X 12.2.1
Apple M1 Pro
Write dates and timestamps:               Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
Create a dataset of timestamps                      895            904          11         11.2          89.5       1.0X
to_csv(timestamp)                                  5376           5580         184          1.9         537.6       0.2X
write timestamps to files                          5284           5334          61          1.9         528.4       0.2X
Create a dataset of dates                          1035           1053          16          9.7         103.5       0.9X
to_csv(date)                                       3530           3552          25          2.8         353.0       0.3X
write dates to files                               3367           3420          56          3.0         336.7       0.3X

OpenJDK 64-Bit Server VM 11.0.14.1+1-LTS on Mac OS X 12.2.1
Apple M1 Pro
Read dates and timestamps:                Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
read timestamp text from files                      892            906          17         11.2          89.2       1.0X
read timestamps from files                        14322          14409          77          0.7        1432.2       0.1X
infer timestamps from files                       29151          29352         273          0.3        2915.1       0.0X
read date text from files                           752            795          47         13.3          75.2       1.2X
read date from files                               4658           4668          11          2.1         465.8       0.2X
infer date from files                             11711          11863         133          0.9        1171.1       0.1X
timestamp strings                                  1958           1963           5          5.1         195.8       0.5X
parse timestamps from Dataset[String]             12822          12843          32          0.8        1282.2       0.1X
infer timestamps from Dataset[String]             24904          25034         154          0.4        2490.4       0.0X
date strings                                       1501           1507           5          6.7         150.1       0.6X
parse dates from Dataset[String]                   6573           6641         110          1.5         657.3       0.1X
from_csv(timestamp)                               12130          12150          18          0.8        1213.0       0.1X
from_csv(date)                                     5894           5922          27          1.7         589.4       0.2X

OpenJDK 64-Bit Server VM 11.0.14.1+1-LTS on Mac OS X 12.2.1
Apple M1 Pro
Filters pushdown:                         Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
w/o filters                                       10395          10427          30          0.0      103945.7       1.0X
pushdown disabled                                 10153          10189          32          0.0      101534.1       1.0X
w/ filters                                          650            652           3          0.2        6501.6      16.0X


